Index: ChildView.cpp
===================================================================
--- ChildView.cpp	(revision 0)
+++ ChildView.cpp	(working copy)
@@ -0,0 +1,53 @@
+// ChildView.cpp : implementation of the CChildView class
+//
+
+#include "stdafx.h"
+#include "VIMESNutritionManagr.h"
+#include "ChildView.h"
+
+#ifdef _DEBUG
+#define new DEBUG_NEW
+#endif
+
+
+// CChildView
+
+CChildView::CChildView()
+{
+}
+
+CChildView::~CChildView()
+{
+}
+
+
+BEGIN_MESSAGE_MAP(CChildView, CWnd)
+	ON_WM_PAINT()
+END_MESSAGE_MAP()
+
+
+
+// CChildView message handlers
+
+BOOL CChildView::PreCreateWindow(CREATESTRUCT& cs) 
+{
+	if (!CWnd::PreCreateWindow(cs))
+		return FALSE;
+
+	cs.dwExStyle |= WS_EX_CLIENTEDGE;
+	cs.style &= ~WS_BORDER;
+	cs.lpszClass = AfxRegisterWndClass(CS_HREDRAW|CS_VREDRAW|CS_DBLCLKS, 
+		::LoadCursor(NULL, IDC_ARROW), reinterpret_cast<HBRUSH>(COLOR_WINDOW+1), NULL);
+
+	return TRUE;
+}
+
+void CChildView::OnPaint() 
+{
+	CPaintDC dc(this); // device context for painting
+	
+	// TODO: Add your message handler code here
+	
+	// Do not call CWnd::OnPaint() for painting messages
+}
+
Index: ChildView.h
===================================================================
--- ChildView.h	(revision 0)
+++ ChildView.h	(working copy)
@@ -0,0 +1,35 @@
+// ChildView.h : interface of the CChildView class
+//
+
+
+#pragma once
+
+
+// CChildView window
+
+class CChildView : public CWnd
+{
+// Construction
+public:
+	CChildView();
+
+// Attributes
+public:
+
+// Operations
+public:
+
+// Overrides
+	protected:
+	virtual BOOL PreCreateWindow(CREATESTRUCT& cs);
+
+// Implementation
+public:
+	virtual ~CChildView();
+
+	// Generated message map functions
+protected:
+	afx_msg void OnPaint();
+	DECLARE_MESSAGE_MAP()
+};
+
Index: HMSDailyFoodOrder.cpp
===================================================================
--- HMSDailyFoodOrder.cpp	(revision 0)
+++ HMSDailyFoodOrder.cpp	(working copy)
@@ -0,0 +1,2189 @@
+#include "HMSDailyFoodOrder.h"
+#include "MainFrm.h"
+#include "HMSDailyFoodOrderList.h"
+#include "HMSConfirmDialog.h"
+#include "ReportDocument.h"
+#include "Excel.h"
+
+static long _OnOrderListLoadDataFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder*)pWnd)->OnOrderListLoadData();
+} 
+static void _OnOrderListDblClickFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder*)pWnd)->OnOrderListDblClick();
+} 
+static void _OnOrderListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CHMSDailyFoodOrder*)pWnd)->OnOrderListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnOrderListDeleteItemFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnOrderListDeleteItem();
+} 
+
+static int _OnOrderListPrintDeliveryDrugFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnOrderListPrintDeliveryDrug();
+}
+static int	_OnExportOrderDeliveryDrugFnc(CWnd *pWnd){
+	return	((CHMSDailyFoodOrder*)pWnd)->OnExportOrderDeliveryDrug();
+}
+static int _OnOrderListPrintSheetDateFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnOrderListPrintSheetDate();
+}
+static int _OnOrderListPrintSheetpublicityFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnOrderListPrintSheetPublicity();
+}
+
+static long _OnPatientListLoadDataFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder*)pWnd)->OnPatientListLoadData();
+} 
+static void _OnPatientListDblClickFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder*)pWnd)->OnPatientListDblClick();
+} 
+static void _OnPatientListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CHMSDailyFoodOrder*)pWnd)->OnPatientListSelectChange(nOldItem, nNewItem);
+} 
+
+static int _OnPatientListIssueAllFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnPatientListIssueAll();
+} 
+
+static int _OnPatientListIssueFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnPatientListIssue();
+} 
+
+static int _OnPatientListRollbackFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnPatientListRollback();
+} 
+
+static int _OnPatientListDeleteItemFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnPatientListDeleteItem();
+} 
+static long _OnDrugListLoadDataFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder*)pWnd)->OnDrugListLoadData();
+} 
+static void _OnDrugListDblClickFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder*)pWnd)->OnDrugListDblClick();
+} 
+static void _OnDrugListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CHMSDailyFoodOrder*)pWnd)->OnDrugListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnDrugListAddEntryFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnDrugListAddEntry();
+} 
+
+static int _OnDrugListDeleteItemFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnDrugListDeleteItem();
+} 
+static int _OnDrugListReturnFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnDrugListReturnDrug();
+} 
+
+/*static void _OnOrderNoChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnOrderNoChange();
+} */
+/*static void _OnOrderNoSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnOrderNoSetfocus();} */ 
+/*static void _OnOrderNoKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnOrderNoKillfocus();
+} */
+static int _OnOrderNoCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnOrderNoCheckValue();
+} 
+static void _OnFindSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnFindSelect();
+} 
+/*static void _OnOrderDateChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnOrderDateChange();
+} */
+/*static void _OnOrderDateSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnOrderDateSetfocus();} */ 
+/*static void _OnOrderDateKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnOrderDateKillfocus();
+} */
+static int _OnOrderDateCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnOrderDateCheckValue();
+} 
+/*static void _OnIssueDateChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnIssueDateChange();
+} */
+/*static void _OnIssueDateSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnIssueDateSetfocus();} */ 
+/*static void _OnIssueDateKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnIssueDateKillfocus();
+} */
+static int _OnIssueDateCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnIssueDateCheckValue();
+} 
+/*static void _OnStatusChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnStatusChange();
+} */
+/*static void _OnStatusSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnStatusSetfocus();} */ 
+/*static void _OnStatusKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+} */
+static int _OnStatusCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnStatusCheckValue();
+} 
+/*static void _OnPrintedChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnPrintedChange();
+} */
+/*static void _OnPrintedSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnPrintedSetfocus();} */ 
+/*static void _OnPrintedKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnPrintedKillfocus();
+} */
+/*static void _OnPatientNameChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderDialog *)pWnd)->OnPatientNameChange();
+} */
+/*static void _OnPatientNameSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderDialog *)pWnd)->OnPatientNameSetfocus();} */ 
+/*static void _OnPatientNameKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderDialog *)pWnd)->OnPatientNameKillfocus();
+} */
+static int _OnPatientNameCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnPatientNameCheckValue();
+} 
+static int _OnPrintedCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnPrintedCheckValue();
+} 
+/*static void _OnNoteChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnNoteChange();
+} */
+/*static void _OnNoteSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnNoteSetfocus();} */ 
+/*static void _OnNoteKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnNoteKillfocus();
+} */
+static int _OnNoteCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnNoteCheckValue();
+} 
+static void _OnAddSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnAddSelect();
+} 
+static void _OnEditSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnEditSelect();
+} 
+static void _OnDeleteSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnDeleteSelect();
+} 
+static void _OnSaveSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnSaveSelect();
+} 
+static void _OnCancelSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnCancelSelect();
+} 
+static void _OnSendSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnSendSelect();
+} 
+static void _OnPrintSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnPrintSelect();
+} 
+static void _OnPrintDeliveryDrugsSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnPrintDeliveryDrugsSelect();
+} 
+static void _OnAddDrugSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnAddDrugSelect();
+} 
+static void _OnAddAutomaticSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnAddAutomaticSelect();
+} 
+static int _OnAddHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnAddHMSDailyFoodOrder();
+} 
+static int _OnEditHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnEditHMSDailyFoodOrder();
+} 
+static int _OnDeleteHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnDeleteHMSDailyFoodOrder();
+} 
+static int _OnSaveHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnSaveHMSDailyFoodOrder();
+} 
+static int _OnCancelHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnCancelHMSDailyFoodOrder();
+} 
+//CHMSDailyFoodOrder::CHMSDailyFoodOrder(CWnd *pParent)
+CHMSDailyFoodOrder::CHMSDailyFoodOrder()
+{
+	m_nDlgWidth = 1000;
+	m_nDlgHeight = 620;
+	SetDefaultValues();
+	m_szOrderNo.Empty();
+}
+CHMSDailyFoodOrder::~CHMSDailyFoodOrder(){
+}
+void CHMSDailyFoodOrder::OnCreateComponents(){	
+	m_wndOrderInformation.Create(this, _T("Order Information"), 5, 5, 550, 180);
+	m_wndPatientInformation.Create(this, _T("Patient Information"), 555, 5, 1020, 410);
+	m_wndDrugInformation.Create(this, _T("Food Informations"), 555, 445, 1020, 625);
+	m_wndGroupListDrug.Create(this, _T("Food Type List"), 5, 185, 550, 625);
+	m_wndOrderNoLabel.Create(this, _T("Order ID"), 10, 30, 140, 55);
+	m_wndOrderNo.Create(this,145, 30, 275, 55); 
+	m_wndFind.Create(this, _T("&Find"), 825, 415, 925, 440);
+	m_wndOrderDateLabel.Create(this, _T("Order Date"), 10, 60, 140, 85);
+	m_wndOrderDate.Create(this,145, 60, 275, 85); 
+	m_wndIssueDateLabel.Create(this, _T("Issue Date"), 280, 60, 410, 85);
+	m_wndIssueDate.Create(this,415, 60, 545, 85); 
+	m_wndStatusLabel.Create(this, _T("Status"), 280, 30, 410, 55);
+	m_wndStatus.Create(this,415, 30, 545, 55); 
+	m_wndNoteLabel.Create(this, _T("Note"), 10, 90, 140, 115);
+	m_wndNote.Create(this,145, 90, 545, 115); 
+	m_wndSend.Create(this, _T("&&Approval"), 370, 150, 455, 175);
+	m_wndPrint.Create(this, _T("&Preview"), 460, 150, 545, 175);
+	m_wndPatientNameLabel.Create(this, _T("Patient Name"), 555, 415, 665, 440);
+	m_wndPatientName.Create(this,670, 415, 820, 440); 
+	m_wndDeptLabel.Create(this, _T("Dept"), 10, 120, 140, 145);
+	m_wndDept.Create(this,145, 120, 545, 145); 
+	m_wndOrderList.Create(this,10, 210, 545, 620); 
+	m_wndPatientList.Create(this,560, 30, 1015, 405); 
+	m_wndDrugList.Create(this,560, 470, 1015, 620); 
+	m_wndTypeLabel.Create(this, _T("Type"), 10, 149, 140, 174);
+	m_wndType.Create(this,145, 149, 360, 174); 
+	m_wndTotalCount.Create(this,935, 415, 1015, 440); 
+}
+void CHMSDailyFoodOrder::OnInitializeComponents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	m_wndFind.ModifyStyle(WS_TABSTOP, 0);
+	m_wndOrderNo.SetLimitText(9);
+	m_wndOrderNo.SetCheckValue(true);
+	m_wndOrderNo.ModifyStyle(0, ES_UPPERCASE);
+	//m_wndOrderDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndOrderDate.SetCheckValue(true);
+	//m_wndOrderDate.SetToolTipMessage(_T("Ngay yeu cau khong hop le"));
+	m_wndIssueDate.SetReadOnly(TRUE);
+	m_wndStatus.SetLimitText(35);
+	m_wndNote.SetLimitText(81);
+	//m_wndNote.SetCheckValue(true);
+	m_wndStatus.SetReadOnly(true);
+	m_wndPrinted.SetReadOnly(true);
+
+//	m_wndOrderNo.ModifyStyle(0, ES_NUMBER);
+
+	m_wndOrderList.InsertColumn(0, _T("ID"), CFMT_TEXT|CFMT_CENTER, 40);	//identify
+	m_wndOrderList.InsertColumn(1, _T("Desc"), CFMT_TEXT, 200);
+	m_wndOrderList.InsertColumn(2, _T("Unit"), CFMT_TEXT|CFMT_CENTER, 0);
+	m_wndOrderList.InsertColumn(3, _T("S\xE1ng"), CFMT_MONEY, 40);	
+	m_wndOrderList.InsertColumn(4, _T("Tr\x1B0\x61"), CFMT_MONEY, 40);	
+	m_wndOrderList.InsertColumn(5, _T("T\x1ED1i"), CFMT_MONEY, 40);	
+	m_wndOrderList.InsertColumn(6, _T("Qty"), CFMT_MONEY, 40);	
+	m_wndOrderList.InsertColumn(7, _T("Price"), CFMT_MONEY, 70);
+	m_wndOrderList.InsertColumn(8, _T("Amount"), CFMT_MONEY, 80);
+	m_wndOrderList.InsertColumn(9, _T("ItemID"), CFMT_TEXT, 0);	
+	m_wndOrderList.InsertColumn(10, _T("GroupID"), CFMT_TEXT, 0);
+	m_wndOrderList.SetSortHeader(false);
+	m_wndOrderList.GetHeaderControl()->SetItemHeight(2);
+	m_wndOrderList.GetHeaderControl()->MergeCell(_T("S\x1ED1 su\x1EA5t"), 0, 3, 1, 6, true);
+	m_wndOrderList.ModifyStyle(0, LVS_NOSORTHEADER);
+
+	m_wndPatientList.InsertColumn(0, _T(""), CFMT_NUMBER, 0);	//orderid
+	m_wndPatientList.InsertColumn(1, _T("Document No"), CFMT_NUMBER, 80);
+	m_wndPatientList.InsertColumn(2, _T("Patient Name"), CFMT_TEXT, 160);
+	m_wndPatientList.InsertColumn(3, _T("Bed"), CFMT_TEXT, 70);
+	m_wndPatientList.InsertColumn(4, _T("Date"), CFMT_DATE, 100);
+	m_wndPatientList.InsertColumn(5, _T("Status"), CFMT_TEXT|CFMT_CENTER, 0);
+	m_wndPatientList.InsertColumn(6, _T("OrderNo"), CFMT_NUMBER, 0);
+	m_wndPatientList.InsertColumn(7, _T("Doctor"), CFMT_TEXT, 120);
+	m_wndPatientList.InsertColumn(8, _T("Created By"), CFMT_TEXT, 0);
+
+	m_wndDrugList.InsertColumn(0, _T("ID"), CFMT_TEXT|CFMT_CENTER, 40);
+	m_wndDrugList.InsertColumn(1, _T("Desc"), CFMT_TEXT, 200);
+	m_wndDrugList.InsertColumn(2, _T("Unit"), CFMT_TEXT|CFMT_CENTER, 60);	
+	m_wndDrugList.InsertColumn(3, _T("Type"), CFMT_TEXT, 0);	
+	m_wndDrugList.InsertColumn(4, _T("SL"), CFMT_MONEY, 40);	
+	m_wndDrugList.InsertColumn(5, _T("Unit Price"), CFMT_MONEY, 70);
+	m_wndDrugList.InsertColumn(6, _T("Amount"), CFMT_MONEY, 80);
+	m_wndDrugList.InsertColumn(7, _T("Orderid"), CFMT_NUMBER, 0);	//product_id
+	m_wndDrugList.InsertColumn(8, _T("Itemdi"), CFMT_TEXT|CFMT_CENTER, 0);
+	//m_wndDrugList.GetHeaderControl()->SetItemHeight(2);
+	
+	
+	m_feefoodTbl.SetTableName(_T("HMS_FOODORDERSHEET"));
+	m_feefoodTbl.AddField(_T("HFOS_ORDERID"), dfLong); 
+	m_feefoodTbl.AddField(_T("HFOS_CREATEDBY"), dfText, 15); 
+	m_feefoodTbl.AddField(_T("HFOS_CREATEDDATE"), dfDateTime); 
+	m_feefoodTbl.AddField(_T("HFOS_UPDATEDBY"), dfText, 15); 
+	m_feefoodTbl.AddField(_T("HFOS_UPDATEDDATE"), dfDateTime); 	
+	m_feefoodTbl.AddField(_T("HFOS_DEPTID"), dfText, 7); 
+	m_feefoodTbl.AddField(_T("HFOS_ORDERTYPE"), dfText, 1);	
+	m_feefoodTbl.AddField(_T("HFOS_ORDERDATE"), dfDateTime);
+	m_feefoodTbl.AddField(_T("HFOS_ORDERSTATUS"), dfText, 1); 
+	m_feefoodTbl.AddField(_T("HFOS_APPROVEDATE"), dfDateTime); 
+	m_feefoodTbl.AddField(_T("HFOS_APPROVEBY"), dfText, 32); 
+	m_feefoodTbl.AddField(_T("HFOS_SHEETNO"), dfText, 65);
+	m_feefoodTbl.AddField(_T("HFOS_DESCRIPTION"), dfText, 254);
+
+}
+void CHMSDailyFoodOrder::OnSetWindowEvents(){
+	m_wndOrderList.SetEvent(WE_SELCHANGE, _OnOrderListSelectChangeFnc);
+	m_wndOrderList.SetEvent(WE_LOADDATA, _OnOrderListLoadDataFnc);
+	m_wndOrderList.SetEvent(WE_DBLCLICK, _OnOrderListDblClickFnc);
+	m_wndOrderList.SetWindowText(_T("Order Information"));
+	m_wndOrderList.AddEvent(1, _T("Print Daily Food"), _OnOrderListPrintDeliveryDrugFnc);
+	//m_wndOrderList.AddEvent(2, _T("Export Delivery Drugs"), _OnExportOrderDeliveryDrugFnc);
+	//m_wndOrderList.AddEvent(3, _T("Print Sheet By Date"), _OnOrderListPrintSheetDateFnc);
+	////m_wndOrderList.AddEvent(4, _T("Print shelt publicity drugs"), _OnOrderListPrintSheetpublicityFnc);
+	//m_wndOrderList.AddEvent(0, _T("-"), NULL);
+	//m_wndOrderList.AddEvent(5, _T("View Detail"), _OnOrderListDeleteItemFnc);
+
+	m_wndPatientList.SetEvent(WE_SELCHANGE, _OnPatientListSelectChangeFnc);
+	m_wndPatientList.SetEvent(WE_LOADDATA, _OnPatientListLoadDataFnc);
+	m_wndPatientList.SetEvent(WE_DBLCLICK, _OnPatientListDblClickFnc);
+	
+	/*
+	m_wndPatientList.SetWindowText(_T("Patient List"));
+	m_wndPatientList.AddEvent(1, _T("Issue All"), _OnPatientListIssueAllFnc);
+	m_wndPatientList.AddEvent(0, _T("-"), NULL);
+	m_wndPatientList.AddEvent(2, _T("Issue"), _OnPatientListIssueFnc);
+	m_wndPatientList.AddEvent(0, _T("-"), NULL);
+	m_wndPatientList.AddEvent(3, _T("DMO_Rollback"), _OnPatientListRollbackFnc);
+	m_wndPatientList.AddEvent(0, _T("-"), NULL);
+	m_wndPatientList.AddEvent(4, _T("Delete Patient"), _OnPatientListDeleteItemFnc);
+*/
+
+	m_wndDrugList.SetEvent(WE_SELCHANGE, _OnDrugListSelectChangeFnc);
+	m_wndDrugList.SetEvent(WE_LOADDATA, _OnDrugListLoadDataFnc);
+	m_wndDrugList.SetEvent(WE_DBLCLICK, _OnDrugListDblClickFnc);
+	m_wndDrugList.SetWindowText(_T("Drug List"));
+	/*m_wndDrugList.AddEvent(1, _T("Add Item"), _OnDrugListAddEntryFnc, 0, VK_F2);
+	m_wndDrugList.AddEvent(0, _T("-"), NULL);
+	m_wndDrugList.AddEvent(2, _T("Delete Item"), _OnDrugListDeleteItemFnc, 0, VK_DELETE);
+	m_wndDrugList.AddEvent(0, _T("-"), NULL);
+	m_wndDrugList.AddEvent(3, _T("Return Item"), _OnDrugListReturnFnc);*/
+	
+	//m_wndOrderNo.SetEvent(WE_CHANGE, _OnOrderNoChangeFnc);
+	//m_wndOrderNo.SetEvent(WE_SETFOCUS, _OnOrderNoSetfocusFnc);
+	//m_wndOrderNo.SetEvent(WE_KILLFOCUS, _OnOrderNoKillfocusFnc);
+	m_wndOrderNo.SetEvent(WE_CHECKVALUE, _OnOrderNoCheckValueFnc);
+	m_wndFind.SetEvent(WE_CLICK, _OnFindSelectFnc);
+	//m_wndOrderDate.SetEvent(WE_CHANGE, _OnOrderDateChangeFnc);
+	//m_wndOrderDate.SetEvent(WE_SETFOCUS, _OnOrderDateSetfocusFnc);
+	//m_wndOrderDate.SetEvent(WE_KILLFOCUS, _OnOrderDateKillfocusFnc);
+	m_wndOrderDate.SetEvent(WE_CHECKVALUE, _OnOrderDateCheckValueFnc);
+	//m_wndIssueDate.SetEvent(WE_CHANGE, _OnIssueDateChangeFnc);
+	//m_wndIssueDate.SetEvent(WE_SETFOCUS, _OnIssueDateSetfocusFnc);
+	//m_wndIssueDate.SetEvent(WE_KILLFOCUS, _OnIssueDateKillfocusFnc);
+	m_wndIssueDate.SetEvent(WE_CHECKVALUE, _OnIssueDateCheckValueFnc);
+	//m_wndStatus.SetEvent(WE_CHANGE, _OnStatusChangeFnc);
+	//m_wndStatus.SetEvent(WE_SETFOCUS, _OnStatusSetfocusFnc);
+	//m_wndStatus.SetEvent(WE_KILLFOCUS, _OnStatusKillfocusFnc);
+	m_wndStatus.SetEvent(WE_CHECKVALUE, _OnStatusCheckValueFnc);
+	//m_wndPrinted.SetEvent(WE_CHANGE, _OnPrintedChangeFnc);
+	//m_wndPrinted.SetEvent(WE_SETFOCUS, _OnPrintedSetfocusFnc);
+	//m_wndPrinted.SetEvent(WE_KILLFOCUS, _OnPrintedKillfocusFnc);
+	m_wndPrinted.SetEvent(WE_CHECKVALUE, _OnPrintedCheckValueFnc);
+	//m_wndNote.SetEvent(WE_CHANGE, _OnNoteChangeFnc);
+	//m_wndNote.SetEvent(WE_SETFOCUS, _OnNoteSetfocusFnc);
+	//m_wndNote.SetEvent(WE_KILLFOCUS, _OnNoteKillfocusFnc);
+	m_wndNote.SetEvent(WE_CHECKVALUE, _OnNoteCheckValueFnc);
+
+	m_wndAddAutomatic.SetEvent(WE_CLICK, _OnAddAutomaticSelectFnc);
+
+	//m_wndPatientName.SetEvent(WE_CHANGE, _OnPatientNameChangeFnc);
+	//m_wndPatientName.SetEvent(WE_SETFOCUS, _OnPatientNameSetfocusFnc);
+	//m_wndPatientName.SetEvent(WE_KILLFOCUS, _OnPatientNameKillfocusFnc);
+	m_wndPatientName.SetEvent(WE_CHECKVALUE, _OnPatientNameCheckValueFnc);
+
+	m_wndAdd.SetEvent(WE_CLICK, _OnAddSelectFnc);
+	m_wndEdit.SetEvent(WE_CLICK, _OnEditSelectFnc);
+	m_wndDelete.SetEvent(WE_CLICK, _OnDeleteSelectFnc);
+	m_wndSave.SetEvent(WE_CLICK, _OnSaveSelectFnc);
+	m_wndCancel.SetEvent(WE_CLICK, _OnCancelSelectFnc);
+	m_wndSend.SetEvent(WE_CLICK, _OnSendSelectFnc);
+	m_wndPrint.SetEvent(WE_CLICK, _OnPrintSelectFnc);
+	m_wndPrintDeliveryDrugs.SetEvent(WE_CLICK, _OnPrintDeliveryDrugsSelectFnc);
+	m_wndAddDrug.SetEvent(WE_CLICK, _OnAddDrugSelectFnc);
+
+	SetWindowFont(&m_wndTotalCount, GetFaceName(), GetFaceSize()+2, TRUE);
+	m_wndTotalCount.SetTextColor(RGB(0, 0, 255));
+	SetMode(VM_NONE);
+}
+void CHMSDailyFoodOrder::OnDoDataExchange(CDataExchange* pDX){
+	DDX_Text(pDX, m_wndOrderNo.GetDlgCtrlID(), m_szOrderNo);
+	DDX_TextEx(pDX, m_wndOrderDate.GetDlgCtrlID(), m_szOrderDate);
+	DDX_TextEx(pDX, m_wndIssueDate.GetDlgCtrlID(), m_szIssueDate);
+	DDX_Text(pDX, m_wndStatus.GetDlgCtrlID(), m_szStatusDesc);
+	DDX_Text(pDX, m_wndDept.GetDlgCtrlID(), m_szDept);
+	DDX_Text(pDX, m_wndNote.GetDlgCtrlID(), m_szNote);
+	DDX_Text(pDX, m_wndPatientName.GetDlgCtrlID(), m_szPatientName);
+	DDX_Text(pDX, m_wndTotalCount.GetDlgCtrlID(), m_nTotalCount);
+}
+void CHMSDailyFoodOrder::GetDataToScreen(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT  ") \
+		_T("HFOS_ORDERID as orderno, ") \
+		_T("HFOS_ORDERDATE as orderdate, ") \
+		_T("HFOS_APPROVEDATE as issuedate, ") \
+		_T("HFOS_DESCRIPTION as description, ") \
+		_T("HFOS_ORDERSTATUS as status, ") \
+		_T("HFOS_SHEETNO as sheetNo, ") \
+		_T("HFOS_DEPTID AS DEPTID, ") \
+		_T("HFOS_CREATEDBY as createdby ") \
+		_T("FROM HMS_FOODORDERSHEET ") \
+		_T("WHERE HFOS_ORDERID=%ld AND HFOS_ORDERSTATUS IN('S','A')"), 
+		m_nOID);
+	rs.ExecSQL(szSQL);
+//_fmsg(_T("%s"), szSQL);
+	if(!rs.IsEOF())
+	{
+		rs.GetValue(_T("createdby"), m_szCreatedBy);
+		rs.GetValue(_T("orderdate"), m_szOrderDate);
+		rs.GetValue(_T("issuedate"), m_szIssueDate);
+		//m_szOrderDate = m_szOrderTime.Left(10);
+		rs.GetValue(_T("description"), m_szNote);
+		rs.GetValue(_T("status"), m_szStatus);
+		rs.GetValue(_T("orderno"), m_szBatchNo);
+		rs.GetValue(_T("sheetNo"), m_szOrderNo);
+		m_szDept = pMF->GetDepartmentName(rs.GetValue(_T("deptid")));
+		//m_szOrderNo = m_szBatchNo;
+		m_szStatusDesc = pMF->GetStatusString(m_szStatus);
+		if(m_szStatus==_T("S"))
+			m_szIssueDate.Empty();		
+		SetMode(VM_VIEW);
+
+
+		
+		OnOrderListLoadData();
+		OnPatientListLoadData();
+
+		m_wndDrugList.DeleteAllItems();
+		CString szLabel;
+		m_wndSend.EnableWindow(true);
+		if(m_szStatus == _T("S")){
+			TranslateString(_T("&Approval"), szLabel);
+			m_wndSend.SetWindowText(szLabel);
+		}
+		else if(m_szStatus ==_T("A"))
+		{
+			TranslateString(_T("&Approval"), szLabel);
+			m_wndSend.SetWindowText(szLabel);
+			m_wndPrint.EnableWindow(true);
+			m_wndSend.EnableWindow(false);	
+		}		
+	}
+	else
+	{
+		SetMode(VM_NONE);
+	}
+
+
+	
+
+	if(m_wndOrderList.GetItemCount() <= 0){
+		m_wndSend.EnableWindow(false);
+		m_wndPrint.EnableWindow(false);
+		//m_wndPrintDeliveryDrugs.EnableWindow(false);
+	}
+
+}
+void CHMSDailyFoodOrder::GetScreenToData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CString szWhere;
+	
+	//m_feefoodTbl.SetValue(_T("HFOS_ORDERID"), dfLong); 
+	m_feefoodTbl.SetValue(_T("HFOS_CREATEDBY"), pMF->GetCurrentUser()); 
+	m_feefoodTbl.SetValue(_T("HFOS_CREATEDDATE"), pMF->GetSysDateTime()); 
+	m_feefoodTbl.SetValue(_T("HFOS_UPDATEDBY"), pMF->GetCurrentUser()); 
+	m_feefoodTbl.SetValue(_T("HFOS_UPDATEDDATE"), pMF->GetSysDateTime()); 	
+	m_feefoodTbl.SetValue(_T("HFOS_DEPTID"), pMF->GetDepartmentID()); 
+	m_feefoodTbl.SetValue(_T("HFOS_ORDERTYPE"), _T("F"));	
+	m_feefoodTbl.SetValue(_T("HFOS_ORDERDATE"), m_szOrderDate);
+	m_feefoodTbl.SetValue(_T("HFOS_ORDERSTATUS"), m_szStatus); 
+	//m_feefoodTbl.SetValue(_T("HFOS_APPROVEDATE"), dfDateTime); 
+	m_feefoodTbl.SetValue(_T("HFOS_APPROVEBY"), _T("")); 
+	m_feefoodTbl.SetValue(_T("HFOS_SHEETNO"), m_szOrderNo); 
+	m_feefoodTbl.SetValue(_T("HFOS_DESCRIPTION"), m_szNote);	
+	
+}
+void CHMSDailyFoodOrder::SetDefaultValues(){
+
+	m_szOrderDate.Empty();
+	m_szIssueDate.Empty();
+	m_szStatus.Empty();
+	m_nTotalCount=0;
+	m_szNote.Empty();
+
+}
+int CHMSDailyFoodOrder::SetMode(int nMode){
+ 		int nOldMode = GetMode(); 
+ 		CGuiView::SetMode(nMode); 
+ 		CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd(); 
+ 		CString szSQL; 
+ 		CRecord rs(&pMF->m_db); 
+  		switch(nMode){ 
+ 		case VM_ADD: 
+ 			EnableControls(TRUE); 
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			SetDefaultValues(); 
+			szSQL.Format(_T("AD_GETNEXTVAL('FOODORDER_NO','Y') "));
+			m_szOrderNo = pMF->ExecDML(szSQL);
+			m_wndOrderNo.EnableWindow(false);
+			m_szOrderDate = pMF->GetSysDate();
+			m_wndOrderDate.SetFocus();
+			m_szStatus = _T("O");
+			m_wndPatientName.EnableWindow(FALSE);
+			m_wndOrderList.DeleteAllItems();
+			m_wndPatientList.DeleteAllItems();
+			m_wndDrugList.DeleteAllItems();
+ 			break; 
+ 		case VM_EDIT: 
+ 			EnableControls(TRUE); 
+ 			EnableButtons(TRUE, 3, 4, -1); 
+			m_wndOrderNo.EnableWindow(false);
+ 			break; 
+ 		case VM_VIEW: 
+ 			EnableControls(FALSE); 
+ 			EnableButtons(FALSE, 3, 4, -1); 
+			m_wndOrderNo.EnableWindow(true);
+			m_wndOrderNo.SetNotEmpty(false);
+			if(m_szStatus != _T("O")){
+				m_wndPrint.EnableWindow(true);
+				m_wndPrintDeliveryDrugs.EnableWindow(true);
+			}
+			m_wndPatientName.EnableWindow(true);
+ 			break; 
+ 		case VM_NONE: 
+ 			EnableControls(FALSE); 
+ 			EnableButtons(TRUE, 0, -1); 
+ 			SetDefaultValues(); 
+			m_wndOrderNo.SetNotEmpty(false);
+			m_wndOrderNo.EnableWindow(true);
+			m_wndOrderList.DeleteAllItems();
+			m_wndPatientList.DeleteAllItems();
+			m_wndDrugList.DeleteAllItems();
+ 			break; 
+ 		}; 
+		if(m_szStatus == _T("O")){
+			m_wndAddDrug.EnableWindow(true);
+		}
+		else
+		{
+			m_wndAddDrug.EnableWindow(false);
+			m_wndDelete.EnableWindow(FALSE);
+		}
+		
+ 		UpdateData(FALSE); 
+ 		return nOldMode; 
+}
+void CHMSDailyFoodOrder::OnOrderListDblClick(){
+	
+} 
+void CHMSDailyFoodOrder::OnOrderListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+} 
+int CHMSDailyFoodOrder::OnOrderListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CHMSDailyFoodOrder::OnOrderListLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szOrderBy, szWhere;	
+	
+	m_wndOrderList.BeginLoad(); 
+	int nCount = 0;
+
+	if(m_szOrderType == _T("F")){
+		szSQL.Format(_T(" SELECT itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   groupid,") \
+		_T("   unit,") \
+		_T("   unitprice,") \
+		_T("   SUM(FoodQtyS)          AS QtyS,  ") \
+		_T("   SUM(FoodQtyT)          AS QtyT,  ") \
+		_T("   SUM(FoodQtyC)          AS QtyC,  ") \
+		_T("   SUM(FoodQty)          AS Qty,  ") \
+		_T("   SUM(FoodQty)*unitprice AS amount") \
+		_T(" FROM") \
+		_T("   (SELECT hfol_itemid AS itemid,") \
+		_T("     hfl_name2          AS foodid,") \
+		_T("     hfl_name          AS foodname,") \
+		_T("	 hfol_type		   AS type, ") \
+		_T("     hfol_groupid      AS groupid,") \
+		_T("     hfl_unit          AS unit,") \
+		_T("     hfol_unitprice    AS unitprice,    ") \
+		_T("     hfol_qtyorder     AS FoodQty,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'S' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyS,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'T' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyT,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'C' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyC    ") \
+		_T("   FROM hms_feefood") \
+		_T("   LEFT JOIN hms_feefoodline") \
+		_T("   ON(hfo_orderid=hfol_orderid)") \
+		_T("   LEFT JOIN hms_fee_list") \
+		_T("   ON(hfl_feeid        =hfol_itemid)") \
+		_T("   WHERE hfo_ordertype ='D'") \
+		_T("   AND hfo_reforder_id = %ld") \
+		_T("   )") \
+		_T(" GROUP BY groupid,") \
+		_T("   itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   unit,") \
+		_T("   unitprice") \
+		_T(" ORDER BY foodname,") \
+		_T("   unit,") \
+		_T("   unitprice"), m_nOID);
+	}
+	else
+	{
+	szSQL.Format(_T(" SELECT itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   groupid,") \
+		_T("   unit,") \
+		_T("   unitprice,") \
+		_T("   SUM(FoodQtyS)          AS QtyS,  ") \
+		_T("   SUM(FoodQtyT)          AS QtyT,  ") \
+		_T("   SUM(FoodQtyC)          AS QtyC,  ") \
+		_T("   SUM(FoodQty)          AS Qty,  ") \
+		_T("   SUM(FoodQty)*unitprice AS amount") \
+		_T(" FROM") \
+		_T("   (SELECT hfoc_itemid AS itemid,") \
+		_T("     hfl_name2          AS foodid,") \
+		_T("     hfl_name          AS foodname,") \
+		_T("	 hfoc_type		   AS type, ") \
+		_T("     hfoc_groupid      AS groupid,") \
+		_T("     hfl_unit          AS unit,") \
+		_T("     hfoc_unitprice    AS unitprice,    ") \
+		_T("     hfoc_qtyorder     AS FoodQty,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfoc_type = 'S' ") \
+		_T("		THEN hfoc_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyS,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfoc_type = 'T' ") \
+		_T("		THEN hfoc_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyT,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfoc_type = 'C' ") \
+		_T("		THEN hfoc_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyC    ") \
+		_T("   FROM hms_feefood") \
+		_T("   LEFT JOIN hms_feefoodcancel") \
+		_T("   ON(hfo_orderid=hfoc_orderid)") \
+		_T("   LEFT JOIN hms_fee_list") \
+		_T("   ON(hfl_feeid        =hfoc_itemid)") \
+		_T("   WHERE hfo_ordertype ='D'") \
+		_T("   AND hfoc_retorder_id = %ld") \
+		_T("   )") \
+		_T(" GROUP BY groupid,") \
+		_T("   itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   unit,") \
+		_T("   unitprice") \
+		_T(" ORDER BY foodname,") \
+		_T("   unit,") \
+		_T("   unitprice"), m_nOID);
+	}
+
+_fmsg(_T("%s"), szSQL);
+	nCount = rs.ExecSQL(szSQL);
+	int nIndex = 1;
+	double nTotalAmount =0;
+	int nItem = 0, nTotalQtyT =0, nTotalQtyC=0, nTotalQtyS=0, nTotalQty =0;	
+	CString tmpStr, szStorageName, szProductName;
+	while(!rs.IsEOF()){		
+		nItem++;
+		nTotalQtyS += str2int(rs.GetValue(_T("QtyS")));
+		nTotalQtyT += str2int(rs.GetValue(_T("QtyT")));
+		nTotalQtyC += str2int(rs.GetValue(_T("QtyC")));
+		nTotalQty += str2int(rs.GetValue(_T("Qty")));
+		nTotalAmount += str2double(rs.GetValue(_T("amount")));
+		m_wndOrderList.AddItems(
+			rs.GetValue(_T("foodid")),
+			rs.GetValue(_T("foodname")),
+			rs.GetValue(_T("unit")),
+			rs.GetValue(_T("QtyS")),
+			rs.GetValue(_T("QtyT")),
+			rs.GetValue(_T("QtyC")),
+			rs.GetValue(_T("Qty")),
+			rs.GetValue(_T("unitprice")),
+			rs.GetValue(_T("amount")), 
+			rs.GetValue(_T("itemid")),
+			rs.GetValue(_T("groupid")),
+			NULL);
+		rs.MoveNext();
+	}
+	if( nItem> 0){
+		TranslateString(_T("Total"), tmpStr);
+		nItem = m_wndOrderList.AddItems(
+			_T(""),
+			tmpStr,
+			_T(""),
+			ToString(nTotalQtyS),
+			ToString(nTotalQtyT),
+			ToString(nTotalQtyC),
+			ToString(nTotalQty),
+			_T(""),
+			ToString(nTotalAmount), 
+			_T(""),
+			_T(""),
+			NULL);
+		m_wndOrderList.SetItemBkColor(nItem, RGB(0, 125, 135), FALSE);
+		m_wndOrderList.SetItemTextColor(nItem, COLOR_WHITE, FALSE);
+		m_wndOrderList.MergeCell(nItem, 1, nItem, 2, DT_LEFT|DT_VCENTER|DT_SINGLELINE, false, true);
+	}
+	
+	m_wndOrderList.EndLoad(); 
+	return nCount;
+
+}
+void CHMSDailyFoodOrder::OnPatientListDblClick(){
+	
+} 
+void CHMSDailyFoodOrder::OnPatientListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	if(nNewItem < 0) return;
+	m_szIssueState = m_wndPatientList.GetItemText(nNewItem, 5);
+	m_szDoctor = m_wndPatientList.GetItemText(nNewItem, 7);
+	m_nDocumentNo = str2long(m_wndPatientList.GetItemText(nNewItem, 1));
+	m_nOrderID = str2long(m_wndPatientList.GetItemText(nNewItem, 0));
+	m_szPatientOrderDate = m_wndPatientList.GetItemText(nNewItem, 4);
+	OnDrugListLoadData();
+} 
+
+int CHMSDailyFoodOrder::OnPatientListIssueAll(){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+	CString szSQL;
+	CRecord rs(&pMF->m_db);
+
+	int nMsg = ShowMessage(14);
+	if(nMsg == IDNO)
+		return 0;
+	
+	szSQL.Format(_T("SELECT hfso_status as status ") \
+		_T("FROM hms_feefoodsheet ") \
+		_T("WHERE hfso_orderid=%ld and hfso_ordertype='T' "), m_nOID);
+	rs.ExecSQL(szSQL);
+	if(rs.IsEOF())
+		return -1;
+	rs.GetValue(_T("status"), m_szStatus);
+
+	if(m_szStatus != _T("A"))
+		return -1;
+
+
+	szSQL.Format(_T("UPDATE hms_feefood ") \
+		_T("SET hfo_orderstatus='I', hfo_updatedby='%s', hfo_updateddate=systimestamp ") \
+		_T("WHERE hfo_reforder_id=%ld AND hfo_orderstatus in('O','S','A') "),
+		pMF->GetCurrentUser(), m_nOID);
+	int ret = pMF->ExecSQL(szSQL);
+	if(ret >= 0){
+		OnPatientListLoadData();
+	}
+	return 0;
+}
+
+
+int CHMSDailyFoodOrder::OnPatientListIssue(){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+	CString szSQL;
+	CRecord rs(&pMF->m_db);
+
+	int nMsg = ShowMessage(15);
+	if(nMsg == IDNO)
+		return 0;
+
+	szSQL.Format(_T("SELECT hfso_status as status ") \
+		_T("FROM hms_feefoodsheet ") \
+		_T("WHERE hfso_orderid=%ld and hfso_ordertype='T' "), m_nOID);
+	rs.ExecSQL(szSQL);
+	if(rs.IsEOF())
+		return -1;
+	rs.GetValue(_T("status"), m_szStatus);
+
+
+	if(m_szStatus != _T("A"))
+		return -1;
+
+	return 0;
+}
+
+int CHMSDailyFoodOrder::OnPatientListRollback(){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+	CString szSQL;
+	if(m_szStatus != _T("A"))
+		return -1;
+	int nMsg = ShowMessage(16);
+	if(nMsg == IDNO)
+		return 0;
+
+	//szSQL.Format(_T("UPDATE hms_feefood SET hfo_orderstatus='A', hfo_updatedby='%s', hfo_updateddate=systimestamp ") \
+	//	_T("WHERE hfo_orderid=%ld AND hfo_orderstatus='I' AND hfo_payment<>'P'"),
+	//	pMF->GetCurrentUser(), m_nPharmaOID);
+	//int ret = pMF->ExecSQL(szSQL);
+	//if(ret >= 0){
+	//	OnPatientListLoadData();
+	//}
+	return 0;
+}
+int CHMSDailyFoodOrder::OnPatientListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd(); 
+	CRecord rs(&pMF->m_db);
+ 	CString szSQL;
+	
+	
+	if(m_wndDrugList.GetItemCount() > 0){
+		ShowMessageBox(_T("Ban phai xoa de muc truoc khi xoa benh nhan"));
+		return 0;
+	}
+
+	int nSel = m_wndPatientList.GetCurSel();
+	if(nSel < 0) return -1;
+	m_nOID = ToLong(m_wndPatientList.GetItemText(nSel, 6));	
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO) 
+ 		return -1; 
+
+	szSQL.Format(_T("SELECT hfso_status as status FROM hms_feefoodsheet WHERE hfso_orderid=%ld"), m_nOID);
+	rs.ExecSQL(szSQL);
+	if(rs.IsEOF())
+		return -1;
+	rs.GetValue(_T("status"), m_szStatus);
+
+	if(m_szStatus != _T("O"))
+		return -1;
+
+	szSQL.Format(_T("DELETE FROM hms_feefood WHERE hfo_orderid = %ld AND hfo_reforder_id=%ld "), m_nOrderID, m_nOID); 
+	//_fmsg(_T("%s"), szSQL);
+ 	int ret = str2int(pMF->ExecDML(szSQL)); 
+ 	if(ret > 0){ 
+		OnPatientListLoadData();
+		OnOrderListLoadData();
+ 	}
+	
+	return 0;
+} 
+long CHMSDailyFoodOrder::OnPatientListLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, tmpStr, szWhere;
+	int nCount = 0, nIndex =1;
+	m_wndPatientList.BeginLoad(); 
+
+	if(m_szOrderType == _T("F"))
+	{
+		szWhere.Format(_T(" and hfo_reforder_id =%ld "), m_nOID);		
+		
+		szSQL.Format(_T(" SELECT distinct hfo_docno as docno,") \
+		_T(" 	trim(hp_surname||' '||hp_midname||' '||hp_firstname) as pname,") \
+		_T(" 	hfo_roomid||'.'||hfo_bedid as bedid,") \
+		_T(" 	 Cast_Timestamp2Date(hfo_orderdate) as orderdate, hfo_createdby ") \
+		_T(" FROM hms_feefood ") \
+		_T(" LEFT JOIN hms_patient ON(hfo_patientno=hp_patientno)") \
+		_T(" WHERE hfo_ordertype ='D' %s ORDER BY docno,orderdate "), szWhere);
+	}
+	else
+	{
+		szWhere.Format(_T(" and hfoc_retorder_id =%ld "), m_nOID);			
+			
+			szSQL.Format(_T(" SELECT distinct hfo_docno as docno,") \
+		_T(" 	trim(hp_surname||' '||hp_midname||' '||hp_firstname) as pname,") \
+		_T(" 	hfo_roomid||'.'||hfo_bedid as bedid,") \
+		_T(" 	trunc_date(hfo_orderdate) as orderdate, hfo_createdby ") \
+		_T(" FROM hms_feefood ") \
+		_T(" LEFT JOIN hms_feefoodcancel") \
+		_T(" ON(hfo_orderid=hfoc_orderid)") \
+		_T(" LEFT JOIN hms_patient ON(hfo_patientno=hp_patientno)") \
+		_T(" WHERE hfo_ordertype ='D' %s ORDER BY docno,orderdate "), szWhere);
+	}
+
+	_fmsg(_T("%s"), szSQL);
+
+	nCount = rs.ExecSQL(szSQL);
+	long nDocumentNo;
+	int n = -1;
+		m_nTotalCount = 0;
+	CString szFirstName, szMidName, szSurName, szSearchName;
+	CString szFirstName2, szMidName2, szSurName2, szSearchName2, szShortName;
+	CString szNewLine, szOldLine;
+	if(!m_szPatientName.IsEmpty())
+	{
+		StringLower(m_szPatientName, szSearchName);
+		SplitName(szSearchName, szSurName, szMidName, szFirstName);
+	}
+
+	while(!rs.IsEOF()){
+		rs.GetValue(_T("pname"), tmpStr);
+		if(!m_szPatientName.IsEmpty()){
+
+			CString szPatientName;
+			
+			StringLower(tmpStr, szPatientName);
+
+			SplitName(szPatientName, szSurName2, szMidName2, szFirstName2);
+			GetShortName(szPatientName, szShortName);
+			if(szShortName != m_szPatientName)
+			{
+				if(!szFirstName.IsEmpty() && szFirstName != szFirstName2){
+					rs.MoveNext();
+					continue;
+				}
+			}
+
+				
+			if(!szSurName.IsEmpty() && szSurName != szSurName2){
+				rs.MoveNext();
+				continue;
+			}
+			if(!szMidName.IsEmpty() && szMidName2.Find(szMidName) == -1){
+				rs.MoveNext();
+				continue;
+			}
+			
+		}
+
+		rs.GetValue(_T("docno"), nDocumentNo);
+		tmpStr.Format(_T("%d"), nIndex++);
+
+		int nItem = m_wndPatientList.AddItems(
+			rs.GetValue(_T("orderid")),
+			rs.GetValue(_T("docno")),
+			rs.GetValue(_T("pname")), 
+			rs.GetValue(_T("bedid")), 
+			rs.GetValue(_T("orderdate")), 
+			rs.GetValue(_T("Status")), 
+			rs.GetValue(_T("orderid")), 
+			rs.GetValue(_T("doctor")), 
+			rs.GetValue(_T("createdby")), 
+			NULL);		
+		
+		szNewLine.Format(_T("%d"), nDocumentNo);
+		if(szNewLine !=szOldLine && !szNewLine.IsEmpty()){
+			m_nTotalCount++;
+			szOldLine = szNewLine;
+		}
+
+		rs.MoveNext();
+	}
+	m_wndPatientList.EndLoad(); 
+	if(n < 0)
+		n = m_wndPatientList.GetItemCount();
+	m_wndPatientList.SetCurSel(n);
+
+	UpdateData(false);
+	return nCount;
+}
+void CHMSDailyFoodOrder::OnDrugListDblClick(){
+	
+} 
+void CHMSDailyFoodOrder::OnDrugListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+} 
+
+int CHMSDailyFoodOrder::OnDrugListAddEntry(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	return 0;
+} 
+
+int CHMSDailyFoodOrder::OnDrugListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd(); 
+ 	CString szSQL, szItemID, szType; 
+	CRecord rs(&pMF->m_db);
+
+	long nIDX;
+	long nOrderID;
+	if(m_szStatus != _T("O"))
+		return -1;
+	
+	if(pMF->GetCurrentUser() != m_szCreatedBy)
+	{
+		CString szMsg;
+		szMsg.Format(_T("This order created by other user[%s]. Can not delete it"), m_szCreatedBy);
+		ShowMessageBox(szMsg);
+		return -1;
+	}
+
+	int nSel = m_wndDrugList.GetCurSel();
+	if(nSel < 0) return -1;
+	
+	
+	
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO) 
+ 		return -1; 
+
+	int ret = 0;
+	
+
+	nIDX = str2long(m_wndDrugList.GetItemText(nSel, 0));
+	szType = m_wndDrugList.GetItemText(nSel, 3);
+	nOrderID = str2long(m_wndDrugList.GetItemText(nSel, 7));
+	szItemID = m_wndDrugList.GetItemText(nSel, 8);
+	
+
+	szSQL.Format(_T("DELETE FROM hms_feefoodline WHERE hfol_orderid=%ld and hfol_itemid='%s' AND hfol_type ='%s' "), nOrderID, szItemID,szType); 
+	_fmsg(_T("%s"), szSQL);
+ 	int res =  pMF->ExecSQL(szSQL); 
+	if(res > 0){
+		m_wndDrugList.DeleteItem(nSel);
+		ret += res;
+	}
+	
+	szSQL.Format(_T("SELECT COUNT(*) FROM hms_feefoodline WHERE hfol_orderid=%ld "), nOrderID);
+	rs.ExecSQL(szSQL);
+	if(rs.GetIntValue() <= 0)
+	{
+		szSQL.Format(_T("DELETE FROM hms_feefood WHERE hfo_orderid=%ld "), nOrderID);
+		pMF->ExecSQL(szSQL);
+	}
+
+ 	if(ret >= 0){
+		OnOrderListLoadData();
+		if(m_wndDrugList.GetItemCount() <=0){			
+			OnPatientListLoadData();
+			OnOrderListLoadData();
+		}
+ 	}
+	return 0;
+} 
+int CHMSDailyFoodOrder::OnDrugListReturnDrug(){
+	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd(); 
+ 	CString szSQL, szItemID, szType; 
+	CRecord rs(&pMF->m_db);
+
+	long nIDX;
+	long nOrderID;
+	if(m_szStatus == _T("O"))
+		return -1;
+	
+	if(pMF->GetCurrentUser() != m_szCreatedBy)
+	{
+		CString szMsg;
+		szMsg.Format(_T("This order created by other user[%s]. Can not delete it"), m_szCreatedBy);
+		ShowMessageBox(szMsg);
+		return -1;
+	}
+
+	int nSel = m_wndDrugList.GetCurSel();
+	if(nSel < 0) return -1;
+	
+	
+	
+ 	if(ShowMessageBox(_T("\x42\x1EA1n \x63\xF3 mu\x1ED1n h\x1EE7y su\x1EA5t \x103n \x63ho \x62\x1EC7nh nh\xE2n kh\xF4ng?"), MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO) 
+ 		return -1; 
+
+	int ret = 0;
+	
+
+	nIDX = str2long(m_wndDrugList.GetItemText(nSel, 0));
+	szType = m_wndDrugList.GetItemText(nSel, 3);
+	nOrderID = str2long(m_wndDrugList.GetItemText(nSel, 7));
+	szItemID = m_wndDrugList.GetItemText(nSel, 8);
+	
+
+	szSQL.Format(_T("UPDATE hms_feefoodline  SET hfe_refstatus ='C' WHERE hfol_orderid=%ld and hfol_itemid='%s' AND hfol_type ='%s' "), nOrderID, szItemID,szType); 
+	_fmsg(_T("%s"), szSQL);
+ 	int res =  pMF->ExecSQL(szSQL);	
+ 	if(ret >= 0){
+		OnOrderListLoadData();
+ 	}
+	return 0;
+} 
+long CHMSDailyFoodOrder::OnDrugListLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, tmpStr;
+	m_wndDrugList.BeginLoad(); 
+	int nCount = 0, nIndex=1;
+
+	if(m_szOrderType == _T("F"))
+	{
+		szSQL.Format(_T(" SELECT hfl_name2 AS idx,") \
+		_T("   hfol_orderid   AS orderid,") \
+		_T("   hfo_orderstatus, hfe_refstatus,") \
+		_T("   hfl_feeid                                           AS feeid,") \
+		_T("   hfl_name                                            AS name,") \
+		_T("   hfol_type                                           AS type,") \
+		_T("   hfl_unit                                            AS unit,") \
+		_T("   hfol_unitprice                                      AS unitprice,") \
+		_T("   SUM(hfol_qtyorder)                                  AS qtyorder,") \
+		_T("   SUM(hfol_qtyissue -hfol_qtyreverse)                 AS qtyissue,") \
+		_T("   SUM((hfol_qtyissue-hfol_qtyreverse)*hfol_unitprice) AS amount") \
+		_T(" FROM hms_feefood") \
+		_T(" LEFT JOIN hms_feefoodline") \
+		_T(" ON(hfol_orderid=hfo_orderid)") \
+		_T(" LEFT JOIN hms_fee_list") \
+		_T(" ON(hfol_itemid          =hfl_feeid)") \
+		_T(" WHERE hfo_docno         =%ld") \
+		_T(" AND hfol_retorder_id    =%ld") \
+		_T(" AND Cast_Timestamp2Date(hfo_orderdate)=cast_string2date('%s')") \
+		_T(" GROUP BY hfol_orderid,") \
+		_T("   hfo_orderstatus,") \
+		_T("   hfl_name2,") \
+		_T("   hfl_feeid,") \
+		_T("   hfl_name,") \
+		_T("   hfl_unit,") \
+		_T("   hfol_type,") \
+		_T("   hfol_unitprice, hfe_refstatus") \
+		_T(" ORDER BY hfol_orderid,") \
+		_T("   hfl_name2,") \
+		_T("   hfl_name,") \
+		_T("   hfl_unit "), m_nDocumentNo,  m_nOID, m_szPatientOrderDate);
+	}
+	else
+	{
+				szSQL.Format(_T(" SELECT hfl_name2 AS idx,") \
+		_T("   hfoc_orderid   AS orderid,") \
+		_T("   hfo_orderstatus, hfe_refstatus,") \
+		_T("   hfl_feeid                                           AS feeid,") \
+		_T("   hfl_name                                            AS name,") \
+		_T("   hfoc_type                                           AS type,") \
+		_T("   hfl_unit                                            AS unit,") \
+		_T("   hfoc_unitprice                                      AS unitprice,") \
+		_T("   SUM(hfoc_qtyorder)                                  AS qtyorder,") \
+		_T("   SUM(hfoc_qtyissue -hfoc_qtyreverse)                 AS qtyissue,") \
+		_T("   SUM((hfoc_qtyissue-hfoc_qtyreverse)*hfoc_unitprice) AS amount") \
+		_T(" FROM hms_feefood") \
+		_T(" LEFT JOIN hms_feefoodcancel") \
+		_T(" ON(hfoc_orderid=hfo_orderid)") \
+		_T(" LEFT JOIN hms_fee_list") \
+		_T(" ON(hfoc_itemid          =hfl_feeid)") \
+		_T(" WHERE hfo_docno         =%ld") \
+		_T(" AND hfoc_retorder_id    =%ld") \
+		_T(" AND trunc_date(hfo_orderdate)=cast_string2date('%s')") \
+		_T(" GROUP BY hfoc_orderid,") \
+		_T("   hfo_orderstatus,") \
+		_T("   hfl_name2,") \
+		_T("   hfl_feeid,") \
+		_T("   hfl_name,") \
+		_T("   hfl_unit,") \
+		_T("   hfoc_type,") \
+		_T("   hfoc_unitprice, hfe_refstatus") \
+		_T(" ORDER BY hfoc_orderid,") \
+		_T("   hfl_name2,") \
+		_T("   hfl_name,") \
+		_T("   hfl_unit, hfoc_type DESC "), m_nDocumentNo,  m_nOID, m_szPatientOrderDate);
+
+	}
+//
+	_fmsg(_T("%s"), szSQL);
+	nCount = rs.ExecSQL(szSQL);
+	int nItem = 0;
+	float nQtyOrder, nQtyIssue;
+	CString szStatus;
+	while(!rs.IsEOF()){
+		rs.GetValue(_T("hfe_refstatus"), szStatus);
+		nItem = m_wndDrugList.AddItems(
+			rs.GetValue(_T("idx")),			
+			rs.GetValue(_T("name")), 
+			rs.GetValue(_T("unit")), 			
+			rs.GetValue(_T("type")), 
+			rs.GetValue(_T("qtyissue")), 
+			rs.GetValue(_T("unitprice")), 
+			rs.GetValue(_T("amount")),
+			rs.GetValue(_T("orderid")), 
+			rs.GetValue(_T("feeid")),
+			szStatus,
+			NULL);
+
+		if(szStatus == _T("C")){
+			m_wndDrugList.SetItemBkColor(nItem, RGB(200, 128, 0), false);
+			m_wndDrugList.SetItemTextColor(nItem, COLOR_WHITE, false);
+		}
+
+		rs.MoveNext();	
+	}
+	m_wndDrugList.EndLoad(); 
+	return nCount;
+}
+/*void CHMSDailyFoodOrder::OnOrderNoChange(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnOrderNoSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnOrderNoKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnOrderNoCheckValue(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+
+	
+	if(GetMode() == VM_VIEW || GetMode() == VM_NONE){
+		szSQL.Format(_T("SELECT HFOS_ORDERID ") \
+			_T("FROM HMS_FOODORDERSHEET ") \
+			_T("WHERE HFOS_SHEETNO='%s'"), 
+			m_szOrderNo);
+		rs.ExecSQL(szSQL);
+_tprintf(_T("\r\n%s"), szSQL);
+		if(rs.GetRecordCount() <=0)
+		{
+
+			m_wndOrderNo.SetToolTipMessage(_T("Order identify not found"));
+			SetMode(VM_NONE);
+			m_wndOrderNo.SetFocus();
+			
+			return -1;			
+		}
+		rs.GetValue(_T("HFOS_ORDERID"), m_nOID);
+		if(m_nOID > 0)
+		{
+			GetDataToScreen();
+			m_wndOrderNo.SetFocus();
+		}
+		return 1;
+	}
+	return 0;
+} 
+void CHMSDailyFoodOrder::OnFindSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	static CString szFromDate, szToDate;
+	OnOrderDateCheckValue();	
+} 
+/*void CHMSDailyFoodOrderDialog::OnPatientNameChange(){
+	
+} */
+/*void CHMSDailyFoodOrderDialog::OnPatientNameSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrderDialog::OnPatientNameKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnPatientNameCheckValue(){
+	OnPatientListLoadData();
+	return 0;
+} 
+
+/*void CHMSDailyFoodOrder::OnOrderDateChange(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnOrderDateSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnOrderDateKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnOrderDateCheckValue(){
+	UpdateData(true);
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	int n = CompareDate(m_szOrderDate, pMF->GetSysDate());
+	
+	if(n < -3 || n > 3)
+		return -1;
+	return 0;
+} 
+/*void CHMSDailyFoodOrder::OnIssueDateChange(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnIssueDateSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnIssueDateKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnIssueDateCheckValue(){
+	return 0;
+} 
+
+/*void CHMSDailyFoodOrder::OnStatusChange(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnStatusSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnStatusKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnStatusCheckValue(){
+	return 0;
+} 
+/*void CHMSDailyFoodOrder::OnPrintedChange(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnPrintedSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnPrintedKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnPrintedCheckValue(){
+	return 0;
+} 
+/*void CHMSDailyFoodOrder::OnNoteChange(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnNoteSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnNoteKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnNoteCheckValue(){
+	return 0;
+} 
+void CHMSDailyFoodOrder::OnAddSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnAddHMSDailyFoodOrder();
+	
+} 
+void CHMSDailyFoodOrder::OnEditSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnEditHMSDailyFoodOrder();
+} 
+void CHMSDailyFoodOrder::OnDeleteSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnDeleteHMSDailyFoodOrder();
+} 
+void CHMSDailyFoodOrder::OnSaveSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnSaveHMSDailyFoodOrder();
+} 
+void CHMSDailyFoodOrder::OnCancelSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnCancelHMSDailyFoodOrder();
+} 
+void CHMSDailyFoodOrder::OnSendSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, tmpStr, szStatus;
+	CString szLabel, szSendOrderBy,szSendByComfirm;
+	if(m_wndOrderList.GetItemCount() <= 0)
+		return;
+
+	/*if(!pMF->CheckPermission(_T("11.04")))
+	{
+		ShowMessageBox(_T("Permission Denined."), 0);
+		return;
+	}*/
+
+	szSendByComfirm.Empty();
+	szSendOrderBy.Empty();
+	pMF->m_bConfirm = true;
+	if(pMF->m_bConfirm)
+	{
+		CHMSConfirmDialog dlg;
+		dlg.m_szDoctor = pMF->m_szDoctor;		
+		if(dlg.DoModal() != IDOK)
+			return;
+		szSendOrderBy = dlg.m_szDoctor;
+	}
+
+	szSQL.Format(_T("SELECT hfos_orderstatus as status ") \
+		_T("FROM hms_foodordersheet ") \
+		_T("WHERE hfos_orderid=%ld "), m_nOID);
+	rs.ExecSQL(szSQL);
+	if(rs.IsEOF())
+		return;
+
+	rs.GetValue(_T("status"), szStatus);
+	_tprintf(_T("%s"), szStatus);
+	if(szStatus == _T("S"))
+	{
+		pMF->BeginTransaction();
+		if(m_szOrderType == _T("F"))
+		{
+			szSQL.Format(_T("UPDATE hms_foodordersheet SET hfos_updateddate=CURRENT_TIMESTAMP,hfos_updatedby='%s', hfos_approveby='%s',") \
+				_T("hfos_approvedate=CURRENT_TIMESTAMP,hfos_orderstatus='A' ") \
+				_T("WHERE hfos_orderid=%ld AND hfos_orderstatus='S' "), 
+				pMF->GetCurrentUser(),szSendOrderBy, m_nOID);
+			pMF->ExecSQL(szSQL);
+	_tprintf(_T("%s"), szSQL);
+			szSQL.Format(_T("UPDATE hms_feefood SET hfo_orderstatus='A', hfo_updateddate=CURRENT_TIMESTAMP, hfo_approvedate=CURRENT_TIMESTAMP,hfo_updatedby='%s',hfo_approveby='%s' ") \
+				_T("WHERE hfo_reforder_id=%ld and hfo_ordertype='D' "), pMF->GetCurrentUser(),szSendOrderBy,m_nOID);
+			pMF->ExecSQL(szSQL);
+		}
+		else
+		{
+			szSQL.Format(_T("HMS_FOODORDER_APPROVA_CANCEL(%ld,'%s','%s')"), m_nOID,_T(""), _T("F"));		
+			_tprintf(_T("%s"), szSQL);
+			int ret = str2long(pMF->ExecDML(szSQL));
+			if(ret > 0){
+				szSQL.Format(_T("UPDATE hms_foodordersheet SET hfos_updateddate=CURRENT_TIMESTAMP,hfos_updatedby='%s', hfos_approveby='%s',") \
+				_T("hfos_approvedate=CURRENT_TIMESTAMP,hfos_orderstatus='A' ") \
+				_T("WHERE hfos_orderid=%ld AND hfos_orderstatus='S' "), 
+				pMF->GetCurrentUser(),szSendOrderBy, m_nOID);
+				pMF->ExecSQL(szSQL);
+				_tprintf(_T("%s"), szSQL);
+			}
+		}
+
+		pMF->Commit();
+	}	
+
+	GetDataToScreen();
+} 
+void CHMSDailyFoodOrder::OnPrintSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szOrderDate;
+
+	if(m_szStatus == _T("O"))
+	{
+		ShowMessageBox(_T("Phi\x1EBFu tr\x1EA1ng th\xE1i \x111\x61ng m\x1EDF. \x42\x1EA1n ph\x1EA3i \x78\xE1\x63 nh\x1EADn g\x1EEDi phi\x1EBFu"));
+		return;
+	}
+
+	szSQL.Format(_T("SELECT DISTINCT Cast_Timestamp2Date(hfo_orderdate) as orderdate ") \
+		_T(" FROM hms_feefood ") \
+		_T(" WHERE hfo_reforder_id =%d ") \
+		_T(" ORDER BY  Cast_Timestamp2Date(hfo_orderdate)"), m_nOID);
+	rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){
+		rs.GetValue(_T("orderdate"), szOrderDate);
+		OnPrintDeliverySummery(m_nOID, szOrderDate);
+		OnPrintDelivery(m_nOID, szOrderDate);
+		rs.MoveNext();
+	}
+	
+} 
+
+
+int CHMSDailyFoodOrder::OnOrderListPrintSheetPublicity(){
+	return 0;	
+}
+int CHMSDailyFoodOrder::OnOrderListPrintSheetDate(){
+	return 0;
+}
+int CHMSDailyFoodOrder::OnAddHMSDailyFoodOrder(){
+ 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)  
+ 		return -1; 
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd(); 
+
+	if(!pMF->CheckPermission(_T("11.01")))
+	{
+		ShowMessageBox(_T("Permission Denined."), 0);
+		return 0;
+	}
+
+ 	SetMode(VM_ADD);
+	return 0; 
+}
+int CHMSDailyFoodOrder::OnEditHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW) 
+ 		return -1; 
+	
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd(); 
+	if(!pMF->CheckPermission(_T("11.02")))
+	{
+		ShowMessageBox(_T("Permission Denined."), 0);
+		return 0;
+	}
+
+	SetMode(VM_EDIT);
+
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT count(*) FROM hms_feefood WHERE hfo_reforder_id= %ld "), m_nOID);
+	rs.ExecSQL(szSQL);
+	if(rs.GetIntValue() > 0){
+		m_wndOrderDate.EnableWindow(false);
+		m_wndNote.SetFocus();
+	}
+ 	
+	return 0;  
+}
+int CHMSDailyFoodOrder::OnDeleteHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW || m_szStatus != _T("O")) 
+ 		return -1; 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd(); 
+ 	CString szSQL; 
+
+
+	if(!pMF->CheckPermission(_T("11.03")))
+	{
+		ShowMessageBox(_T("Permission Denined."), 0);
+		return 0;
+	}
+
+	if(pMF->GetCurrentUser() != m_szCreatedBy)
+	{
+		CString szMsg;
+		szMsg.Format(_T("This order created by other user[%s]. Can not delete it"), m_szCreatedBy);
+		ShowMessageBox(szMsg);
+	}
+
+	if(m_wndOrderList.GetItemCount() > 0)
+	{
+		ShowMessageBox(_T("Ban phai xoa thuoc cua cac benh nhan truoc khi xoa phieu."));
+		return -1;
+	}
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO) 
+ 		return -1; 
+ 	
+	szSQL.Format(_T("DELETE FROM hms_foodordersheet WHERE hfos_orderid = %ld AND HFOS_ORDERSTATUS = 'O'"), m_nOID); 
+ 	int ret = pMF->ExecSQL(szSQL); 
+ 	if(ret >= 0){ 
+		m_wndPatientList.DeleteAllItems();
+		m_wndDrugList.DeleteAllItems();
+		m_wndOrderList.DeleteAllItems();
+ 		SetMode(VM_NONE); 
+ 	}
+	return 0;
+}
+int CHMSDailyFoodOrder::OnSaveHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT) 
+ 		return -1; 
+	
+ 	if(!IsValidateData()) 
+ 		return -1; 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd(); 
+	CRecord rs(&pMF->m_db);
+ 	CString szSQL; 
+ 	if(GetMode() == VM_ADD){ 
+		szSQL.Format(_T("AD_NEXTSEQUENCE('M_TRANSACTION_ID_ASQ') "));
+		m_nOID = str2long(pMF->ExecDML(szSQL));	
+		if(m_nOID <=0) return -1;		
+		m_feefoodTbl.SetValue(_T("HFOS_ORDERID"), m_nOID);
+ 		szSQL = m_feefoodTbl.GetInsertSQL(); 
+ 	} 
+ 	else if(GetMode() == VM_EDIT){ 
+ 		CString szWhere; 
+ 		szWhere.Format(_T(" WHERE HFOS_ORDERID=%ld "), m_nOID); 
+ 		szSQL = m_feefoodTbl.GetUpdateSQL(_T("hfos_createdby, hfos_createddate,hfos_approveddate,hfos_orderstatus"));
+ 		szSQL += szWhere; 
+ 	} 
+ _fmsg(_T("%s"), szSQL); 
+ 	int ret = pMF->ExecSQL(szSQL); 
+ 	if(ret > 0) 
+ 	{ 	
+		if(GetMode() == VM_EDIT){
+			SetMode(VM_VIEW); 
+		}
+		else
+		{
+			GetDataToScreen();
+			SetMode(VM_VIEW); 
+			m_wndAddDrug.SetFocus();
+		}
+ 		
+		
+ 	} 
+ 	return m_nOID; 
+ 	return 0; 
+}
+void CHMSDailyFoodOrder::OnAddAutomaticSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+
+	
+} 
+
+int CHMSDailyFoodOrder::OnCancelHMSDailyFoodOrder(){
+ 	if(GetMode() == VM_EDIT) 
+ 	{ 
+ 		SetMode(VM_VIEW); 
+ 	} 
+ 	else 
+ 	{ 
+ 		SetMode(VM_NONE); 
+ 	} 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd(); 
+ 	return 0;
+} 
+int CHMSDailyFoodOrder::OnHMSDailyFoodOrderListLoadData(){
+	return 0;
+}
+
+
+void CHMSDailyFoodOrder::RefreshData(){
+	OnOrderListLoadData();
+	OnPatientListLoadData();
+}
+
+void CHMSDailyFoodOrder::LoadDrugList(long nID){
+	for (int i =0; i < m_wndPatientList.GetItemCount(); i++){
+		m_nOID = ToLong(m_wndPatientList.GetItemText(i, 6));
+		if(m_nOID = nID)
+		{
+			m_wndPatientList.SetCurSel(i);
+			break;
+		}
+	}
+}
+
+void CHMSDailyFoodOrder::OnPrintDeliverySummery(long nTransactionID, LPCTSTR lpszOrderDate){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+	CReport rpt;	
+	CString tmpStr, szSQL;
+	CRecord rs(&pMF->m_db);	
+	long nPharmaOID;
+	
+	if(!rpt.Init(_T("Reports/HMS/TM_FOODORDERSUMMERY.RPT")) )
+		return;
+
+	tmpStr.Empty();
+	StringUpper(pMF->m_CompanyInfo.sc_pname, tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("HealthService"), tmpStr);
+	StringUpper(pMF->m_CompanyInfo.sc_name, tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("HospitalName"), tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("Department"), pMF->GetDepartmentName(pMF->m_szDept));
+	tmpStr.Format(rpt.GetReportHeader()->GetValue(_T("ReportDate")), CDate::Convert(lpszOrderDate, yyyymmdd, ddmmyyyy));
+	rpt.GetReportHeader()->SetValue(_T("ReportDate"), tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("SheetNo"), m_szOrderNo);
+	//Page Header
+
+	szSQL.Format(_T(" SELECT ") \
+	_T("   foodid,") \
+	_T("   foodname,") \
+	_T("   unitprice, ") \
+	_T("   SUM(FoodQtyT/2) AS FoodQtyT,") \
+	_T("   SUM(FoodQtyC/2) AS FoodQtyC,") \
+	_T("   SUM(QUAN/2) AS QUAN,") \
+	_T("   SUM(BAOHIEM/2) AS BAOHIEM,") \
+	_T("   SUM(DICHVU/2) AS DICHVU,") \
+	_T("   SUM(CHINHSACH/2) AS CHINHSACH,") \
+	_T("   SUM(HUUTRI/2) AS HUUTRI,") \
+	_T("   SUM(BAN/2) AS BAN,") \
+	_T("   SUM((BAN+BAOHIEM+QUAN+DICHVU+CHINHSACH+HUUTRI)/2) AS TONG ") \
+	_T(" FROM") \
+	_T("   ( SELECT DISTINCT hfo_docno AS docno,") \
+	_T("     hfl_name2                 AS foodid,") \
+	_T("     hfl_name				   AS foodname,") \
+	_T("	 hfol_unitprice			   AS unitprice, ") \
+	_T("     CASE ") \
+	_T("		WHEN hfol_type = 'T' ") \
+	_T("		THEN hfol_qtyorder ") \
+	_T("		ELSE 0 ") \
+	_T("	 END AS FoodQtyT,    ") \
+	_T("     CASE ") \
+	_T("		WHEN hfol_type = 'C' ") \
+	_T("		THEN hfol_qtyorder ") \
+	_T("		ELSE 0 ") \
+	_T("	 END AS FoodQtyC,   ") \
+	_T("     CASE") \
+	_T("       WHEN ho_id IN(4,5,6,12)") \
+	_T("       THEN hfol_qtyorder ") \
+	_T("       ELSE 0") \
+	_T("     END AS BAOHIEM,") \
+	_T("     CASE") \
+	_T("       WHEN ho_type ='S'") \
+	_T("       THEN hfol_qtyorder ") \
+	_T("       ELSE 0") \
+	_T("     END AS DICHVU,") \
+	_T("     CASE") \
+	_T("       WHEN ho_id IN(1,2,10,11)") \
+	_T("       THEN hfol_qtyorder ") \
+	_T("       ELSE 0") \
+	_T("     END AS QUAN,") \
+	_T("     CASE") \
+	_T("       WHEN ho_type ='P'") \
+	_T("       THEN hfol_qtyorder ") \
+	_T("       ELSE 0") \
+	_T("     END AS CHINHSACH,") \
+	_T("     CASE") \
+	_T("       WHEN ho_id ='8'") \
+	_T("       THEN hfol_qtyorder ") \
+	_T("       ELSE 0") \
+	_T("     END AS BAN,") \
+	_T("     CASE") \
+	_T("       WHEN ho_type ='H'") \
+	_T("       THEN hfol_qtyorder ") \
+	_T("       ELSE 0") \
+	_T("     END AS HUUTRI") \
+	_T("   FROM hms_patient") \
+	_T("   LEFT JOIN hms_doc") \
+	_T("   ON(hd_patientno=hp_patientno)") \
+	_T("   LEFT JOIN hms_feefood") \
+	_T("   ON(hfo_docno=hd_docno)") \
+	_T("   LEFT JOIN hms_feefoodline") \
+	_T("   ON(hfo_orderid=hfol_orderid)") \
+	_T("   LEFT JOIN hms_fee_list") \
+	_T("   ON(hfol_itemid=hfl_feeid)") \
+	_T("   LEFT JOIN hms_treatment_record") \
+	_T("   ON(htr_docno =hfo_docno") \
+	_T("   AND htr_idx  =hfo_refidx)") \
+	_T("   LEFT JOIN hms_object") \
+	_T("   ON(CAST(ho_id AS INTEGER)=hd_object)") \
+	_T("   WHERE hfo_reforder_id    =%ld") \
+	_T("   AND Cast_Timestamp2Date(hfo_orderdate) = cast_string2date('%s') AND hfo_orderstatus IN('S','A')") \
+	_T("   )") \
+	_T(" GROUP BY foodid,") \
+	_T("   foodname,") \
+	_T("   unitprice ") \
+	_T(" ORDER BY ") \
+	_T("   foodid"), nTransactionID, lpszOrderDate);
+	
+	_fmsg(_T("%s"), szSQL);
+	
+	rs.ExecSQL(szSQL);
+	CReportSection* rptDetail;
+	CString szItemID;
+	long nItem =0;
+	double nBH, nDV, nCS, nQUAN, nHUU, nBAN, nTotal, nTotal1, nQty;
+	double nTotalBH, nTotalDV, nTotalCS, nTotalQUAN,nTotalBAN, nTotalHUU, nTrua, nToi;
+	double nPrice =0, nAmount=0, nTotalAmount =0, nTotalAmount1 =0;
+
+	int i = 1;
+
+	nTrua = nToi =0;
+	nBH=nDV= nCS= nQUAN=nHUU=nBAN=nTotal=nTotal1 =0;
+	nTotalBH=nTotalDV=nTotalCS=nTotalQUAN=nTotalBAN=nTotalHUU=0;
+
+	CString szNewLine, szOldLine;
+	while(!rs.IsEOF())
+	{	
+		rptDetail = rpt.AddDetail();
+		nItem++;		
+		tmpStr.Format(_T("%ld"), nItem);
+		rptDetail->SetValue(_T("1"), tmpStr);
+		rs.GetValue(_T("foodname"), tmpStr);
+		rptDetail->SetValue(_T("2"), tmpStr);		
+		rs.GetValue(_T("foodid"), tmpStr);
+		rptDetail->SetValue(_T("3"), tmpStr);
+		rs.GetValue(_T("foodqtyt"), tmpStr);
+		rptDetail->SetValue(_T("4"),tmpStr);
+		rs.GetValue(_T("foodqtyc"), tmpStr);
+		rptDetail->SetValue(_T("5"),tmpStr);
+		rs.GetValue(_T("UnitPrice"), tmpStr);
+		rptDetail->SetValue(_T("6"),tmpStr);
+
+		rs.GetValue(_T("QUAN"), nQUAN);
+		tmpStr.Format(_T("%0.1f"), nQUAN);		
+		nTotalQUAN += nQUAN;
+		rptDetail->SetValue(_T("7"),tmpStr);
+
+		rs.GetValue(_T("HUUTRI"), nHUU);
+		tmpStr.Format(_T("%0.1f"), nHUU);		
+		nTotalHUU += nHUU;
+		rptDetail->SetValue(_T("8"),tmpStr);		
+
+		rs.GetValue(_T("CHINHSACH"), nCS);
+		tmpStr.Format(_T("%0.1f"), nCS);		
+		nTotalCS +=nCS;
+		rptDetail->SetValue(_T("9"),tmpStr);
+		
+		rs.GetValue(_T("BAOHIEM"), nBH);
+		tmpStr.Format(_T("%0.1f"), nBH);
+		nTotalBH += nBH;		
+		rptDetail->SetValue(_T("10"),tmpStr);
+		
+		rs.GetValue(_T("DICHVU"), nDV);
+		tmpStr.Format(_T("%0.1f"), nDV);
+		nTotalDV += nDV;
+		
+		rptDetail->SetValue(_T("11"),tmpStr);
+		
+		rs.GetValue(_T("BAN"), nBAN);
+		tmpStr.Format(_T("%0.1f"), nBAN);
+		nTotalBAN += nBAN;		
+		rptDetail->SetValue(_T("12"),tmpStr);
+		
+		rs.GetValue(_T("TONG"), nQty);		
+		tmpStr.Format(_T("%0.1f"), nQty);
+		nTotal += nQty;
+		rptDetail->SetValue(_T("13"),tmpStr);
+
+		rs.GetValue(_T("UnitPrice"), nPrice);
+		nAmount = (nPrice*nQty)*2;
+		nTotalAmount += nAmount;
+		FormatCurrency(nAmount, tmpStr);
+		rptDetail->SetValue(_T("14"),tmpStr);
+		
+		rs.MoveNext();
+	}
+	
+		
+	if(nTotalAmount + nTotalAmount1 > 0){
+		rptDetail = rpt.AddDetail(rpt.GetGroupFooter(1));
+		rptDetail->SetValue(_T("s5"), nTrua);
+		rptDetail->SetValue(_T("s6"), nToi);
+		rptDetail->SetValue(_T("s7"), nTotalQUAN);
+		rptDetail->SetValue(_T("s8"), nTotalHUU);
+		rptDetail->SetValue(_T("s9"), nTotalCS);
+		rptDetail->SetValue(_T("s10"), nTotalBH);
+		rptDetail->SetValue(_T("s11"), nTotalDV);
+		rptDetail->SetValue(_T("s12"), nTotalBAN);
+		rptDetail->SetValue(_T("s13"), nTotal);
+		FormatCurrency(nTotalAmount, tmpStr);
+		rptDetail->SetValue(_T("s14"), tmpStr);
+	}
+
+	CString szDate;
+	tmpStr = pMF->GetSysDate();
+	szDate.Format(rpt.GetReportFooter()->GetValue(_T("PrintDate")), tmpStr.Mid(8, 2), tmpStr.Mid(5, 2), tmpStr.Left(4));
+	rpt.GetReportFooter()->SetValue(_T("PrintDate"), szDate);
+//	rs.GetValue(_T("doctor"), tmpStr);
+	rpt.GetReportFooter()->SetValue(_T("UserName"), pMF->GetDoctorName(pMF->GetCurrentUser()));
+	CReportItem *img = rpt.GetReportFooter()->GetItem(_T("Signature"));
+	if(img)
+	{
+		img->SetHBITMAP(pMF->GetSignatureImage(tmpStr));
+		img->SetFixedHeight(false);
+	}
+
+	rpt.PrintPreview();
+}
+
+void CHMSDailyFoodOrder::OnPrintDelivery(long nTransactionID, LPCTSTR lpszOrderDate){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+	CReport rpt;	
+	CString tmpStr, szSQL;
+	CRecord rs(&pMF->m_db);
+	
+	if(!rpt.Init(_T("Reports/HMS/TM_FOODORDER.RPT")) )
+		return;
+
+	tmpStr.Empty();
+	StringUpper(pMF->m_CompanyInfo.sc_pname, tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("HealthService"), tmpStr);
+	StringUpper(pMF->m_CompanyInfo.sc_name, tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("HospitalName"), tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("Department"), pMF->GetDepartmentName(pMF->m_szDept));
+	tmpStr.Format(rpt.GetReportHeader()->GetValue(_T("ReportDate")), CDate::Convert(lpszOrderDate, yyyymmdd, ddmmyyyy));
+	rpt.GetReportHeader()->SetValue(_T("ReportDate"), tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("SheetNo"), m_szOrderNo);
+	//Page Header
+
+	szSQL.Format(_T(" SELECT docno,") \
+	_T("   foodid,") \
+	_T("   orderid,") \
+	_T("   recordno,") \
+	_T("   trua,") \
+	_T("   chieu,") \
+	_T("   pname,") \
+	_T("   age,") \
+	_T("   roomid,") \
+	_T("   bedid,") \
+	_T("   unitprice, ") \
+	_T("   SUM(BAOHIEM/2) AS BAOHIEM,") \
+	_T("   SUM(QUAN/2) AS QUAN,") \
+	_T("   SUM(DICHVU/2) AS DICHVU,") \
+	_T("   SUM(CHINHSACH/2) AS CHINHSACH,") \
+	_T("   SUM(HUUTRI/2) AS HUUTRI,") \
+	_T("   SUM(BAN/2) AS BAN,") \
+	_T("   SUM((BAOHIEM+QUAN+DICHVU+CHINHSACH+HUUTRI+BAN)/2) AS TONG ") \
+	_T(" FROM") \
+	_T("   ( SELECT DISTINCT hfo_docno AS docno,") \
+	_T("     hfl_name2                 AS foodid,") \
+	_T("     hfo_orderid               AS orderid,") \
+	_T("     htr_recordno              AS recordno,") \
+	_T("   CASE") \
+	_T("       WHEN hfol_type ='T'") \
+	_T("       THEN hfl_name2") \
+	_T("       ELSE NULL") \
+	_T("     END AS TRUA,") \
+	_T("     CASE") \
+	_T("       WHEN hfol_type ='C'") \
+	_T("       THEN hfl_name2") \
+	_T("       ELSE NULL") \
+	_T("     END          AS CHIEU,") \
+	_T("     trim(hp_surname") \
+	_T("     ||' '") \
+	_T("     ||hp_midname") \
+	_T("     ||' '") \
+	_T("     ||hp_firstname)                                AS pname,") \
+	_T("     hms_getage( Cast_Timestamp2Date(hd_admitdate), hp_birthdate) AS age,") \
+	_T("     hfo_roomid                                     AS roomid,") \
+	_T("     hfo_bedid                                      AS bedid,") \
+	_T("	 hfol_unitprice									AS unitprice, ") \
+	_T("     CASE") \
+	_T("       WHEN ho_id IN(4,5,6,12)") \
+	_T("       THEN hfol_qtyorder") \
+	_T("       ELSE 0") \
+	_T("     END AS BAOHIEM,") \
+	_T("     CASE") \
+	_T("       WHEN ho_type ='S'") \
+	_T("       THEN hfol_qtyorder") \
+	_T("       ELSE 0") \
+	_T("     END AS DICHVU,") \
+	_T("     CASE") \
+	_T("       WHEN ho_id IN(1,2,10,11)") \
+	_T("       THEN hfol_qtyorder") \
+	_T("       ELSE 0") \
+	_T("     END AS QUAN,") \
+	_T("     CASE") \
+	_T("       WHEN ho_type ='P'") \
+	_T("       THEN hfol_qtyorder") \
+	_T("       ELSE 0") \
+	_T("     END AS CHINHSACH,") \
+	_T("     CASE") \
+	_T("       WHEN ho_id ='8'") \
+	_T("       THEN hfol_qtyorder") \
+	_T("       ELSE 0") \
+	_T("     END AS BAN,") \
+	_T("     CASE") \
+	_T("       WHEN ho_type ='H'") \
+	_T("       THEN hfol_qtyorder") \
+	_T("       ELSE 0") \
+	_T("     END AS HUUTRI") \
+	_T("   FROM hms_patient") \
+	_T("   LEFT JOIN hms_doc") \
+	_T("   ON(hd_patientno=hp_patientno)") \
+	_T("   LEFT JOIN hms_feefood") \
+	_T("   ON(hfo_docno=hd_docno)") \
+	_T("   LEFT JOIN hms_feefoodline") \
+	_T("   ON(hfo_orderid=hfol_orderid)") \
+	_T("   LEFT JOIN hms_fee_list") \
+	_T("   ON(hfol_itemid=hfl_feeid)") \
+	_T("   LEFT JOIN hms_treatment_record") \
+	_T("   ON(htr_docno =hfo_docno") \
+	_T("   AND htr_idx  =hfo_refidx)") \
+	_T("   LEFT JOIN hms_object") \
+	_T("   ON(CAST(ho_id AS INTEGER)=hd_object)") \
+	_T("   WHERE hfo_reforder_id    =%ld") \
+	_T("   AND Cast_Timestamp2Date(hfo_orderdate) = cast_string2date('%s') AND hfo_orderstatus IN('S','A')") \
+	_T("   )") \
+	_T(" GROUP BY docno,") \
+	_T("   foodid,") \
+	_T("   orderid,") \
+	_T("   recordno,") \
+	_T("   pname,") \
+	_T("   age,") \
+	_T("   trua,") \
+	_T("   chieu,") \
+	_T("   roomid,") \
+	_T("   unitprice, ") \
+	_T("   bedid") \
+	_T(" ORDER BY roomid,") \
+	_T("   bedid,") \
+	_T("   pname,") \
+	_T("   docno "), nTransactionID, lpszOrderDate);
+	
+	//_fmsg(_T("%s"), szSQL);
+	rs.ExecSQL(szSQL);
+	CReportSection* rptDetail;
+	CString szItemID;
+	long nItem =0;
+	double nBH, nDV, nCS, nQUAN, nHUU, nBAN, nTotal, nTotal1;
+	double nTotalBH, nTotalDV, nTotalCS, nTotalQUAN,nTotalBAN, nTotalHUU, nTrua, nToi;
+	double nQty[15];
+	double nPrice =0, nAmount=0, nTotalAmount =0, nTotalAmount1 =0, nTotalQty=0;
+	for(int i= 0; i< 15; i++){
+		nQty[i] = 0;
+	}
+
+	int i = 1;
+
+	nTrua = nToi =0;
+	nBH=nDV= nCS= nQUAN=nHUU=nBAN=nTotal=nTotal1 =0;
+	nTotalBH=nTotalDV=nTotalCS=nTotalQUAN=nTotalBAN=nTotalHUU=0;
+	
+	CString szNewLine, szOldLine;
+	while(!rs.IsEOF())
+	{		
+		rs.GetValue(_T("docno"), szNewLine);
+		if(szNewLine != szOldLine && !szNewLine.IsEmpty()){
+			rptDetail = rpt.AddDetail();
+			nItem++;
+			nTotal=nTotal1=0;
+			nQty[7]=nQty[8]=nQty[9]=nQty[10]=nQty[11]=nQty[12]=0;
+			tmpStr.Format(_T("%ld"), nItem);
+			rptDetail->SetValue(_T("1"), tmpStr);
+			rs.GetValue(_T("pname"), tmpStr);		
+			rptDetail->SetValue(_T("2"), tmpStr);		
+			tmpStr.Format(_T("%s.%s"), rs.GetValue(_T("roomid")),rs.GetValue(_T("bedid")));
+			rptDetail->SetValue(_T("3"), tmpStr);
+			rs.GetValue(_T("RecordNo"), tmpStr);
+			rptDetail->SetValue(_T("4"),tmpStr);			
+
+			rs.GetValue(_T("QUAN"), nQUAN);
+			tmpStr.Format(_T("%0.1f"), nQUAN);
+			nQty[7]=nQUAN;
+			nTotalQUAN += nQUAN;
+			rptDetail->SetValue(_T("7"),tmpStr);
+
+			rs.GetValue(_T("HUUTRI"), nHUU);
+			tmpStr.Format(_T("%0.1f"), nHUU);
+			nQty[8]=nHUU;			
+			nTotalHUU += nHUU;
+			rptDetail->SetValue(_T("8"),tmpStr);		
+
+			rs.GetValue(_T("CHINHSACH"), nCS);
+			tmpStr.Format(_T("%0.1f"), nCS);
+			nQty[9]=nCS;
+			nTotalCS +=nCS;
+			rptDetail->SetValue(_T("9"),tmpStr);
+			
+			rs.GetValue(_T("BAOHIEM"), nBH);
+			tmpStr.Format(_T("%0.1f"), nBH);
+			nTotalBH += nBH;
+			nQty[10]=nBH;
+			rptDetail->SetValue(_T("10"),tmpStr);
+			
+			rs.GetValue(_T("DICHVU"), nDV);
+			tmpStr.Format(_T("%0.1f"), nDV);
+			nTotalDV += nDV;
+			nQty[11]=nDV;
+			rptDetail->SetValue(_T("11"),tmpStr);
+			
+			rs.GetValue(_T("BAN"), nBAN);
+			tmpStr.Format(_T("%0.1f"), nBAN);
+			nTotalBAN += nBAN;
+			nQty[12]=nBAN;
+			rptDetail->SetValue(_T("12"),tmpStr);		
+			
+			nTotal = nQty[7]+nQty[8]+nQty[9]+nQty[10]+nQty[11]+nQty[12];
+			
+			rs.GetValue(_T("trua"), tmpStr);
+			rptDetail->SetValue(_T("5"),tmpStr);
+			if(!tmpStr.IsEmpty()){
+				nTrua += nTotal;
+			}
+			
+			rs.GetValue(_T("chieu"), tmpStr);
+			rptDetail->SetValue(_T("6"),tmpStr);
+			if(!tmpStr.IsEmpty()){
+				nToi += nTotal;
+			}
+			
+
+			/*rs.GetValue(_T("UnitPrice"), nPrice);
+			nAmount = nPrice*nTotal;
+			nTotalAmount += nAmount;
+			FormatCurrency(nPrice*nTotal, tmpStr);			
+			rptDetail->SetValue(_T("13"),tmpStr);*/
+
+			szOldLine = szNewLine;
+		}
+		else
+		{	
+			rs.GetValue(_T("QUAN"), nQUAN);
+			tmpStr.Format(_T("%0.1f"), nQUAN+nQty[7]);
+			nTotalQUAN += nQUAN;
+			rptDetail->SetValue(_T("7"),tmpStr);
+
+			rs.GetValue(_T("HUUTRI"), nHUU);
+			tmpStr.Format(_T("%0.1f"), nHUU+nQty[8]);			
+			nTotalHUU += nHUU;
+			rptDetail->SetValue(_T("8"),tmpStr);		
+
+			rs.GetValue(_T("CHINHSACH"), nCS);
+			tmpStr.Format(_T("%0.1f"), nCS+nQty[9]);
+			nTotalCS +=nCS;
+			rptDetail->SetValue(_T("9"),tmpStr);
+			
+			rs.GetValue(_T("BAOHIEM"), nBH);
+			tmpStr.Format(_T("%0.1f"), nBH+nQty[10]);
+			nTotalBH += nBH;
+			rptDetail->SetValue(_T("10"),tmpStr);
+			
+			rs.GetValue(_T("DICHVU"), nDV);
+			tmpStr.Format(_T("%0.1f"), nDV+nQty[11]);
+			nTotalDV += nDV;
+			rptDetail->SetValue(_T("11"),tmpStr);
+
+			rs.GetValue(_T("BAN"), nBAN);
+			tmpStr.Format(_T("%0.1f"), nBAN+nQty[12]);
+			nTotalBAN += nBAN;
+			rptDetail->SetValue(_T("12"),tmpStr);
+			nTotal1 = nDV + nBH + nCS + nQUAN + nHUU + nBAN;
+			
+
+			rs.GetValue(_T("trua"), tmpStr);			
+			if(!tmpStr.IsEmpty()){
+				rptDetail->SetValue(_T("5"),tmpStr);
+				nTrua += nTotal1;
+			}
+			
+			rs.GetValue(_T("chieu"), tmpStr);			
+			if(!tmpStr.IsEmpty()){
+				rptDetail->SetValue(_T("6"),tmpStr);
+				nToi += nTotal1;
+			}
+
+			
+		}
+
+		rs.GetValue(_T("UnitPrice"), nPrice);
+		nAmount = nPrice*(nTotal+nTotal1)*2;
+		FormatCurrency(nAmount, tmpStr);
+		rptDetail->SetValue(_T("13"),tmpStr);		
+		rs.GetValue(_T("TONG"), nTotal);
+		nTotalQty += nTotal;	
+		rs.MoveNext();
+	}	
+	
+	nTotalAmount = (nTotalQty*nPrice)*2;
+
+	if(nTotalAmount + nTotalAmount1 > 0){
+		rptDetail = rpt.AddDetail(rpt.GetGroupFooter(1));
+		rptDetail->SetValue(_T("s5"), nTrua);
+		rptDetail->SetValue(_T("s6"), nToi);
+		rptDetail->SetValue(_T("s7"), nTotalQUAN);
+		rptDetail->SetValue(_T("s8"), nTotalHUU);
+		rptDetail->SetValue(_T("s9"), nTotalCS);
+		rptDetail->SetValue(_T("s10"), nTotalBH);
+		rptDetail->SetValue(_T("s11"), nTotalDV);
+		rptDetail->SetValue(_T("s12"), nTotalBAN);
+		FormatCurrency(nTotalAmount, tmpStr);
+		rptDetail->SetValue(_T("s13"), tmpStr);
+	}
+
+	CString szDate;
+	tmpStr = pMF->GetSysDate();
+	szDate.Format(rpt.GetReportFooter()->GetValue(_T("PrintDate")), tmpStr.Mid(8, 2), tmpStr.Mid(5, 2), tmpStr.Left(4));
+	rpt.GetReportFooter()->SetValue(_T("PrintDate"), szDate);
+//	rs.GetValue(_T("doctor"), tmpStr);
+	rpt.GetReportFooter()->SetValue(_T("UserName"), pMF->GetDoctorName(pMF->GetCurrentUser()));
+	CReportItem *img = rpt.GetReportFooter()->GetItem(_T("Signature"));
+	if(img)
+	{
+		img->SetHBITMAP(pMF->GetSignatureImage(tmpStr));
+		img->SetFixedHeight(false);
+	}
+
+	rpt.PrintPreview();
+}
+
+int CHMSDailyFoodOrder::OnExportOrderDeliveryDrug(){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+
+	return 0;
+}
+int CHMSDailyFoodOrder::OnOrderListPrintDeliveryDrug()
+{
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();	
+	return 0;
+}
+
+void CHMSDailyFoodOrder::OnAddDrugSelect(){
+	OnDrugListAddEntry();
+}
+
+void CHMSDailyFoodOrder::OnPrintDeliveryDrugsSelect(){
+
+}
+
+void CHMSDailyFoodOrder::Refresh(long nTransactionID, long nDocumentNo){
+	m_nTransactionID = nTransactionID;
+	m_nDocumentNo = nDocumentNo;
+	OnPatientListLoadData();
+	OnOrderListLoadData();
+	OnDrugListLoadData();
+	if(m_wndOrderList.GetItemCount() > 0 && m_szStatus == _T("O")){
+		m_wndSend.EnableWindow(TRUE);
+		m_wndPrint.EnableWindow(TRUE);
+		m_wndPrintDeliveryDrugs.EnableWindow(TRUE);
+	}	
+}
+
+long CHMSDailyFoodOrder::GetTransactionID(int nStorageID)
+{
+	long nTransactionID = -1;
+	for (int i =0; i < m_storages.GetCount(); i++){
+		if(nStorageID == m_storages[i])
+		{
+			nTransactionID = m_transaction_orders[i];
+			return nTransactionID;
+		}
+	}
+	return -1;
+}
\ No newline at end of file
Index: HMSDailyFoodOrder.h
===================================================================
--- HMSDailyFoodOrder.h	(revision 0)
+++ HMSDailyFoodOrder.h	(working copy)
@@ -0,0 +1,193 @@
+#ifndef HMSDailyFoodOrder_H
+#define HMSDailyFoodOrder_H
+
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Copyright(C) Viet Nam Medical Software Join Stock Company. 2005-2010. 			
+//	All rights reserved. 
+//	This program is protected by Viet nam and international treaties.  
+//	Unauthorized reproduction or distribution of this program, 
+//	or any portion of it, may result in severe civil and criminal penalties, 
+//	and will be prosecuted to the maximum extent possible under the law.
+//	This file is a part of the GUI(Graphical User Interface) class library.
+//	(c) 2006-2008 Hay Hoang Van, All rights reserved.
+//	CONTACT INFORMATION:
+//	Email  : hayhv@vimes.com.vn or hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+/////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Ban quyen cua Cong Ty Co Phan Phan Mem Y Te Viet Nam 2005-2010.
+//	Do Cuc Ban Quyen, Bo VHTT nuoc Cong hoa xa hoi chu nghia Viet Nam cap.
+//	Chuong trinh phan mem nay duoc Luat phap Viet Nam va quoc te bao ho.
+//	San xuat, su dung hoac phan phoi trai phep toan bo hoac mot phan cua phan men nay se
+//	chiu cac hinh phat va hinh su hoac dan su, co the len den muc toi da dung theo Luat qui dinh.
+//	File nay la mot phan cua thu vien lap trinh(GUI). Ban quyen cua Hoang Van Hay. 2006-2008
+//	THONG TIN LIEN HE:
+//	Email  : hayhv@vimes.com.vn hoac hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+#include "GuiUtils.h"
+#include "GuiView.h"
+#include "DbField.h"
+#include "GridListCtrl.h"
+
+
+class CHMSDailyFoodOrder : public CGuiView{
+protected:
+public:
+	long	m_nOID;	//Order ID
+	long	m_nTransactionID;
+	long	m_nOrderID;
+	long	m_nDocumentNo;
+	CArray<long,long&> m_transaction_orders;
+	CArray<int,int&> m_storages;
+	CString	m_szDoctor;
+	CString	m_szBatchNo;
+	CString	m_szPatientOrderDate;
+	CString m_szOrderType;
+
+	CString	m_szIssueState;
+	CString	m_szCreatedBy;
+	CString	m_szAutoPrintDeliveryVote;
+	CString	m_szPrintType;	
+	CString	m_szTransactionString;
+	
+	
+	void			RefreshData();
+	void			LoadDrugList(long nID);
+	CGuiGroupBox	m_wndOrderInformation;
+	CGuiGroupBox	m_wndPatientInformation;
+	CGuiGroupBox	m_wndDrugInformation;
+	CGuiGroupBox	m_wndGroupListDrug;
+	CGridListCtrl	m_wndOrderList;
+	CGridListCtrl	m_wndPatientList;
+	CGridListCtrl	m_wndDrugList;
+	CGuiLabel		m_wndOrderNoLabel;
+	CGuiTextCtrl	m_wndOrderNo;
+	CGuiButton		m_wndFind;
+	CGuiLabel		m_wndOrderDateLabel;
+	CGuiDateTimeCtrl	m_wndOrderDate;
+	CGuiLabel		m_wndIssueDateLabel;
+	CGuiDateTimeCtrl	m_wndIssueDate;
+	CGuiLabel		m_wndStatusLabel;
+	CGuiTextCtrl	m_wndStatus;
+	CGuiLabel		m_wndPrintedLabel;
+	CGuiNumberCtrl	m_wndPrinted;
+	CGuiLabel		m_wndNoteLabel;
+	CGuiTextCtrl	m_wndNote;
+	CGuiButton		m_wndAdd;
+	CGuiButton		m_wndEdit;
+	CGuiButton		m_wndDelete;
+	CGuiButton		m_wndSave;
+	CGuiButton		m_wndCancel;
+	CGuiButton		m_wndSend;
+	CGuiButton		m_wndPrint;
+	CGuiButton		m_wndPrintDeliveryDrugs;
+	CGuiButton		m_wndAddDrug;
+	CGuiButton		m_wndAddAutomatic;
+	CGuiLabel		m_wndPatientNameLabel;
+	CGuiTextCtrl	m_wndPatientName;
+	CGuiLabel		m_wndDeptLabel;
+	CGuiTextCtrl	m_wndDept;
+	CGuiLabel		m_wndTypeLabel;
+	CGuiTextCtrl	m_wndType;
+	CGuiNumberCtrl	m_wndTotalCount;
+
+
+	CString	m_szOrderNo;
+	CString	m_szOrderDate;
+	CString	m_szOrderTime;
+	CString	m_szIssueDate;
+	CString	m_szPatientName;
+	CString	m_szDept;
+
+	CString	m_szStatus;
+	CString	m_szStatusDesc;
+	long	m_nTotalCount;
+	CString	m_szNote;
+	CDbfMap	m_feefoodTbl;
+	long		OnOrderListLoadData(); 
+	void		OnOrderListSelectChange(int nOldItem, int nNewItem); 
+	void		OnOrderListDblClick(); 
+	int			OnOrderListDeleteItem(); 
+	int			OnOrderListPrintDeliveryDrug(); 
+	int			OnExportOrderDeliveryDrug();
+	int			OnOrderListPrintSheetDate();
+	int			OnOrderListPrintSheetPublicity();	
+	long		OnPatientListLoadData(); 
+	void		OnPatientListSelectChange(int nOldItem, int nNewItem); 
+	void		OnPatientListDblClick(); 
+	int			OnPatientListIssueAll(); 
+	int			OnPatientListIssue(); 
+	int			OnPatientListRollback(); 
+	int			OnPatientListDeleteItem(); 
+	long		OnDrugListLoadData(); 
+	void		OnDrugListSelectChange(int nOldItem, int nNewItem); 
+	void		OnDrugListDblClick(); 
+	int			OnDrugListAddEntry(); 
+	int			OnDrugListDeleteItem(); 
+	int			OnDrugListReturnDrug(); 
+
+	//void			OnPatientNameChange(); 
+	//void			OnPatientNameSetfocus(); 
+	//void			OnPatientNameKillfocus(); 
+	int			OnPatientNameCheckValue(); 
+
+
+	//void		OnOrderNoChange(); 
+	//void		OnOrderNoSetfocus(); 
+	//void		OnOrderNoKillfocus(); 
+	int			OnOrderNoCheckValue(); 
+	void			OnFindSelect(); 
+	//void			OnOrderDateChange(); 
+	//void			OnOrderDateSetfocus(); 
+	//void			OnOrderDateKillfocus(); 
+	int			OnOrderDateCheckValue(); 
+	//void			OnIssueDateChange(); 
+	//void			OnIssueDateSetfocus(); 
+	//void			OnIssueDateKillfocus(); 
+	int			OnIssueDateCheckValue(); 
+	//void			OnStatusChange(); 
+	//void			OnStatusSetfocus(); 
+	//void			OnStatusKillfocus(); 
+	int			OnStatusCheckValue(); 
+	//void			OnPrintedChange(); 
+	//void			OnPrintedSetfocus(); 
+	//void			OnPrintedKillfocus(); 
+	int			OnPrintedCheckValue(); 
+	//void			OnNoteChange(); 
+	//void			OnNoteSetfocus(); 
+	//void			OnNoteKillfocus(); 
+	int			OnNoteCheckValue(); 
+	void			OnAddSelect(); 
+	void			OnEditSelect(); 
+	void			OnDeleteSelect(); 
+	void			OnSaveSelect(); 
+	void			OnCancelSelect(); 
+	void			OnSendSelect(); 
+	void			OnPrintSelect(); 
+	void			OnPrintDeliveryDrugsSelect(); 
+	void			OnAddDrugSelect(); 
+	void			OnAddAutomaticSelect(); 
+	void			OnPrintDelivery(long nOID, LPCTSTR lpszOrderDate);
+	void			OnPrintDeliverySummery(long nOID, LPCTSTR lpszOrderDate);
+	
+	//CHMSDailyFoodOrder(CWnd *pParent);
+	CHMSDailyFoodOrder();
+	~CHMSDailyFoodOrder();
+	void OnCreateComponents();
+	void OnInitializeComponents();
+	void OnSetWindowEvents();
+	void OnDoDataExchange(CDataExchange* pDX);
+	void GetDataToScreen();
+	void GetScreenToData();
+	void SetDefaultValues();
+	int SetMode(int nMode);
+	int OnAddHMSDailyFoodOrder(); 
+	int OnEditHMSDailyFoodOrder(); 
+	int OnDeleteHMSDailyFoodOrder(); 
+	int OnSaveHMSDailyFoodOrder(); 
+	int OnCancelHMSDailyFoodOrder(); 
+	int OnHMSDailyFoodOrderListLoadData(); 
+	void	Refresh(long nTransactionID, long nPharmaOID);
+	long	GetTransactionID(int nStorageID);
+};
+#endif
Index: HMSDailyFoodOrderList.cpp
===================================================================
--- HMSDailyFoodOrderList.cpp	(revision 0)
+++ HMSDailyFoodOrderList.cpp	(working copy)
@@ -0,0 +1,561 @@
+#include "HMSDailyFoodOrder.h"
+#include "HMSDailyFoodOrderList.h"
+//#include "stdafx.h"
+
+#include "MainFrm.h"
+static void _OnAllStatusCheckFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnAllStatusCheck();
+}
+static void _OnOpenStatusCheckFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnOpenStatusCheck();
+}
+static void _OnSendStatusCheckFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnSendStatusCheck();
+}
+static void _OnIssueStatusCheckFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnIssueStatusCheck();
+}
+/*static void _OnFromDateChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnFromDateChange();
+} */
+/*static void _OnFromDateSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnFromDateSetfocus();} */ 
+/*static void _OnFromDateKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnFromDateKillfocus();
+} */
+static int _OnFromDateCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrderList *)pWnd)->OnFromDateCheckValue();
+} 
+/*static void _OnToDateChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnToDateChange();
+} */
+/*static void _OnToDateSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnToDateSetfocus();} */ 
+/*static void _OnToDateKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnToDateKillfocus();
+} */
+static int _OnToDateCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrderList *)pWnd)->OnToDateCheckValue();
+} 
+
+
+
+static int _OnOrderNoCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrderList *)pWnd)->OnOrderNoCheckValue();
+}
+static long _OnListLoadDataFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrderList*)pWnd)->OnListLoadData();
+} 
+static void _OnListDblClickFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList*)pWnd)->OnListDblClick();
+} 
+static void _OnListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CHMSDailyFoodOrderList*)pWnd)->OnListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnListSelectItemFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrderList*)pWnd)->OnListSelectItem();
+} 
+static void _OnPrintSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrderList *pVw = (CHMSDailyFoodOrderList *)pWnd;
+	pVw->OnPrintSelect();
+} 
+static void _OnCancelSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrderList *pVw = (CHMSDailyFoodOrderList *)pWnd;
+	pVw->OnCancelSelect();
+} 
+static int _OnAddHMSDailyDrugOrderListDialogFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrderList*)pWnd)->OnAddHMSDailyDrugOrderListDialog();
+} 
+static int _OnEditHMSDailyDrugOrderListDialogFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrderList*)pWnd)->OnEditHMSDailyDrugOrderListDialog();
+} 
+static int _OnDeleteHMSDailyDrugOrderListDialogFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrderList*)pWnd)->OnDeleteHMSDailyDrugOrderListDialog();
+} 
+static int _OnSaveHMSDailyDrugOrderListDialogFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrderList*)pWnd)->OnSaveHMSDailyDrugOrderListDialog();
+} 
+static int _OnCancelHMSDailyDrugOrderListDialogFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrderList*)pWnd)->OnCancelHMSDailyDrugOrderListDialog();
+} 
+static void _OnFindSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrderList *pVw = (CHMSDailyFoodOrderList *)pWnd;
+	pVw->OnFindSelect();
+} 
+static void _OnDepartmentSelectChangeFnc(CWnd *pWnd, int nOldItemSel, int nNewItemSel){
+	((CHMSDailyFoodOrderList* )pWnd)->OnDepartmentSelectChange(nOldItemSel, nNewItemSel);
+} 
+static void _OnDepartmentSelendokFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnDepartmentSelendok();
+}
+/*static void _OnDepartmentSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnDepartmentKillfocus();
+}*/
+/*static void _OnDepartmentKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnDepartmentKillfocus();
+}*/
+static long _OnDepartmentLoadDataFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrderList *)pWnd)->OnDepartmentLoadData();
+}
+/*static void _OnDepartmentAddNewFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnDepartmentAddNew();
+}*/
+
+
+CHMSDailyFoodOrderList::CHMSDailyFoodOrderList()	
+{
+	m_nDlgWidth = 1024;
+	m_nDlgHeight = 620;
+	SetDefaultValues();
+	m_bAllStatus = m_bSendStatus = m_bIssueStatus = TRUE;
+	m_bOpenStatus = TRUE;
+
+}
+CHMSDailyFoodOrderList::~CHMSDailyFoodOrderList(){
+}
+void CHMSDailyFoodOrderList::OnCreateComponents(){
+	m_wndAllStatus.Create(this, _T("All"), 10, 590, 110, 615);	
+	m_wndSendStatus.Create(this, _T("Sending"), 115, 590, 215, 615);
+	m_wndIssueStatus.Create(this, _T("Issued"), 220, 590, 320, 615);
+	m_wndOrderInformation.Create(this, _T("Order Information"), 5, 5, 1015, 60);
+	m_wndFromDateLabel.Create(this, _T("From Date"), 10, 30, 85, 55);
+	m_wndFromDate.Create(this,90, 30, 175, 55); 
+	m_wndToDateLabel.Create(this, _T("To Date"), 180, 30, 255, 55);
+	m_wndToDate.Create(this,260, 30, 345, 55);
+	m_wndDepartmentLabel.Create(this, _T("Department"), 350, 30, 415, 55);
+	m_wndDepartment.Create(this,420, 30, 675, 55); 
+	m_wndOrderNoLabel.Create(this, _T("Sheet No"), 680, 30, 755, 55);
+	m_wndOrderNo.Create(this,760, 30, 895, 55); 
+	m_wndFind.Create(this, _T("&Find"), 900, 30, 1000, 55);
+	m_wndList.Create(this, 5, 65, 1015, 585);
+	m_wndPrint.Create(this, _T("&Print"), 795, 590, 895, 615);
+	m_wndCancel.Create(this, _T("&Cancel"), 900, 590, 1000, 615);
+}
+void CHMSDailyFoodOrderList::OnInitializeComponents(){
+	CHMSMainFrame *pMF = (CHMSMainFrame*) AfxGetMainWnd();
+	EnableControls(true);
+	m_wndFromDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndFromDate.SetCheckValue(true);
+	m_wndToDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndToDate.SetCheckValue(true);
+	m_wndOrderNo.ModifyStyle(0, ES_UPPERCASE);
+
+	m_wndDepartment.InsertColumn(0, _T("ID"), CFMT_TEXT, 50);
+	m_wndDepartment.InsertColumn(1, _T("Name"), CFMT_TEXT, 250);
+
+	m_wndList.InsertColumn(0, _T(""), CFMT_NUMBER, 0);	//batch_id
+	m_wndList.InsertColumn(1, _T("ORDERNO"), CFMT_TEXT, 90);
+	m_wndList.InsertColumn(2, _T("ORDERDATE"), CFMT_DATETIME, 120);
+	m_wndList.InsertColumn(3, _T("Approval Date"), CFMT_DATETIME, 120);
+	m_wndList.InsertColumn(4, _T("Status"), CFMT_TEXT|CFMT_CENTER, 90);
+	m_wndList.InsertColumn(5, _T("Description"), CFMT_TEXT, 230);
+	m_wndList.InsertColumn(6, _T("Department"), CFMT_TEXT, 250);	
+	m_wndList.InsertColumn(7, _T("Order Type"), CFMT_TEXT, 120);
+	m_wndList.InsertColumn(8, _T("Created By"), CFMT_TEXT, 120);
+	m_wndList.GetHeaderControl()->SetItemHeight(2);	
+
+}
+void CHMSDailyFoodOrderList::OnSetWindowEvents(){
+	//m_wndFromDate.SetEvent(WE_CHANGE, _OnFromDateChangeFnc);
+	//m_wndFromDate.SetEvent(WE_SETFOCUS, _OnFromDateSetfocusFnc);
+	//m_wndFromDate.SetEvent(WE_KILLFOCUS, _OnFromDateKillfocusFnc);
+	m_wndFromDate.SetEvent(WE_CHECKVALUE, _OnFromDateCheckValueFnc);
+	//m_wndToDate.SetEvent(WE_CHANGE, _OnToDateChangeFnc);
+	//m_wndToDate.SetEvent(WE_SETFOCUS, _OnToDateSetfocusFnc);
+	//m_wndToDate.SetEvent(WE_KILLFOCUS, _OnToDateKillfocusFnc);
+	m_wndToDate.SetEvent(WE_CHECKVALUE, _OnToDateCheckValueFnc);
+	m_wndOrderNo.SetEvent(WE_CHECKVALUE, _OnOrderNoCheckValueFnc);
+	
+	m_wndDepartment.SetEvent(WE_SELENDOK, _OnDepartmentSelendokFnc);
+	//m_wndDepartment.SetEvent(WE_SETFOCUS, _OnDepartmentSetfocusFnc);
+	//m_wndDepartment.SetEvent(WE_KILLFOCUS, _OnDepartmentKillfocusFnc);
+	m_wndDepartment.SetEvent(WE_SELCHANGE, _OnDepartmentSelectChangeFnc);
+	m_wndDepartment.SetEvent(WE_LOADDATA, _OnDepartmentLoadDataFnc);
+	//m_wndDepartment.SetEvent(WE_ADDNEW, _OnDepartmentAddNewFnc);
+
+	m_wndFind.SetEvent(WE_CLICK, _OnFindSelectFnc);
+	m_wndList.SetEvent(WE_SELCHANGE, _OnListSelectChangeFnc);
+	m_wndList.SetEvent(WE_LOADDATA, _OnListLoadDataFnc);
+	m_wndList.SetEvent(WE_DBLCLICK, _OnListDblClickFnc);
+	m_wndList.AddEvent(1, _T("Select"), _OnListSelectItemFnc, 0, VK_F3, 0);
+	m_wndPrint.SetEvent(WE_CLICK, _OnPrintSelectFnc);
+	m_wndCancel.SetEvent(WE_CLICK, _OnCancelSelectFnc);
+
+	m_wndAllStatus.SetEvent(WE_CLICK, _OnAllStatusCheckFnc);
+	m_wndOpenStatus.SetEvent(WE_CLICK, _OnOpenStatusCheckFnc);
+	m_wndSendStatus.SetEvent(WE_CLICK, _OnSendStatusCheckFnc);
+	m_wndIssueStatus.SetEvent(WE_CLICK, _OnIssueStatusCheckFnc);
+
+	CHMSMainFrame *pMF = (CHMSMainFrame*) AfxGetMainWnd();
+	if(m_szFromDate.IsEmpty())
+	{
+		m_szFromDate = pMF->GetSysDate();
+		m_szToDate = m_szFromDate;
+	}
+	if(!m_szDeptKey.IsEmpty())
+	{
+	//	m_wndDept.EnableWindow(false);
+	}
+	UpdateData(false);	
+	
+	OnListLoadData();
+
+}
+void CHMSDailyFoodOrderList::OnDoDataExchange(CDataExchange* pDX){
+	DDX_TextEx(pDX, m_wndFromDate.GetDlgCtrlID(), m_szFromDate);
+	DDX_TextEx(pDX, m_wndToDate.GetDlgCtrlID(), m_szToDate);
+	DDX_TextEx(pDX, m_wndDepartment.GetDlgCtrlID(), m_szDepartmentKey);
+	DDX_Text(pDX, m_wndOrderNo.GetDlgCtrlID(), m_szOrderNo);
+	DDX_Check(pDX, m_wndAllStatus.GetDlgCtrlID(), m_bAllStatus);
+	DDX_Check(pDX, m_wndOpenStatus.GetDlgCtrlID(), m_bOpenStatus);
+	DDX_Check(pDX, m_wndSendStatus.GetDlgCtrlID(), m_bSendStatus);
+	DDX_Check(pDX, m_wndIssueStatus.GetDlgCtrlID(), m_bIssueStatus);
+}
+void CHMSDailyFoodOrderList::GetDataToScreen(){
+	CHMSMainFrame *pMF = (CHMSMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT * FROM "));
+	rs.ExecSQL(szSQL);
+
+}
+void CHMSDailyFoodOrderList::GetScreenToData(){
+	CHMSMainFrame *pMF = (CHMSMainFrame*) AfxGetMainWnd();
+
+}
+void CHMSDailyFoodOrderList::SetDefaultValues(){
+
+	m_szFromDate.Empty();
+	m_szToDate.Empty();
+	m_szFromStockKey.Empty();
+	m_szDeptKey.Empty();
+
+}
+int CHMSDailyFoodOrderList::SetMode(int nMode){ 
+ 		int nOldMode = GetMode(); 
+ 		CGuiView::SetMode(nMode); 
+ 		CHMSMainFrame *pMF = (CHMSMainFrame *) AfxGetMainWnd(); 
+ 		CString szSQL; 
+ 		CRecord rs(&pMF->m_db); 
+  		switch(nMode){ 
+ 		case VM_ADD: 
+ 			EnableControls(TRUE); 
+ 			EnableButtons(TRUE, 3, 4, -1); 
+ 			SetDefaultValues(); 
+ 			break; 
+ 		case VM_EDIT: 
+ 			EnableControls(TRUE); 
+ 			EnableButtons(TRUE, 3, 4, -1); 
+ 			break; 
+ 		case VM_VIEW: 
+ 			EnableControls(FALSE); 
+ 			EnableButtons(FALSE, 3, 4, -1); 
+ 			break; 
+ 		case VM_NONE: 
+ 			EnableControls(FALSE); 
+ 			EnableButtons(TRUE, 0, 6, -1); 
+ 			SetDefaultValues(); 
+ 			break; 
+ 		}; 
+ 		UpdateData(FALSE); 
+ 		return nOldMode; 
+ 	} 
+/*void CHMSDailyFoodOrderList::OnFromDateChange(){
+	
+} */
+/*void CHMSDailyFoodOrderList::OnFromDateSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrderList::OnFromDateKillfocus(){
+	
+} */
+int CHMSDailyFoodOrderList::OnFromDateCheckValue(){
+	OnListLoadData();
+	return 1;
+} 
+/*void CHMSDailyFoodOrderList::OnToDateChange(){
+	
+} */
+/*void CHMSDailyFoodOrderList::OnToDateSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrderList::OnToDateKillfocus(){
+	
+} */
+int CHMSDailyFoodOrderList::OnToDateCheckValue(){
+	OnListLoadData();
+	return 1;
+} 
+
+
+int CHMSDailyFoodOrderList::OnOrderNoCheckValue(){
+	OnListLoadData();
+	return 1;
+}
+
+void CHMSDailyFoodOrderList::OnListDblClick(){
+	int nSel = m_wndList.GetCurSel();
+	if(nSel < 0)
+	{
+		ShowMessageBox(_T("You must select an item"), MB_OK);
+		return;
+	}
+	long m_nID = ToLong(m_wndList.GetItemText(nSel, 0));	
+	((CHMSDailyFoodOrder*)m_wndOrder)->m_nOID = m_nOID;
+	((CHMSDailyFoodOrder*)m_wndOrder)->m_szOrderType = m_szOrderType;
+	((CHMSDailyFoodOrder*)m_wndOrder)->GetDataToScreen();
+	((CGuiTabCtrl*)GetParent())->SetCurSel(1);
+} 
+void CHMSDailyFoodOrderList::OnListSelectChange(int nOldItem, int nNewItem){
+	if(nNewItem < 0)
+		return;
+	m_nOID = str2long(m_wndList.GetItemText(nNewItem, 0));
+	m_szOrderType = m_wndList.GetItemText(nNewItem, 7);
+	
+} 
+int CHMSDailyFoodOrderList::OnListSelectItem(){
+	//OnOK();
+	return 0;
+} 
+long CHMSDailyFoodOrderList::OnListLoadData(){
+	CHMSMainFrame *pMF = (CHMSMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szWhere, szStatusFilter;
+	UpdateData(true);
+	m_wndList.BeginLoad(); 
+	int nCount = 0;
+
+			
+	if(m_bAllStatus){
+		m_bOpenStatus = m_bSendStatus = m_bIssueStatus = TRUE;
+	}	
+	if(m_bSendStatus){
+		if(!szStatusFilter.IsEmpty())
+			szStatusFilter += _T(",");
+		szStatusFilter += _T("'S'");
+	}
+	if(m_bIssueStatus){
+		if(!szStatusFilter.IsEmpty())
+			szStatusFilter += _T(",");
+		szStatusFilter += _T("'A','I'");
+	}
+	if(!szStatusFilter.IsEmpty())
+	{
+		szWhere.AppendFormat(_T(" and HFOS_ORDERSTATUS in(%s) "), szStatusFilter);
+	}
+
+	if(!m_szDepartmentKey.IsEmpty())
+	{
+		szWhere.AppendFormat(_T(" AND hfos_deptid ='%s' "), m_szDepartmentKey);
+	}
+
+	if(!m_szOrderNo.IsEmpty())
+	{
+		szWhere.AppendFormat(_T(" and hfos_sheetno='%s' "), m_szOrderNo);
+	}
+
+	szSQL.Format(_T(" SELECT HFOS_ORDERID as ORDERID,") \
+		_T(" HFOS_SHEETNO as SHEETNO, ") \
+		_T("   HFOS_ORDERDATE                     AS orderdate,") \
+		_T("   hfos_approvedate                     AS issuedate,") \
+		_T("   HFOS_DESCRIPTION as description,") \
+		_T("   HFOS_ORDERSTATUS as status,") \
+		_T("   HFOS_ORDERTYPE as ORDERTYPE,") \
+		_T("   HFOS_DEPTID AS DEPTID, ") \
+		_T("   m_transaction_getstatusdesc(HFOS_ORDERSTATUS) as statusdesc,") \
+		_T("   HFOS_CREATEDBY as createdby ") \
+		_T(" FROM HMS_FOODORDERSHEET ") \
+		_T(" WHERE Cast_Timestamp2Date(HFOS_ORDERDATE) BETWEEN cast_string2date('%s') AND cast_string2date('%s') AND HFOS_ORDERSTATUS IN('S','A')") \
+		_T(" %s ") \
+		_T(" ORDER BY ORDERID, HFOS_ORDERDATE"), m_szFromDate, m_szToDate,  szWhere);
+
+	
+	//_fmsg(_T("%s"), szSQL);
+
+	CString szStatus, tmpStr;
+	int nItem = 0;
+	int nIndex = 1;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		rs.GetValue(_T("status"), szStatus);
+		tmpStr.Format(_T("%d"), nIndex++);		
+		nItem = m_wndList.AddItems(
+			rs.GetValue(_T("ORDERID")), 
+			rs.GetValue(_T("SHEETNO")),			
+			rs.GetValue(_T("orderDate")), 
+			rs.GetValue(_T("IssueDate")), 
+			rs.GetValue(_T("statusdesc")),
+			rs.GetValue(_T("description")),			
+			pMF->GetDepartmentName(rs.GetValue(_T("deptid"))),			
+			rs.GetValue(_T("ORDERTYPE")), 
+			pMF->GetDoctorName(rs.GetValue(_T("createdby"))), 
+			NULL);
+
+		if(szStatus == _T("A")){
+			m_wndList.SetItemBkColor(nItem, COLOR_SEND, FALSE);
+			m_wndList.SetItemTextColor(nItem, COLOR_BLACK, FALSE);
+		}
+		/*else if(szStatus == _T("S")){
+			m_wndList.SetItemBkColor(nItem, COLOR_TERMINATE, FALSE);
+			m_wndList.SetItemTextColor(nItem, COLOR_WHITE, FALSE);
+		}*/
+
+		rs.MoveNext();
+	}
+	m_wndList.EndLoad(); 
+	return nCount;
+}
+void CHMSDailyFoodOrderList::OnPrintSelect(){
+	CHMSMainFrame *pMF = (CHMSMainFrame*) AfxGetMainWnd();
+	
+} 
+void CHMSDailyFoodOrderList::OnCancelSelect(){
+//	OnCancel();	
+} 
+int CHMSDailyFoodOrderList::OnAddHMSDailyDrugOrderListDialog(){
+ 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)  
+ 		return -1; 
+ 	CHMSMainFrame *pMF = (CHMSMainFrame *) AfxGetMainWnd(); 
+ 	SetMode(VM_ADD);
+	return 0;  
+} 
+int CHMSDailyFoodOrderList::OnEditHMSDailyDrugOrderListDialog(){
+ 	if(GetMode() != VM_VIEW) 
+ 		return -1; 
+ 	CHMSMainFrame *pMF = (CHMSMainFrame *) AfxGetMainWnd(); 
+ 	SetMode(VM_EDIT);
+return 0;  
+ 
+} 
+int CHMSDailyFoodOrderList::OnDeleteHMSDailyDrugOrderListDialog(){
+ 	if(GetMode() != VM_VIEW) 
+ 		return -1; 
+ 	CHMSMainFrame *pMF = (CHMSMainFrame *)AfxGetMainWnd(); 
+ 	CString szSQL; 
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO) 
+ 		return -1; 
+ 	szSQL.Format(_T("DELETE FROM  WHERE  AND") ); 
+ 	int ret = pMF->ExecSQL(szSQL); 
+ 	if(ret >= 0){ 
+ 		SetMode(VM_NONE); 
+ 		OnCancelHMSDailyDrugOrderListDialog(); 
+ 	}
+return 0;
+ } 
+int CHMSDailyFoodOrderList::OnSaveHMSDailyDrugOrderListDialog(){
+ 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT) 
+ 		return -1; 
+ 	if(!IsValidateData()) 
+ 		return -1; 
+ 	CHMSMainFrame *pMF = (CHMSMainFrame *)AfxGetMainWnd(); 
+ 	CString szSQL; 
+ 	if(GetMode() == VM_ADD){ 
+ 		//7szSQL = m_dm_purchaseorderlnTbl.GetInsertSQL(); 
+ 	} 
+ 	else if(GetMode() == VM_EDIT){ 
+ 		CString szWhere; 
+ 		szWhere.Format(_T(" WHERE")); 
+ 		//szSQL = m_dm_purchaseorderlnTbl.GetUpdateSQL(_T("createdby,createddate")); 
+ 		szSQL += szWhere; 
+ 	} 
+ //_fmsg(_T("%s"), szSQL); 
+ 	int ret = pMF->ExecSQL(szSQL); 
+ 	if(ret > 0) 
+ 	{ 
+ 		//OnHMSDailyDrugOrderListDialogListLoadData(); 
+ 		SetMode(VM_VIEW); 
+ 		 
+ 	} 
+ 	else 
+ 	{ 
+ 	} 
+ 	return ret; 
+ 	return 0; 
+}
+int CHMSDailyFoodOrderList::OnCancelHMSDailyDrugOrderListDialog(){
+ 	if(GetMode() == VM_EDIT) 
+ 	{ 
+ 		SetMode(VM_VIEW); 
+ 	} 
+ 	else 
+ 	{ 
+ 		SetMode(VM_NONE); 
+ 	} 
+ 	CHMSMainFrame *pMF = (CHMSMainFrame *)AfxGetMainWnd(); 
+ 	 
+ 	return 0;
+} 
+int CHMSDailyFoodOrderList::OnHMSDailyDrugOrderListDialogListLoadData(){
+	return 0;
+}
+
+void CHMSDailyFoodOrderList::OnAllStatusCheck(){
+	UpdateData(TRUE);
+	m_bAllStatus =TRUE;
+	m_bOpenStatus = m_bSendStatus = m_bIssueStatus = FALSE;
+    OnListLoadData();
+	UpdateData(FALSE);
+}
+void CHMSDailyFoodOrderList::OnOpenStatusCheck(){
+	UpdateData(TRUE);
+	m_bOpenStatus =TRUE;
+	m_bAllStatus = m_bSendStatus = m_bIssueStatus = FALSE;
+    OnListLoadData();
+	UpdateData(FALSE);
+}
+void CHMSDailyFoodOrderList::OnSendStatusCheck(){
+	UpdateData(TRUE);
+	m_bSendStatus =TRUE;
+	m_bAllStatus = m_bOpenStatus = m_bIssueStatus = FALSE;
+    OnListLoadData();
+	UpdateData(FALSE);
+}
+void CHMSDailyFoodOrderList::OnIssueStatusCheck(){
+	UpdateData(TRUE);
+	m_bIssueStatus =TRUE;
+	m_bAllStatus = m_bSendStatus = m_bOpenStatus = FALSE;
+    OnListLoadData();
+	UpdateData(FALSE);
+}
+void CHMSDailyFoodOrderList::OnFindSelect(){
+	OnListLoadData();
+}
+void CHMSDailyFoodOrderList::OnDepartmentSelectChange(int nOldItemSel, int nNewItemSel){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CHMSDailyFoodOrderList::OnDepartmentSelendok(){
+	 
+}
+/*void CHMSDailyFoodOrderList::OnDepartmentSetfocus(){
+	
+}*/
+/*void CHMSDailyFoodOrderList::OnDepartmentKillfocus(){
+	
+}*/
+long CHMSDailyFoodOrderList::OnDepartmentLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szWhere;
+	if(m_wndDepartment.IsSearchKey() && !m_szDepartmentKey.IsEmpty()){
+		szWhere.Format(_T(" AND sd_id='%s' "), m_szDepartmentKey);
+	};
+
+	m_wndDepartment.DeleteAllItems(); 
+	int nCount = 0;
+	szSQL.Format(_T("SELECT * FROM sys_dept WHERE sd_type in('DT') and sd_isactive='Y' %s ORDER BY sd_id"), szWhere);
+
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndDepartment.AddItems(
+			rs.GetValue(_T("sd_id")), 
+			rs.GetValue(_T("sd_name")), 
+			NULL);
+		rs.MoveNext();
+	}
+	return nCount;
+}
+/*void CHMSDailyFoodOrderList::OnDepartmentAddNew(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} */
Index: HMSDailyFoodOrderList.h
===================================================================
--- HMSDailyFoodOrderList.h	(revision 0)
+++ HMSDailyFoodOrderList.h	(working copy)
@@ -0,0 +1,111 @@
+#ifndef HMSDailyDrugOrderListDialog_H
+#define HMSDailyDrugOrderListDialog_H
+
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Copyright(C) Viet Nam Medical Software Join Stock Company. 2005-2010. 			
+//	All rights reserved. 
+//	This program is protected by Viet nam and international treaties.  
+//	Unauthorized reproduction or distribution of this program, 
+//	or any portion of it, may result in severe civil and criminal penalties, 
+//	and will be prosecuted to the maximum extent possible under the law.
+//	This file is a part of the GUI(Graphical User Interface) class library.
+//	(c) 2006-2008 Hay Hoang Van, All rights reserved.
+//	CONTACT INFORMATION:
+//	Email  : hayhv@miteco.com.vn or hayhv@yahoo.com
+//	Website: http://www.miteco.com.vn
+/////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Ban quyen cua Cong Ty Co Phan Phan Mem Y Te Viet Nam 2005-2010.
+//	Do Cuc Ban Quyen, Bo VHTT nuoc Cong hoa xa hoi chu nghia Viet Nam cap.
+//	Chuong trinh phan mem nay duoc Luat phap Viet Nam va quoc te bao ho.
+//	San xuat, su dung hoac phan phoi trai phep toan bo hoac mot phan cua phan men nay se
+//	chiu cac hinh phat va hinh su hoac dan su, co the len den muc toi da dung theo Luat qui dinh.
+//	File nay la mot phan cua thu vien lap trinh(GUI). Ban quyen cua Hoang Van Hay. 2006-2008
+//	THONG TIN LIEN HE:
+//	Email  : hayhv@miteco.com.vn hoac hayhv@yahoo.com
+//	Website: http://www.miteco.com.vn
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+#include "GuiUtils.h"
+#include "GuiView.h"
+#include "DbField.h"
+class CHMSDailyFoodOrderList : public CGuiView{
+protected:
+public:
+	long		m_nOID;
+	CWnd*		m_wndOrder;
+	CString		m_szOrderNo;
+	CString		m_szStockList;
+	CGuiGroupBox	m_wndOrderInformation;
+	CGuiLabel		m_wndFromDateLabel;
+	CGuiDateCtrl	m_wndFromDate;
+	CGuiLabel		m_wndToDateLabel;
+	CGuiDateCtrl	m_wndToDate;
+	CGuiLabel		m_wndOrderNoLabel;
+	CGuiTextCtrl	m_wndOrderNo;
+	CGuiLabel		m_wndDepartmentLabel;
+	CGuiComboBox	m_wndDepartment;
+	CGuiListCtrl	m_wndList;
+	CGuiButton		m_wndPrint;
+	CGuiButton		m_wndCancel;
+	CGuiCheckBox	m_wndAllStatus;
+	CGuiCheckBox	m_wndOpenStatus;
+	CGuiCheckBox	m_wndSendStatus;
+	CGuiCheckBox	m_wndIssueStatus;
+	CGuiButton		m_wndFind;
+	
+	CString	m_szFromDate;
+	CString	m_szToDate;
+	CString	m_szFromStockKey;
+	CString	m_szDeptKey;
+	CString	m_szOrderType;
+	CString	m_szDepartmentKey;
+//	CString	m_szOrderNo;	
+	BOOL	m_bAllStatus;
+	BOOL	m_bOpenStatus;
+	BOOL	m_bSendStatus;
+	BOOL	m_bIssueStatus;
+	CDbfMap	m_dm_purchaseorderlnTbl;
+	//void			OnFromDateChange(); 
+	//void			OnFromDateSetfocus(); 
+	//void			OnFromDateKillfocus(); 
+	int			OnFromDateCheckValue(); 
+	//void			OnToDateChange(); 
+	//void			OnToDateSetfocus(); 
+	//void			OnToDateKillfocus(); 
+	int			OnToDateCheckValue(); 
+	int			OnOrderNoCheckValue(); 
+	void			OnFindSelect();
+	long			OnListLoadData(); 
+	void			OnListSelectChange(int nOldItem, int nNewItem); 
+	void			OnListDblClick(); 
+	int				OnListSelectItem(); 
+	void			OnPrintSelect(); 
+	void			OnCancelSelect(); 
+	void			OnAllStatusCheck();
+	void			OnOpenStatusCheck();
+	void			OnSendStatusCheck();
+	void			OnIssueStatusCheck();
+	
+	void			OnDepartmentSelectChange(int nOldItemSel, int nNewItemSel); 
+	void			OnDepartmentSelendok(); 
+	//void			OnDepartmentSetfocus(); 
+	//void			OnDepartmentKillfocus(); 
+	long			OnDepartmentLoadData(); 
+	//void			OnDepartmentAddNew(); 
+	CHMSDailyFoodOrderList();
+	~CHMSDailyFoodOrderList();
+	void OnCreateComponents();
+	void OnInitializeComponents();
+	void OnSetWindowEvents();
+	void OnDoDataExchange(CDataExchange* pDX);
+	void GetDataToScreen();
+	void GetScreenToData();
+	void SetDefaultValues();
+	int SetMode(int nMode);
+	int OnAddHMSDailyDrugOrderListDialog(); 
+	int OnEditHMSDailyDrugOrderListDialog(); 
+	int OnDeleteHMSDailyDrugOrderListDialog(); 
+	int OnSaveHMSDailyDrugOrderListDialog(); 
+	int OnCancelHMSDailyDrugOrderListDialog(); 
+	int OnHMSDailyDrugOrderListDialogListLoadData(); 
+};
+#endif
Index: HMSSummaryDailyFoodOrder.cpp
===================================================================
--- HMSSummaryDailyFoodOrder.cpp	(revision 0)
+++ HMSSummaryDailyFoodOrder.cpp	(working copy)
@@ -0,0 +1,1149 @@
+#include "HMSSummaryDailyFoodOrder.h"
+#include "MainFrm.h"
+/*static void _OnFormDateChangeFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFormDateChange();
+} */
+/*static void _OnFormDateSetfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFormDateSetfocus();} */ 
+/*static void _OnFormDateKillfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFormDateKillfocus();
+} */
+static int _OnFormDateCheckValueFnc(CWnd *pWnd){
+	return ((CHMSSummaryDailyFoodOrder *)pWnd)->OnFormDateCheckValue();
+} 
+/*static void _OnToDateChangeFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnToDateChange();
+} */
+/*static void _OnToDateSetfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnToDateSetfocus();} */ 
+/*static void _OnToDateKillfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnToDateKillfocus();
+} */
+static int _OnToDateCheckValueFnc(CWnd *pWnd){
+	return ((CHMSSummaryDailyFoodOrder *)pWnd)->OnToDateCheckValue();
+} 
+static void _OnStatusSelectChangeFnc(CWnd *pWnd, int nOldItemSel, int nNewItemSel){
+	((CHMSSummaryDailyFoodOrder* )pWnd)->OnStatusSelectChange(nOldItemSel, nNewItemSel);
+} 
+static void _OnStatusSelendokFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnStatusSelendok();
+}
+/*static void _OnStatusSetfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+}*/
+/*static void _OnStatusKillfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+}*/
+static long _OnStatusLoadDataFnc(CWnd *pWnd){
+	return ((CHMSSummaryDailyFoodOrder *)pWnd)->OnStatusLoadData();
+}
+/*static void _OnStatusAddNewFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnStatusAddNew();
+}*/
+static void _OnPrintSelectFnc(CWnd *pWnd){
+	CHMSSummaryDailyFoodOrder *pVw = (CHMSSummaryDailyFoodOrder *)pWnd;
+	pVw->OnPrintSelect();
+} 
+static long _OnOrderListLoadDataFnc(CWnd *pWnd){
+	return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListLoadData();
+} 
+static void _OnOrderListDblClickFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListDblClick();
+} 
+static void _OnOrderListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnOrderListDeleteItemFnc(CWnd *pWnd){
+	 return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListDeleteItem();
+} 
+static void _OnRefreshSelectFnc(CWnd *pWnd){
+	CHMSSummaryDailyFoodOrder *pVw = (CHMSSummaryDailyFoodOrder *)pWnd;
+	pVw->OnRefreshSelect();
+} 
+static void _OnFoodTypeSelectChangeFnc(CWnd *pWnd, int nOldItemSel, int nNewItemSel){
+	((CHMSSummaryDailyFoodOrder* )pWnd)->OnFoodTypeSelectChange(nOldItemSel, nNewItemSel);
+} 
+static void _OnFoodTypeSelendokFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeSelendok();
+}
+/*static void _OnFoodTypeSetfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeKillfocus();
+}*/
+/*static void _OnFoodTypeKillfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeKillfocus();
+}*/
+static long _OnFoodTypeLoadDataFnc(CWnd *pWnd){
+	return ((CHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeLoadData();
+}
+/*static void _OnFoodTypeAddNewFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeAddNew();
+}*/
+static int _OnAddCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnAddCHMSSummaryDailyFoodOrder();
+} 
+static int _OnEditCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnEditCHMSSummaryDailyFoodOrder();
+} 
+static int _OnDeleteCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnDeleteCHMSSummaryDailyFoodOrder();
+} 
+static int _OnSaveCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnSaveCHMSSummaryDailyFoodOrder();
+} 
+static int _OnCancelCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnCancelCHMSSummaryDailyFoodOrder();
+} 
+CHMSSummaryDailyFoodOrder::CHMSSummaryDailyFoodOrder(){
+
+	m_nDlgWidth = 1029;
+	m_nDlgHeight = 635;
+	SetDefaultValues();
+}
+CHMSSummaryDailyFoodOrder::~CHMSSummaryDailyFoodOrder(){
+}
+void CHMSSummaryDailyFoodOrder::OnCreateComponents(){
+	m_wndOrderInformation.Create(this, _T("Order Information"), 5, 5, 1020, 60);
+	m_wndGroupListDrug.Create(this, _T("Food Type List"), 5, 65, 1020, 625);
+	m_wndFormDateLabel.Create(this, _T("From Date"), 10, 30, 100, 55);
+	m_wndFormDate.Create(this,105, 30, 195, 55); 
+	m_wndToDateLabel.Create(this, _T("To Date"), 200, 30, 290, 55);
+	m_wndToDate.Create(this,295, 30, 385, 55); 
+	m_wndStatusLabel.Create(this, _T("Status"), 390, 30, 480, 55);
+	m_wndStatus.Create(this,485, 30, 625, 55); 
+	m_wndPrint.Create(this, _T("&Preview"), 930, 30, 1015, 55);
+	m_wndOrderList.Create(this,10, 90, 1015, 620); 
+	m_wndRefresh.Create(this, _T("Refresh"), 845, 30, 925, 55);
+	m_wndAllDept.Create(this, _T("Summery"), 630, 30, 710, 55);
+	/*m_wndFoodTypeLabel.Create(this, _T("Food Type"), 630, 30, 710, 55);
+	m_wndFoodType.Create(this,715, 30, 840, 55); */
+
+}
+void CHMSSummaryDailyFoodOrder::OnInitializeComponents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	m_wndFormDate.SetMax(CDate(pMF->GetSysDate()));
+	//m_wndFormDate.SetCheckValue(true);
+	m_wndToDate.SetMax(CDate(pMF->GetSysDate()));
+	//m_wndToDate.SetCheckValue(true);
+	m_wndStatus.SetCheckValue(true);
+	m_wndStatus.LimitText(1024);
+	m_wndFoodType.SetCheckValue(true);
+	m_wndFoodType.LimitText(35);
+
+	m_wndStatus.InsertColumn(0, _T("ID"), CFMT_TEXT, 50);
+	m_wndStatus.InsertColumn(1, _T("Name"), CFMT_TEXT, 150);
+
+	m_wndFoodType.InsertColumn(0, _T("ID"), CFMT_TEXT, 50);
+	m_wndFoodType.InsertColumn(1, _T("Name"), CFMT_TEXT, 150);
+
+	m_wndOrderList.InsertColumn(0, _T("ID"), CFMT_TEXT|CFMT_RIGHT, 60);	//identify
+	m_wndOrderList.InsertColumn(1, _T("Desc"), CFMT_TEXT, 350);	
+	m_wndOrderList.InsertColumn(2, _T("\x42\xE1o"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(3, _T("\x43\x1EAFt"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(4, _T("Qty"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(5, _T("\x42\xE1o"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(6, _T("\x43\x1EAFt"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(7, _T("Qty"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(8, _T("\x42\xE1o"), CFMT_NUMBER, 40);		
+	m_wndOrderList.InsertColumn(9, _T("\x43\x1EAFt"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(10, _T("Qty"), CFMT_NUMBER, 40);	
+	//m_wndOrderList.InsertColumn(11, _T("\x43\x1EAFt"), CFMT_MONEY, 40);	
+	m_wndOrderList.InsertColumn(11, _T("T\x1ED5ng s\x1ED1"), CFMT_NUMBER, 50);
+	m_wndOrderList.InsertColumn(12, _T("Price"), CFMT_MONEY, 70);
+	m_wndOrderList.InsertColumn(13, _T("Amount"), CFMT_MONEY, 90);
+	m_wndOrderList.InsertColumn(14, _T("ItemID"), CFMT_TEXT, 0);	
+	m_wndOrderList.InsertColumn(15, _T("GroupID"), CFMT_TEXT, 0);
+	m_wndOrderList.SetSortHeader(false);
+	m_wndOrderList.GetHeaderControl()->SetItemHeight(2);
+	m_wndOrderList.GetHeaderControl()->MergeCell(_T("S\xE1ng"), 0, 2, 1, 4, true);
+	m_wndOrderList.GetHeaderControl()->MergeCell(_T("Tr\x1B0\x61"), 0, 5, 1, 7, true);
+	m_wndOrderList.GetHeaderControl()->MergeCell(_T("T\x1ED1i"), 0, 8, 1, 10, true);
+	
+	m_wndOrderList.ModifyStyle(0, LVS_NOSORTHEADER);
+
+}
+void CHMSSummaryDailyFoodOrder::OnSetWindowEvents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	//m_wndFormDate.SetEvent(WE_CHANGE, _OnFormDateChangeFnc);
+	//m_wndFormDate.SetEvent(WE_SETFOCUS, _OnFormDateSetfocusFnc);
+	//m_wndFormDate.SetEvent(WE_KILLFOCUS, _OnFormDateKillfocusFnc);
+	m_wndFormDate.SetEvent(WE_CHECKVALUE, _OnFormDateCheckValueFnc);
+	//m_wndToDate.SetEvent(WE_CHANGE, _OnToDateChangeFnc);
+	//m_wndToDate.SetEvent(WE_SETFOCUS, _OnToDateSetfocusFnc);
+	//m_wndToDate.SetEvent(WE_KILLFOCUS, _OnToDateKillfocusFnc);
+	m_wndToDate.SetEvent(WE_CHECKVALUE, _OnToDateCheckValueFnc);
+	m_wndStatus.SetEvent(WE_SELENDOK, _OnStatusSelendokFnc);
+	//m_wndStatus.SetEvent(WE_SETFOCUS, _OnStatusSetfocusFnc);
+	//m_wndStatus.SetEvent(WE_KILLFOCUS, _OnStatusKillfocusFnc);
+	m_wndStatus.SetEvent(WE_SELCHANGE, _OnStatusSelectChangeFnc);
+	m_wndStatus.SetEvent(WE_LOADDATA, _OnStatusLoadDataFnc);
+	//m_wndStatus.SetEvent(WE_ADDNEW, _OnStatusAddNewFnc);
+	m_wndPrint.SetEvent(WE_CLICK, _OnPrintSelectFnc);
+	m_wndOrderList.SetEvent(WE_SELCHANGE, _OnOrderListSelectChangeFnc);
+	m_wndOrderList.SetEvent(WE_LOADDATA, _OnOrderListLoadDataFnc);
+	m_wndOrderList.SetEvent(WE_DBLCLICK, _OnOrderListDblClickFnc);
+	m_wndOrderList.AddEvent(1, _T("Delete"), _OnOrderListDeleteItemFnc, 0, VK_DELETE, 0);
+	m_wndRefresh.SetEvent(WE_CLICK, _OnRefreshSelectFnc);
+	m_wndFoodType.SetEvent(WE_SELENDOK, _OnFoodTypeSelendokFnc);
+	//m_wndFoodType.SetEvent(WE_SETFOCUS, _OnFoodTypeSetfocusFnc);
+	//m_wndFoodType.SetEvent(WE_KILLFOCUS, _OnFoodTypeKillfocusFnc);
+	m_wndFoodType.SetEvent(WE_SELCHANGE, _OnFoodTypeSelectChangeFnc);
+	m_wndFoodType.SetEvent(WE_LOADDATA, _OnFoodTypeLoadDataFnc);
+	//m_wndFoodType.SetEvent(WE_ADDNEW, _OnFoodTypeAddNewFnc);
+	AddEvent(1, _T("Add	Ctrl+A"), _OnAddCHMSSummaryDailyFoodOrderFnc, 0, 'A', VK_CONTROL);
+	AddEvent(2, _T("Edit	Ctrl+E"), _OnEditCHMSSummaryDailyFoodOrderFnc, 0, 'E', VK_CONTROL);
+	AddEvent(3, _T("Delete	Ctrl+D"), _OnDeleteCHMSSummaryDailyFoodOrderFnc, 0, 'D', VK_CONTROL);
+	AddEvent(4, _T("Save	Ctrl+S"), _OnSaveCHMSSummaryDailyFoodOrderFnc, 0, 'S', VK_CONTROL);
+	AddEvent(0, _T("-"));
+	AddEvent(5, _T("Cancel	Ctrl+T"), _OnCancelCHMSSummaryDailyFoodOrderFnc, 0, 'T', VK_CONTROL);
+	m_szFormDate = m_szToDate = pMF->GetSysDate();
+	SetMode(VM_EDIT);
+
+}
+void CHMSSummaryDailyFoodOrder::OnDoDataExchange(CDataExchange* pDX){
+	DDX_TextEx(pDX, m_wndFormDate.GetDlgCtrlID(), m_szFormDate);
+	DDX_TextEx(pDX, m_wndToDate.GetDlgCtrlID(), m_szToDate);
+	DDX_TextEx(pDX, m_wndStatus.GetDlgCtrlID(), m_szStatusKey);
+	//DDX_TextEx(pDX, m_wndFoodType.GetDlgCtrlID(), m_szFoodTypeKey);
+	DDX_Check(pDX, m_wndAllDept.GetDlgCtrlID(), m_bAllDept);
+
+}
+void CHMSSummaryDailyFoodOrder::GetDataToScreen(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT * FROM "));
+	rs.ExecSQL(szSQL);
+
+}
+void CHMSSummaryDailyFoodOrder::GetScreenToData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+
+}
+void CHMSSummaryDailyFoodOrder::SetDefaultValues(){
+
+	m_szFormDate.Empty();
+	m_szToDate.Empty();
+	m_szStatusKey.Empty();
+	m_szFoodTypeKey.Empty();
+
+}
+int CHMSSummaryDailyFoodOrder::SetMode(int nMode){
+ 		int nOldMode = GetMode();
+ 		CGuiView::SetMode(nMode);
+ 		CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 		CString szSQL;
+ 		CRecord rs(&pMF->m_db);
+  		switch(nMode){
+ 		case VM_ADD: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		case VM_EDIT: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 0, 1, -1);
+ 			break;
+ 		case VM_VIEW: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(FALSE, 3, 4, -1);
+ 			break;
+ 		case VM_NONE: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(TRUE, 0, 6, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		};
+ 		UpdateData(FALSE);
+ 		return nOldMode;
+}
+/*void CHMSSummaryDailyFoodOrder::OnFormDateChange(){
+	
+} */
+/*void CHMSSummaryDailyFoodOrder::OnFormDateSetfocus(){
+	
+} */
+/*void CHMSSummaryDailyFoodOrder::OnFormDateKillfocus(){
+	
+} */
+int CHMSSummaryDailyFoodOrder::OnFormDateCheckValue(){
+	return 0;
+} 
+/*void CHMSSummaryDailyFoodOrder::OnToDateChange(){
+	
+} */
+/*void CHMSSummaryDailyFoodOrder::OnToDateSetfocus(){
+	
+} */
+/*void CHMSSummaryDailyFoodOrder::OnToDateKillfocus(){
+	
+} */
+int CHMSSummaryDailyFoodOrder::OnToDateCheckValue(){
+	return 0;
+} 
+void CHMSSummaryDailyFoodOrder::OnStatusSelectChange(int nOldItemSel, int nNewItemSel){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CHMSSummaryDailyFoodOrder::OnStatusSelendok(){
+	 
+}
+/*void CHMSSummaryDailyFoodOrder::OnStatusSetfocus(){
+	
+}*/
+/*void CHMSSummaryDailyFoodOrder::OnStatusKillfocus(){
+	
+}*/
+long CHMSSummaryDailyFoodOrder::OnStatusLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CString szLabel;	
+	TranslateString(_T("Confirm"), szLabel);
+	m_wndStatus.AddItems(_T("S"), szLabel, NULL);
+	TranslateString(_T("Approval"), szLabel);
+	m_wndStatus.AddItems(_T("A"), szLabel, NULL);
+
+	return 0;
+}
+/*void CHMSSummaryDailyFoodOrder::OnStatusAddNew(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} */
+void CHMSSummaryDailyFoodOrder::OnPrintSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnPrintDeliverySummery(_T(""), _T(""));
+} 
+void CHMSSummaryDailyFoodOrder::OnOrderListDblClick(){
+	
+} 
+void CHMSSummaryDailyFoodOrder::OnOrderListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CHMSSummaryDailyFoodOrder::OnOrderListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CHMSSummaryDailyFoodOrder::OnOrderListLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szOrderBy, szWhere;	
+	UpdateData(true);
+	int nSubQtySC=0,nSubQtyTC=0,nSubQtyCC=0, nSubQtyS=0,nSubQtyT=0,nSubQtyC=0, nSubQty=0, nSubAmount=0,nSubTongS=0, nSubTongT=0, nSubTongC=0;
+	int nTotalQtySC,nTotalQtyTC,nTotalQtyCC, nTotalQtyS,nTotalQtyT,nTotalQtyC, nTongS, nTongT, nTongC;
+	nTotalQtySC = nTotalQtyTC = nTotalQtyCC = nTotalQtyS = nTotalQtyT = nTotalQtyC = nTongS = nTongT = nTongC=0;
+	m_szStatusKey = m_wndStatus.GetCurrent(0);
+
+	if(m_szStatusKey == _T("S"))
+	{
+		szWhere.Format(_T(" AND hfo_orderstatus = 'S' AND Cast_Timestamp2Date(hfo_orderdate) BETWEEN cast_string2date('%s') AND cast_string2date('%s') "),  m_szFormDate, m_szToDate);
+	}
+	else
+	{
+		szWhere.Format(_T(" AND hfo_orderstatus = 'A' AND Cast_Timestamp2Date(hfo_orderdate) BETWEEN cast_string2date('%s') AND cast_string2date('%s') "),  m_szFormDate, m_szToDate);
+	}
+
+	/*if(!m_szFoodTypeKey.IsEmpty()){
+		szWhere.AppendFormat(_T(" AND hfl_name2 ='%s' "), m_szFoodTypeKey);
+	}*/
+
+	m_wndOrderList.BeginLoad(); 
+	int nCount = 0;
+
+	if(m_bAllDept){
+		m_szSQL.Format(_T(" SELECT itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   groupid,") \
+		_T("   unit,") \
+		_T("   unitprice,") \
+		_T("   SUM(FoodQtyS)          AS QtyS,  ") \
+		_T("   SUM(FoodQtySC)          AS QtySC,  ") \
+		_T("   SUM(FoodQtyS-FoodQtySC) AS TongS,  ") \
+		_T("   SUM(FoodQtyT)          AS QtyT,  ") \
+		_T("   SUM(FoodQtyTC)          AS QtyTC,  ") \
+		_T("   SUM(FoodQtyT-FoodQtyTC) AS TongT,  ") \
+		_T("   SUM(FoodQtyC)          AS QtyC,  ") \
+		_T("   SUM(FoodQtyCC)          AS QtyCC,  ") \
+		_T("   SUM(FoodQtyC-FoodQtyCC) AS TongC,  ") \
+		_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))          AS Qty,  ") \
+		_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))*unitprice AS amount") \
+		_T(" FROM") \
+		_T("   (SELECT hfol_itemid AS itemid,") \
+		_T("     hfo_deptid         AS deptid,") \
+		_T("     hfl_name2          AS foodid,") \
+		_T("     hfl_name          AS foodname,") \
+		_T("	 hfol_type		   AS type, ") \
+		_T("     hfol_groupid      AS groupid,") \
+		_T("     hfl_unit          AS unit,") \
+		_T("     hfol_unitprice    AS unitprice,    ") \
+		_T("     hfol_qtyorder     AS FoodQty,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'S' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyS,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'S' AND hfe_refstatus='C'") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtySC,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'T' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyT,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'T' AND hfe_refstatus='C'") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyTC,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'C' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyC,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'C' AND hfe_refstatus='C'") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyCC    ") \
+		_T("   FROM hms_feefood") \
+		_T("   LEFT JOIN hms_feefoodline") \
+		_T("   ON(hfo_orderid=hfol_orderid)") \
+		_T("   LEFT JOIN hms_fee_list") \
+		_T("   ON(hfl_feeid        =hfol_itemid)") \
+		_T("   WHERE hfo_ordertype ='D'") \
+		_T("   %s ") \
+		_T("   )") \
+		_T(" GROUP BY groupid,") \
+		_T("   itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   unit,") \
+		_T("   unitprice") \
+		_T(" ORDER BY foodname,") \
+		_T("   unit,") \
+		_T("   unitprice"), szWhere);
+	}
+	else
+	{
+		m_szSQL.Format(_T(" SELECT itemid,") \
+			_T("   HMS_GETDEPARTMENTNAME(deptid) AS DeptName,") \
+			_T("   foodid,") \
+			_T("   foodname,") \
+			_T("   groupid,") \
+			_T("   unit,") \
+			_T("   unitprice,") \
+			_T("   SUM(FoodQtyS)          AS QtyS,  ") \
+			_T("   SUM(FoodQtySC)          AS QtySC,  ") \
+			_T("   SUM(FoodQtyS-FoodQtySC) AS TongS,  ") \
+			_T("   SUM(FoodQtyT)          AS QtyT,  ") \
+			_T("   SUM(FoodQtyTC)          AS QtyTC,  ") \
+			_T("   SUM(FoodQtyT-FoodQtyTC) AS TongT,  ") \
+			_T("   SUM(FoodQtyC)          AS QtyC,  ") \
+			_T("   SUM(FoodQtyCC)          AS QtyCC,  ") \
+			_T("   SUM(FoodQtyC-FoodQtyCC) AS TongC,  ") \
+			_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))          AS Qty,  ") \
+			_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))*unitprice AS amount") \
+			_T(" FROM") \
+			_T("   (SELECT hfol_itemid AS itemid,") \
+			_T("     hfo_deptid         AS deptid,") \
+			_T("     hfl_name2          AS foodid,") \
+			_T("     hfl_name          AS foodname,") \
+			_T("	 hfol_type		   AS type, ") \
+			_T("     hfol_groupid      AS groupid,") \
+			_T("     hfl_unit          AS unit,") \
+			_T("     hfol_unitprice    AS unitprice,    ") \
+			_T("     hfol_qtyorder     AS FoodQty,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'S' ") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyS,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'S' AND hfe_refstatus='C'") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtySC,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'T' ") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyT,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'T' AND hfe_refstatus='C'") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyTC,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'C' ") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyC,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'C' AND hfe_refstatus='C'") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyCC    ") \
+			_T("   FROM hms_feefood") \
+			_T("   LEFT JOIN hms_feefoodline") \
+			_T("   ON(hfo_orderid=hfol_orderid)") \
+			_T("   LEFT JOIN hms_fee_list") \
+			_T("   ON(hfl_feeid        =hfol_itemid)") \
+			_T("   WHERE hfo_ordertype ='D'") \
+			_T("   %s ") \
+			_T("   )") \
+			_T(" GROUP BY groupid,") \
+			_T("   itemid,") \
+			_T("   deptid,") \
+			_T("   foodid,") \
+			_T("   foodname,") \
+			_T("   unit,") \
+			_T("   unitprice") \
+			_T(" ORDER BY DeptName,foodname,") \
+			_T("   unit,") \
+			_T("   unitprice"), szWhere);
+	}
+		
+
+_fmsg(_T("%s"), m_szSQL);
+	nCount = rs.ExecSQL(m_szSQL);
+	int nIndex = 1;
+	double nTotalAmount =0;
+	int nItem = 0, nTotalQty =0;	
+	CString tmpStr, szStorageName, szProductName, szLineNew, szLineOld;
+	while(!rs.IsEOF()){		
+		nItem++;		
+		rs.GetValue(_T("deptname"), szLineNew);
+		if(szLineNew != szLineOld && !szLineNew.IsEmpty() && !m_bAllDept)
+		{
+			if( nSubQty > 0){
+				TranslateString(_T("Sum"), tmpStr);
+				nItem = m_wndOrderList.AddItems(
+					_T(""),
+					tmpStr,			
+					ToString(nSubQtyS),
+					ToString(nSubQtySC),
+					ToString(nSubTongS),
+					ToString(nSubQtyT),
+					ToString(nSubQtyTC),
+					ToString(nSubTongT),
+					ToString(nSubQtyC),
+					ToString(nSubQtyCC),
+					ToString(nSubTongC),
+					ToString(nSubQty),
+					_T(""),
+					ToString(nSubAmount), 
+					_T(""),
+					_T(""),
+					NULL);
+				m_wndOrderList.SetItemBkColor(nItem, RGB(192, 192, 192), FALSE);
+				m_wndOrderList.SetItemTextColor(nItem, RGB(0, 0, 255), FALSE);
+				m_wndOrderList.MergeCell(nItem, 1, nItem, 1, DT_LEFT|DT_VCENTER|DT_SINGLELINE, false, true);
+
+				nTotalQtySC += nSubQtySC;
+				nTotalQtyTC += nSubQtyTC;
+				nTotalQtyCC += nSubQtyCC; 
+				nTotalQtyS += nSubQtyS;
+				nTotalQtyT += nSubQtyT;
+				nTotalQtyC += nSubQtyC;
+				nTongS += nSubTongS;
+				nTongT += nSubTongT;
+				nTongC += nSubTongC;
+				nTotalQty += nSubQty;
+				nTotalAmount += nSubAmount;
+
+				nSubQtySC=0,nSubQtyTC=0,nSubQtyCC=0, nSubQtyS=0,nSubQtyT=0,nSubQtyC=0,nSubQty=0;
+				nSubAmount=nSubTongS=nSubTongT=nSubTongC=0;
+				
+			}
+			nItem = m_wndOrderList.AddItems(_T(""), szLineNew, NULL);
+			m_wndOrderList.SetItemBkColor(nItem, RGB( 64, 128, 128), FALSE);
+			m_wndOrderList.SetItemTextColor(nItem, COLOR_WHITE, FALSE);
+			m_wndOrderList.MergeCell(nItem, 1, nItem, 10, DT_LEFT|DT_VCENTER|DT_SINGLELINE, true, false);
+			szLineOld = szLineNew;
+		}
+
+
+		nSubQtyS += str2int(rs.GetValue(_T("QtyS")));
+		nSubQtySC += str2int(rs.GetValue(_T("QtySC")));
+		nSubTongS += str2int(rs.GetValue(_T("TongS")));
+
+		nSubQtyT += str2int(rs.GetValue(_T("QtyT")));
+		nSubQtyTC += str2int(rs.GetValue(_T("QtyTC")));
+		nSubTongT += str2int(rs.GetValue(_T("TongT")));
+
+		nSubQtyC += str2int(rs.GetValue(_T("QtyC")));
+		nSubQtyCC += str2int(rs.GetValue(_T("QtyCC")));
+		nSubTongC += str2int(rs.GetValue(_T("TongC")));
+
+		nSubQty += str2int(rs.GetValue(_T("Qty")));
+		nSubAmount += str2double(rs.GetValue(_T("amount")));
+
+
+		m_wndOrderList.AddItems(
+			rs.GetValue(_T("foodid")),
+			rs.GetValue(_T("foodname")),
+			rs.GetValue(_T("QtyS")),
+			rs.GetValue(_T("QtySC")),
+			rs.GetValue(_T("TongS")),
+			rs.GetValue(_T("QtyT")),
+			rs.GetValue(_T("QtyTC")),
+			rs.GetValue(_T("TongT")),
+			rs.GetValue(_T("QtyC")),
+			rs.GetValue(_T("QtyCC")),
+			rs.GetValue(_T("TongC")),
+			rs.GetValue(_T("Qty")),
+			rs.GetValue(_T("unitprice")),
+			rs.GetValue(_T("amount")),
+			rs.GetValue(_T("itemid")),
+			rs.GetValue(_T("Groupid")),
+			NULL);
+		rs.MoveNext();
+	}
+	if( nSubQty > 0){
+		TranslateString(_T("Sum"), tmpStr);
+		nItem = m_wndOrderList.AddItems(
+			_T(""),
+			tmpStr,			
+			ToString(nSubQtyS),
+			ToString(nSubQtySC),
+			ToString(nSubTongS),
+			ToString(nSubQtyT),
+			ToString(nSubQtyTC),
+			ToString(nSubTongT),
+			ToString(nSubQtyC),
+			ToString(nSubQtyCC),
+			ToString(nSubTongC),
+			ToString(nSubQty),
+			_T(""),
+			ToString(nSubAmount), 
+			_T(""),
+			_T(""),
+			NULL);
+		m_wndOrderList.SetItemBkColor(nItem, RGB(192, 192, 192), FALSE);
+		m_wndOrderList.SetItemTextColor(nItem, RGB(0, 0, 255), FALSE);
+		m_wndOrderList.MergeCell(nItem, 1, nItem, 1, DT_LEFT|DT_VCENTER|DT_SINGLELINE, false, true);
+
+		nTotalQtySC += nSubQtySC;
+		nTotalQtyTC += nSubQtyTC;
+		nTotalQtyCC += nSubQtyCC; 
+		nTotalQtyS += nSubQtyS;
+		nTotalQtyT += nSubQtyT;
+		nTotalQtyC += nSubQtyC;
+		nTongS += nSubTongS;
+		nTongT += nSubTongT;
+		nTongC += nSubTongC;
+		nTotalQty += nSubQty;
+		nTotalAmount += nSubAmount;
+	}
+
+	if(nTotalQty > 0 && !m_bAllDept){
+		TranslateString(_T("Total"), tmpStr);
+		nItem = m_wndOrderList.AddItems(
+			_T(""),
+			tmpStr,			
+			ToString(nTotalQtyS),
+			ToString(nTotalQtySC),
+			ToString(nTongS),
+			ToString(nTotalQtyT),
+			ToString(nTotalQtyTC),
+			ToString(nTongT),
+			ToString(nTotalQtyC),
+			ToString(nTotalQtyCC),
+			ToString(nTongC),
+			ToString(nTotalQty),
+			_T(""),
+			ToString(nTotalAmount), 
+			_T(""),
+			_T(""),
+			NULL);
+		m_wndOrderList.SetItemBkColor(nItem, RGB(192, 192, 192), FALSE);
+		m_wndOrderList.SetItemTextColor(nItem, RGB(0, 0, 255), FALSE);
+		m_wndOrderList.MergeCell(nItem, 1, nItem, 1, DT_LEFT|DT_VCENTER|DT_SINGLELINE, true, true);
+	}
+	
+	m_wndOrderList.EndLoad();
+
+	return nCount;
+}
+void CHMSSummaryDailyFoodOrder::OnRefreshSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnOrderListLoadData();
+} 
+void CHMSSummaryDailyFoodOrder::OnFoodTypeSelectChange(int nOldItemSel, int nNewItemSel){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CHMSSummaryDailyFoodOrder::OnFoodTypeSelendok(){
+	 
+}
+/*void CHMSSummaryDailyFoodOrder::OnFoodTypeSetfocus(){
+	
+}*/
+/*void CHMSSummaryDailyFoodOrder::OnFoodTypeKillfocus(){
+	
+}*/
+long CHMSSummaryDailyFoodOrder::OnFoodTypeLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szWhere;
+	if(m_wndFoodType.IsSearchKey() && str2int(m_szFoodTypeKey)){
+		szWhere.Format(_T(" AND hfl_name2='%s' "), m_szFoodTypeKey);
+	};
+	
+	m_wndFoodType.DeleteAllItems(); 
+	int nCount = 0;
+	szSQL.Format(_T(" SELECT  hfl_name2 as id,") \
+_T(" 	hfl_feeid as itemid, ") \
+_T(" 	hfl_name as name, ") \
+_T(" 	hfl_unit as unit, ") \
+_T(" 	hfl_servprice as unitprice,") \
+_T(" 	hfl_groupid as groupid, ") \
+_T(" 	hfl_typeid as typeid ") \
+_T(" FROM hms_fee_list ") \
+_T(" WHERE hfl_typeid = 'F' and hfl_groupid = 'FF000' and hfl_active='Y' %s ") \
+_T(" ORDER BY name, unit, unitprice "), szWhere );
+	nCount = rs.ExecSQL(szSQL);
+_tprintf(_T("%s"), szSQL);
+
+_fmsg(_T("%s"), szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndFoodType.AddItems(
+			rs.GetValue(_T("id")),
+			rs.GetValue(_T("name")), 
+			rs.GetValue(_T("unit")), 
+			rs.GetValue(_T("unitprice")), 
+			rs.GetValue(_T("groupid")), 
+			rs.GetValue(_T("itemid")),			
+			NULL);
+		rs.MoveNext();
+	}
+	return nCount;
+}
+/*void CHMSSummaryDailyFoodOrder::OnFoodTypeAddNew(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} */
+int CHMSSummaryDailyFoodOrder::OnAddCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_ADD);
+	return 0;
+}
+int CHMSSummaryDailyFoodOrder::OnEditCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_EDIT);
+	return 0;  
+}
+int CHMSSummaryDailyFoodOrder::OnDeleteCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO)
+ 		return -1;
+ 	szSQL.Format(_T("DELETE FROM  WHERE  AND") );
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret >= 0){
+ 		SetMode(VM_NONE);
+ 		OnCancelCHMSSummaryDailyFoodOrder();
+ 	}
+	return 0;
+}
+int CHMSSummaryDailyFoodOrder::OnSaveCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT)
+ 		return -1;
+ 	if(!IsValidateData())
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(GetMode() == VM_ADD){
+ 		//szSQL = m_tblTbl.GetInsertSQL();
+ 	}
+ 	else if(GetMode() == VM_EDIT){
+ 		CString szWhere;
+ 		szWhere.Format(_T(" WHERE"));
+ 		//szSQL = m_tblTbl.GetUpdateSQL(_T("createdby,createddate"));
+ 		szSQL += szWhere;
+ 	}
+ _fmsg(_T("%s"), szSQL);
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret > 0)
+ 	{
+ 		//OnCHMSSummaryDailyFoodOrderListLoadData();
+ 		SetMode(VM_VIEW);
+ 	}
+ 	else
+ 	{
+ 	}
+ 	return ret;
+ 	return 0;
+}
+int CHMSSummaryDailyFoodOrder::OnCancelCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() == VM_EDIT)
+ 	{
+ 		SetMode(VM_VIEW);
+ 	} 
+ 	else 
+ 	{
+ 		SetMode(VM_NONE);
+ 	} 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	return 0;
+} 
+int CHMSSummaryDailyFoodOrder::OnCHMSSummaryDailyFoodOrderListLoadData(){
+	return 0;
+}
+
+void CHMSSummaryDailyFoodOrder::OnPrintDeliverySummery(LPCTSTR lpszFromDate, LPCTSTR lpszToDate){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+	CReport rpt;	
+	CString tmpStr;
+	CString szSQL, szWhere;
+	CRecord rs(&pMF->m_db);	
+	int nSubQtySC=0,nSubQtyTC=0,nSubQtyCC=0, nSubQtyS=0,nSubQtyT=0,nSubQtyC=0, nSubQty=0, nSubAmount=0,nSubTongS=0, nSubTongT=0, nSubTongC=0;
+	int nTotalQtySC,nTotalQtyTC,nTotalQtyCC, nTotalQtyS,nTotalQtyT,nTotalQtyC, nTongS, nTongT, nTongC;
+	nTotalQtySC = nTotalQtyTC = nTotalQtyCC = nTotalQtyS = nTotalQtyT = nTotalQtyC = nTongS = nTongT = nTongC=0;
+
+	UpdateData(true);
+
+	if(!rpt.Init(_T("Reports/HMS/TM_FOODORDERSUMMERYALL.RPT")) )
+		return;
+		
+	
+	m_szStatusKey = m_wndStatus.GetCurrent(0);
+
+	if(m_szStatusKey == _T("S"))
+	{
+		szWhere.Format(_T(" AND hfo_orderstatus = 'S' AND Cast_Timestamp2Date(hfo_orderdate) BETWEEN cast_string2date('%s') AND cast_string2date('%s') "),  m_szFormDate, m_szToDate);
+	}
+	else
+	{
+		szWhere.Format(_T(" AND hfo_orderstatus = 'A' AND Cast_Timestamp2Date(hfo_orderdate) BETWEEN cast_string2date('%s') AND cast_string2date('%s') "),  m_szFormDate, m_szToDate);
+	}
+	if(m_bAllDept){
+		m_szSQL.Format(_T(" SELECT itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   groupid,") \
+		_T("   unit,") \
+		_T("   unitprice,") \
+		_T("   SUM(FoodQtyS)          AS QtyS,  ") \
+		_T("   SUM(FoodQtySC)          AS QtySC,  ") \
+		_T("   SUM(FoodQtyS-FoodQtySC) AS TongS,  ") \
+		_T("   SUM(FoodQtyT)          AS QtyT,  ") \
+		_T("   SUM(FoodQtyTC)          AS QtyTC,  ") \
+		_T("   SUM(FoodQtyT-FoodQtyTC) AS TongT,  ") \
+		_T("   SUM(FoodQtyC)          AS QtyC,  ") \
+		_T("   SUM(FoodQtyCC)          AS QtyCC,  ") \
+		_T("   SUM(FoodQtyC-FoodQtyCC) AS TongC,  ") \
+		_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))          AS Qty,  ") \
+		_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))*unitprice AS amount") \
+		_T(" FROM") \
+		_T("   (SELECT hfol_itemid AS itemid,") \
+		_T("     hfo_deptid         AS deptid,") \
+		_T("     hfl_name2          AS foodid,") \
+		_T("     hfl_name          AS foodname,") \
+		_T("	 hfol_type		   AS type, ") \
+		_T("     hfol_groupid      AS groupid,") \
+		_T("     hfl_unit          AS unit,") \
+		_T("     hfol_unitprice    AS unitprice,    ") \
+		_T("     hfol_qtyorder     AS FoodQty,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'S' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyS,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'S' AND hfe_refstatus='C'") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtySC,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'T' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyT,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'T' AND hfe_refstatus='C'") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyTC,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'C' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyC,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'C' AND hfe_refstatus='C'") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyCC    ") \
+		_T("   FROM hms_feefood") \
+		_T("   LEFT JOIN hms_feefoodline") \
+		_T("   ON(hfo_orderid=hfol_orderid)") \
+		_T("   LEFT JOIN hms_fee_list") \
+		_T("   ON(hfl_feeid        =hfol_itemid)") \
+		_T("   WHERE hfo_ordertype ='D'") \
+		_T("   %s ") \
+		_T("   )") \
+		_T(" GROUP BY groupid,") \
+		_T("   itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   unit,") \
+		_T("   unitprice") \
+		_T(" ORDER BY foodname,") \
+		_T("   unit,") \
+		_T("   unitprice"), szWhere);
+	}
+	else
+	{
+		m_szSQL.Format(_T(" SELECT itemid,") \
+			_T("   HMS_GETDEPARTMENTNAME(deptid) AS DeptName,") \
+			_T("   foodid,") \
+			_T("   foodname,") \
+			_T("   groupid,") \
+			_T("   unit,") \
+			_T("   unitprice,") \
+			_T("   SUM(FoodQtyS)          AS QtyS,  ") \
+			_T("   SUM(FoodQtySC)          AS QtySC,  ") \
+			_T("   SUM(FoodQtyS-FoodQtySC) AS TongS,  ") \
+			_T("   SUM(FoodQtyT)          AS QtyT,  ") \
+			_T("   SUM(FoodQtyTC)          AS QtyTC,  ") \
+			_T("   SUM(FoodQtyT-FoodQtyTC) AS TongT,  ") \
+			_T("   SUM(FoodQtyC)          AS QtyC,  ") \
+			_T("   SUM(FoodQtyCC)          AS QtyCC,  ") \
+			_T("   SUM(FoodQtyC-FoodQtyCC) AS TongC,  ") \
+			_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))          AS Qty,  ") \
+			_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))*unitprice AS amount") \
+			_T(" FROM") \
+			_T("   (SELECT hfol_itemid AS itemid,") \
+			_T("     hfo_deptid         AS deptid,") \
+			_T("     hfl_name2          AS foodid,") \
+			_T("     hfl_name          AS foodname,") \
+			_T("	 hfol_type		   AS type, ") \
+			_T("     hfol_groupid      AS groupid,") \
+			_T("     hfl_unit          AS unit,") \
+			_T("     hfol_unitprice    AS unitprice,    ") \
+			_T("     hfol_qtyorder     AS FoodQty,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'S' ") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyS,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'S' AND hfe_refstatus='C'") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtySC,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'T' ") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyT,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'T' AND hfe_refstatus='C'") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyTC,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'C' ") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyC,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'C' AND hfe_refstatus='C'") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyCC    ") \
+			_T("   FROM hms_feefood") \
+			_T("   LEFT JOIN hms_feefoodline") \
+			_T("   ON(hfo_orderid=hfol_orderid)") \
+			_T("   LEFT JOIN hms_fee_list") \
+			_T("   ON(hfl_feeid        =hfol_itemid)") \
+			_T("   WHERE hfo_ordertype ='D'") \
+			_T("   %s ") \
+			_T("   )") \
+			_T(" GROUP BY groupid,") \
+			_T("   itemid,") \
+			_T("   deptid,") \
+			_T("   foodid,") \
+			_T("   foodname,") \
+			_T("   unit,") \
+			_T("   unitprice") \
+			_T(" ORDER BY DeptName,foodname,") \
+			_T("   unit,") \
+			_T("   unitprice"), szWhere);
+	}
+
+	rs.ExecSQL(m_szSQL);
+
+	CString szDate;
+	CReportSection* rptDetail;
+	CString szItemID;	
+	int nIndex = 1;
+	double nTotalAmount =0;
+	int nItem = 0, nTotalQty =0;
+	
+	szDate.Format(_T("Ng\xE0y %s"), CDate::Convert(m_szFormDate, yyyymmdd, ddmmyyyy));
+	if(m_szFormDate != m_szToDate )
+		szDate.Format(_T("T\x1EEB ng\xE0y %s \x111\x1EBFn ng\xE0y %s "), CDate::Convert(m_szFormDate, yyyymmdd, ddmmyyyy), CDate::Convert(m_szToDate, yyyymmdd, ddmmyyyy));
+
+	rpt.GetReportHeader()->SetValue(_T("ReportDate"), szDate);
+
+	CString szLineNew, szLineOld;
+	while(!rs.IsEOF())
+	{		
+		rs.GetValue(_T("deptname"), szLineNew);
+		if(szLineNew != szLineOld && !szLineNew.IsEmpty() && !m_bAllDept)
+		{
+			if(nSubQty > 0)
+			{				
+				rptDetail = rpt.AddDetail(rpt.GetGroupFooter(1));			
+				rptDetail->SetValue(_T("s3"), nSubQtyS);
+				rptDetail->SetValue(_T("s4"), nSubQtySC);
+				rptDetail->SetValue(_T("s5"), nSubTongS),
+				rptDetail->SetValue(_T("s6"), nSubQtyT);
+				rptDetail->SetValue(_T("s7"), nSubQtyTC);
+				rptDetail->SetValue(_T("s8"), nSubTongT);
+				rptDetail->SetValue(_T("s9"), nSubQtyC);
+				rptDetail->SetValue(_T("s10"), nSubQtyCC);
+				rptDetail->SetValue(_T("s11"), nSubTongC);
+				rptDetail->SetValue(_T("s12"), nSubQty);
+				rptDetail->SetValue(_T("s14"), nSubAmount);	
+
+				nTotalQtySC += nSubQtySC;
+				nTotalQtyTC += nSubQtyTC;
+				nTotalQtyCC += nSubQtyCC; 
+				nTotalQtyS += nSubQtyS;
+				nTotalQtyT += nSubQtyT;
+				nTotalQtyC += nSubQtyC;
+				nTongS += nSubTongS;
+				nTongT += nSubTongT;
+				nTongC += nSubTongC;
+				nTotalQty += nSubQty;
+				nTotalAmount += nSubAmount;
+			}
+
+			rptDetail = rpt.AddDetail(rpt.GetGroupHeader(1));
+			rptDetail->SetValue(_T("name"), szLineNew);
+			szLineOld = szLineNew;
+
+			nSubQtySC=0,nSubQtyTC=0,nSubQtyCC=0, nSubQtyS=0,nSubQtyT=0,nSubQtyC=0,nSubQty=0;
+			nSubAmount=nSubTongS=nSubTongT=nSubTongC=0;
+		}
+		
+		rptDetail = rpt.AddDetail();
+		nItem++;
+		rs.GetValue(_T("foodid"), tmpStr);
+		rptDetail->SetValue(_T("1"), tmpStr);
+		rs.GetValue(_T("foodname"), tmpStr);
+		rptDetail->SetValue(_T("2"), tmpStr);
+		rs.GetValue(_T("QtyS"), tmpStr);
+		rptDetail->SetValue(_T("3"), tmpStr);
+		rs.GetValue(_T("QtySC"), tmpStr);
+		rptDetail->SetValue(_T("4"), tmpStr);
+		rs.GetValue(_T("TongS"), tmpStr);
+		rptDetail->SetValue(_T("5"), tmpStr);
+		rs.GetValue(_T("QtyT"), tmpStr);
+		rptDetail->SetValue(_T("6"), tmpStr);
+		rs.GetValue(_T("QtyTC"), tmpStr);
+		rptDetail->SetValue(_T("7"), tmpStr);
+		rs.GetValue(_T("TongT"), tmpStr);
+		rptDetail->SetValue(_T("8"), tmpStr);
+		rs.GetValue(_T("QtyC"), tmpStr);
+		rptDetail->SetValue(_T("9"), tmpStr);		
+		rs.GetValue(_T("QtyCC"), tmpStr);
+		rptDetail->SetValue(_T("10"), tmpStr);
+		rs.GetValue(_T("TongC"), tmpStr);
+		rptDetail->SetValue(_T("11"), tmpStr);
+		rs.GetValue(_T("Qty"), tmpStr);
+		rptDetail->SetValue(_T("12"), tmpStr);
+		rs.GetValue(_T("unitprice"), tmpStr);
+		rptDetail->SetValue(_T("13"), tmpStr);
+		rs.GetValue(_T("amount"), tmpStr);
+		rptDetail->SetValue(_T("14"), tmpStr);
+
+		nSubQtyS += str2int(rs.GetValue(_T("QtyS")));
+		nSubQtySC += str2int(rs.GetValue(_T("QtySC")));
+		nSubTongS += str2int(rs.GetValue(_T("TongS")));
+
+		nSubQtyT += str2int(rs.GetValue(_T("QtyT")));
+		nSubQtyTC += str2int(rs.GetValue(_T("QtyTC")));
+		nSubTongT += str2int(rs.GetValue(_T("TongT")));
+
+		nSubQtyC += str2int(rs.GetValue(_T("QtyC")));
+		nSubQtyCC += str2int(rs.GetValue(_T("QtyCC")));
+		nSubTongC += str2int(rs.GetValue(_T("TongC")));
+
+		nSubQty += str2int(rs.GetValue(_T("Qty")));
+		nSubAmount += str2double(rs.GetValue(_T("amount")));
+
+		
+		rs.MoveNext();
+	}
+	
+
+	if(nSubQty > 0)
+	{		
+		rptDetail = rpt.AddDetail(rpt.GetGroupFooter(1));			
+		rptDetail->SetValue(_T("s3"), nSubQtyS);
+		rptDetail->SetValue(_T("s4"), nSubQtySC);
+		rptDetail->SetValue(_T("s5"), nSubTongS),
+		rptDetail->SetValue(_T("s6"), nSubQtyT);
+		rptDetail->SetValue(_T("s7"), nSubQtyTC);
+		rptDetail->SetValue(_T("s8"), nSubTongT);
+		rptDetail->SetValue(_T("s9"), nSubQtyC);
+		rptDetail->SetValue(_T("s10"), nSubQtyCC);
+		rptDetail->SetValue(_T("s11"), nSubTongC);
+		rptDetail->SetValue(_T("s12"), nSubQty);			
+		rptDetail->SetValue(_T("s14"), nSubAmount);	
+
+		nTotalQtySC += nSubQtySC;
+		nTotalQtyTC += nSubQtyTC;
+		nTotalQtyCC += nSubQtyCC; 
+		nTotalQtyS += nSubQtyS;
+		nTotalQtyT += nSubQtyT;
+		nTotalQtyC += nSubQtyC;
+		nTongS += nSubTongS;
+		nTongT += nSubTongT;
+		nTongC += nSubTongC;
+		nTotalQty += nSubQty;
+		nTotalAmount += nSubAmount;		
+	}
+
+	if(nTotalQty > 0 && !m_bAllDept)
+	{		
+		rptDetail = rpt.AddDetail(rpt.GetGroupFooter(1));			
+		rptDetail->SetValue(_T("s3"), nTotalQtyS);
+		rptDetail->SetValue(_T("s4"), nTotalQtySC);
+		rptDetail->SetValue(_T("s5"), nTongS),
+		rptDetail->SetValue(_T("s6"), nTotalQtyT);
+		rptDetail->SetValue(_T("s7"), nTotalQtyTC);
+		rptDetail->SetValue(_T("s8"), nTongT);
+		rptDetail->SetValue(_T("s9"), nTotalQtyC);
+		rptDetail->SetValue(_T("s10"), nTotalQtyCC);
+		rptDetail->SetValue(_T("s11"), nTongC);
+		rptDetail->SetValue(_T("s12"), nTotalQty);			
+		rptDetail->SetValue(_T("s14"), nTotalAmount);		
+	}
+
+
+	tmpStr = pMF->GetSysDate();
+	szDate.Format(rpt.GetReportFooter()->GetValue(_T("PrintDate")), tmpStr.Mid(8, 2), tmpStr.Mid(5, 2), tmpStr.Left(4));
+	rpt.GetReportFooter()->SetValue(_T("PrintDate"), szDate);
+//	rs.GetValue(_T("doctor"), tmpStr);
+	rpt.GetReportFooter()->SetValue(_T("UserName"), pMF->GetDoctorName(pMF->GetCurrentUser()));
+	CReportItem *img = rpt.GetReportFooter()->GetItem(_T("Signature"));
+	if(img)
+	{
+		img->SetHBITMAP(pMF->GetSignatureImage(tmpStr));
+		img->SetFixedHeight(false);
+	}
+
+	rpt.PrintPreview();
+}
Index: HMSSummaryDailyFoodOrder.h
===================================================================
--- HMSSummaryDailyFoodOrder.h	(revision 0)
+++ HMSSummaryDailyFoodOrder.h	(working copy)
@@ -0,0 +1,99 @@
+#ifndef CHMSSUMMARYDAILYFOODORDER_H
+#define CHMSSUMMARYDAILYFOODORDER_H
+
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Copyright  Viet Nam Medical Software Joint Stock Company. 2005-2012. 			
+//	All rights reserved. 
+//	This program is protected by Viet nam and international treaties.  
+//	Unauthorized reproduction or distribution of this program, 
+//	or any portion of it, may result in severe civil and criminal penalties, 
+//	and will be prosecuted to the maximum extent possible under the law.
+//	This file is a part of the GUI(Graphical User Interface) class library.
+//	(c) 2006-2008 Hoang Van Hay, All rights reserved.
+//	CONTACT INFORMATION:
+//	Email  : hayhv@vimes.com.vn or hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+/////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Ban quyen cua Cong Ty Co Phan Phan Mem Y Te Viet Nam 2005-2012.
+//	Do Cuc Ban Quyen, Bo VHTT nuoc Cong hoa xa hoi chu nghia Viet Nam cap.
+//	Chuong trinh phan mem nay duoc Luat phap Viet Nam va quoc te bao ho.
+//	San xuat, su dung hoac phan phoi trai phep toan bo hoac mot phan cua phan men nay se
+//	chiu cac hinh phat va hinh su hoac dan su, co the len den muc toi da dung theo Luat qui dinh.
+//	File nay la mot phan cua thu vien lap trinh(GUI). Ban quyen cua Hoang Van Hay. 2006-2008
+//	THONG TIN LIEN HE:
+//	Email  : hayhv@vimes.com.vn hoac hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+#include "GuiUtils.h"
+#include "GuiView.h"
+#include "DbField.h"
+class CHMSSummaryDailyFoodOrder : public CGuiView{
+protected:
+public:
+	CGuiGroupBox	m_wndOrderInformation;
+	CGuiGroupBox	m_wndGroupListDrug;
+	CGuiLabel		m_wndFormDateLabel;
+	CGuiDateCtrl	m_wndFormDate;
+	CGuiLabel		m_wndToDateLabel;
+	CGuiDateCtrl	m_wndToDate;
+	CGuiLabel		m_wndStatusLabel;
+	CGuiComboBox	m_wndStatus;
+	CGuiButton		m_wndPrint;
+	CGuiListCtrl	m_wndOrderList;
+	CGuiButton		m_wndRefresh;
+	CGuiLabel		m_wndFoodTypeLabel;
+	CGuiComboBox	m_wndFoodType;
+	CGuiCheckBox	m_wndAllDept;
+
+	CString	m_szFormDate;
+	CString	m_szToDate;
+	CString	m_szStatusKey;
+	CString	m_szFoodTypeKey;
+	CString	m_szSQL;
+	BOOL	m_bAllDept;
+	//void			OnFormDateChange(); 
+	//void			OnFormDateSetfocus(); 
+	//void			OnFormDateKillfocus(); 
+	int			OnFormDateCheckValue(); 
+	//void			OnToDateChange(); 
+	//void			OnToDateSetfocus(); 
+	//void			OnToDateKillfocus(); 
+	int			OnToDateCheckValue(); 
+	void			OnStatusSelectChange(int nOldItemSel, int nNewItemSel); 
+	void			OnStatusSelendok(); 
+	//void			OnStatusSetfocus(); 
+	//void			OnStatusKillfocus(); 
+	long			OnStatusLoadData(); 
+	//void			OnStatusAddNew(); 
+	void			OnPrintSelect(); 
+	long			OnOrderListLoadData(); 
+	void			OnOrderListSelectChange(int nOldItem, int nNewItem); 
+	void			OnOrderListDblClick(); 
+	int			OnOrderListDeleteItem(); 
+	void			OnPrintDeliverySummery(LPCTSTR lpszFromDate, LPCTSTR lpszToDate);
+	void			OnRefreshSelect(); 
+	void			OnFoodTypeSelectChange(int nOldItemSel, int nNewItemSel); 
+	void			OnFoodTypeSelendok(); 
+	//void			OnFoodTypeSetfocus(); 
+	//void			OnFoodTypeKillfocus(); 
+	long			OnFoodTypeLoadData(); 
+	//void			OnFoodTypeAddNew(); 
+
+	CHMSSummaryDailyFoodOrder();
+	~CHMSSummaryDailyFoodOrder();
+	void OnCreateComponents();
+	void OnInitializeComponents();
+	void OnSetWindowEvents();
+	void OnDoDataExchange(CDataExchange* pDX);
+	void GetDataToScreen();
+	void GetScreenToData();
+	void SetDefaultValues();
+	int SetMode(int nMode);
+	int OnAddCHMSSummaryDailyFoodOrder(); 
+	int OnEditCHMSSummaryDailyFoodOrder(); 
+	int OnDeleteCHMSSummaryDailyFoodOrder(); 
+	int OnSaveCHMSSummaryDailyFoodOrder(); 
+	int OnCancelCHMSSummaryDailyFoodOrder(); 
+	int OnCHMSSummaryDailyFoodOrderListLoadData(); 
+};
+#endif
Index: MainFrm.cpp
===================================================================
--- MainFrm.cpp	(revision 0)
+++ MainFrm.cpp	(working copy)
@@ -0,0 +1,104 @@
+// MainFrm.cpp : implementation of the CMainFrame class
+//
+#include "stdafx.h"
+#include "MainFrm.h"
+#include "GuiUtils.h"
+#include "resource.h"
+#include ".\mainfrm.h"
+
+
+IMPLEMENT_DYNAMIC(CMainFrame, CHMSMainFrame)
+
+BEGIN_MESSAGE_MAP(CMainFrame, CHMSMainFrame)
+	ON_WM_CREATE()
+	ON_WM_SIZE()
+END_MESSAGE_MAP()
+
+// CMainFrame construction/destruction
+
+CMainFrame::CMainFrame()
+{
+	SetLocalLang(1);
+	m_szModuleName = _T("NUTRITION MODULE");
+	m_szModuleID = _T("NM");
+	m_szVersion = _T("1.1");
+	m_szSize = CSize(1024, 720);
+}
+
+CMainFrame::~CMainFrame()
+{	
+
+}
+
+void _OnSelChange(CWnd* pWnd, int nOldItem, int nNewItem)
+{
+	//_msg(_T("%d : %d"), nOldItem, nNewItem);
+	CMainFrame *pMF = (CMainFrame *)pWnd;
+	if (nNewItem == 0)
+	{
+		/*if (pMF->m_wndSurgerySchedule.m_wndWeekView.GetCheck())
+		{
+			pMF->m_wndSurgerySchedule.m_wndCalendar.SetView(WV_WEEKVIEW, FALSE);
+		}*/
+	}
+}
+
+int CMainFrame::OnCreate(LPCREATESTRUCT lpCreateStruct)
+{
+
+	if (CHMSMainFrame::OnCreate(lpCreateStruct) == -1)
+		return -1;
+	CString szSQL, tmpStr;
+
+	TranslateString(_T("NUTRITON MODULE"), tmpStr);
+	SetWindowText(tmpStr);
+
+	ModifyStyle(WS_MAXIMIZEBOX|WS_SIZEBOX, 0);
+	m_hIcon = AfxGetApp()->LoadIcon(IDR_MAINFRAME);
+	SetIcon(m_hIcon, TRUE);			// Set big icon
+	SetIcon(m_hIcon, FALSE);		// Set small icon
+
+	CenterWindow();
+	
+	m_wndTab.Create(this,0, 0, 1024, 660);
+	m_wndDailyFoodOrderList.Create(&m_wndTab);
+	m_wndDailyFoodOrder.Create(&m_wndTab);
+	m_wndSummaryDailyFoodOrder.Create(&m_wndTab);
+	m_wndTab.Add(_T("Order List"), &m_wndDailyFoodOrderList);
+	m_wndTab.Add(_T("Order Information"), &m_wndDailyFoodOrder);
+	m_wndTab.Add(_T("Summary Order"), &m_wndSummaryDailyFoodOrder);
+	//SetWindowText(_T("Delivery Cabinet Management"));
+	m_wndDailyFoodOrderList.m_wndOrder = &m_wndDailyFoodOrder;
+
+
+	CString szStatus, szStatusLabel, szDate;
+	szDate = GetSysDate();
+	TranslateString(_T("UserID: %s - Working Date: %s"), szStatusLabel);
+	szStatus.Format(szStatusLabel, GetCurrentUser(), CDate::Convert(szDate, yyyymmdd, ddmmyyyy));
+	szStatus.AppendFormat(_T(" - Host: %s"), GetHost(), GetDatabase());
+	SetStatusText(szStatus, 1);
+
+	SetActivePane(0);
+
+	SetForegroundWindow();
+
+	CGuiTabCtrl *pTab = (CGuiTabCtrl *)GetPane();
+	pTab->SetEvent(WE_SELCHANGE, _OnSelChange);
+	
+	return 0;
+}
+
+void CMainFrame::OnInitializes()
+{
+	CHMSMainFrame::OnInitializes();
+	CString szSQL;
+	CRecord rs(&m_db);
+	
+	/*if (GetCurrentUser().Trim().MakeLower() != _T("admin"))
+	{
+		m_pSplashThread->HideSplash();
+		ShowMessageBox(_T("Permisson denied"), MB_OK | MB_ICONERROR);
+		exit(0);
+	}*/
+
+}
\ No newline at end of file
Index: MainFrm.h
===================================================================
--- MainFrm.h	(revision 0)
+++ MainFrm.h	(working copy)
@@ -0,0 +1,31 @@
+#ifndef MAINFRAME_H
+#define MAINFRAME_H
+#include "HMSDailyFoodOrderList.h"
+#include "HMSDailyFoodOrder.h"
+#include "HMSMainFrame.h"
+#include "HMSSummaryDailyFoodOrder.h"
+
+class CMainFrame : public CHMSMainFrame
+{
+	CHMSDailyFoodOrderList	m_wndDailyFoodOrderList;
+	CHMSDailyFoodOrder		m_wndDailyFoodOrder;
+	CHMSSummaryDailyFoodOrder		m_wndSummaryDailyFoodOrder;
+	CGuiTabCtrl	m_wndTab;
+
+	DECLARE_DYNAMIC(CMainFrame)
+	HICON m_hIcon;
+public:
+
+	CMainFrame();
+	virtual ~CMainFrame();
+
+protected: 
+	
+	void OnInitializes();
+	afx_msg int OnCreate(LPCREATESTRUCT lpCreateStruct);
+
+	DECLARE_MESSAGE_MAP()
+public:
+	void Recurse(LPCTSTR pstr);
+};
+#endif
\ No newline at end of file
Index: ReadMe.txt
===================================================================
--- ReadMe.txt	(revision 0)
+++ ReadMe.txt	(working copy)
@@ -0,0 +1,122 @@
+================================================================================
+    MICROSOFT FOUNDATION CLASS LIBRARY : VIMESNutritionManagr Project Overview
+===============================================================================
+
+The application wizard has created this VIMESNutritionManagr application for 
+you.  This application not only demonstrates the basics of using the Microsoft 
+Foundation Classes but is also a starting point for writing your application.
+
+This file contains a summary of what you will find in each of the files that
+make up your VIMESNutritionManagr application.
+
+VIMESNutritionManagr.vcproj
+    This is the main project file for VC++ projects generated using an application wizard. 
+    It contains information about the version of Visual C++ that generated the file, and 
+    information about the platforms, configurations, and project features selected with the
+    application wizard.
+
+VIMESNutritionManagr.h
+    This is the main header file for the application.  It includes other
+    project specific headers (including Resource.h) and declares the
+    CVIMESNutritionManagrApp application class.
+
+VIMESNutritionManagr.cpp
+    This is the main application source file that contains the application
+    class CVIMESNutritionManagrApp.
+
+VIMESNutritionManagr.rc
+    This is a listing of all of the Microsoft Windows resources that the
+    program uses.  It includes the icons, bitmaps, and cursors that are stored
+    in the RES subdirectory.  This file can be directly edited in Microsoft
+    Visual C++. Your project resources are in 1033.
+
+res\VIMESNutritionManagr.ico
+    This is an icon file, which is used as the application's icon.  This
+    icon is included by the main resource file VIMESNutritionManagr.rc.
+
+res\VIMESNutritionManagr.rc2
+    This file contains resources that are not edited by Microsoft 
+    Visual C++. You should place all resources not editable by
+    the resource editor in this file.
+/////////////////////////////////////////////////////////////////////////////
+
+For the main frame window:
+    The project includes a standard MFC interface.
+MainFrm.h, MainFrm.cpp
+    These files contain the frame class CMainFrame, which is derived from
+    CMDIFrameWnd and controls all MDI frame features.
+res\Toolbar.bmp
+    This bitmap file is used to create tiled images for the toolbar.
+    The initial toolbar and status bar are constructed in the CMainFrame
+    class. Edit this toolbar bitmap using the resource editor, and
+    update the IDR_MAINFRAME TOOLBAR array in VIMESNutritionManagr.rc to add
+    toolbar buttons.
+/////////////////////////////////////////////////////////////////////////////
+
+For the child frame window:
+
+ChildFrm.h, ChildFrm.cpp
+    These files define and implement the CChildFrame class, which
+    supports the child windows in an MDI application.
+
+/////////////////////////////////////////////////////////////////////////////
+
+The application wizard creates one document type and one view:
+
+VIMESNutritionManagrDoc.h, VIMESNutritionManagrDoc.cpp - the document
+    These files contain your CVIMESNutritionManagrDoc class.  Edit these files to
+    add your special document data and to implement file saving and loading
+    (via CVIMESNutritionManagrDoc::Serialize).
+VIMESNutritionManagrView.h, VIMESNutritionManagrView.cpp - the view of the document
+    These files contain your CVIMESNutritionManagrView class.
+    CVIMESNutritionManagrView objects are used to view CVIMESNutritionManagrDoc objects.
+res\VIMESNutritionManagrDoc.ico
+    This is an icon file, which is used as the icon for MDI child windows
+    for the CVIMESNutritionManagrDoc class.  This icon is included by the main
+    resource file VIMESNutritionManagr.rc.
+/////////////////////////////////////////////////////////////////////////////
+
+Other Features:
+
+ActiveX Controls
+    The application includes support to use ActiveX controls.
+
+Printing and Print Preview support
+    The application wizard has generated code to handle the print, print setup, and print preview
+    commands by calling member functions in the CView class from the MFC library.
+/////////////////////////////////////////////////////////////////////////////
+
+Other standard files:
+
+StdAfx.h, StdAfx.cpp
+    These files are used to build a precompiled header (PCH) file
+    named VIMESNutritionManagr.pch and a precompiled types file named StdAfx.obj.
+
+Resource.h
+    This is the standard header file, which defines new resource IDs.
+    Microsoft Visual C++ reads and updates this file.
+
+VIMESNutritionManagr.manifest
+	Application manifest files are used by Windows XP to describe an applications 
+	dependency on specific versions of Side-by-Side assemblies. The loader uses this 
+	information to load the appropriate assembly from the assembly cache or private 
+	from the application. The Application manifest  maybe included for redistribution 
+	as an external .manifest file that is installed in the same folder as the application 
+	executable or it may be included in the executable in the form of a resource. 
+/////////////////////////////////////////////////////////////////////////////
+
+Other notes:
+
+The application wizard uses "TODO:" to indicate parts of the source code you
+should add to or customize.
+
+If your application uses MFC in a shared DLL, and your application is in a 
+language other than the operating system's current language, you will need 
+to copy the corresponding localized resources MFC70XXX.DLL from the Microsoft
+Visual C++ CD-ROM under the Win\System directory to your computer's system or 
+system32 directory, and rename it to be MFCLOC.DLL.  ("XXX" stands for the 
+language abbreviation.  For example, MFC70DEU.DLL contains resources 
+translated to German.)  If you don't do this, some of the UI elements of 
+your application will remain in the language of the operating system.
+
+/////////////////////////////////////////////////////////////////////////////
Index: Resx/CHMSDailyFoodOrder.cpp
===================================================================
--- Resx/CHMSDailyFoodOrder.cpp	(revision 0)
+++ Resx/CHMSDailyFoodOrder.cpp	(working copy)
@@ -0,0 +1,635 @@
+#include "CHMSDailyFoodOrder.h"
+#include "MainFrm.h"
+/*static void _OnOrderNoChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderNoChange();
+} */
+/*static void _OnOrderNoSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderNoSetfocus();} */ 
+/*static void _OnOrderNoKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderNoKillfocus();
+} */
+static int _OnOrderNoCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnOrderNoCheckValue();
+} 
+static void _OnFindSelectFnc(CWnd *pWnd){
+	CCHMSDailyFoodOrder *pVw = (CCHMSDailyFoodOrder *)pWnd;
+	pVw->OnFindSelect();
+} 
+/*static void _OnOrderDateChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderDateChange();
+} */
+/*static void _OnOrderDateSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderDateSetfocus();} */ 
+/*static void _OnOrderDateKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderDateKillfocus();
+} */
+static int _OnOrderDateCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnOrderDateCheckValue();
+} 
+/*static void _OnIssueDateChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnIssueDateChange();
+} */
+/*static void _OnIssueDateSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnIssueDateSetfocus();} */ 
+/*static void _OnIssueDateKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnIssueDateKillfocus();
+} */
+static int _OnIssueDateCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnIssueDateCheckValue();
+} 
+/*static void _OnStatusChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnStatusChange();
+} */
+/*static void _OnStatusSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnStatusSetfocus();} */ 
+/*static void _OnStatusKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+} */
+static int _OnStatusCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnStatusCheckValue();
+} 
+/*static void _OnNoteChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnNoteChange();
+} */
+/*static void _OnNoteSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnNoteSetfocus();} */ 
+/*static void _OnNoteKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnNoteKillfocus();
+} */
+static int _OnNoteCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnNoteCheckValue();
+} 
+static void _OnSendSelectFnc(CWnd *pWnd){
+	CCHMSDailyFoodOrder *pVw = (CCHMSDailyFoodOrder *)pWnd;
+	pVw->OnSendSelect();
+} 
+static void _OnPrintSelectFnc(CWnd *pWnd){
+	CCHMSDailyFoodOrder *pVw = (CCHMSDailyFoodOrder *)pWnd;
+	pVw->OnPrintSelect();
+} 
+/*static void _OnPatientNameChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnPatientNameChange();
+} */
+/*static void _OnPatientNameSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnPatientNameSetfocus();} */ 
+/*static void _OnPatientNameKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnPatientNameKillfocus();
+} */
+static int _OnPatientNameCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnPatientNameCheckValue();
+} 
+/*static void _OnDeptChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnDeptChange();
+} */
+/*static void _OnDeptSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnDeptSetfocus();} */ 
+/*static void _OnDeptKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnDeptKillfocus();
+} */
+static int _OnDeptCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnDeptCheckValue();
+} 
+static long _OnOrderListLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder*)pWnd)->OnOrderListLoadData();
+} 
+static void _OnOrderListDblClickFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder*)pWnd)->OnOrderListDblClick();
+} 
+static void _OnOrderListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CCHMSDailyFoodOrder*)pWnd)->OnOrderListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnOrderListDeleteItemFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnOrderListDeleteItem();
+} 
+static long _OnPatientListLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder*)pWnd)->OnPatientListLoadData();
+} 
+static void _OnPatientListDblClickFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder*)pWnd)->OnPatientListDblClick();
+} 
+static void _OnPatientListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CCHMSDailyFoodOrder*)pWnd)->OnPatientListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnPatientListDeleteItemFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnPatientListDeleteItem();
+} 
+static long _OnDrugListLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder*)pWnd)->OnDrugListLoadData();
+} 
+static void _OnDrugListDblClickFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder*)pWnd)->OnDrugListDblClick();
+} 
+static void _OnDrugListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CCHMSDailyFoodOrder*)pWnd)->OnDrugListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnDrugListDeleteItemFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnDrugListDeleteItem();
+} 
+/*static void _OnTypeChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTypeChange();
+} */
+/*static void _OnTypeSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTypeSetfocus();} */ 
+/*static void _OnTypeKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTypeKillfocus();
+} */
+static int _OnTypeCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnTypeCheckValue();
+} 
+/*static void _OnTotalCountChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTotalCountChange();
+} */
+/*static void _OnTotalCountSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTotalCountSetfocus();} */ 
+/*static void _OnTotalCountKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTotalCountKillfocus();
+} */
+static int _OnTotalCountCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnTotalCountCheckValue();
+} 
+static int _OnAddCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnAddCHMSDailyFoodOrder();
+} 
+static int _OnEditCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnEditCHMSDailyFoodOrder();
+} 
+static int _OnDeleteCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnDeleteCHMSDailyFoodOrder();
+} 
+static int _OnSaveCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnSaveCHMSDailyFoodOrder();
+} 
+static int _OnCancelCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnCancelCHMSDailyFoodOrder();
+} 
+CCHMSDailyFoodOrder::CCHMSDailyFoodOrder(){
+
+	m_nDlgWidth = 1029;
+	m_nDlgHeight = 635;
+	SetDefaultValues();
+}
+CCHMSDailyFoodOrder::~CCHMSDailyFoodOrder(){
+}
+void CCHMSDailyFoodOrder::OnCreateComponents(){
+	m_wndOrderInformation.Create(this, _T("Order Information"), 5, 5, 550, 180);
+	m_wndPatientInformation.Create(this, _T("Patient Information"), 555, 5, 1020, 410);
+	m_wndDrugInformation.Create(this, _T("Food Informations"), 555, 445, 1020, 625);
+	m_wndGroupListDrug.Create(this, _T("Food Type List"), 5, 185, 550, 625);
+	m_wndOrderNoLabel.Create(this, _T("Order ID"), 10, 30, 140, 55);
+	m_wndOrderNo.Create(this,145, 30, 275, 55); 
+	m_wndFind.Create(this, _T("&Find"), 825, 415, 925, 440);
+	m_wndOrderDateLabel.Create(this, _T("Order Date"), 10, 60, 140, 85);
+	m_wndOrderDate.Create(this,145, 60, 275, 85); 
+	m_wndIssueDateLabel.Create(this, _T("Issue Date"), 280, 60, 410, 85);
+	m_wndIssueDate.Create(this,415, 60, 545, 85); 
+	m_wndStatusLabel.Create(this, _T("Status"), 280, 30, 410, 55);
+	m_wndStatus.Create(this,415, 30, 545, 55); 
+	m_wndNoteLabel.Create(this, _T("Note"), 10, 90, 140, 115);
+	m_wndNote.Create(this,145, 90, 545, 115); 
+	m_wndSend.Create(this, _T("&Send"), 370, 150, 455, 175);
+	m_wndPrint.Create(this, _T("&Preview"), 460, 150, 545, 175);
+	m_wndPatientNameLabel.Create(this, _T("Patient Name"), 555, 415, 665, 440);
+	m_wndPatientName.Create(this,670, 415, 820, 440); 
+	m_wndDeptLabel.Create(this, _T("Dept"), 10, 120, 140, 145);
+	m_wndDept.Create(this,145, 120, 545, 145); 
+	m_wndOrderList.Create(this,10, 210, 545, 620); 
+	m_wndPatientList.Create(this,560, 30, 1015, 405); 
+	m_wndDrugList.Create(this,560, 470, 1015, 620); 
+	m_wndTypeLabel.Create(this, _T("Type"), 10, 149, 140, 174);
+	m_wndType.Create(this,145, 149, 360, 174); 
+	m_wndTotalCount.Create(this,935, 415, 1015, 440); 
+
+}
+void CCHMSDailyFoodOrder::OnInitializeComponents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	m_wndOrderNo.SetLimitText(1024);
+	m_wndOrderNo.SetCheckValue(true);
+	m_wndOrderDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndOrderDate.SetCheckValue(true);
+	m_wndIssueDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndIssueDate.SetCheckValue(true);
+	m_wndStatus.SetLimitText(1024);
+	m_wndStatus.SetCheckValue(true);
+	m_wndNote.SetLimitText(1024);
+	m_wndNote.SetCheckValue(true);
+	m_wndPatientName.SetLimitText(1024);
+	m_wndPatientName.SetCheckValue(true);
+	m_wndDept.SetLimitText(35);
+	m_wndDept.SetCheckValue(true);
+	m_wndType.SetLimitText(35);
+	m_wndType.SetCheckValue(true);
+	m_wndTotalCount.SetLimitText(16);
+	m_wndTotalCount.SetCheckValue(true);
+
+
+
+
+
+
+
+}
+void CCHMSDailyFoodOrder::OnSetWindowEvents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	//m_wndOrderNo.SetEvent(WE_CHANGE, _OnOrderNoChangeFnc);
+	//m_wndOrderNo.SetEvent(WE_SETFOCUS, _OnOrderNoSetfocusFnc);
+	//m_wndOrderNo.SetEvent(WE_KILLFOCUS, _OnOrderNoKillfocusFnc);
+	m_wndOrderNo.SetEvent(WE_CHECKVALUE, _OnOrderNoCheckValueFnc);
+	m_wndFind.SetEvent(WE_CLICK, _OnFindSelectFnc);
+	//m_wndOrderDate.SetEvent(WE_CHANGE, _OnOrderDateChangeFnc);
+	//m_wndOrderDate.SetEvent(WE_SETFOCUS, _OnOrderDateSetfocusFnc);
+	//m_wndOrderDate.SetEvent(WE_KILLFOCUS, _OnOrderDateKillfocusFnc);
+	m_wndOrderDate.SetEvent(WE_CHECKVALUE, _OnOrderDateCheckValueFnc);
+	//m_wndIssueDate.SetEvent(WE_CHANGE, _OnIssueDateChangeFnc);
+	//m_wndIssueDate.SetEvent(WE_SETFOCUS, _OnIssueDateSetfocusFnc);
+	//m_wndIssueDate.SetEvent(WE_KILLFOCUS, _OnIssueDateKillfocusFnc);
+	m_wndIssueDate.SetEvent(WE_CHECKVALUE, _OnIssueDateCheckValueFnc);
+	//m_wndStatus.SetEvent(WE_CHANGE, _OnStatusChangeFnc);
+	//m_wndStatus.SetEvent(WE_SETFOCUS, _OnStatusSetfocusFnc);
+	//m_wndStatus.SetEvent(WE_KILLFOCUS, _OnStatusKillfocusFnc);
+	m_wndStatus.SetEvent(WE_CHECKVALUE, _OnStatusCheckValueFnc);
+	//m_wndNote.SetEvent(WE_CHANGE, _OnNoteChangeFnc);
+	//m_wndNote.SetEvent(WE_SETFOCUS, _OnNoteSetfocusFnc);
+	//m_wndNote.SetEvent(WE_KILLFOCUS, _OnNoteKillfocusFnc);
+	m_wndNote.SetEvent(WE_CHECKVALUE, _OnNoteCheckValueFnc);
+	m_wndSend.SetEvent(WE_CLICK, _OnSendSelectFnc);
+	m_wndPrint.SetEvent(WE_CLICK, _OnPrintSelectFnc);
+	//m_wndPatientName.SetEvent(WE_CHANGE, _OnPatientNameChangeFnc);
+	//m_wndPatientName.SetEvent(WE_SETFOCUS, _OnPatientNameSetfocusFnc);
+	//m_wndPatientName.SetEvent(WE_KILLFOCUS, _OnPatientNameKillfocusFnc);
+	m_wndPatientName.SetEvent(WE_CHECKVALUE, _OnPatientNameCheckValueFnc);
+	//m_wndDept.SetEvent(WE_CHANGE, _OnDeptChangeFnc);
+	//m_wndDept.SetEvent(WE_SETFOCUS, _OnDeptSetfocusFnc);
+	//m_wndDept.SetEvent(WE_KILLFOCUS, _OnDeptKillfocusFnc);
+	m_wndDept.SetEvent(WE_CHECKVALUE, _OnDeptCheckValueFnc);
+	m_wndOrderList.SetEvent(WE_SELCHANGE, _OnOrderListSelectChangeFnc);
+	m_wndOrderList.SetEvent(WE_LOADDATA, _OnOrderListLoadDataFnc);
+	m_wndOrderList.SetEvent(WE_DBLCLICK, _OnOrderListDblClickFnc);
+	m_wndOrderList.AddEvent(1, _T("Delete"), _OnOrderListDeleteItemFnc, 0, VK_DELETE, 0);
+	m_wndPatientList.SetEvent(WE_SELCHANGE, _OnPatientListSelectChangeFnc);
+	m_wndPatientList.SetEvent(WE_LOADDATA, _OnPatientListLoadDataFnc);
+	m_wndPatientList.SetEvent(WE_DBLCLICK, _OnPatientListDblClickFnc);
+	m_wndPatientList.AddEvent(1, _T("Delete"), _OnPatientListDeleteItemFnc, 0, VK_DELETE, 0);
+	m_wndDrugList.SetEvent(WE_SELCHANGE, _OnDrugListSelectChangeFnc);
+	m_wndDrugList.SetEvent(WE_LOADDATA, _OnDrugListLoadDataFnc);
+	m_wndDrugList.SetEvent(WE_DBLCLICK, _OnDrugListDblClickFnc);
+	m_wndDrugList.AddEvent(1, _T("Delete"), _OnDrugListDeleteItemFnc, 0, VK_DELETE, 0);
+	//m_wndType.SetEvent(WE_CHANGE, _OnTypeChangeFnc);
+	//m_wndType.SetEvent(WE_SETFOCUS, _OnTypeSetfocusFnc);
+	//m_wndType.SetEvent(WE_KILLFOCUS, _OnTypeKillfocusFnc);
+	m_wndType.SetEvent(WE_CHECKVALUE, _OnTypeCheckValueFnc);
+	//m_wndTotalCount.SetEvent(WE_CHANGE, _OnTotalCountChangeFnc);
+	//m_wndTotalCount.SetEvent(WE_SETFOCUS, _OnTotalCountSetfocusFnc);
+	//m_wndTotalCount.SetEvent(WE_KILLFOCUS, _OnTotalCountKillfocusFnc);
+	m_wndTotalCount.SetEvent(WE_CHECKVALUE, _OnTotalCountCheckValueFnc);
+	AddEvent(1, _T("Add	Ctrl+A"), _OnAddCHMSDailyFoodOrderFnc, 0, 'A', VK_CONTROL);
+	AddEvent(2, _T("Edit	Ctrl+E"), _OnEditCHMSDailyFoodOrderFnc, 0, 'E', VK_CONTROL);
+	AddEvent(3, _T("Delete	Ctrl+D"), _OnDeleteCHMSDailyFoodOrderFnc, 0, 'D', VK_CONTROL);
+	AddEvent(4, _T("Save	Ctrl+S"), _OnSaveCHMSDailyFoodOrderFnc, 0, 'S', VK_CONTROL);
+	AddEvent(0, _T("-"));
+	AddEvent(5, _T("Cancel	Ctrl+T"), _OnCancelCHMSDailyFoodOrderFnc, 0, 'T', VK_CONTROL);
+	SetMode(VM_NONE);
+
+}
+void CCHMSDailyFoodOrder::OnDoDataExchange(CDataExchange* pDX){
+	DDX_Text(pDX, m_wndOrderNo.GetDlgCtrlID(), m_szOrderNo);
+	DDX_TextEx(pDX, m_wndOrderDate.GetDlgCtrlID(), m_szOrderDate);
+	DDX_TextEx(pDX, m_wndIssueDate.GetDlgCtrlID(), m_szIssueDate);
+	DDX_Text(pDX, m_wndStatus.GetDlgCtrlID(), m_szStatus);
+	DDX_Text(pDX, m_wndNote.GetDlgCtrlID(), m_szNote);
+	DDX_Text(pDX, m_wndPatientName.GetDlgCtrlID(), m_szPatientName);
+	DDX_Text(pDX, m_wndDept.GetDlgCtrlID(), m_szDept);
+	DDX_Text(pDX, m_wndType.GetDlgCtrlID(), m_szType);
+	DDX_Text(pDX, m_wndTotalCount.GetDlgCtrlID(), m_nTotalCount);
+
+}
+void CCHMSDailyFoodOrder::GetDataToScreen(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT * FROM "));
+	rs.ExecSQL(szSQL);
+
+}
+void CCHMSDailyFoodOrder::GetScreenToData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+
+}
+void CCHMSDailyFoodOrder::SetDefaultValues(){
+
+	m_szOrderNo.Empty();
+	m_szOrderDate.Empty();
+	m_szIssueDate.Empty();
+	m_szStatus.Empty();
+	m_szNote.Empty();
+	m_szPatientName.Empty();
+	m_szDept.Empty();
+	m_szType.Empty();
+	m_nTotalCount=0;
+
+}
+int CCHMSDailyFoodOrder::SetMode(int nMode){
+ 		int nOldMode = GetMode();
+ 		CGuiView::SetMode(nMode);
+ 		CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 		CString szSQL;
+ 		CRecord rs(&pMF->m_db);
+  		switch(nMode){
+ 		case VM_ADD: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		case VM_EDIT: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			break;
+ 		case VM_VIEW: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(FALSE, 3, 4, -1);
+ 			break;
+ 		case VM_NONE: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(TRUE, 0, 6, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		};
+ 		UpdateData(FALSE);
+ 		return nOldMode;
+}
+/*void CCHMSDailyFoodOrder::OnOrderNoChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnOrderNoSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnOrderNoKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnOrderNoCheckValue(){
+	return 0;
+} 
+void CCHMSDailyFoodOrder::OnFindSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+/*void CCHMSDailyFoodOrder::OnOrderDateChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnOrderDateSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnOrderDateKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnOrderDateCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnIssueDateChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnIssueDateSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnIssueDateKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnIssueDateCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnStatusChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnStatusSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnStatusKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnStatusCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnNoteChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnNoteSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnNoteKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnNoteCheckValue(){
+	return 0;
+} 
+void CCHMSDailyFoodOrder::OnSendSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSDailyFoodOrder::OnPrintSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+/*void CCHMSDailyFoodOrder::OnPatientNameChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnPatientNameSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnPatientNameKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnPatientNameCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnDeptChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnDeptSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnDeptKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnDeptCheckValue(){
+	return 0;
+} 
+void CCHMSDailyFoodOrder::OnOrderListDblClick(){
+	
+} 
+void CCHMSDailyFoodOrder::OnOrderListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CCHMSDailyFoodOrder::OnOrderListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CCHMSDailyFoodOrder::OnOrderListLoadData(){
+/*
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	m_wndOrderList.BeginLoad(); 
+	int nCount = 0;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndOrderList.AddItems(
+		rs.MoveNext();
+	}
+	m_wndOrderList.EndLoad(); 
+	return nCount;
+*/
+	return 0;
+}
+void CCHMSDailyFoodOrder::OnPatientListDblClick(){
+	
+} 
+void CCHMSDailyFoodOrder::OnPatientListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CCHMSDailyFoodOrder::OnPatientListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CCHMSDailyFoodOrder::OnPatientListLoadData(){
+/*
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	m_wndPatientList.BeginLoad(); 
+	int nCount = 0;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndPatientList.AddItems(
+		rs.MoveNext();
+	}
+	m_wndPatientList.EndLoad(); 
+	return nCount;
+*/
+	return 0;
+}
+void CCHMSDailyFoodOrder::OnDrugListDblClick(){
+	
+} 
+void CCHMSDailyFoodOrder::OnDrugListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CCHMSDailyFoodOrder::OnDrugListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CCHMSDailyFoodOrder::OnDrugListLoadData(){
+/*
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	m_wndDrugList.BeginLoad(); 
+	int nCount = 0;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndDrugList.AddItems(
+		rs.MoveNext();
+	}
+	m_wndDrugList.EndLoad(); 
+	return nCount;
+*/
+	return 0;
+}
+/*void CCHMSDailyFoodOrder::OnTypeChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnTypeSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnTypeKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnTypeCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnTotalCountChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnTotalCountSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnTotalCountKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnTotalCountCheckValue(){
+	return 0;
+} 
+int CCHMSDailyFoodOrder::OnAddCHMSDailyFoodOrder(){
+ 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_ADD);
+	return 0;
+}
+int CCHMSDailyFoodOrder::OnEditCHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_EDIT);
+	return 0;  
+}
+int CCHMSDailyFoodOrder::OnDeleteCHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO)
+ 		return -1;
+ 	szSQL.Format(_T("DELETE FROM  WHERE  AND") );
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret >= 0){
+ 		SetMode(VM_NONE);
+ 		OnCancelCHMSDailyFoodOrder();
+ 	}
+	return 0;
+}
+int CCHMSDailyFoodOrder::OnSaveCHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT)
+ 		return -1;
+ 	if(!IsValidateData())
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(GetMode() == VM_ADD){
+ 		//szSQL = m_tblTbl.GetInsertSQL();
+ 	}
+ 	else if(GetMode() == VM_EDIT){
+ 		CString szWhere;
+ 		szWhere.Format(_T(" WHERE"));
+ 		//szSQL = m_tblTbl.GetUpdateSQL(_T("createdby,createddate"));
+ 		szSQL += szWhere;
+ 	}
+ _fmsg(_T("%s"), szSQL);
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret > 0)
+ 	{
+ 		//OnCHMSDailyFoodOrderListLoadData();
+ 		SetMode(VM_VIEW);
+ 	}
+ 	else
+ 	{
+ 	}
+ 	return ret;
+ 	return 0;
+}
+int CCHMSDailyFoodOrder::OnCancelCHMSDailyFoodOrder(){
+ 	if(GetMode() == VM_EDIT)
+ 	{
+ 		SetMode(VM_VIEW);
+ 	} 
+ 	else 
+ 	{
+ 		SetMode(VM_NONE);
+ 	} 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	return 0;
+} 
+int CCHMSDailyFoodOrder::OnCHMSDailyFoodOrderListLoadData(){
+	return 0;
+}
Index: Resx/CHMSDailyFoodOrder.h
===================================================================
--- Resx/CHMSDailyFoodOrder.h	(revision 0)
+++ Resx/CHMSDailyFoodOrder.h	(working copy)
@@ -0,0 +1,137 @@
+#ifndef CHMSDAILYFOODORDER_H
+#define CHMSDAILYFOODORDER_H
+
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Copyright  Viet Nam Medical Software Joint Stock Company. 2005-2012. 			
+//	All rights reserved. 
+//	This program is protected by Viet nam and international treaties.  
+//	Unauthorized reproduction or distribution of this program, 
+//	or any portion of it, may result in severe civil and criminal penalties, 
+//	and will be prosecuted to the maximum extent possible under the law.
+//	This file is a part of the GUI(Graphical User Interface) class library.
+//	(c) 2006-2008 Hoang Van Hay, All rights reserved.
+//	CONTACT INFORMATION:
+//	Email  : hayhv@vimes.com.vn or hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+/////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Ban quyen cua Cong Ty Co Phan Phan Mem Y Te Viet Nam 2005-2012.
+//	Do Cuc Ban Quyen, Bo VHTT nuoc Cong hoa xa hoi chu nghia Viet Nam cap.
+//	Chuong trinh phan mem nay duoc Luat phap Viet Nam va quoc te bao ho.
+//	San xuat, su dung hoac phan phoi trai phep toan bo hoac mot phan cua phan men nay se
+//	chiu cac hinh phat va hinh su hoac dan su, co the len den muc toi da dung theo Luat qui dinh.
+//	File nay la mot phan cua thu vien lap trinh(GUI). Ban quyen cua Hoang Van Hay. 2006-2008
+//	THONG TIN LIEN HE:
+//	Email  : hayhv@vimes.com.vn hoac hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+#include "GuiUtils.h"
+#include "GuiView.h"
+#include "DbField.h"
+class CCHMSDailyFoodOrder : public CGuiView{
+protected:
+public:
+	CGuiGroupBox	m_wndOrderInformation;
+	CGuiGroupBox	m_wndPatientInformation;
+	CGuiGroupBox	m_wndDrugInformation;
+	CGuiGroupBox	m_wndGroupListDrug;
+	CGuiLabel		m_wndOrderNoLabel;
+	CGuiTextCtrl	m_wndOrderNo;
+	CGuiButton		m_wndFind;
+	CGuiLabel		m_wndOrderDateLabel;
+	CGuiDateCtrl	m_wndOrderDate;
+	CGuiLabel		m_wndIssueDateLabel;
+	CGuiDateCtrl	m_wndIssueDate;
+	CGuiLabel		m_wndStatusLabel;
+	CGuiTextCtrl	m_wndStatus;
+	CGuiLabel		m_wndNoteLabel;
+	CGuiTextCtrl	m_wndNote;
+	CGuiButton		m_wndSend;
+	CGuiButton		m_wndPrint;
+	CGuiLabel		m_wndPatientNameLabel;
+	CGuiTextCtrl	m_wndPatientName;
+	CGuiLabel		m_wndDeptLabel;
+	CGuiTextCtrl	m_wndDept;
+	CGuiListCtrl	m_wndOrderList;
+	CGuiListCtrl	m_wndPatientList;
+	CGuiListCtrl	m_wndDrugList;
+	CGuiLabel		m_wndTypeLabel;
+	CGuiTextCtrl	m_wndType;
+	CGuiNumberCtrl	m_wndTotalCount;
+	CString	m_szOrderNo;
+	CString	m_szOrderDate;
+	CString	m_szIssueDate;
+	CString	m_szStatus;
+	CString	m_szNote;
+	CString	m_szPatientName;
+	CString	m_szDept;
+	CString	m_szType;
+	long	m_nTotalCount;
+	//void			OnOrderNoChange(); 
+	//void			OnOrderNoSetfocus(); 
+	//void			OnOrderNoKillfocus(); 
+	int			OnOrderNoCheckValue(); 
+	void			OnFindSelect(); 
+	//void			OnOrderDateChange(); 
+	//void			OnOrderDateSetfocus(); 
+	//void			OnOrderDateKillfocus(); 
+	int			OnOrderDateCheckValue(); 
+	//void			OnIssueDateChange(); 
+	//void			OnIssueDateSetfocus(); 
+	//void			OnIssueDateKillfocus(); 
+	int			OnIssueDateCheckValue(); 
+	//void			OnStatusChange(); 
+	//void			OnStatusSetfocus(); 
+	//void			OnStatusKillfocus(); 
+	int			OnStatusCheckValue(); 
+	//void			OnNoteChange(); 
+	//void			OnNoteSetfocus(); 
+	//void			OnNoteKillfocus(); 
+	int			OnNoteCheckValue(); 
+	void			OnSendSelect(); 
+	void			OnPrintSelect(); 
+	//void			OnPatientNameChange(); 
+	//void			OnPatientNameSetfocus(); 
+	//void			OnPatientNameKillfocus(); 
+	int			OnPatientNameCheckValue(); 
+	//void			OnDeptChange(); 
+	//void			OnDeptSetfocus(); 
+	//void			OnDeptKillfocus(); 
+	int			OnDeptCheckValue(); 
+	long			OnOrderListLoadData(); 
+	void			OnOrderListSelectChange(int nOldItem, int nNewItem); 
+	void			OnOrderListDblClick(); 
+	int			OnOrderListDeleteItem(); 
+	long			OnPatientListLoadData(); 
+	void			OnPatientListSelectChange(int nOldItem, int nNewItem); 
+	void			OnPatientListDblClick(); 
+	int			OnPatientListDeleteItem(); 
+	long			OnDrugListLoadData(); 
+	void			OnDrugListSelectChange(int nOldItem, int nNewItem); 
+	void			OnDrugListDblClick(); 
+	int			OnDrugListDeleteItem(); 
+	//void			OnTypeChange(); 
+	//void			OnTypeSetfocus(); 
+	//void			OnTypeKillfocus(); 
+	int			OnTypeCheckValue(); 
+	//void			OnTotalCountChange(); 
+	//void			OnTotalCountSetfocus(); 
+	//void			OnTotalCountKillfocus(); 
+	int			OnTotalCountCheckValue(); 
+	CCHMSDailyFoodOrder();
+	~CCHMSDailyFoodOrder();
+	void OnCreateComponents();
+	void OnInitializeComponents();
+	void OnSetWindowEvents();
+	void OnDoDataExchange(CDataExchange* pDX);
+	void GetDataToScreen();
+	void GetScreenToData();
+	void SetDefaultValues();
+	int SetMode(int nMode);
+	int OnAddCHMSDailyFoodOrder(); 
+	int OnEditCHMSDailyFoodOrder(); 
+	int OnDeleteCHMSDailyFoodOrder(); 
+	int OnSaveCHMSDailyFoodOrder(); 
+	int OnCancelCHMSDailyFoodOrder(); 
+	int OnCHMSDailyFoodOrderListLoadData(); 
+};
+#endif
Index: Resx/CHMSDailyFoodOrder.resx
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: Resx/CHMSDailyFoodOrder.resx
===================================================================
--- Resx/CHMSDailyFoodOrder.resx	(revision 0)
+++ Resx/CHMSDailyFoodOrder.resx	(working copy)

Property changes on: Resx/CHMSDailyFoodOrder.resx
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: Resx/CHMSSummaryDailyFoodOrder.cpp
===================================================================
--- Resx/CHMSSummaryDailyFoodOrder.cpp	(revision 0)
+++ Resx/CHMSSummaryDailyFoodOrder.cpp	(working copy)
@@ -0,0 +1,441 @@
+#include "CHMSSummaryDailyFoodOrder.h"
+#include "MainFrm.h"
+/*static void _OnOrderDateChangeFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnOrderDateChange();
+} */
+/*static void _OnOrderDateSetfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnOrderDateSetfocus();} */ 
+/*static void _OnOrderDateKillfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnOrderDateKillfocus();
+} */
+static int _OnOrderDateCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder *)pWnd)->OnOrderDateCheckValue();
+} 
+/*static void _OnIssueDateChangeFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnIssueDateChange();
+} */
+/*static void _OnIssueDateSetfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnIssueDateSetfocus();} */ 
+/*static void _OnIssueDateKillfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnIssueDateKillfocus();
+} */
+static int _OnIssueDateCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder *)pWnd)->OnIssueDateCheckValue();
+} 
+static void _OnStatusSelectChangeFnc(CWnd *pWnd, int nOldItemSel, int nNewItemSel){
+	((CCHMSSummaryDailyFoodOrder* )pWnd)->OnStatusSelectChange(nOldItemSel, nNewItemSel);
+} 
+static void _OnStatusSelendokFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusSelendok();
+}
+/*static void _OnStatusSetfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+}*/
+/*static void _OnStatusKillfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+}*/
+static long _OnStatusLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusLoadData();
+}
+/*static void _OnStatusAddNewFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusAddNew();
+}*/
+static void _OnPrintSelectFnc(CWnd *pWnd){
+	CCHMSSummaryDailyFoodOrder *pVw = (CCHMSSummaryDailyFoodOrder *)pWnd;
+	pVw->OnPrintSelect();
+} 
+static long _OnOrderListLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListLoadData();
+} 
+static void _OnOrderListDblClickFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListDblClick();
+} 
+static void _OnOrderListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CCHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnOrderListDeleteItemFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListDeleteItem();
+} 
+static void _OnRefreshSelectFnc(CWnd *pWnd){
+	CCHMSSummaryDailyFoodOrder *pVw = (CCHMSSummaryDailyFoodOrder *)pWnd;
+	pVw->OnRefreshSelect();
+} 
+static void _OnFoodTypeSelectChangeFnc(CWnd *pWnd, int nOldItemSel, int nNewItemSel){
+	((CCHMSSummaryDailyFoodOrder* )pWnd)->OnFoodTypeSelectChange(nOldItemSel, nNewItemSel);
+} 
+static void _OnFoodTypeSelendokFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeSelendok();
+}
+/*static void _OnFoodTypeSetfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeKillfocus();
+}*/
+/*static void _OnFoodTypeKillfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeKillfocus();
+}*/
+static long _OnFoodTypeLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeLoadData();
+}
+/*static void _OnFoodTypeAddNewFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeAddNew();
+}*/
+static int _OnAddCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnAddCHMSSummaryDailyFoodOrder();
+} 
+static int _OnEditCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnEditCHMSSummaryDailyFoodOrder();
+} 
+static int _OnDeleteCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnDeleteCHMSSummaryDailyFoodOrder();
+} 
+static int _OnSaveCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnSaveCHMSSummaryDailyFoodOrder();
+} 
+static int _OnCancelCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnCancelCHMSSummaryDailyFoodOrder();
+} 
+CCHMSSummaryDailyFoodOrder::CCHMSSummaryDailyFoodOrder(){
+
+	m_nDlgWidth = 1029;
+	m_nDlgHeight = 635;
+	SetDefaultValues();
+}
+CCHMSSummaryDailyFoodOrder::~CCHMSSummaryDailyFoodOrder(){
+}
+void CCHMSSummaryDailyFoodOrder::OnCreateComponents(){
+	m_wndOrderInformation.Create(this, _T("Order Information"), 5, 5, 1020, 60);
+	m_wndGroupListDrug.Create(this, _T("Food Type List"), 5, 65, 1020, 625);
+	m_wndOrderDateLabel.Create(this, _T("Order Date"), 10, 30, 100, 55);
+	m_wndOrderDate.Create(this,105, 30, 195, 55); 
+	m_wndIssueDateLabel.Create(this, _T("Issue Date"), 200, 30, 290, 55);
+	m_wndIssueDate.Create(this,295, 30, 385, 55); 
+	m_wndStatusLabel.Create(this, _T("Status"), 390, 30, 480, 55);
+	m_wndStatus.Create(this,485, 30, 625, 55); 
+	m_wndPrint.Create(this, _T("&Preview"), 930, 30, 1015, 55);
+	m_wndOrderList.Create(this,10, 90, 1015, 620); 
+	m_wndRefresh.Create(this, _T("Refresh"), 845, 30, 925, 55);
+	m_wndFoodTypeLabel.Create(this, _T("Food Type"), 630, 30, 710, 55);
+	m_wndFoodType.Create(this,715, 30, 840, 55); 
+
+}
+void CCHMSSummaryDailyFoodOrder::OnInitializeComponents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	m_wndOrderDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndOrderDate.SetCheckValue(true);
+	m_wndIssueDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndIssueDate.SetCheckValue(true);
+	m_wndStatus.SetCheckValue(true);
+	m_wndStatus.LimitText(1024);
+	m_wndFoodType.SetCheckValue(true);
+	m_wndFoodType.LimitText(35);
+
+
+
+
+
+
+	m_wndFoodType.InsertColumn(0, _T("ID"), CFMT_TEXT, 50);
+	m_wndFoodType.InsertColumn(1, _T("Name"), CFMT_TEXT, 150);
+
+}
+void CCHMSSummaryDailyFoodOrder::OnSetWindowEvents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	//m_wndOrderDate.SetEvent(WE_CHANGE, _OnOrderDateChangeFnc);
+	//m_wndOrderDate.SetEvent(WE_SETFOCUS, _OnOrderDateSetfocusFnc);
+	//m_wndOrderDate.SetEvent(WE_KILLFOCUS, _OnOrderDateKillfocusFnc);
+	m_wndOrderDate.SetEvent(WE_CHECKVALUE, _OnOrderDateCheckValueFnc);
+	//m_wndIssueDate.SetEvent(WE_CHANGE, _OnIssueDateChangeFnc);
+	//m_wndIssueDate.SetEvent(WE_SETFOCUS, _OnIssueDateSetfocusFnc);
+	//m_wndIssueDate.SetEvent(WE_KILLFOCUS, _OnIssueDateKillfocusFnc);
+	m_wndIssueDate.SetEvent(WE_CHECKVALUE, _OnIssueDateCheckValueFnc);
+	m_wndStatus.SetEvent(WE_SELENDOK, _OnStatusSelendokFnc);
+	//m_wndStatus.SetEvent(WE_SETFOCUS, _OnStatusSetfocusFnc);
+	//m_wndStatus.SetEvent(WE_KILLFOCUS, _OnStatusKillfocusFnc);
+	m_wndStatus.SetEvent(WE_SELCHANGE, _OnStatusSelectChangeFnc);
+	m_wndStatus.SetEvent(WE_LOADDATA, _OnStatusLoadDataFnc);
+	//m_wndStatus.SetEvent(WE_ADDNEW, _OnStatusAddNewFnc);
+	m_wndPrint.SetEvent(WE_CLICK, _OnPrintSelectFnc);
+	m_wndOrderList.SetEvent(WE_SELCHANGE, _OnOrderListSelectChangeFnc);
+	m_wndOrderList.SetEvent(WE_LOADDATA, _OnOrderListLoadDataFnc);
+	m_wndOrderList.SetEvent(WE_DBLCLICK, _OnOrderListDblClickFnc);
+	m_wndOrderList.AddEvent(1, _T("Delete"), _OnOrderListDeleteItemFnc, 0, VK_DELETE, 0);
+	m_wndRefresh.SetEvent(WE_CLICK, _OnRefreshSelectFnc);
+	m_wndFoodType.SetEvent(WE_SELENDOK, _OnFoodTypeSelendokFnc);
+	//m_wndFoodType.SetEvent(WE_SETFOCUS, _OnFoodTypeSetfocusFnc);
+	//m_wndFoodType.SetEvent(WE_KILLFOCUS, _OnFoodTypeKillfocusFnc);
+	m_wndFoodType.SetEvent(WE_SELCHANGE, _OnFoodTypeSelectChangeFnc);
+	m_wndFoodType.SetEvent(WE_LOADDATA, _OnFoodTypeLoadDataFnc);
+	//m_wndFoodType.SetEvent(WE_ADDNEW, _OnFoodTypeAddNewFnc);
+	AddEvent(1, _T("Add	Ctrl+A"), _OnAddCHMSSummaryDailyFoodOrderFnc, 0, 'A', VK_CONTROL);
+	AddEvent(2, _T("Edit	Ctrl+E"), _OnEditCHMSSummaryDailyFoodOrderFnc, 0, 'E', VK_CONTROL);
+	AddEvent(3, _T("Delete	Ctrl+D"), _OnDeleteCHMSSummaryDailyFoodOrderFnc, 0, 'D', VK_CONTROL);
+	AddEvent(4, _T("Save	Ctrl+S"), _OnSaveCHMSSummaryDailyFoodOrderFnc, 0, 'S', VK_CONTROL);
+	AddEvent(0, _T("-"));
+	AddEvent(5, _T("Cancel	Ctrl+T"), _OnCancelCHMSSummaryDailyFoodOrderFnc, 0, 'T', VK_CONTROL);
+	SetMode(VM_NONE);
+
+}
+void CCHMSSummaryDailyFoodOrder::OnDoDataExchange(CDataExchange* pDX){
+	DDX_TextEx(pDX, m_wndOrderDate.GetDlgCtrlID(), m_szOrderDate);
+	DDX_TextEx(pDX, m_wndIssueDate.GetDlgCtrlID(), m_szIssueDate);
+	DDX_TextEx(pDX, m_wndStatus.GetDlgCtrlID(), m_szStatusKey);
+	DDX_TextEx(pDX, m_wndFoodType.GetDlgCtrlID(), m_szFoodTypeKey);
+
+}
+void CCHMSSummaryDailyFoodOrder::GetDataToScreen(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT * FROM "));
+	rs.ExecSQL(szSQL);
+
+}
+void CCHMSSummaryDailyFoodOrder::GetScreenToData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+
+}
+void CCHMSSummaryDailyFoodOrder::SetDefaultValues(){
+
+	m_szOrderDate.Empty();
+	m_szIssueDate.Empty();
+	m_szStatusKey.Empty();
+	m_szFoodTypeKey.Empty();
+
+}
+int CCHMSSummaryDailyFoodOrder::SetMode(int nMode){
+ 		int nOldMode = GetMode();
+ 		CGuiView::SetMode(nMode);
+ 		CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 		CString szSQL;
+ 		CRecord rs(&pMF->m_db);
+  		switch(nMode){
+ 		case VM_ADD: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		case VM_EDIT: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			break;
+ 		case VM_VIEW: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(FALSE, 3, 4, -1);
+ 			break;
+ 		case VM_NONE: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(TRUE, 0, 6, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		};
+ 		UpdateData(FALSE);
+ 		return nOldMode;
+}
+/*void CCHMSSummaryDailyFoodOrder::OnOrderDateChange(){
+	
+} */
+/*void CCHMSSummaryDailyFoodOrder::OnOrderDateSetfocus(){
+	
+} */
+/*void CCHMSSummaryDailyFoodOrder::OnOrderDateKillfocus(){
+	
+} */
+int CCHMSSummaryDailyFoodOrder::OnOrderDateCheckValue(){
+	return 0;
+} 
+/*void CCHMSSummaryDailyFoodOrder::OnIssueDateChange(){
+	
+} */
+/*void CCHMSSummaryDailyFoodOrder::OnIssueDateSetfocus(){
+	
+} */
+/*void CCHMSSummaryDailyFoodOrder::OnIssueDateKillfocus(){
+	
+} */
+int CCHMSSummaryDailyFoodOrder::OnIssueDateCheckValue(){
+	return 0;
+} 
+void CCHMSSummaryDailyFoodOrder::OnStatusSelectChange(int nOldItemSel, int nNewItemSel){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnStatusSelendok(){
+	 
+}
+/*void CCHMSSummaryDailyFoodOrder::OnStatusSetfocus(){
+	
+}*/
+/*void CCHMSSummaryDailyFoodOrder::OnStatusKillfocus(){
+	
+}*/
+long CCHMSSummaryDailyFoodOrder::OnStatusLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+/*
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szWhere;
+	if(m_wndStatus.IsSearchKey() && !m_szStatusKey.IsEmpty()){
+	 szWhere.Format(_T(" and id='%s' "), m_szStatusKey
+};
+	m_wndStatus.DeleteAllItems(); 
+	int nCount = 0;
+	szSQL.Format(_T("SELECT fld1 as id, fld2 as name FROM tbl WHERE 1=1 %s ORDER BY id "), szWhere
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndStatus.AddItems(
+		rs.MoveNext();
+	}
+	return nCount;
+*/
+	return 0;
+}
+/*void CCHMSSummaryDailyFoodOrder::OnStatusAddNew(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} */
+void CCHMSSummaryDailyFoodOrder::OnPrintSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnOrderListDblClick(){
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnOrderListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CCHMSSummaryDailyFoodOrder::OnOrderListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CCHMSSummaryDailyFoodOrder::OnOrderListLoadData(){
+/*
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	m_wndOrderList.BeginLoad(); 
+	int nCount = 0;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndOrderList.AddItems(
+		rs.MoveNext();
+	}
+	m_wndOrderList.EndLoad(); 
+	return nCount;
+*/
+	return 0;
+}
+void CCHMSSummaryDailyFoodOrder::OnRefreshSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnFoodTypeSelectChange(int nOldItemSel, int nNewItemSel){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnFoodTypeSelendok(){
+	 
+}
+/*void CCHMSSummaryDailyFoodOrder::OnFoodTypeSetfocus(){
+	
+}*/
+/*void CCHMSSummaryDailyFoodOrder::OnFoodTypeKillfocus(){
+	
+}*/
+long CCHMSSummaryDailyFoodOrder::OnFoodTypeLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+/*
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szWhere;
+	if(m_wndFoodType.IsSearchKey() && !m_szFoodTypeKey.IsEmpty()){
+	 szWhere.Format(_T(" and id='%s' "), m_szFoodTypeKey
+};
+	m_wndFoodType.DeleteAllItems(); 
+	int nCount = 0;
+	szSQL.Format(_T("SELECT fld1 as id, fld2 as name FROM tbl WHERE 1=1 %s ORDER BY id "), szWhere
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndFoodType.AddItems(
+			rs.GetValue(_T("id")), 
+			rs.GetValue(_T("name")), NULL);
+		rs.MoveNext();
+	}
+	return nCount;
+*/
+	return 0;
+}
+/*void CCHMSSummaryDailyFoodOrder::OnFoodTypeAddNew(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} */
+int CCHMSSummaryDailyFoodOrder::OnAddCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_ADD);
+	return 0;
+}
+int CCHMSSummaryDailyFoodOrder::OnEditCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_EDIT);
+	return 0;  
+}
+int CCHMSSummaryDailyFoodOrder::OnDeleteCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO)
+ 		return -1;
+ 	szSQL.Format(_T("DELETE FROM  WHERE  AND") );
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret >= 0){
+ 		SetMode(VM_NONE);
+ 		OnCancelCHMSSummaryDailyFoodOrder();
+ 	}
+	return 0;
+}
+int CCHMSSummaryDailyFoodOrder::OnSaveCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT)
+ 		return -1;
+ 	if(!IsValidateData())
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(GetMode() == VM_ADD){
+ 		//szSQL = m_tblTbl.GetInsertSQL();
+ 	}
+ 	else if(GetMode() == VM_EDIT){
+ 		CString szWhere;
+ 		szWhere.Format(_T(" WHERE"));
+ 		//szSQL = m_tblTbl.GetUpdateSQL(_T("createdby,createddate"));
+ 		szSQL += szWhere;
+ 	}
+ _fmsg(_T("%s"), szSQL);
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret > 0)
+ 	{
+ 		//OnCHMSSummaryDailyFoodOrderListLoadData();
+ 		SetMode(VM_VIEW);
+ 	}
+ 	else
+ 	{
+ 	}
+ 	return ret;
+ 	return 0;
+}
+int CCHMSSummaryDailyFoodOrder::OnCancelCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() == VM_EDIT)
+ 	{
+ 		SetMode(VM_VIEW);
+ 	} 
+ 	else 
+ 	{
+ 		SetMode(VM_NONE);
+ 	} 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	return 0;
+} 
+int CCHMSSummaryDailyFoodOrder::OnCHMSSummaryDailyFoodOrderListLoadData(){
+	return 0;
+}
Index: Resx/CHMSSummaryDailyFoodOrder.h
===================================================================
--- Resx/CHMSSummaryDailyFoodOrder.h	(revision 0)
+++ Resx/CHMSSummaryDailyFoodOrder.h	(working copy)
@@ -0,0 +1,93 @@
+#ifndef CHMSSUMMARYDAILYFOODORDER_H
+#define CHMSSUMMARYDAILYFOODORDER_H
+
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Copyright  Viet Nam Medical Software Joint Stock Company. 2005-2012. 			
+//	All rights reserved. 
+//	This program is protected by Viet nam and international treaties.  
+//	Unauthorized reproduction or distribution of this program, 
+//	or any portion of it, may result in severe civil and criminal penalties, 
+//	and will be prosecuted to the maximum extent possible under the law.
+//	This file is a part of the GUI(Graphical User Interface) class library.
+//	(c) 2006-2008 Hoang Van Hay, All rights reserved.
+//	CONTACT INFORMATION:
+//	Email  : hayhv@vimes.com.vn or hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+/////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Ban quyen cua Cong Ty Co Phan Phan Mem Y Te Viet Nam 2005-2012.
+//	Do Cuc Ban Quyen, Bo VHTT nuoc Cong hoa xa hoi chu nghia Viet Nam cap.
+//	Chuong trinh phan mem nay duoc Luat phap Viet Nam va quoc te bao ho.
+//	San xuat, su dung hoac phan phoi trai phep toan bo hoac mot phan cua phan men nay se
+//	chiu cac hinh phat va hinh su hoac dan su, co the len den muc toi da dung theo Luat qui dinh.
+//	File nay la mot phan cua thu vien lap trinh(GUI). Ban quyen cua Hoang Van Hay. 2006-2008
+//	THONG TIN LIEN HE:
+//	Email  : hayhv@vimes.com.vn hoac hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+#include "GuiUtils.h"
+#include "GuiView.h"
+#include "DbField.h"
+class CCHMSSummaryDailyFoodOrder : public CGuiView{
+protected:
+public:
+	CGuiGroupBox	m_wndOrderInformation;
+	CGuiGroupBox	m_wndGroupListDrug;
+	CGuiLabel		m_wndOrderDateLabel;
+	CGuiDateCtrl	m_wndOrderDate;
+	CGuiLabel		m_wndIssueDateLabel;
+	CGuiDateCtrl	m_wndIssueDate;
+	CGuiLabel		m_wndStatusLabel;
+	CGuiComboBox	m_wndStatus;
+	CGuiButton		m_wndPrint;
+	CGuiListCtrl	m_wndOrderList;
+	CGuiButton		m_wndRefresh;
+	CGuiLabel		m_wndFoodTypeLabel;
+	CGuiComboBox	m_wndFoodType;
+	CString	m_szOrderDate;
+	CString	m_szIssueDate;
+	CString	m_szStatusKey;
+	CString	m_szFoodTypeKey;
+	//void			OnOrderDateChange(); 
+	//void			OnOrderDateSetfocus(); 
+	//void			OnOrderDateKillfocus(); 
+	int			OnOrderDateCheckValue(); 
+	//void			OnIssueDateChange(); 
+	//void			OnIssueDateSetfocus(); 
+	//void			OnIssueDateKillfocus(); 
+	int			OnIssueDateCheckValue(); 
+	void			OnStatusSelectChange(int nOldItemSel, int nNewItemSel); 
+	void			OnStatusSelendok(); 
+	//void			OnStatusSetfocus(); 
+	//void			OnStatusKillfocus(); 
+	long			OnStatusLoadData(); 
+	//void			OnStatusAddNew(); 
+	void			OnPrintSelect(); 
+	long			OnOrderListLoadData(); 
+	void			OnOrderListSelectChange(int nOldItem, int nNewItem); 
+	void			OnOrderListDblClick(); 
+	int			OnOrderListDeleteItem(); 
+	void			OnRefreshSelect(); 
+	void			OnFoodTypeSelectChange(int nOldItemSel, int nNewItemSel); 
+	void			OnFoodTypeSelendok(); 
+	//void			OnFoodTypeSetfocus(); 
+	//void			OnFoodTypeKillfocus(); 
+	long			OnFoodTypeLoadData(); 
+	//void			OnFoodTypeAddNew(); 
+	CCHMSSummaryDailyFoodOrder();
+	~CCHMSSummaryDailyFoodOrder();
+	void OnCreateComponents();
+	void OnInitializeComponents();
+	void OnSetWindowEvents();
+	void OnDoDataExchange(CDataExchange* pDX);
+	void GetDataToScreen();
+	void GetScreenToData();
+	void SetDefaultValues();
+	int SetMode(int nMode);
+	int OnAddCHMSSummaryDailyFoodOrder(); 
+	int OnEditCHMSSummaryDailyFoodOrder(); 
+	int OnDeleteCHMSSummaryDailyFoodOrder(); 
+	int OnSaveCHMSSummaryDailyFoodOrder(); 
+	int OnCancelCHMSSummaryDailyFoodOrder(); 
+	int OnCHMSSummaryDailyFoodOrderListLoadData(); 
+};
+#endif
Index: Resx/CHMSSummaryDailyFoodOrder.resx
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: Resx/CHMSSummaryDailyFoodOrder.resx
===================================================================
--- Resx/CHMSSummaryDailyFoodOrder.resx	(revision 0)
+++ Resx/CHMSSummaryDailyFoodOrder.resx	(working copy)

Property changes on: Resx/CHMSSummaryDailyFoodOrder.resx
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: VIMESNutritionManagr.aps
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: VIMESNutritionManagr.aps
===================================================================
--- VIMESNutritionManagr.aps	(revision 0)
+++ VIMESNutritionManagr.aps	(working copy)

Property changes on: VIMESNutritionManagr.aps
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: VIMESNutritionManagr.cpp
===================================================================
--- VIMESNutritionManagr.cpp	(revision 0)
+++ VIMESNutritionManagr.cpp	(working copy)
@@ -0,0 +1,128 @@
+// VIMESNutritionManagr.cpp : Defines the class behaviors for the application.
+//
+
+#include "stdafx.h"
+#include "VIMESNutritionManagr.h"
+#include "MainFrm.h"
+
+#ifdef _DEBUG
+#define new DEBUG_NEW
+#endif
+
+
+// CVIMESNutritionManagrApp
+
+BEGIN_MESSAGE_MAP(CVIMESNutritionManagrApp, CWinApp)
+	ON_COMMAND(ID_APP_ABOUT, OnAppAbout)
+	// Standard file based document commands
+	ON_COMMAND(ID_FILE_NEW, CWinApp::OnFileNew)
+	ON_COMMAND(ID_FILE_OPEN, CWinApp::OnFileOpen)
+	// Standard print setup command
+	ON_COMMAND(ID_FILE_PRINT_SETUP, CWinApp::OnFilePrintSetup)
+END_MESSAGE_MAP()
+
+
+// CVIMESNutritionManagrApp construction
+
+CVIMESNutritionManagrApp::CVIMESNutritionManagrApp()
+{
+	// TODO: add construction code here,
+	// Place all significant initialization in InitInstance
+}
+
+
+// The one and only CVIMESNutritionManagrApp object
+
+CVIMESNutritionManagrApp theApp;
+
+// CVIMESNutritionManagrApp initialization
+
+BOOL CVIMESNutritionManagrApp::InitInstance()
+{
+	// InitCommonControls() is required on Windows XP if an application
+	// manifest specifies use of ComCtl32.dll version 6 or later to enable
+	// visual styles.  Otherwise, any window creation will fail.
+	InitCommonControls();
+
+	CWinApp::InitInstance();
+
+	// Initialize OLE libraries
+	if (!AfxOleInit())
+	{
+		AfxMessageBox(IDP_OLE_INIT_FAILED);
+		return FALSE;
+	}
+	AfxEnableControlContainer();
+	// Standard initialization
+	// If you are not using these features and wish to reduce the size
+	// of your final executable, you should remove from the following
+	// the specific initialization routines you do not need
+	// Change the registry key under which our settings are stored
+	// TODO: You should modify this string to be something appropriate
+	// such as the name of your company or organization
+	SetRegistryKey(_T("Local AppWizard-Generated Applications"));
+	// To create the main window, this code creates a new frame window
+	// object and then sets it as the application's main window object
+
+	
+	CMainFrame* pFrame = new CMainFrame;
+	if (!pFrame)
+		return FALSE;
+	m_pMainWnd = pFrame;
+	// create and load the frame with its resources
+	pFrame->LoadFrame(IDR_MAINFRAME,
+		WS_OVERLAPPEDWINDOW | FWS_ADDTOTITLE, NULL,
+		NULL);
+	// The one and only window has been initialized, so show and update it
+	pFrame->CenterWindow();
+	pFrame->ShowWindow(SW_SHOW);
+	pFrame->UpdateWindow();
+
+	//pFrame->OnFileInvoicesetup();
+	// call DragAcceptFiles only if there's a suffix
+	//  In an SDI app, this should occur after ProcessShellCommand
+	return TRUE;
+}
+
+
+
+// CAboutDlg dialog used for App About
+
+class CAboutDlg : public CDialog
+{
+public:
+	CAboutDlg();
+
+// Dialog Data
+	enum { IDD = IDD_ABOUTBOX };
+
+protected:
+	virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support
+
+// Implementation
+protected:
+	DECLARE_MESSAGE_MAP()
+};
+
+CAboutDlg::CAboutDlg() : CDialog(CAboutDlg::IDD)
+{
+}
+
+void CAboutDlg::DoDataExchange(CDataExchange* pDX)
+{
+	CDialog::DoDataExchange(pDX);
+}
+
+BEGIN_MESSAGE_MAP(CAboutDlg, CDialog)
+END_MESSAGE_MAP()
+
+// App command to run the dialog
+void CVIMESNutritionManagrApp::OnAppAbout()
+{
+	CAboutDlg aboutDlg;
+	aboutDlg.DoModal();
+}
+
+
+// CVIMESNutritionManagrApp message handlers
+
Index: VIMESNutritionManagr.h
===================================================================
--- VIMESNutritionManagr.h	(revision 0)
+++ VIMESNutritionManagr.h	(working copy)
@@ -0,0 +1,31 @@
+// VIMESNutritionManagr.h : main header file for the VIMESNutritionManagr application
+//
+#pragma once
+
+#ifndef __AFXWIN_H__
+	#error include 'stdafx.h' before including this file for PCH
+#endif
+
+#include "resource.h"       // main symbols
+
+
+// CVIMESNutritionManagrApp:
+// See VIMESNutritionManagr.cpp for the implementation of this class
+//
+
+class CVIMESNutritionManagrApp : public CWinApp
+{
+public:
+	CVIMESNutritionManagrApp();
+
+
+// Overrides
+public:
+	virtual BOOL InitInstance();
+
+// Implementation
+	afx_msg void OnAppAbout();
+	DECLARE_MESSAGE_MAP()
+};
+
+extern CVIMESNutritionManagrApp theApp;
\ No newline at end of file
Index: res/Toolbar.bmp
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: res/Toolbar.bmp
===================================================================
--- res/Toolbar.bmp	(revision 0)
+++ res/Toolbar.bmp	(working copy)

Property changes on: res/Toolbar.bmp
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: res/VIMESNutritionManagr.ico
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: res/VIMESNutritionManagr.ico
===================================================================
--- res/VIMESNutritionManagr.ico	(revision 0)
+++ res/VIMESNutritionManagr.ico	(working copy)

Property changes on: res/VIMESNutritionManagr.ico
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: res/VIMESNutritionManagr.manifest
===================================================================
--- res/VIMESNutritionManagr.manifest	(revision 0)
+++ res/VIMESNutritionManagr.manifest	(working copy)
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
+<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"> 
+<assemblyIdentity 
+    version="1.0.0.0" 
+    processorArchitecture="X86" 
+    name="Microsoft.Windows.VIMESNutritionManagr"
+    type="win32" 
+/> 
+<description>Your app description here</description> 
+<dependency> 
+    <dependentAssembly> 
+        <assemblyIdentity 
+            type="win32" 
+            name="Microsoft.Windows.Common-Controls" 
+            version="6.0.0.0" 
+            processorArchitecture="X86" 
+            publicKeyToken="6595b64144ccf1df" 
+            language="*" 
+        /> 
+    </dependentAssembly> 
+</dependency> 
+</assembly>
Index: res/VIMESNutritionManagr.rc2
===================================================================
--- res/VIMESNutritionManagr.rc2	(revision 0)
+++ res/VIMESNutritionManagr.rc2	(working copy)
@@ -0,0 +1,13 @@
+//
+// VIMESNutritionManagr.RC2 - resources Microsoft Visual C++ does not edit directly
+//
+
+#ifdef APSTUDIO_INVOKED
+#error this file is not editable by Microsoft Visual C++
+#endif //APSTUDIO_INVOKED
+
+
+/////////////////////////////////////////////////////////////////////////////
+// Add manually edited resources here...
+
+/////////////////////////////////////////////////////////////////////////////
Index: res/VIMESNutritionManagrDoc.ico
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: res/VIMESNutritionManagrDoc.ico
===================================================================
--- res/VIMESNutritionManagrDoc.ico	(revision 0)
+++ res/VIMESNutritionManagrDoc.ico	(working copy)

Property changes on: res/VIMESNutritionManagrDoc.ico
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: res/sandwich.ico
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: res/sandwich.ico
===================================================================
--- res/sandwich.ico	(revision 0)
+++ res/sandwich.ico	(working copy)

Property changes on: res/sandwich.ico
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: resource.h
===================================================================
--- resource.h	(revision 0)
+++ resource.h	(working copy)
@@ -0,0 +1,20 @@
+//{{NO_DEPENDENCIES}}
+// Microsoft Visual C++ generated include file.
+// Used by VIMESNutritionManagr.rc
+//
+#define IDD_ABOUTBOX                    100
+#define IDP_OLE_INIT_FAILED             100
+#define IDR_MAINFRAME                   128
+#define IDR_VIMESNutritionMTYPE         129
+#define IDI_ICON1                       0
+
+// Next default values for new objects
+// 
+#ifdef APSTUDIO_INVOKED
+#ifndef APSTUDIO_READONLY_SYMBOLS
+#define _APS_NEXT_RESOURCE_VALUE        131
+#define _APS_NEXT_COMMAND_VALUE         32771
+#define _APS_NEXT_CONTROL_VALUE         1000
+#define _APS_NEXT_SYMED_VALUE           101
+#endif
+#endif
Index: stdafx.cpp
===================================================================
--- stdafx.cpp	(revision 0)
+++ stdafx.cpp	(working copy)
@@ -0,0 +1,7 @@
+// stdafx.cpp : source file that includes just the standard includes
+// VIMESNutritionManagr.pch will be the pre-compiled header
+// stdafx.obj will contain the pre-compiled type information
+
+#include "stdafx.h"
+
+
Index: stdafx.h
===================================================================
--- stdafx.h	(revision 0)
+++ stdafx.h	(working copy)
@@ -0,0 +1,42 @@
+// stdafx.h : include file for standard system include files,
+// or project specific include files that are used frequently,
+// but are changed infrequently
+
+#pragma once
+
+#ifndef VC_EXTRALEAN
+#define VC_EXTRALEAN		// Exclude rarely-used stuff from Windows headers
+#endif
+
+// Modify the following defines if you have to target a platform prior to the ones specified below.
+// Refer to MSDN for the latest info on corresponding values for different platforms.
+#ifndef WINVER				// Allow use of features specific to Windows 95 and Windows NT 4 or later.
+#define WINVER 0x0400		// Change this to the appropriate value to target Windows 98 and Windows 2000 or later.
+#endif
+
+#ifndef _WIN32_WINNT		// Allow use of features specific to Windows NT 4 or later.
+#define _WIN32_WINNT 0x0400		// Change this to the appropriate value to target Windows 98 and Windows 2000 or later.
+#endif						
+
+#ifndef _WIN32_WINDOWS		// Allow use of features specific to Windows 98 or later.
+#define _WIN32_WINDOWS 0x0410 // Change this to the appropriate value to target Windows Me or later.
+#endif
+
+#ifndef _WIN32_IE			// Allow use of features specific to IE 4.0 or later.
+#define _WIN32_IE 0x0400	// Change this to the appropriate value to target IE 5.0 or later.
+#endif
+
+#define _ATL_CSTRING_EXPLICIT_CONSTRUCTORS	// some CString constructors will be explicit
+
+// turns off MFC's hiding of some common and often safely ignored warning messages
+#define _AFX_ALL_WARNINGS
+
+#include <afxwin.h>         // MFC core and standard components
+#include <afxext.h>         // MFC extensions
+#include <afxdisp.h>        // MFC Automation classes
+
+#include <afxdtctl.h>		// MFC support for Internet Explorer 4 Common Controls
+#ifndef _AFX_NO_AFXCMN_SUPPORT
+#include <afxcmn.h>			// MFC support for Windows Common Controls
+#endif // _AFX_NO_AFXCMN_SUPPORT
+
Index: ChildView.cpp
===================================================================
--- ChildView.cpp	(revision 0)
+++ ChildView.cpp	(working copy)
@@ -0,0 +1,53 @@
+// ChildView.cpp : implementation of the CChildView class
+//
+
+#include "stdafx.h"
+#include "VIMESNutritionManagr.h"
+#include "ChildView.h"
+
+#ifdef _DEBUG
+#define new DEBUG_NEW
+#endif
+
+
+// CChildView
+
+CChildView::CChildView()
+{
+}
+
+CChildView::~CChildView()
+{
+}
+
+
+BEGIN_MESSAGE_MAP(CChildView, CWnd)
+	ON_WM_PAINT()
+END_MESSAGE_MAP()
+
+
+
+// CChildView message handlers
+
+BOOL CChildView::PreCreateWindow(CREATESTRUCT& cs) 
+{
+	if (!CWnd::PreCreateWindow(cs))
+		return FALSE;
+
+	cs.dwExStyle |= WS_EX_CLIENTEDGE;
+	cs.style &= ~WS_BORDER;
+	cs.lpszClass = AfxRegisterWndClass(CS_HREDRAW|CS_VREDRAW|CS_DBLCLKS, 
+		::LoadCursor(NULL, IDC_ARROW), reinterpret_cast<HBRUSH>(COLOR_WINDOW+1), NULL);
+
+	return TRUE;
+}
+
+void CChildView::OnPaint() 
+{
+	CPaintDC dc(this); // device context for painting
+	
+	// TODO: Add your message handler code here
+	
+	// Do not call CWnd::OnPaint() for painting messages
+}
+
Index: ChildView.h
===================================================================
--- ChildView.h	(revision 0)
+++ ChildView.h	(working copy)
@@ -0,0 +1,35 @@
+// ChildView.h : interface of the CChildView class
+//
+
+
+#pragma once
+
+
+// CChildView window
+
+class CChildView : public CWnd
+{
+// Construction
+public:
+	CChildView();
+
+// Attributes
+public:
+
+// Operations
+public:
+
+// Overrides
+	protected:
+	virtual BOOL PreCreateWindow(CREATESTRUCT& cs);
+
+// Implementation
+public:
+	virtual ~CChildView();
+
+	// Generated message map functions
+protected:
+	afx_msg void OnPaint();
+	DECLARE_MESSAGE_MAP()
+};
+
Index: HMSDailyFoodOrder.cpp
===================================================================
--- HMSDailyFoodOrder.cpp	(revision 0)
+++ HMSDailyFoodOrder.cpp	(working copy)
@@ -0,0 +1,2189 @@
+#include "HMSDailyFoodOrder.h"
+#include "MainFrm.h"
+#include "HMSDailyFoodOrderList.h"
+#include "HMSConfirmDialog.h"
+#include "ReportDocument.h"
+#include "Excel.h"
+
+static long _OnOrderListLoadDataFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder*)pWnd)->OnOrderListLoadData();
+} 
+static void _OnOrderListDblClickFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder*)pWnd)->OnOrderListDblClick();
+} 
+static void _OnOrderListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CHMSDailyFoodOrder*)pWnd)->OnOrderListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnOrderListDeleteItemFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnOrderListDeleteItem();
+} 
+
+static int _OnOrderListPrintDeliveryDrugFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnOrderListPrintDeliveryDrug();
+}
+static int	_OnExportOrderDeliveryDrugFnc(CWnd *pWnd){
+	return	((CHMSDailyFoodOrder*)pWnd)->OnExportOrderDeliveryDrug();
+}
+static int _OnOrderListPrintSheetDateFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnOrderListPrintSheetDate();
+}
+static int _OnOrderListPrintSheetpublicityFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnOrderListPrintSheetPublicity();
+}
+
+static long _OnPatientListLoadDataFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder*)pWnd)->OnPatientListLoadData();
+} 
+static void _OnPatientListDblClickFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder*)pWnd)->OnPatientListDblClick();
+} 
+static void _OnPatientListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CHMSDailyFoodOrder*)pWnd)->OnPatientListSelectChange(nOldItem, nNewItem);
+} 
+
+static int _OnPatientListIssueAllFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnPatientListIssueAll();
+} 
+
+static int _OnPatientListIssueFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnPatientListIssue();
+} 
+
+static int _OnPatientListRollbackFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnPatientListRollback();
+} 
+
+static int _OnPatientListDeleteItemFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnPatientListDeleteItem();
+} 
+static long _OnDrugListLoadDataFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder*)pWnd)->OnDrugListLoadData();
+} 
+static void _OnDrugListDblClickFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder*)pWnd)->OnDrugListDblClick();
+} 
+static void _OnDrugListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CHMSDailyFoodOrder*)pWnd)->OnDrugListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnDrugListAddEntryFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnDrugListAddEntry();
+} 
+
+static int _OnDrugListDeleteItemFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnDrugListDeleteItem();
+} 
+static int _OnDrugListReturnFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnDrugListReturnDrug();
+} 
+
+/*static void _OnOrderNoChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnOrderNoChange();
+} */
+/*static void _OnOrderNoSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnOrderNoSetfocus();} */ 
+/*static void _OnOrderNoKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnOrderNoKillfocus();
+} */
+static int _OnOrderNoCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnOrderNoCheckValue();
+} 
+static void _OnFindSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnFindSelect();
+} 
+/*static void _OnOrderDateChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnOrderDateChange();
+} */
+/*static void _OnOrderDateSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnOrderDateSetfocus();} */ 
+/*static void _OnOrderDateKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnOrderDateKillfocus();
+} */
+static int _OnOrderDateCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnOrderDateCheckValue();
+} 
+/*static void _OnIssueDateChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnIssueDateChange();
+} */
+/*static void _OnIssueDateSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnIssueDateSetfocus();} */ 
+/*static void _OnIssueDateKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnIssueDateKillfocus();
+} */
+static int _OnIssueDateCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnIssueDateCheckValue();
+} 
+/*static void _OnStatusChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnStatusChange();
+} */
+/*static void _OnStatusSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnStatusSetfocus();} */ 
+/*static void _OnStatusKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+} */
+static int _OnStatusCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnStatusCheckValue();
+} 
+/*static void _OnPrintedChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnPrintedChange();
+} */
+/*static void _OnPrintedSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnPrintedSetfocus();} */ 
+/*static void _OnPrintedKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnPrintedKillfocus();
+} */
+/*static void _OnPatientNameChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderDialog *)pWnd)->OnPatientNameChange();
+} */
+/*static void _OnPatientNameSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderDialog *)pWnd)->OnPatientNameSetfocus();} */ 
+/*static void _OnPatientNameKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderDialog *)pWnd)->OnPatientNameKillfocus();
+} */
+static int _OnPatientNameCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnPatientNameCheckValue();
+} 
+static int _OnPrintedCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnPrintedCheckValue();
+} 
+/*static void _OnNoteChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnNoteChange();
+} */
+/*static void _OnNoteSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnNoteSetfocus();} */ 
+/*static void _OnNoteKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrder *)pWnd)->OnNoteKillfocus();
+} */
+static int _OnNoteCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrder *)pWnd)->OnNoteCheckValue();
+} 
+static void _OnAddSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnAddSelect();
+} 
+static void _OnEditSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnEditSelect();
+} 
+static void _OnDeleteSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnDeleteSelect();
+} 
+static void _OnSaveSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnSaveSelect();
+} 
+static void _OnCancelSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnCancelSelect();
+} 
+static void _OnSendSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnSendSelect();
+} 
+static void _OnPrintSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnPrintSelect();
+} 
+static void _OnPrintDeliveryDrugsSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnPrintDeliveryDrugsSelect();
+} 
+static void _OnAddDrugSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnAddDrugSelect();
+} 
+static void _OnAddAutomaticSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrder *pVw = (CHMSDailyFoodOrder *)pWnd;
+	pVw->OnAddAutomaticSelect();
+} 
+static int _OnAddHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnAddHMSDailyFoodOrder();
+} 
+static int _OnEditHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnEditHMSDailyFoodOrder();
+} 
+static int _OnDeleteHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnDeleteHMSDailyFoodOrder();
+} 
+static int _OnSaveHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnSaveHMSDailyFoodOrder();
+} 
+static int _OnCancelHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrder*)pWnd)->OnCancelHMSDailyFoodOrder();
+} 
+//CHMSDailyFoodOrder::CHMSDailyFoodOrder(CWnd *pParent)
+CHMSDailyFoodOrder::CHMSDailyFoodOrder()
+{
+	m_nDlgWidth = 1000;
+	m_nDlgHeight = 620;
+	SetDefaultValues();
+	m_szOrderNo.Empty();
+}
+CHMSDailyFoodOrder::~CHMSDailyFoodOrder(){
+}
+void CHMSDailyFoodOrder::OnCreateComponents(){	
+	m_wndOrderInformation.Create(this, _T("Order Information"), 5, 5, 550, 180);
+	m_wndPatientInformation.Create(this, _T("Patient Information"), 555, 5, 1020, 410);
+	m_wndDrugInformation.Create(this, _T("Food Informations"), 555, 445, 1020, 625);
+	m_wndGroupListDrug.Create(this, _T("Food Type List"), 5, 185, 550, 625);
+	m_wndOrderNoLabel.Create(this, _T("Order ID"), 10, 30, 140, 55);
+	m_wndOrderNo.Create(this,145, 30, 275, 55); 
+	m_wndFind.Create(this, _T("&Find"), 825, 415, 925, 440);
+	m_wndOrderDateLabel.Create(this, _T("Order Date"), 10, 60, 140, 85);
+	m_wndOrderDate.Create(this,145, 60, 275, 85); 
+	m_wndIssueDateLabel.Create(this, _T("Issue Date"), 280, 60, 410, 85);
+	m_wndIssueDate.Create(this,415, 60, 545, 85); 
+	m_wndStatusLabel.Create(this, _T("Status"), 280, 30, 410, 55);
+	m_wndStatus.Create(this,415, 30, 545, 55); 
+	m_wndNoteLabel.Create(this, _T("Note"), 10, 90, 140, 115);
+	m_wndNote.Create(this,145, 90, 545, 115); 
+	m_wndSend.Create(this, _T("&&Approval"), 370, 150, 455, 175);
+	m_wndPrint.Create(this, _T("&Preview"), 460, 150, 545, 175);
+	m_wndPatientNameLabel.Create(this, _T("Patient Name"), 555, 415, 665, 440);
+	m_wndPatientName.Create(this,670, 415, 820, 440); 
+	m_wndDeptLabel.Create(this, _T("Dept"), 10, 120, 140, 145);
+	m_wndDept.Create(this,145, 120, 545, 145); 
+	m_wndOrderList.Create(this,10, 210, 545, 620); 
+	m_wndPatientList.Create(this,560, 30, 1015, 405); 
+	m_wndDrugList.Create(this,560, 470, 1015, 620); 
+	m_wndTypeLabel.Create(this, _T("Type"), 10, 149, 140, 174);
+	m_wndType.Create(this,145, 149, 360, 174); 
+	m_wndTotalCount.Create(this,935, 415, 1015, 440); 
+}
+void CHMSDailyFoodOrder::OnInitializeComponents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	m_wndFind.ModifyStyle(WS_TABSTOP, 0);
+	m_wndOrderNo.SetLimitText(9);
+	m_wndOrderNo.SetCheckValue(true);
+	m_wndOrderNo.ModifyStyle(0, ES_UPPERCASE);
+	//m_wndOrderDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndOrderDate.SetCheckValue(true);
+	//m_wndOrderDate.SetToolTipMessage(_T("Ngay yeu cau khong hop le"));
+	m_wndIssueDate.SetReadOnly(TRUE);
+	m_wndStatus.SetLimitText(35);
+	m_wndNote.SetLimitText(81);
+	//m_wndNote.SetCheckValue(true);
+	m_wndStatus.SetReadOnly(true);
+	m_wndPrinted.SetReadOnly(true);
+
+//	m_wndOrderNo.ModifyStyle(0, ES_NUMBER);
+
+	m_wndOrderList.InsertColumn(0, _T("ID"), CFMT_TEXT|CFMT_CENTER, 40);	//identify
+	m_wndOrderList.InsertColumn(1, _T("Desc"), CFMT_TEXT, 200);
+	m_wndOrderList.InsertColumn(2, _T("Unit"), CFMT_TEXT|CFMT_CENTER, 0);
+	m_wndOrderList.InsertColumn(3, _T("S\xE1ng"), CFMT_MONEY, 40);	
+	m_wndOrderList.InsertColumn(4, _T("Tr\x1B0\x61"), CFMT_MONEY, 40);	
+	m_wndOrderList.InsertColumn(5, _T("T\x1ED1i"), CFMT_MONEY, 40);	
+	m_wndOrderList.InsertColumn(6, _T("Qty"), CFMT_MONEY, 40);	
+	m_wndOrderList.InsertColumn(7, _T("Price"), CFMT_MONEY, 70);
+	m_wndOrderList.InsertColumn(8, _T("Amount"), CFMT_MONEY, 80);
+	m_wndOrderList.InsertColumn(9, _T("ItemID"), CFMT_TEXT, 0);	
+	m_wndOrderList.InsertColumn(10, _T("GroupID"), CFMT_TEXT, 0);
+	m_wndOrderList.SetSortHeader(false);
+	m_wndOrderList.GetHeaderControl()->SetItemHeight(2);
+	m_wndOrderList.GetHeaderControl()->MergeCell(_T("S\x1ED1 su\x1EA5t"), 0, 3, 1, 6, true);
+	m_wndOrderList.ModifyStyle(0, LVS_NOSORTHEADER);
+
+	m_wndPatientList.InsertColumn(0, _T(""), CFMT_NUMBER, 0);	//orderid
+	m_wndPatientList.InsertColumn(1, _T("Document No"), CFMT_NUMBER, 80);
+	m_wndPatientList.InsertColumn(2, _T("Patient Name"), CFMT_TEXT, 160);
+	m_wndPatientList.InsertColumn(3, _T("Bed"), CFMT_TEXT, 70);
+	m_wndPatientList.InsertColumn(4, _T("Date"), CFMT_DATE, 100);
+	m_wndPatientList.InsertColumn(5, _T("Status"), CFMT_TEXT|CFMT_CENTER, 0);
+	m_wndPatientList.InsertColumn(6, _T("OrderNo"), CFMT_NUMBER, 0);
+	m_wndPatientList.InsertColumn(7, _T("Doctor"), CFMT_TEXT, 120);
+	m_wndPatientList.InsertColumn(8, _T("Created By"), CFMT_TEXT, 0);
+
+	m_wndDrugList.InsertColumn(0, _T("ID"), CFMT_TEXT|CFMT_CENTER, 40);
+	m_wndDrugList.InsertColumn(1, _T("Desc"), CFMT_TEXT, 200);
+	m_wndDrugList.InsertColumn(2, _T("Unit"), CFMT_TEXT|CFMT_CENTER, 60);	
+	m_wndDrugList.InsertColumn(3, _T("Type"), CFMT_TEXT, 0);	
+	m_wndDrugList.InsertColumn(4, _T("SL"), CFMT_MONEY, 40);	
+	m_wndDrugList.InsertColumn(5, _T("Unit Price"), CFMT_MONEY, 70);
+	m_wndDrugList.InsertColumn(6, _T("Amount"), CFMT_MONEY, 80);
+	m_wndDrugList.InsertColumn(7, _T("Orderid"), CFMT_NUMBER, 0);	//product_id
+	m_wndDrugList.InsertColumn(8, _T("Itemdi"), CFMT_TEXT|CFMT_CENTER, 0);
+	//m_wndDrugList.GetHeaderControl()->SetItemHeight(2);
+	
+	
+	m_feefoodTbl.SetTableName(_T("HMS_FOODORDERSHEET"));
+	m_feefoodTbl.AddField(_T("HFOS_ORDERID"), dfLong); 
+	m_feefoodTbl.AddField(_T("HFOS_CREATEDBY"), dfText, 15); 
+	m_feefoodTbl.AddField(_T("HFOS_CREATEDDATE"), dfDateTime); 
+	m_feefoodTbl.AddField(_T("HFOS_UPDATEDBY"), dfText, 15); 
+	m_feefoodTbl.AddField(_T("HFOS_UPDATEDDATE"), dfDateTime); 	
+	m_feefoodTbl.AddField(_T("HFOS_DEPTID"), dfText, 7); 
+	m_feefoodTbl.AddField(_T("HFOS_ORDERTYPE"), dfText, 1);	
+	m_feefoodTbl.AddField(_T("HFOS_ORDERDATE"), dfDateTime);
+	m_feefoodTbl.AddField(_T("HFOS_ORDERSTATUS"), dfText, 1); 
+	m_feefoodTbl.AddField(_T("HFOS_APPROVEDATE"), dfDateTime); 
+	m_feefoodTbl.AddField(_T("HFOS_APPROVEBY"), dfText, 32); 
+	m_feefoodTbl.AddField(_T("HFOS_SHEETNO"), dfText, 65);
+	m_feefoodTbl.AddField(_T("HFOS_DESCRIPTION"), dfText, 254);
+
+}
+void CHMSDailyFoodOrder::OnSetWindowEvents(){
+	m_wndOrderList.SetEvent(WE_SELCHANGE, _OnOrderListSelectChangeFnc);
+	m_wndOrderList.SetEvent(WE_LOADDATA, _OnOrderListLoadDataFnc);
+	m_wndOrderList.SetEvent(WE_DBLCLICK, _OnOrderListDblClickFnc);
+	m_wndOrderList.SetWindowText(_T("Order Information"));
+	m_wndOrderList.AddEvent(1, _T("Print Daily Food"), _OnOrderListPrintDeliveryDrugFnc);
+	//m_wndOrderList.AddEvent(2, _T("Export Delivery Drugs"), _OnExportOrderDeliveryDrugFnc);
+	//m_wndOrderList.AddEvent(3, _T("Print Sheet By Date"), _OnOrderListPrintSheetDateFnc);
+	////m_wndOrderList.AddEvent(4, _T("Print shelt publicity drugs"), _OnOrderListPrintSheetpublicityFnc);
+	//m_wndOrderList.AddEvent(0, _T("-"), NULL);
+	//m_wndOrderList.AddEvent(5, _T("View Detail"), _OnOrderListDeleteItemFnc);
+
+	m_wndPatientList.SetEvent(WE_SELCHANGE, _OnPatientListSelectChangeFnc);
+	m_wndPatientList.SetEvent(WE_LOADDATA, _OnPatientListLoadDataFnc);
+	m_wndPatientList.SetEvent(WE_DBLCLICK, _OnPatientListDblClickFnc);
+	
+	/*
+	m_wndPatientList.SetWindowText(_T("Patient List"));
+	m_wndPatientList.AddEvent(1, _T("Issue All"), _OnPatientListIssueAllFnc);
+	m_wndPatientList.AddEvent(0, _T("-"), NULL);
+	m_wndPatientList.AddEvent(2, _T("Issue"), _OnPatientListIssueFnc);
+	m_wndPatientList.AddEvent(0, _T("-"), NULL);
+	m_wndPatientList.AddEvent(3, _T("DMO_Rollback"), _OnPatientListRollbackFnc);
+	m_wndPatientList.AddEvent(0, _T("-"), NULL);
+	m_wndPatientList.AddEvent(4, _T("Delete Patient"), _OnPatientListDeleteItemFnc);
+*/
+
+	m_wndDrugList.SetEvent(WE_SELCHANGE, _OnDrugListSelectChangeFnc);
+	m_wndDrugList.SetEvent(WE_LOADDATA, _OnDrugListLoadDataFnc);
+	m_wndDrugList.SetEvent(WE_DBLCLICK, _OnDrugListDblClickFnc);
+	m_wndDrugList.SetWindowText(_T("Drug List"));
+	/*m_wndDrugList.AddEvent(1, _T("Add Item"), _OnDrugListAddEntryFnc, 0, VK_F2);
+	m_wndDrugList.AddEvent(0, _T("-"), NULL);
+	m_wndDrugList.AddEvent(2, _T("Delete Item"), _OnDrugListDeleteItemFnc, 0, VK_DELETE);
+	m_wndDrugList.AddEvent(0, _T("-"), NULL);
+	m_wndDrugList.AddEvent(3, _T("Return Item"), _OnDrugListReturnFnc);*/
+	
+	//m_wndOrderNo.SetEvent(WE_CHANGE, _OnOrderNoChangeFnc);
+	//m_wndOrderNo.SetEvent(WE_SETFOCUS, _OnOrderNoSetfocusFnc);
+	//m_wndOrderNo.SetEvent(WE_KILLFOCUS, _OnOrderNoKillfocusFnc);
+	m_wndOrderNo.SetEvent(WE_CHECKVALUE, _OnOrderNoCheckValueFnc);
+	m_wndFind.SetEvent(WE_CLICK, _OnFindSelectFnc);
+	//m_wndOrderDate.SetEvent(WE_CHANGE, _OnOrderDateChangeFnc);
+	//m_wndOrderDate.SetEvent(WE_SETFOCUS, _OnOrderDateSetfocusFnc);
+	//m_wndOrderDate.SetEvent(WE_KILLFOCUS, _OnOrderDateKillfocusFnc);
+	m_wndOrderDate.SetEvent(WE_CHECKVALUE, _OnOrderDateCheckValueFnc);
+	//m_wndIssueDate.SetEvent(WE_CHANGE, _OnIssueDateChangeFnc);
+	//m_wndIssueDate.SetEvent(WE_SETFOCUS, _OnIssueDateSetfocusFnc);
+	//m_wndIssueDate.SetEvent(WE_KILLFOCUS, _OnIssueDateKillfocusFnc);
+	m_wndIssueDate.SetEvent(WE_CHECKVALUE, _OnIssueDateCheckValueFnc);
+	//m_wndStatus.SetEvent(WE_CHANGE, _OnStatusChangeFnc);
+	//m_wndStatus.SetEvent(WE_SETFOCUS, _OnStatusSetfocusFnc);
+	//m_wndStatus.SetEvent(WE_KILLFOCUS, _OnStatusKillfocusFnc);
+	m_wndStatus.SetEvent(WE_CHECKVALUE, _OnStatusCheckValueFnc);
+	//m_wndPrinted.SetEvent(WE_CHANGE, _OnPrintedChangeFnc);
+	//m_wndPrinted.SetEvent(WE_SETFOCUS, _OnPrintedSetfocusFnc);
+	//m_wndPrinted.SetEvent(WE_KILLFOCUS, _OnPrintedKillfocusFnc);
+	m_wndPrinted.SetEvent(WE_CHECKVALUE, _OnPrintedCheckValueFnc);
+	//m_wndNote.SetEvent(WE_CHANGE, _OnNoteChangeFnc);
+	//m_wndNote.SetEvent(WE_SETFOCUS, _OnNoteSetfocusFnc);
+	//m_wndNote.SetEvent(WE_KILLFOCUS, _OnNoteKillfocusFnc);
+	m_wndNote.SetEvent(WE_CHECKVALUE, _OnNoteCheckValueFnc);
+
+	m_wndAddAutomatic.SetEvent(WE_CLICK, _OnAddAutomaticSelectFnc);
+
+	//m_wndPatientName.SetEvent(WE_CHANGE, _OnPatientNameChangeFnc);
+	//m_wndPatientName.SetEvent(WE_SETFOCUS, _OnPatientNameSetfocusFnc);
+	//m_wndPatientName.SetEvent(WE_KILLFOCUS, _OnPatientNameKillfocusFnc);
+	m_wndPatientName.SetEvent(WE_CHECKVALUE, _OnPatientNameCheckValueFnc);
+
+	m_wndAdd.SetEvent(WE_CLICK, _OnAddSelectFnc);
+	m_wndEdit.SetEvent(WE_CLICK, _OnEditSelectFnc);
+	m_wndDelete.SetEvent(WE_CLICK, _OnDeleteSelectFnc);
+	m_wndSave.SetEvent(WE_CLICK, _OnSaveSelectFnc);
+	m_wndCancel.SetEvent(WE_CLICK, _OnCancelSelectFnc);
+	m_wndSend.SetEvent(WE_CLICK, _OnSendSelectFnc);
+	m_wndPrint.SetEvent(WE_CLICK, _OnPrintSelectFnc);
+	m_wndPrintDeliveryDrugs.SetEvent(WE_CLICK, _OnPrintDeliveryDrugsSelectFnc);
+	m_wndAddDrug.SetEvent(WE_CLICK, _OnAddDrugSelectFnc);
+
+	SetWindowFont(&m_wndTotalCount, GetFaceName(), GetFaceSize()+2, TRUE);
+	m_wndTotalCount.SetTextColor(RGB(0, 0, 255));
+	SetMode(VM_NONE);
+}
+void CHMSDailyFoodOrder::OnDoDataExchange(CDataExchange* pDX){
+	DDX_Text(pDX, m_wndOrderNo.GetDlgCtrlID(), m_szOrderNo);
+	DDX_TextEx(pDX, m_wndOrderDate.GetDlgCtrlID(), m_szOrderDate);
+	DDX_TextEx(pDX, m_wndIssueDate.GetDlgCtrlID(), m_szIssueDate);
+	DDX_Text(pDX, m_wndStatus.GetDlgCtrlID(), m_szStatusDesc);
+	DDX_Text(pDX, m_wndDept.GetDlgCtrlID(), m_szDept);
+	DDX_Text(pDX, m_wndNote.GetDlgCtrlID(), m_szNote);
+	DDX_Text(pDX, m_wndPatientName.GetDlgCtrlID(), m_szPatientName);
+	DDX_Text(pDX, m_wndTotalCount.GetDlgCtrlID(), m_nTotalCount);
+}
+void CHMSDailyFoodOrder::GetDataToScreen(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT  ") \
+		_T("HFOS_ORDERID as orderno, ") \
+		_T("HFOS_ORDERDATE as orderdate, ") \
+		_T("HFOS_APPROVEDATE as issuedate, ") \
+		_T("HFOS_DESCRIPTION as description, ") \
+		_T("HFOS_ORDERSTATUS as status, ") \
+		_T("HFOS_SHEETNO as sheetNo, ") \
+		_T("HFOS_DEPTID AS DEPTID, ") \
+		_T("HFOS_CREATEDBY as createdby ") \
+		_T("FROM HMS_FOODORDERSHEET ") \
+		_T("WHERE HFOS_ORDERID=%ld AND HFOS_ORDERSTATUS IN('S','A')"), 
+		m_nOID);
+	rs.ExecSQL(szSQL);
+//_fmsg(_T("%s"), szSQL);
+	if(!rs.IsEOF())
+	{
+		rs.GetValue(_T("createdby"), m_szCreatedBy);
+		rs.GetValue(_T("orderdate"), m_szOrderDate);
+		rs.GetValue(_T("issuedate"), m_szIssueDate);
+		//m_szOrderDate = m_szOrderTime.Left(10);
+		rs.GetValue(_T("description"), m_szNote);
+		rs.GetValue(_T("status"), m_szStatus);
+		rs.GetValue(_T("orderno"), m_szBatchNo);
+		rs.GetValue(_T("sheetNo"), m_szOrderNo);
+		m_szDept = pMF->GetDepartmentName(rs.GetValue(_T("deptid")));
+		//m_szOrderNo = m_szBatchNo;
+		m_szStatusDesc = pMF->GetStatusString(m_szStatus);
+		if(m_szStatus==_T("S"))
+			m_szIssueDate.Empty();		
+		SetMode(VM_VIEW);
+
+
+		
+		OnOrderListLoadData();
+		OnPatientListLoadData();
+
+		m_wndDrugList.DeleteAllItems();
+		CString szLabel;
+		m_wndSend.EnableWindow(true);
+		if(m_szStatus == _T("S")){
+			TranslateString(_T("&Approval"), szLabel);
+			m_wndSend.SetWindowText(szLabel);
+		}
+		else if(m_szStatus ==_T("A"))
+		{
+			TranslateString(_T("&Approval"), szLabel);
+			m_wndSend.SetWindowText(szLabel);
+			m_wndPrint.EnableWindow(true);
+			m_wndSend.EnableWindow(false);	
+		}		
+	}
+	else
+	{
+		SetMode(VM_NONE);
+	}
+
+
+	
+
+	if(m_wndOrderList.GetItemCount() <= 0){
+		m_wndSend.EnableWindow(false);
+		m_wndPrint.EnableWindow(false);
+		//m_wndPrintDeliveryDrugs.EnableWindow(false);
+	}
+
+}
+void CHMSDailyFoodOrder::GetScreenToData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CString szWhere;
+	
+	//m_feefoodTbl.SetValue(_T("HFOS_ORDERID"), dfLong); 
+	m_feefoodTbl.SetValue(_T("HFOS_CREATEDBY"), pMF->GetCurrentUser()); 
+	m_feefoodTbl.SetValue(_T("HFOS_CREATEDDATE"), pMF->GetSysDateTime()); 
+	m_feefoodTbl.SetValue(_T("HFOS_UPDATEDBY"), pMF->GetCurrentUser()); 
+	m_feefoodTbl.SetValue(_T("HFOS_UPDATEDDATE"), pMF->GetSysDateTime()); 	
+	m_feefoodTbl.SetValue(_T("HFOS_DEPTID"), pMF->GetDepartmentID()); 
+	m_feefoodTbl.SetValue(_T("HFOS_ORDERTYPE"), _T("F"));	
+	m_feefoodTbl.SetValue(_T("HFOS_ORDERDATE"), m_szOrderDate);
+	m_feefoodTbl.SetValue(_T("HFOS_ORDERSTATUS"), m_szStatus); 
+	//m_feefoodTbl.SetValue(_T("HFOS_APPROVEDATE"), dfDateTime); 
+	m_feefoodTbl.SetValue(_T("HFOS_APPROVEBY"), _T("")); 
+	m_feefoodTbl.SetValue(_T("HFOS_SHEETNO"), m_szOrderNo); 
+	m_feefoodTbl.SetValue(_T("HFOS_DESCRIPTION"), m_szNote);	
+	
+}
+void CHMSDailyFoodOrder::SetDefaultValues(){
+
+	m_szOrderDate.Empty();
+	m_szIssueDate.Empty();
+	m_szStatus.Empty();
+	m_nTotalCount=0;
+	m_szNote.Empty();
+
+}
+int CHMSDailyFoodOrder::SetMode(int nMode){
+ 		int nOldMode = GetMode(); 
+ 		CGuiView::SetMode(nMode); 
+ 		CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd(); 
+ 		CString szSQL; 
+ 		CRecord rs(&pMF->m_db); 
+  		switch(nMode){ 
+ 		case VM_ADD: 
+ 			EnableControls(TRUE); 
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			SetDefaultValues(); 
+			szSQL.Format(_T("AD_GETNEXTVAL('FOODORDER_NO','Y') "));
+			m_szOrderNo = pMF->ExecDML(szSQL);
+			m_wndOrderNo.EnableWindow(false);
+			m_szOrderDate = pMF->GetSysDate();
+			m_wndOrderDate.SetFocus();
+			m_szStatus = _T("O");
+			m_wndPatientName.EnableWindow(FALSE);
+			m_wndOrderList.DeleteAllItems();
+			m_wndPatientList.DeleteAllItems();
+			m_wndDrugList.DeleteAllItems();
+ 			break; 
+ 		case VM_EDIT: 
+ 			EnableControls(TRUE); 
+ 			EnableButtons(TRUE, 3, 4, -1); 
+			m_wndOrderNo.EnableWindow(false);
+ 			break; 
+ 		case VM_VIEW: 
+ 			EnableControls(FALSE); 
+ 			EnableButtons(FALSE, 3, 4, -1); 
+			m_wndOrderNo.EnableWindow(true);
+			m_wndOrderNo.SetNotEmpty(false);
+			if(m_szStatus != _T("O")){
+				m_wndPrint.EnableWindow(true);
+				m_wndPrintDeliveryDrugs.EnableWindow(true);
+			}
+			m_wndPatientName.EnableWindow(true);
+ 			break; 
+ 		case VM_NONE: 
+ 			EnableControls(FALSE); 
+ 			EnableButtons(TRUE, 0, -1); 
+ 			SetDefaultValues(); 
+			m_wndOrderNo.SetNotEmpty(false);
+			m_wndOrderNo.EnableWindow(true);
+			m_wndOrderList.DeleteAllItems();
+			m_wndPatientList.DeleteAllItems();
+			m_wndDrugList.DeleteAllItems();
+ 			break; 
+ 		}; 
+		if(m_szStatus == _T("O")){
+			m_wndAddDrug.EnableWindow(true);
+		}
+		else
+		{
+			m_wndAddDrug.EnableWindow(false);
+			m_wndDelete.EnableWindow(FALSE);
+		}
+		
+ 		UpdateData(FALSE); 
+ 		return nOldMode; 
+}
+void CHMSDailyFoodOrder::OnOrderListDblClick(){
+	
+} 
+void CHMSDailyFoodOrder::OnOrderListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+} 
+int CHMSDailyFoodOrder::OnOrderListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CHMSDailyFoodOrder::OnOrderListLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szOrderBy, szWhere;	
+	
+	m_wndOrderList.BeginLoad(); 
+	int nCount = 0;
+
+	if(m_szOrderType == _T("F")){
+		szSQL.Format(_T(" SELECT itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   groupid,") \
+		_T("   unit,") \
+		_T("   unitprice,") \
+		_T("   SUM(FoodQtyS)          AS QtyS,  ") \
+		_T("   SUM(FoodQtyT)          AS QtyT,  ") \
+		_T("   SUM(FoodQtyC)          AS QtyC,  ") \
+		_T("   SUM(FoodQty)          AS Qty,  ") \
+		_T("   SUM(FoodQty)*unitprice AS amount") \
+		_T(" FROM") \
+		_T("   (SELECT hfol_itemid AS itemid,") \
+		_T("     hfl_name2          AS foodid,") \
+		_T("     hfl_name          AS foodname,") \
+		_T("	 hfol_type		   AS type, ") \
+		_T("     hfol_groupid      AS groupid,") \
+		_T("     hfl_unit          AS unit,") \
+		_T("     hfol_unitprice    AS unitprice,    ") \
+		_T("     hfol_qtyorder     AS FoodQty,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'S' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyS,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'T' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyT,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'C' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyC    ") \
+		_T("   FROM hms_feefood") \
+		_T("   LEFT JOIN hms_feefoodline") \
+		_T("   ON(hfo_orderid=hfol_orderid)") \
+		_T("   LEFT JOIN hms_fee_list") \
+		_T("   ON(hfl_feeid        =hfol_itemid)") \
+		_T("   WHERE hfo_ordertype ='D'") \
+		_T("   AND hfo_reforder_id = %ld") \
+		_T("   )") \
+		_T(" GROUP BY groupid,") \
+		_T("   itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   unit,") \
+		_T("   unitprice") \
+		_T(" ORDER BY foodname,") \
+		_T("   unit,") \
+		_T("   unitprice"), m_nOID);
+	}
+	else
+	{
+	szSQL.Format(_T(" SELECT itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   groupid,") \
+		_T("   unit,") \
+		_T("   unitprice,") \
+		_T("   SUM(FoodQtyS)          AS QtyS,  ") \
+		_T("   SUM(FoodQtyT)          AS QtyT,  ") \
+		_T("   SUM(FoodQtyC)          AS QtyC,  ") \
+		_T("   SUM(FoodQty)          AS Qty,  ") \
+		_T("   SUM(FoodQty)*unitprice AS amount") \
+		_T(" FROM") \
+		_T("   (SELECT hfoc_itemid AS itemid,") \
+		_T("     hfl_name2          AS foodid,") \
+		_T("     hfl_name          AS foodname,") \
+		_T("	 hfoc_type		   AS type, ") \
+		_T("     hfoc_groupid      AS groupid,") \
+		_T("     hfl_unit          AS unit,") \
+		_T("     hfoc_unitprice    AS unitprice,    ") \
+		_T("     hfoc_qtyorder     AS FoodQty,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfoc_type = 'S' ") \
+		_T("		THEN hfoc_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyS,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfoc_type = 'T' ") \
+		_T("		THEN hfoc_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyT,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfoc_type = 'C' ") \
+		_T("		THEN hfoc_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyC    ") \
+		_T("   FROM hms_feefood") \
+		_T("   LEFT JOIN hms_feefoodcancel") \
+		_T("   ON(hfo_orderid=hfoc_orderid)") \
+		_T("   LEFT JOIN hms_fee_list") \
+		_T("   ON(hfl_feeid        =hfoc_itemid)") \
+		_T("   WHERE hfo_ordertype ='D'") \
+		_T("   AND hfoc_retorder_id = %ld") \
+		_T("   )") \
+		_T(" GROUP BY groupid,") \
+		_T("   itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   unit,") \
+		_T("   unitprice") \
+		_T(" ORDER BY foodname,") \
+		_T("   unit,") \
+		_T("   unitprice"), m_nOID);
+	}
+
+_fmsg(_T("%s"), szSQL);
+	nCount = rs.ExecSQL(szSQL);
+	int nIndex = 1;
+	double nTotalAmount =0;
+	int nItem = 0, nTotalQtyT =0, nTotalQtyC=0, nTotalQtyS=0, nTotalQty =0;	
+	CString tmpStr, szStorageName, szProductName;
+	while(!rs.IsEOF()){		
+		nItem++;
+		nTotalQtyS += str2int(rs.GetValue(_T("QtyS")));
+		nTotalQtyT += str2int(rs.GetValue(_T("QtyT")));
+		nTotalQtyC += str2int(rs.GetValue(_T("QtyC")));
+		nTotalQty += str2int(rs.GetValue(_T("Qty")));
+		nTotalAmount += str2double(rs.GetValue(_T("amount")));
+		m_wndOrderList.AddItems(
+			rs.GetValue(_T("foodid")),
+			rs.GetValue(_T("foodname")),
+			rs.GetValue(_T("unit")),
+			rs.GetValue(_T("QtyS")),
+			rs.GetValue(_T("QtyT")),
+			rs.GetValue(_T("QtyC")),
+			rs.GetValue(_T("Qty")),
+			rs.GetValue(_T("unitprice")),
+			rs.GetValue(_T("amount")), 
+			rs.GetValue(_T("itemid")),
+			rs.GetValue(_T("groupid")),
+			NULL);
+		rs.MoveNext();
+	}
+	if( nItem> 0){
+		TranslateString(_T("Total"), tmpStr);
+		nItem = m_wndOrderList.AddItems(
+			_T(""),
+			tmpStr,
+			_T(""),
+			ToString(nTotalQtyS),
+			ToString(nTotalQtyT),
+			ToString(nTotalQtyC),
+			ToString(nTotalQty),
+			_T(""),
+			ToString(nTotalAmount), 
+			_T(""),
+			_T(""),
+			NULL);
+		m_wndOrderList.SetItemBkColor(nItem, RGB(0, 125, 135), FALSE);
+		m_wndOrderList.SetItemTextColor(nItem, COLOR_WHITE, FALSE);
+		m_wndOrderList.MergeCell(nItem, 1, nItem, 2, DT_LEFT|DT_VCENTER|DT_SINGLELINE, false, true);
+	}
+	
+	m_wndOrderList.EndLoad(); 
+	return nCount;
+
+}
+void CHMSDailyFoodOrder::OnPatientListDblClick(){
+	
+} 
+void CHMSDailyFoodOrder::OnPatientListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	if(nNewItem < 0) return;
+	m_szIssueState = m_wndPatientList.GetItemText(nNewItem, 5);
+	m_szDoctor = m_wndPatientList.GetItemText(nNewItem, 7);
+	m_nDocumentNo = str2long(m_wndPatientList.GetItemText(nNewItem, 1));
+	m_nOrderID = str2long(m_wndPatientList.GetItemText(nNewItem, 0));
+	m_szPatientOrderDate = m_wndPatientList.GetItemText(nNewItem, 4);
+	OnDrugListLoadData();
+} 
+
+int CHMSDailyFoodOrder::OnPatientListIssueAll(){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+	CString szSQL;
+	CRecord rs(&pMF->m_db);
+
+	int nMsg = ShowMessage(14);
+	if(nMsg == IDNO)
+		return 0;
+	
+	szSQL.Format(_T("SELECT hfso_status as status ") \
+		_T("FROM hms_feefoodsheet ") \
+		_T("WHERE hfso_orderid=%ld and hfso_ordertype='T' "), m_nOID);
+	rs.ExecSQL(szSQL);
+	if(rs.IsEOF())
+		return -1;
+	rs.GetValue(_T("status"), m_szStatus);
+
+	if(m_szStatus != _T("A"))
+		return -1;
+
+
+	szSQL.Format(_T("UPDATE hms_feefood ") \
+		_T("SET hfo_orderstatus='I', hfo_updatedby='%s', hfo_updateddate=systimestamp ") \
+		_T("WHERE hfo_reforder_id=%ld AND hfo_orderstatus in('O','S','A') "),
+		pMF->GetCurrentUser(), m_nOID);
+	int ret = pMF->ExecSQL(szSQL);
+	if(ret >= 0){
+		OnPatientListLoadData();
+	}
+	return 0;
+}
+
+
+int CHMSDailyFoodOrder::OnPatientListIssue(){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+	CString szSQL;
+	CRecord rs(&pMF->m_db);
+
+	int nMsg = ShowMessage(15);
+	if(nMsg == IDNO)
+		return 0;
+
+	szSQL.Format(_T("SELECT hfso_status as status ") \
+		_T("FROM hms_feefoodsheet ") \
+		_T("WHERE hfso_orderid=%ld and hfso_ordertype='T' "), m_nOID);
+	rs.ExecSQL(szSQL);
+	if(rs.IsEOF())
+		return -1;
+	rs.GetValue(_T("status"), m_szStatus);
+
+
+	if(m_szStatus != _T("A"))
+		return -1;
+
+	return 0;
+}
+
+int CHMSDailyFoodOrder::OnPatientListRollback(){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+	CString szSQL;
+	if(m_szStatus != _T("A"))
+		return -1;
+	int nMsg = ShowMessage(16);
+	if(nMsg == IDNO)
+		return 0;
+
+	//szSQL.Format(_T("UPDATE hms_feefood SET hfo_orderstatus='A', hfo_updatedby='%s', hfo_updateddate=systimestamp ") \
+	//	_T("WHERE hfo_orderid=%ld AND hfo_orderstatus='I' AND hfo_payment<>'P'"),
+	//	pMF->GetCurrentUser(), m_nPharmaOID);
+	//int ret = pMF->ExecSQL(szSQL);
+	//if(ret >= 0){
+	//	OnPatientListLoadData();
+	//}
+	return 0;
+}
+int CHMSDailyFoodOrder::OnPatientListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd(); 
+	CRecord rs(&pMF->m_db);
+ 	CString szSQL;
+	
+	
+	if(m_wndDrugList.GetItemCount() > 0){
+		ShowMessageBox(_T("Ban phai xoa de muc truoc khi xoa benh nhan"));
+		return 0;
+	}
+
+	int nSel = m_wndPatientList.GetCurSel();
+	if(nSel < 0) return -1;
+	m_nOID = ToLong(m_wndPatientList.GetItemText(nSel, 6));	
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO) 
+ 		return -1; 
+
+	szSQL.Format(_T("SELECT hfso_status as status FROM hms_feefoodsheet WHERE hfso_orderid=%ld"), m_nOID);
+	rs.ExecSQL(szSQL);
+	if(rs.IsEOF())
+		return -1;
+	rs.GetValue(_T("status"), m_szStatus);
+
+	if(m_szStatus != _T("O"))
+		return -1;
+
+	szSQL.Format(_T("DELETE FROM hms_feefood WHERE hfo_orderid = %ld AND hfo_reforder_id=%ld "), m_nOrderID, m_nOID); 
+	//_fmsg(_T("%s"), szSQL);
+ 	int ret = str2int(pMF->ExecDML(szSQL)); 
+ 	if(ret > 0){ 
+		OnPatientListLoadData();
+		OnOrderListLoadData();
+ 	}
+	
+	return 0;
+} 
+long CHMSDailyFoodOrder::OnPatientListLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, tmpStr, szWhere;
+	int nCount = 0, nIndex =1;
+	m_wndPatientList.BeginLoad(); 
+
+	if(m_szOrderType == _T("F"))
+	{
+		szWhere.Format(_T(" and hfo_reforder_id =%ld "), m_nOID);		
+		
+		szSQL.Format(_T(" SELECT distinct hfo_docno as docno,") \
+		_T(" 	trim(hp_surname||' '||hp_midname||' '||hp_firstname) as pname,") \
+		_T(" 	hfo_roomid||'.'||hfo_bedid as bedid,") \
+		_T(" 	 Cast_Timestamp2Date(hfo_orderdate) as orderdate, hfo_createdby ") \
+		_T(" FROM hms_feefood ") \
+		_T(" LEFT JOIN hms_patient ON(hfo_patientno=hp_patientno)") \
+		_T(" WHERE hfo_ordertype ='D' %s ORDER BY docno,orderdate "), szWhere);
+	}
+	else
+	{
+		szWhere.Format(_T(" and hfoc_retorder_id =%ld "), m_nOID);			
+			
+			szSQL.Format(_T(" SELECT distinct hfo_docno as docno,") \
+		_T(" 	trim(hp_surname||' '||hp_midname||' '||hp_firstname) as pname,") \
+		_T(" 	hfo_roomid||'.'||hfo_bedid as bedid,") \
+		_T(" 	trunc_date(hfo_orderdate) as orderdate, hfo_createdby ") \
+		_T(" FROM hms_feefood ") \
+		_T(" LEFT JOIN hms_feefoodcancel") \
+		_T(" ON(hfo_orderid=hfoc_orderid)") \
+		_T(" LEFT JOIN hms_patient ON(hfo_patientno=hp_patientno)") \
+		_T(" WHERE hfo_ordertype ='D' %s ORDER BY docno,orderdate "), szWhere);
+	}
+
+	_fmsg(_T("%s"), szSQL);
+
+	nCount = rs.ExecSQL(szSQL);
+	long nDocumentNo;
+	int n = -1;
+		m_nTotalCount = 0;
+	CString szFirstName, szMidName, szSurName, szSearchName;
+	CString szFirstName2, szMidName2, szSurName2, szSearchName2, szShortName;
+	CString szNewLine, szOldLine;
+	if(!m_szPatientName.IsEmpty())
+	{
+		StringLower(m_szPatientName, szSearchName);
+		SplitName(szSearchName, szSurName, szMidName, szFirstName);
+	}
+
+	while(!rs.IsEOF()){
+		rs.GetValue(_T("pname"), tmpStr);
+		if(!m_szPatientName.IsEmpty()){
+
+			CString szPatientName;
+			
+			StringLower(tmpStr, szPatientName);
+
+			SplitName(szPatientName, szSurName2, szMidName2, szFirstName2);
+			GetShortName(szPatientName, szShortName);
+			if(szShortName != m_szPatientName)
+			{
+				if(!szFirstName.IsEmpty() && szFirstName != szFirstName2){
+					rs.MoveNext();
+					continue;
+				}
+			}
+
+				
+			if(!szSurName.IsEmpty() && szSurName != szSurName2){
+				rs.MoveNext();
+				continue;
+			}
+			if(!szMidName.IsEmpty() && szMidName2.Find(szMidName) == -1){
+				rs.MoveNext();
+				continue;
+			}
+			
+		}
+
+		rs.GetValue(_T("docno"), nDocumentNo);
+		tmpStr.Format(_T("%d"), nIndex++);
+
+		int nItem = m_wndPatientList.AddItems(
+			rs.GetValue(_T("orderid")),
+			rs.GetValue(_T("docno")),
+			rs.GetValue(_T("pname")), 
+			rs.GetValue(_T("bedid")), 
+			rs.GetValue(_T("orderdate")), 
+			rs.GetValue(_T("Status")), 
+			rs.GetValue(_T("orderid")), 
+			rs.GetValue(_T("doctor")), 
+			rs.GetValue(_T("createdby")), 
+			NULL);		
+		
+		szNewLine.Format(_T("%d"), nDocumentNo);
+		if(szNewLine !=szOldLine && !szNewLine.IsEmpty()){
+			m_nTotalCount++;
+			szOldLine = szNewLine;
+		}
+
+		rs.MoveNext();
+	}
+	m_wndPatientList.EndLoad(); 
+	if(n < 0)
+		n = m_wndPatientList.GetItemCount();
+	m_wndPatientList.SetCurSel(n);
+
+	UpdateData(false);
+	return nCount;
+}
+void CHMSDailyFoodOrder::OnDrugListDblClick(){
+	
+} 
+void CHMSDailyFoodOrder::OnDrugListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+} 
+
+int CHMSDailyFoodOrder::OnDrugListAddEntry(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	return 0;
+} 
+
+int CHMSDailyFoodOrder::OnDrugListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd(); 
+ 	CString szSQL, szItemID, szType; 
+	CRecord rs(&pMF->m_db);
+
+	long nIDX;
+	long nOrderID;
+	if(m_szStatus != _T("O"))
+		return -1;
+	
+	if(pMF->GetCurrentUser() != m_szCreatedBy)
+	{
+		CString szMsg;
+		szMsg.Format(_T("This order created by other user[%s]. Can not delete it"), m_szCreatedBy);
+		ShowMessageBox(szMsg);
+		return -1;
+	}
+
+	int nSel = m_wndDrugList.GetCurSel();
+	if(nSel < 0) return -1;
+	
+	
+	
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO) 
+ 		return -1; 
+
+	int ret = 0;
+	
+
+	nIDX = str2long(m_wndDrugList.GetItemText(nSel, 0));
+	szType = m_wndDrugList.GetItemText(nSel, 3);
+	nOrderID = str2long(m_wndDrugList.GetItemText(nSel, 7));
+	szItemID = m_wndDrugList.GetItemText(nSel, 8);
+	
+
+	szSQL.Format(_T("DELETE FROM hms_feefoodline WHERE hfol_orderid=%ld and hfol_itemid='%s' AND hfol_type ='%s' "), nOrderID, szItemID,szType); 
+	_fmsg(_T("%s"), szSQL);
+ 	int res =  pMF->ExecSQL(szSQL); 
+	if(res > 0){
+		m_wndDrugList.DeleteItem(nSel);
+		ret += res;
+	}
+	
+	szSQL.Format(_T("SELECT COUNT(*) FROM hms_feefoodline WHERE hfol_orderid=%ld "), nOrderID);
+	rs.ExecSQL(szSQL);
+	if(rs.GetIntValue() <= 0)
+	{
+		szSQL.Format(_T("DELETE FROM hms_feefood WHERE hfo_orderid=%ld "), nOrderID);
+		pMF->ExecSQL(szSQL);
+	}
+
+ 	if(ret >= 0){
+		OnOrderListLoadData();
+		if(m_wndDrugList.GetItemCount() <=0){			
+			OnPatientListLoadData();
+			OnOrderListLoadData();
+		}
+ 	}
+	return 0;
+} 
+int CHMSDailyFoodOrder::OnDrugListReturnDrug(){
+	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd(); 
+ 	CString szSQL, szItemID, szType; 
+	CRecord rs(&pMF->m_db);
+
+	long nIDX;
+	long nOrderID;
+	if(m_szStatus == _T("O"))
+		return -1;
+	
+	if(pMF->GetCurrentUser() != m_szCreatedBy)
+	{
+		CString szMsg;
+		szMsg.Format(_T("This order created by other user[%s]. Can not delete it"), m_szCreatedBy);
+		ShowMessageBox(szMsg);
+		return -1;
+	}
+
+	int nSel = m_wndDrugList.GetCurSel();
+	if(nSel < 0) return -1;
+	
+	
+	
+ 	if(ShowMessageBox(_T("\x42\x1EA1n \x63\xF3 mu\x1ED1n h\x1EE7y su\x1EA5t \x103n \x63ho \x62\x1EC7nh nh\xE2n kh\xF4ng?"), MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO) 
+ 		return -1; 
+
+	int ret = 0;
+	
+
+	nIDX = str2long(m_wndDrugList.GetItemText(nSel, 0));
+	szType = m_wndDrugList.GetItemText(nSel, 3);
+	nOrderID = str2long(m_wndDrugList.GetItemText(nSel, 7));
+	szItemID = m_wndDrugList.GetItemText(nSel, 8);
+	
+
+	szSQL.Format(_T("UPDATE hms_feefoodline  SET hfe_refstatus ='C' WHERE hfol_orderid=%ld and hfol_itemid='%s' AND hfol_type ='%s' "), nOrderID, szItemID,szType); 
+	_fmsg(_T("%s"), szSQL);
+ 	int res =  pMF->ExecSQL(szSQL);	
+ 	if(ret >= 0){
+		OnOrderListLoadData();
+ 	}
+	return 0;
+} 
+long CHMSDailyFoodOrder::OnDrugListLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, tmpStr;
+	m_wndDrugList.BeginLoad(); 
+	int nCount = 0, nIndex=1;
+
+	if(m_szOrderType == _T("F"))
+	{
+		szSQL.Format(_T(" SELECT hfl_name2 AS idx,") \
+		_T("   hfol_orderid   AS orderid,") \
+		_T("   hfo_orderstatus, hfe_refstatus,") \
+		_T("   hfl_feeid                                           AS feeid,") \
+		_T("   hfl_name                                            AS name,") \
+		_T("   hfol_type                                           AS type,") \
+		_T("   hfl_unit                                            AS unit,") \
+		_T("   hfol_unitprice                                      AS unitprice,") \
+		_T("   SUM(hfol_qtyorder)                                  AS qtyorder,") \
+		_T("   SUM(hfol_qtyissue -hfol_qtyreverse)                 AS qtyissue,") \
+		_T("   SUM((hfol_qtyissue-hfol_qtyreverse)*hfol_unitprice) AS amount") \
+		_T(" FROM hms_feefood") \
+		_T(" LEFT JOIN hms_feefoodline") \
+		_T(" ON(hfol_orderid=hfo_orderid)") \
+		_T(" LEFT JOIN hms_fee_list") \
+		_T(" ON(hfol_itemid          =hfl_feeid)") \
+		_T(" WHERE hfo_docno         =%ld") \
+		_T(" AND hfol_retorder_id    =%ld") \
+		_T(" AND Cast_Timestamp2Date(hfo_orderdate)=cast_string2date('%s')") \
+		_T(" GROUP BY hfol_orderid,") \
+		_T("   hfo_orderstatus,") \
+		_T("   hfl_name2,") \
+		_T("   hfl_feeid,") \
+		_T("   hfl_name,") \
+		_T("   hfl_unit,") \
+		_T("   hfol_type,") \
+		_T("   hfol_unitprice, hfe_refstatus") \
+		_T(" ORDER BY hfol_orderid,") \
+		_T("   hfl_name2,") \
+		_T("   hfl_name,") \
+		_T("   hfl_unit "), m_nDocumentNo,  m_nOID, m_szPatientOrderDate);
+	}
+	else
+	{
+				szSQL.Format(_T(" SELECT hfl_name2 AS idx,") \
+		_T("   hfoc_orderid   AS orderid,") \
+		_T("   hfo_orderstatus, hfe_refstatus,") \
+		_T("   hfl_feeid                                           AS feeid,") \
+		_T("   hfl_name                                            AS name,") \
+		_T("   hfoc_type                                           AS type,") \
+		_T("   hfl_unit                                            AS unit,") \
+		_T("   hfoc_unitprice                                      AS unitprice,") \
+		_T("   SUM(hfoc_qtyorder)                                  AS qtyorder,") \
+		_T("   SUM(hfoc_qtyissue -hfoc_qtyreverse)                 AS qtyissue,") \
+		_T("   SUM((hfoc_qtyissue-hfoc_qtyreverse)*hfoc_unitprice) AS amount") \
+		_T(" FROM hms_feefood") \
+		_T(" LEFT JOIN hms_feefoodcancel") \
+		_T(" ON(hfoc_orderid=hfo_orderid)") \
+		_T(" LEFT JOIN hms_fee_list") \
+		_T(" ON(hfoc_itemid          =hfl_feeid)") \
+		_T(" WHERE hfo_docno         =%ld") \
+		_T(" AND hfoc_retorder_id    =%ld") \
+		_T(" AND trunc_date(hfo_orderdate)=cast_string2date('%s')") \
+		_T(" GROUP BY hfoc_orderid,") \
+		_T("   hfo_orderstatus,") \
+		_T("   hfl_name2,") \
+		_T("   hfl_feeid,") \
+		_T("   hfl_name,") \
+		_T("   hfl_unit,") \
+		_T("   hfoc_type,") \
+		_T("   hfoc_unitprice, hfe_refstatus") \
+		_T(" ORDER BY hfoc_orderid,") \
+		_T("   hfl_name2,") \
+		_T("   hfl_name,") \
+		_T("   hfl_unit, hfoc_type DESC "), m_nDocumentNo,  m_nOID, m_szPatientOrderDate);
+
+	}
+//
+	_fmsg(_T("%s"), szSQL);
+	nCount = rs.ExecSQL(szSQL);
+	int nItem = 0;
+	float nQtyOrder, nQtyIssue;
+	CString szStatus;
+	while(!rs.IsEOF()){
+		rs.GetValue(_T("hfe_refstatus"), szStatus);
+		nItem = m_wndDrugList.AddItems(
+			rs.GetValue(_T("idx")),			
+			rs.GetValue(_T("name")), 
+			rs.GetValue(_T("unit")), 			
+			rs.GetValue(_T("type")), 
+			rs.GetValue(_T("qtyissue")), 
+			rs.GetValue(_T("unitprice")), 
+			rs.GetValue(_T("amount")),
+			rs.GetValue(_T("orderid")), 
+			rs.GetValue(_T("feeid")),
+			szStatus,
+			NULL);
+
+		if(szStatus == _T("C")){
+			m_wndDrugList.SetItemBkColor(nItem, RGB(200, 128, 0), false);
+			m_wndDrugList.SetItemTextColor(nItem, COLOR_WHITE, false);
+		}
+
+		rs.MoveNext();	
+	}
+	m_wndDrugList.EndLoad(); 
+	return nCount;
+}
+/*void CHMSDailyFoodOrder::OnOrderNoChange(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnOrderNoSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnOrderNoKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnOrderNoCheckValue(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+
+	
+	if(GetMode() == VM_VIEW || GetMode() == VM_NONE){
+		szSQL.Format(_T("SELECT HFOS_ORDERID ") \
+			_T("FROM HMS_FOODORDERSHEET ") \
+			_T("WHERE HFOS_SHEETNO='%s'"), 
+			m_szOrderNo);
+		rs.ExecSQL(szSQL);
+_tprintf(_T("\r\n%s"), szSQL);
+		if(rs.GetRecordCount() <=0)
+		{
+
+			m_wndOrderNo.SetToolTipMessage(_T("Order identify not found"));
+			SetMode(VM_NONE);
+			m_wndOrderNo.SetFocus();
+			
+			return -1;			
+		}
+		rs.GetValue(_T("HFOS_ORDERID"), m_nOID);
+		if(m_nOID > 0)
+		{
+			GetDataToScreen();
+			m_wndOrderNo.SetFocus();
+		}
+		return 1;
+	}
+	return 0;
+} 
+void CHMSDailyFoodOrder::OnFindSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	static CString szFromDate, szToDate;
+	OnOrderDateCheckValue();	
+} 
+/*void CHMSDailyFoodOrderDialog::OnPatientNameChange(){
+	
+} */
+/*void CHMSDailyFoodOrderDialog::OnPatientNameSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrderDialog::OnPatientNameKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnPatientNameCheckValue(){
+	OnPatientListLoadData();
+	return 0;
+} 
+
+/*void CHMSDailyFoodOrder::OnOrderDateChange(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnOrderDateSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnOrderDateKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnOrderDateCheckValue(){
+	UpdateData(true);
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	int n = CompareDate(m_szOrderDate, pMF->GetSysDate());
+	
+	if(n < -3 || n > 3)
+		return -1;
+	return 0;
+} 
+/*void CHMSDailyFoodOrder::OnIssueDateChange(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnIssueDateSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnIssueDateKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnIssueDateCheckValue(){
+	return 0;
+} 
+
+/*void CHMSDailyFoodOrder::OnStatusChange(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnStatusSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnStatusKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnStatusCheckValue(){
+	return 0;
+} 
+/*void CHMSDailyFoodOrder::OnPrintedChange(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnPrintedSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnPrintedKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnPrintedCheckValue(){
+	return 0;
+} 
+/*void CHMSDailyFoodOrder::OnNoteChange(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnNoteSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrder::OnNoteKillfocus(){
+	
+} */
+int CHMSDailyFoodOrder::OnNoteCheckValue(){
+	return 0;
+} 
+void CHMSDailyFoodOrder::OnAddSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnAddHMSDailyFoodOrder();
+	
+} 
+void CHMSDailyFoodOrder::OnEditSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnEditHMSDailyFoodOrder();
+} 
+void CHMSDailyFoodOrder::OnDeleteSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnDeleteHMSDailyFoodOrder();
+} 
+void CHMSDailyFoodOrder::OnSaveSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnSaveHMSDailyFoodOrder();
+} 
+void CHMSDailyFoodOrder::OnCancelSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnCancelHMSDailyFoodOrder();
+} 
+void CHMSDailyFoodOrder::OnSendSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, tmpStr, szStatus;
+	CString szLabel, szSendOrderBy,szSendByComfirm;
+	if(m_wndOrderList.GetItemCount() <= 0)
+		return;
+
+	/*if(!pMF->CheckPermission(_T("11.04")))
+	{
+		ShowMessageBox(_T("Permission Denined."), 0);
+		return;
+	}*/
+
+	szSendByComfirm.Empty();
+	szSendOrderBy.Empty();
+	pMF->m_bConfirm = true;
+	if(pMF->m_bConfirm)
+	{
+		CHMSConfirmDialog dlg;
+		dlg.m_szDoctor = pMF->m_szDoctor;		
+		if(dlg.DoModal() != IDOK)
+			return;
+		szSendOrderBy = dlg.m_szDoctor;
+	}
+
+	szSQL.Format(_T("SELECT hfos_orderstatus as status ") \
+		_T("FROM hms_foodordersheet ") \
+		_T("WHERE hfos_orderid=%ld "), m_nOID);
+	rs.ExecSQL(szSQL);
+	if(rs.IsEOF())
+		return;
+
+	rs.GetValue(_T("status"), szStatus);
+	_tprintf(_T("%s"), szStatus);
+	if(szStatus == _T("S"))
+	{
+		pMF->BeginTransaction();
+		if(m_szOrderType == _T("F"))
+		{
+			szSQL.Format(_T("UPDATE hms_foodordersheet SET hfos_updateddate=CURRENT_TIMESTAMP,hfos_updatedby='%s', hfos_approveby='%s',") \
+				_T("hfos_approvedate=CURRENT_TIMESTAMP,hfos_orderstatus='A' ") \
+				_T("WHERE hfos_orderid=%ld AND hfos_orderstatus='S' "), 
+				pMF->GetCurrentUser(),szSendOrderBy, m_nOID);
+			pMF->ExecSQL(szSQL);
+	_tprintf(_T("%s"), szSQL);
+			szSQL.Format(_T("UPDATE hms_feefood SET hfo_orderstatus='A', hfo_updateddate=CURRENT_TIMESTAMP, hfo_approvedate=CURRENT_TIMESTAMP,hfo_updatedby='%s',hfo_approveby='%s' ") \
+				_T("WHERE hfo_reforder_id=%ld and hfo_ordertype='D' "), pMF->GetCurrentUser(),szSendOrderBy,m_nOID);
+			pMF->ExecSQL(szSQL);
+		}
+		else
+		{
+			szSQL.Format(_T("HMS_FOODORDER_APPROVA_CANCEL(%ld,'%s','%s')"), m_nOID,_T(""), _T("F"));		
+			_tprintf(_T("%s"), szSQL);
+			int ret = str2long(pMF->ExecDML(szSQL));
+			if(ret > 0){
+				szSQL.Format(_T("UPDATE hms_foodordersheet SET hfos_updateddate=CURRENT_TIMESTAMP,hfos_updatedby='%s', hfos_approveby='%s',") \
+				_T("hfos_approvedate=CURRENT_TIMESTAMP,hfos_orderstatus='A' ") \
+				_T("WHERE hfos_orderid=%ld AND hfos_orderstatus='S' "), 
+				pMF->GetCurrentUser(),szSendOrderBy, m_nOID);
+				pMF->ExecSQL(szSQL);
+				_tprintf(_T("%s"), szSQL);
+			}
+		}
+
+		pMF->Commit();
+	}	
+
+	GetDataToScreen();
+} 
+void CHMSDailyFoodOrder::OnPrintSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szOrderDate;
+
+	if(m_szStatus == _T("O"))
+	{
+		ShowMessageBox(_T("Phi\x1EBFu tr\x1EA1ng th\xE1i \x111\x61ng m\x1EDF. \x42\x1EA1n ph\x1EA3i \x78\xE1\x63 nh\x1EADn g\x1EEDi phi\x1EBFu"));
+		return;
+	}
+
+	szSQL.Format(_T("SELECT DISTINCT Cast_Timestamp2Date(hfo_orderdate) as orderdate ") \
+		_T(" FROM hms_feefood ") \
+		_T(" WHERE hfo_reforder_id =%d ") \
+		_T(" ORDER BY  Cast_Timestamp2Date(hfo_orderdate)"), m_nOID);
+	rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){
+		rs.GetValue(_T("orderdate"), szOrderDate);
+		OnPrintDeliverySummery(m_nOID, szOrderDate);
+		OnPrintDelivery(m_nOID, szOrderDate);
+		rs.MoveNext();
+	}
+	
+} 
+
+
+int CHMSDailyFoodOrder::OnOrderListPrintSheetPublicity(){
+	return 0;	
+}
+int CHMSDailyFoodOrder::OnOrderListPrintSheetDate(){
+	return 0;
+}
+int CHMSDailyFoodOrder::OnAddHMSDailyFoodOrder(){
+ 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)  
+ 		return -1; 
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd(); 
+
+	if(!pMF->CheckPermission(_T("11.01")))
+	{
+		ShowMessageBox(_T("Permission Denined."), 0);
+		return 0;
+	}
+
+ 	SetMode(VM_ADD);
+	return 0; 
+}
+int CHMSDailyFoodOrder::OnEditHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW) 
+ 		return -1; 
+	
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd(); 
+	if(!pMF->CheckPermission(_T("11.02")))
+	{
+		ShowMessageBox(_T("Permission Denined."), 0);
+		return 0;
+	}
+
+	SetMode(VM_EDIT);
+
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT count(*) FROM hms_feefood WHERE hfo_reforder_id= %ld "), m_nOID);
+	rs.ExecSQL(szSQL);
+	if(rs.GetIntValue() > 0){
+		m_wndOrderDate.EnableWindow(false);
+		m_wndNote.SetFocus();
+	}
+ 	
+	return 0;  
+}
+int CHMSDailyFoodOrder::OnDeleteHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW || m_szStatus != _T("O")) 
+ 		return -1; 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd(); 
+ 	CString szSQL; 
+
+
+	if(!pMF->CheckPermission(_T("11.03")))
+	{
+		ShowMessageBox(_T("Permission Denined."), 0);
+		return 0;
+	}
+
+	if(pMF->GetCurrentUser() != m_szCreatedBy)
+	{
+		CString szMsg;
+		szMsg.Format(_T("This order created by other user[%s]. Can not delete it"), m_szCreatedBy);
+		ShowMessageBox(szMsg);
+	}
+
+	if(m_wndOrderList.GetItemCount() > 0)
+	{
+		ShowMessageBox(_T("Ban phai xoa thuoc cua cac benh nhan truoc khi xoa phieu."));
+		return -1;
+	}
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO) 
+ 		return -1; 
+ 	
+	szSQL.Format(_T("DELETE FROM hms_foodordersheet WHERE hfos_orderid = %ld AND HFOS_ORDERSTATUS = 'O'"), m_nOID); 
+ 	int ret = pMF->ExecSQL(szSQL); 
+ 	if(ret >= 0){ 
+		m_wndPatientList.DeleteAllItems();
+		m_wndDrugList.DeleteAllItems();
+		m_wndOrderList.DeleteAllItems();
+ 		SetMode(VM_NONE); 
+ 	}
+	return 0;
+}
+int CHMSDailyFoodOrder::OnSaveHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT) 
+ 		return -1; 
+	
+ 	if(!IsValidateData()) 
+ 		return -1; 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd(); 
+	CRecord rs(&pMF->m_db);
+ 	CString szSQL; 
+ 	if(GetMode() == VM_ADD){ 
+		szSQL.Format(_T("AD_NEXTSEQUENCE('M_TRANSACTION_ID_ASQ') "));
+		m_nOID = str2long(pMF->ExecDML(szSQL));	
+		if(m_nOID <=0) return -1;		
+		m_feefoodTbl.SetValue(_T("HFOS_ORDERID"), m_nOID);
+ 		szSQL = m_feefoodTbl.GetInsertSQL(); 
+ 	} 
+ 	else if(GetMode() == VM_EDIT){ 
+ 		CString szWhere; 
+ 		szWhere.Format(_T(" WHERE HFOS_ORDERID=%ld "), m_nOID); 
+ 		szSQL = m_feefoodTbl.GetUpdateSQL(_T("hfos_createdby, hfos_createddate,hfos_approveddate,hfos_orderstatus"));
+ 		szSQL += szWhere; 
+ 	} 
+ _fmsg(_T("%s"), szSQL); 
+ 	int ret = pMF->ExecSQL(szSQL); 
+ 	if(ret > 0) 
+ 	{ 	
+		if(GetMode() == VM_EDIT){
+			SetMode(VM_VIEW); 
+		}
+		else
+		{
+			GetDataToScreen();
+			SetMode(VM_VIEW); 
+			m_wndAddDrug.SetFocus();
+		}
+ 		
+		
+ 	} 
+ 	return m_nOID; 
+ 	return 0; 
+}
+void CHMSDailyFoodOrder::OnAddAutomaticSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+
+	
+} 
+
+int CHMSDailyFoodOrder::OnCancelHMSDailyFoodOrder(){
+ 	if(GetMode() == VM_EDIT) 
+ 	{ 
+ 		SetMode(VM_VIEW); 
+ 	} 
+ 	else 
+ 	{ 
+ 		SetMode(VM_NONE); 
+ 	} 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd(); 
+ 	return 0;
+} 
+int CHMSDailyFoodOrder::OnHMSDailyFoodOrderListLoadData(){
+	return 0;
+}
+
+
+void CHMSDailyFoodOrder::RefreshData(){
+	OnOrderListLoadData();
+	OnPatientListLoadData();
+}
+
+void CHMSDailyFoodOrder::LoadDrugList(long nID){
+	for (int i =0; i < m_wndPatientList.GetItemCount(); i++){
+		m_nOID = ToLong(m_wndPatientList.GetItemText(i, 6));
+		if(m_nOID = nID)
+		{
+			m_wndPatientList.SetCurSel(i);
+			break;
+		}
+	}
+}
+
+void CHMSDailyFoodOrder::OnPrintDeliverySummery(long nTransactionID, LPCTSTR lpszOrderDate){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+	CReport rpt;	
+	CString tmpStr, szSQL;
+	CRecord rs(&pMF->m_db);	
+	long nPharmaOID;
+	
+	if(!rpt.Init(_T("Reports/HMS/TM_FOODORDERSUMMERY.RPT")) )
+		return;
+
+	tmpStr.Empty();
+	StringUpper(pMF->m_CompanyInfo.sc_pname, tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("HealthService"), tmpStr);
+	StringUpper(pMF->m_CompanyInfo.sc_name, tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("HospitalName"), tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("Department"), pMF->GetDepartmentName(pMF->m_szDept));
+	tmpStr.Format(rpt.GetReportHeader()->GetValue(_T("ReportDate")), CDate::Convert(lpszOrderDate, yyyymmdd, ddmmyyyy));
+	rpt.GetReportHeader()->SetValue(_T("ReportDate"), tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("SheetNo"), m_szOrderNo);
+	//Page Header
+
+	szSQL.Format(_T(" SELECT ") \
+	_T("   foodid,") \
+	_T("   foodname,") \
+	_T("   unitprice, ") \
+	_T("   SUM(FoodQtyT/2) AS FoodQtyT,") \
+	_T("   SUM(FoodQtyC/2) AS FoodQtyC,") \
+	_T("   SUM(QUAN/2) AS QUAN,") \
+	_T("   SUM(BAOHIEM/2) AS BAOHIEM,") \
+	_T("   SUM(DICHVU/2) AS DICHVU,") \
+	_T("   SUM(CHINHSACH/2) AS CHINHSACH,") \
+	_T("   SUM(HUUTRI/2) AS HUUTRI,") \
+	_T("   SUM(BAN/2) AS BAN,") \
+	_T("   SUM((BAN+BAOHIEM+QUAN+DICHVU+CHINHSACH+HUUTRI)/2) AS TONG ") \
+	_T(" FROM") \
+	_T("   ( SELECT DISTINCT hfo_docno AS docno,") \
+	_T("     hfl_name2                 AS foodid,") \
+	_T("     hfl_name				   AS foodname,") \
+	_T("	 hfol_unitprice			   AS unitprice, ") \
+	_T("     CASE ") \
+	_T("		WHEN hfol_type = 'T' ") \
+	_T("		THEN hfol_qtyorder ") \
+	_T("		ELSE 0 ") \
+	_T("	 END AS FoodQtyT,    ") \
+	_T("     CASE ") \
+	_T("		WHEN hfol_type = 'C' ") \
+	_T("		THEN hfol_qtyorder ") \
+	_T("		ELSE 0 ") \
+	_T("	 END AS FoodQtyC,   ") \
+	_T("     CASE") \
+	_T("       WHEN ho_id IN(4,5,6,12)") \
+	_T("       THEN hfol_qtyorder ") \
+	_T("       ELSE 0") \
+	_T("     END AS BAOHIEM,") \
+	_T("     CASE") \
+	_T("       WHEN ho_type ='S'") \
+	_T("       THEN hfol_qtyorder ") \
+	_T("       ELSE 0") \
+	_T("     END AS DICHVU,") \
+	_T("     CASE") \
+	_T("       WHEN ho_id IN(1,2,10,11)") \
+	_T("       THEN hfol_qtyorder ") \
+	_T("       ELSE 0") \
+	_T("     END AS QUAN,") \
+	_T("     CASE") \
+	_T("       WHEN ho_type ='P'") \
+	_T("       THEN hfol_qtyorder ") \
+	_T("       ELSE 0") \
+	_T("     END AS CHINHSACH,") \
+	_T("     CASE") \
+	_T("       WHEN ho_id ='8'") \
+	_T("       THEN hfol_qtyorder ") \
+	_T("       ELSE 0") \
+	_T("     END AS BAN,") \
+	_T("     CASE") \
+	_T("       WHEN ho_type ='H'") \
+	_T("       THEN hfol_qtyorder ") \
+	_T("       ELSE 0") \
+	_T("     END AS HUUTRI") \
+	_T("   FROM hms_patient") \
+	_T("   LEFT JOIN hms_doc") \
+	_T("   ON(hd_patientno=hp_patientno)") \
+	_T("   LEFT JOIN hms_feefood") \
+	_T("   ON(hfo_docno=hd_docno)") \
+	_T("   LEFT JOIN hms_feefoodline") \
+	_T("   ON(hfo_orderid=hfol_orderid)") \
+	_T("   LEFT JOIN hms_fee_list") \
+	_T("   ON(hfol_itemid=hfl_feeid)") \
+	_T("   LEFT JOIN hms_treatment_record") \
+	_T("   ON(htr_docno =hfo_docno") \
+	_T("   AND htr_idx  =hfo_refidx)") \
+	_T("   LEFT JOIN hms_object") \
+	_T("   ON(CAST(ho_id AS INTEGER)=hd_object)") \
+	_T("   WHERE hfo_reforder_id    =%ld") \
+	_T("   AND Cast_Timestamp2Date(hfo_orderdate) = cast_string2date('%s') AND hfo_orderstatus IN('S','A')") \
+	_T("   )") \
+	_T(" GROUP BY foodid,") \
+	_T("   foodname,") \
+	_T("   unitprice ") \
+	_T(" ORDER BY ") \
+	_T("   foodid"), nTransactionID, lpszOrderDate);
+	
+	_fmsg(_T("%s"), szSQL);
+	
+	rs.ExecSQL(szSQL);
+	CReportSection* rptDetail;
+	CString szItemID;
+	long nItem =0;
+	double nBH, nDV, nCS, nQUAN, nHUU, nBAN, nTotal, nTotal1, nQty;
+	double nTotalBH, nTotalDV, nTotalCS, nTotalQUAN,nTotalBAN, nTotalHUU, nTrua, nToi;
+	double nPrice =0, nAmount=0, nTotalAmount =0, nTotalAmount1 =0;
+
+	int i = 1;
+
+	nTrua = nToi =0;
+	nBH=nDV= nCS= nQUAN=nHUU=nBAN=nTotal=nTotal1 =0;
+	nTotalBH=nTotalDV=nTotalCS=nTotalQUAN=nTotalBAN=nTotalHUU=0;
+
+	CString szNewLine, szOldLine;
+	while(!rs.IsEOF())
+	{	
+		rptDetail = rpt.AddDetail();
+		nItem++;		
+		tmpStr.Format(_T("%ld"), nItem);
+		rptDetail->SetValue(_T("1"), tmpStr);
+		rs.GetValue(_T("foodname"), tmpStr);
+		rptDetail->SetValue(_T("2"), tmpStr);		
+		rs.GetValue(_T("foodid"), tmpStr);
+		rptDetail->SetValue(_T("3"), tmpStr);
+		rs.GetValue(_T("foodqtyt"), tmpStr);
+		rptDetail->SetValue(_T("4"),tmpStr);
+		rs.GetValue(_T("foodqtyc"), tmpStr);
+		rptDetail->SetValue(_T("5"),tmpStr);
+		rs.GetValue(_T("UnitPrice"), tmpStr);
+		rptDetail->SetValue(_T("6"),tmpStr);
+
+		rs.GetValue(_T("QUAN"), nQUAN);
+		tmpStr.Format(_T("%0.1f"), nQUAN);		
+		nTotalQUAN += nQUAN;
+		rptDetail->SetValue(_T("7"),tmpStr);
+
+		rs.GetValue(_T("HUUTRI"), nHUU);
+		tmpStr.Format(_T("%0.1f"), nHUU);		
+		nTotalHUU += nHUU;
+		rptDetail->SetValue(_T("8"),tmpStr);		
+
+		rs.GetValue(_T("CHINHSACH"), nCS);
+		tmpStr.Format(_T("%0.1f"), nCS);		
+		nTotalCS +=nCS;
+		rptDetail->SetValue(_T("9"),tmpStr);
+		
+		rs.GetValue(_T("BAOHIEM"), nBH);
+		tmpStr.Format(_T("%0.1f"), nBH);
+		nTotalBH += nBH;		
+		rptDetail->SetValue(_T("10"),tmpStr);
+		
+		rs.GetValue(_T("DICHVU"), nDV);
+		tmpStr.Format(_T("%0.1f"), nDV);
+		nTotalDV += nDV;
+		
+		rptDetail->SetValue(_T("11"),tmpStr);
+		
+		rs.GetValue(_T("BAN"), nBAN);
+		tmpStr.Format(_T("%0.1f"), nBAN);
+		nTotalBAN += nBAN;		
+		rptDetail->SetValue(_T("12"),tmpStr);
+		
+		rs.GetValue(_T("TONG"), nQty);		
+		tmpStr.Format(_T("%0.1f"), nQty);
+		nTotal += nQty;
+		rptDetail->SetValue(_T("13"),tmpStr);
+
+		rs.GetValue(_T("UnitPrice"), nPrice);
+		nAmount = (nPrice*nQty)*2;
+		nTotalAmount += nAmount;
+		FormatCurrency(nAmount, tmpStr);
+		rptDetail->SetValue(_T("14"),tmpStr);
+		
+		rs.MoveNext();
+	}
+	
+		
+	if(nTotalAmount + nTotalAmount1 > 0){
+		rptDetail = rpt.AddDetail(rpt.GetGroupFooter(1));
+		rptDetail->SetValue(_T("s5"), nTrua);
+		rptDetail->SetValue(_T("s6"), nToi);
+		rptDetail->SetValue(_T("s7"), nTotalQUAN);
+		rptDetail->SetValue(_T("s8"), nTotalHUU);
+		rptDetail->SetValue(_T("s9"), nTotalCS);
+		rptDetail->SetValue(_T("s10"), nTotalBH);
+		rptDetail->SetValue(_T("s11"), nTotalDV);
+		rptDetail->SetValue(_T("s12"), nTotalBAN);
+		rptDetail->SetValue(_T("s13"), nTotal);
+		FormatCurrency(nTotalAmount, tmpStr);
+		rptDetail->SetValue(_T("s14"), tmpStr);
+	}
+
+	CString szDate;
+	tmpStr = pMF->GetSysDate();
+	szDate.Format(rpt.GetReportFooter()->GetValue(_T("PrintDate")), tmpStr.Mid(8, 2), tmpStr.Mid(5, 2), tmpStr.Left(4));
+	rpt.GetReportFooter()->SetValue(_T("PrintDate"), szDate);
+//	rs.GetValue(_T("doctor"), tmpStr);
+	rpt.GetReportFooter()->SetValue(_T("UserName"), pMF->GetDoctorName(pMF->GetCurrentUser()));
+	CReportItem *img = rpt.GetReportFooter()->GetItem(_T("Signature"));
+	if(img)
+	{
+		img->SetHBITMAP(pMF->GetSignatureImage(tmpStr));
+		img->SetFixedHeight(false);
+	}
+
+	rpt.PrintPreview();
+}
+
+void CHMSDailyFoodOrder::OnPrintDelivery(long nTransactionID, LPCTSTR lpszOrderDate){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+	CReport rpt;	
+	CString tmpStr, szSQL;
+	CRecord rs(&pMF->m_db);
+	
+	if(!rpt.Init(_T("Reports/HMS/TM_FOODORDER.RPT")) )
+		return;
+
+	tmpStr.Empty();
+	StringUpper(pMF->m_CompanyInfo.sc_pname, tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("HealthService"), tmpStr);
+	StringUpper(pMF->m_CompanyInfo.sc_name, tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("HospitalName"), tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("Department"), pMF->GetDepartmentName(pMF->m_szDept));
+	tmpStr.Format(rpt.GetReportHeader()->GetValue(_T("ReportDate")), CDate::Convert(lpszOrderDate, yyyymmdd, ddmmyyyy));
+	rpt.GetReportHeader()->SetValue(_T("ReportDate"), tmpStr);
+	rpt.GetReportHeader()->SetValue(_T("SheetNo"), m_szOrderNo);
+	//Page Header
+
+	szSQL.Format(_T(" SELECT docno,") \
+	_T("   foodid,") \
+	_T("   orderid,") \
+	_T("   recordno,") \
+	_T("   trua,") \
+	_T("   chieu,") \
+	_T("   pname,") \
+	_T("   age,") \
+	_T("   roomid,") \
+	_T("   bedid,") \
+	_T("   unitprice, ") \
+	_T("   SUM(BAOHIEM/2) AS BAOHIEM,") \
+	_T("   SUM(QUAN/2) AS QUAN,") \
+	_T("   SUM(DICHVU/2) AS DICHVU,") \
+	_T("   SUM(CHINHSACH/2) AS CHINHSACH,") \
+	_T("   SUM(HUUTRI/2) AS HUUTRI,") \
+	_T("   SUM(BAN/2) AS BAN,") \
+	_T("   SUM((BAOHIEM+QUAN+DICHVU+CHINHSACH+HUUTRI+BAN)/2) AS TONG ") \
+	_T(" FROM") \
+	_T("   ( SELECT DISTINCT hfo_docno AS docno,") \
+	_T("     hfl_name2                 AS foodid,") \
+	_T("     hfo_orderid               AS orderid,") \
+	_T("     htr_recordno              AS recordno,") \
+	_T("   CASE") \
+	_T("       WHEN hfol_type ='T'") \
+	_T("       THEN hfl_name2") \
+	_T("       ELSE NULL") \
+	_T("     END AS TRUA,") \
+	_T("     CASE") \
+	_T("       WHEN hfol_type ='C'") \
+	_T("       THEN hfl_name2") \
+	_T("       ELSE NULL") \
+	_T("     END          AS CHIEU,") \
+	_T("     trim(hp_surname") \
+	_T("     ||' '") \
+	_T("     ||hp_midname") \
+	_T("     ||' '") \
+	_T("     ||hp_firstname)                                AS pname,") \
+	_T("     hms_getage( Cast_Timestamp2Date(hd_admitdate), hp_birthdate) AS age,") \
+	_T("     hfo_roomid                                     AS roomid,") \
+	_T("     hfo_bedid                                      AS bedid,") \
+	_T("	 hfol_unitprice									AS unitprice, ") \
+	_T("     CASE") \
+	_T("       WHEN ho_id IN(4,5,6,12)") \
+	_T("       THEN hfol_qtyorder") \
+	_T("       ELSE 0") \
+	_T("     END AS BAOHIEM,") \
+	_T("     CASE") \
+	_T("       WHEN ho_type ='S'") \
+	_T("       THEN hfol_qtyorder") \
+	_T("       ELSE 0") \
+	_T("     END AS DICHVU,") \
+	_T("     CASE") \
+	_T("       WHEN ho_id IN(1,2,10,11)") \
+	_T("       THEN hfol_qtyorder") \
+	_T("       ELSE 0") \
+	_T("     END AS QUAN,") \
+	_T("     CASE") \
+	_T("       WHEN ho_type ='P'") \
+	_T("       THEN hfol_qtyorder") \
+	_T("       ELSE 0") \
+	_T("     END AS CHINHSACH,") \
+	_T("     CASE") \
+	_T("       WHEN ho_id ='8'") \
+	_T("       THEN hfol_qtyorder") \
+	_T("       ELSE 0") \
+	_T("     END AS BAN,") \
+	_T("     CASE") \
+	_T("       WHEN ho_type ='H'") \
+	_T("       THEN hfol_qtyorder") \
+	_T("       ELSE 0") \
+	_T("     END AS HUUTRI") \
+	_T("   FROM hms_patient") \
+	_T("   LEFT JOIN hms_doc") \
+	_T("   ON(hd_patientno=hp_patientno)") \
+	_T("   LEFT JOIN hms_feefood") \
+	_T("   ON(hfo_docno=hd_docno)") \
+	_T("   LEFT JOIN hms_feefoodline") \
+	_T("   ON(hfo_orderid=hfol_orderid)") \
+	_T("   LEFT JOIN hms_fee_list") \
+	_T("   ON(hfol_itemid=hfl_feeid)") \
+	_T("   LEFT JOIN hms_treatment_record") \
+	_T("   ON(htr_docno =hfo_docno") \
+	_T("   AND htr_idx  =hfo_refidx)") \
+	_T("   LEFT JOIN hms_object") \
+	_T("   ON(CAST(ho_id AS INTEGER)=hd_object)") \
+	_T("   WHERE hfo_reforder_id    =%ld") \
+	_T("   AND Cast_Timestamp2Date(hfo_orderdate) = cast_string2date('%s') AND hfo_orderstatus IN('S','A')") \
+	_T("   )") \
+	_T(" GROUP BY docno,") \
+	_T("   foodid,") \
+	_T("   orderid,") \
+	_T("   recordno,") \
+	_T("   pname,") \
+	_T("   age,") \
+	_T("   trua,") \
+	_T("   chieu,") \
+	_T("   roomid,") \
+	_T("   unitprice, ") \
+	_T("   bedid") \
+	_T(" ORDER BY roomid,") \
+	_T("   bedid,") \
+	_T("   pname,") \
+	_T("   docno "), nTransactionID, lpszOrderDate);
+	
+	//_fmsg(_T("%s"), szSQL);
+	rs.ExecSQL(szSQL);
+	CReportSection* rptDetail;
+	CString szItemID;
+	long nItem =0;
+	double nBH, nDV, nCS, nQUAN, nHUU, nBAN, nTotal, nTotal1;
+	double nTotalBH, nTotalDV, nTotalCS, nTotalQUAN,nTotalBAN, nTotalHUU, nTrua, nToi;
+	double nQty[15];
+	double nPrice =0, nAmount=0, nTotalAmount =0, nTotalAmount1 =0, nTotalQty=0;
+	for(int i= 0; i< 15; i++){
+		nQty[i] = 0;
+	}
+
+	int i = 1;
+
+	nTrua = nToi =0;
+	nBH=nDV= nCS= nQUAN=nHUU=nBAN=nTotal=nTotal1 =0;
+	nTotalBH=nTotalDV=nTotalCS=nTotalQUAN=nTotalBAN=nTotalHUU=0;
+	
+	CString szNewLine, szOldLine;
+	while(!rs.IsEOF())
+	{		
+		rs.GetValue(_T("docno"), szNewLine);
+		if(szNewLine != szOldLine && !szNewLine.IsEmpty()){
+			rptDetail = rpt.AddDetail();
+			nItem++;
+			nTotal=nTotal1=0;
+			nQty[7]=nQty[8]=nQty[9]=nQty[10]=nQty[11]=nQty[12]=0;
+			tmpStr.Format(_T("%ld"), nItem);
+			rptDetail->SetValue(_T("1"), tmpStr);
+			rs.GetValue(_T("pname"), tmpStr);		
+			rptDetail->SetValue(_T("2"), tmpStr);		
+			tmpStr.Format(_T("%s.%s"), rs.GetValue(_T("roomid")),rs.GetValue(_T("bedid")));
+			rptDetail->SetValue(_T("3"), tmpStr);
+			rs.GetValue(_T("RecordNo"), tmpStr);
+			rptDetail->SetValue(_T("4"),tmpStr);			
+
+			rs.GetValue(_T("QUAN"), nQUAN);
+			tmpStr.Format(_T("%0.1f"), nQUAN);
+			nQty[7]=nQUAN;
+			nTotalQUAN += nQUAN;
+			rptDetail->SetValue(_T("7"),tmpStr);
+
+			rs.GetValue(_T("HUUTRI"), nHUU);
+			tmpStr.Format(_T("%0.1f"), nHUU);
+			nQty[8]=nHUU;			
+			nTotalHUU += nHUU;
+			rptDetail->SetValue(_T("8"),tmpStr);		
+
+			rs.GetValue(_T("CHINHSACH"), nCS);
+			tmpStr.Format(_T("%0.1f"), nCS);
+			nQty[9]=nCS;
+			nTotalCS +=nCS;
+			rptDetail->SetValue(_T("9"),tmpStr);
+			
+			rs.GetValue(_T("BAOHIEM"), nBH);
+			tmpStr.Format(_T("%0.1f"), nBH);
+			nTotalBH += nBH;
+			nQty[10]=nBH;
+			rptDetail->SetValue(_T("10"),tmpStr);
+			
+			rs.GetValue(_T("DICHVU"), nDV);
+			tmpStr.Format(_T("%0.1f"), nDV);
+			nTotalDV += nDV;
+			nQty[11]=nDV;
+			rptDetail->SetValue(_T("11"),tmpStr);
+			
+			rs.GetValue(_T("BAN"), nBAN);
+			tmpStr.Format(_T("%0.1f"), nBAN);
+			nTotalBAN += nBAN;
+			nQty[12]=nBAN;
+			rptDetail->SetValue(_T("12"),tmpStr);		
+			
+			nTotal = nQty[7]+nQty[8]+nQty[9]+nQty[10]+nQty[11]+nQty[12];
+			
+			rs.GetValue(_T("trua"), tmpStr);
+			rptDetail->SetValue(_T("5"),tmpStr);
+			if(!tmpStr.IsEmpty()){
+				nTrua += nTotal;
+			}
+			
+			rs.GetValue(_T("chieu"), tmpStr);
+			rptDetail->SetValue(_T("6"),tmpStr);
+			if(!tmpStr.IsEmpty()){
+				nToi += nTotal;
+			}
+			
+
+			/*rs.GetValue(_T("UnitPrice"), nPrice);
+			nAmount = nPrice*nTotal;
+			nTotalAmount += nAmount;
+			FormatCurrency(nPrice*nTotal, tmpStr);			
+			rptDetail->SetValue(_T("13"),tmpStr);*/
+
+			szOldLine = szNewLine;
+		}
+		else
+		{	
+			rs.GetValue(_T("QUAN"), nQUAN);
+			tmpStr.Format(_T("%0.1f"), nQUAN+nQty[7]);
+			nTotalQUAN += nQUAN;
+			rptDetail->SetValue(_T("7"),tmpStr);
+
+			rs.GetValue(_T("HUUTRI"), nHUU);
+			tmpStr.Format(_T("%0.1f"), nHUU+nQty[8]);			
+			nTotalHUU += nHUU;
+			rptDetail->SetValue(_T("8"),tmpStr);		
+
+			rs.GetValue(_T("CHINHSACH"), nCS);
+			tmpStr.Format(_T("%0.1f"), nCS+nQty[9]);
+			nTotalCS +=nCS;
+			rptDetail->SetValue(_T("9"),tmpStr);
+			
+			rs.GetValue(_T("BAOHIEM"), nBH);
+			tmpStr.Format(_T("%0.1f"), nBH+nQty[10]);
+			nTotalBH += nBH;
+			rptDetail->SetValue(_T("10"),tmpStr);
+			
+			rs.GetValue(_T("DICHVU"), nDV);
+			tmpStr.Format(_T("%0.1f"), nDV+nQty[11]);
+			nTotalDV += nDV;
+			rptDetail->SetValue(_T("11"),tmpStr);
+
+			rs.GetValue(_T("BAN"), nBAN);
+			tmpStr.Format(_T("%0.1f"), nBAN+nQty[12]);
+			nTotalBAN += nBAN;
+			rptDetail->SetValue(_T("12"),tmpStr);
+			nTotal1 = nDV + nBH + nCS + nQUAN + nHUU + nBAN;
+			
+
+			rs.GetValue(_T("trua"), tmpStr);			
+			if(!tmpStr.IsEmpty()){
+				rptDetail->SetValue(_T("5"),tmpStr);
+				nTrua += nTotal1;
+			}
+			
+			rs.GetValue(_T("chieu"), tmpStr);			
+			if(!tmpStr.IsEmpty()){
+				rptDetail->SetValue(_T("6"),tmpStr);
+				nToi += nTotal1;
+			}
+
+			
+		}
+
+		rs.GetValue(_T("UnitPrice"), nPrice);
+		nAmount = nPrice*(nTotal+nTotal1)*2;
+		FormatCurrency(nAmount, tmpStr);
+		rptDetail->SetValue(_T("13"),tmpStr);		
+		rs.GetValue(_T("TONG"), nTotal);
+		nTotalQty += nTotal;	
+		rs.MoveNext();
+	}	
+	
+	nTotalAmount = (nTotalQty*nPrice)*2;
+
+	if(nTotalAmount + nTotalAmount1 > 0){
+		rptDetail = rpt.AddDetail(rpt.GetGroupFooter(1));
+		rptDetail->SetValue(_T("s5"), nTrua);
+		rptDetail->SetValue(_T("s6"), nToi);
+		rptDetail->SetValue(_T("s7"), nTotalQUAN);
+		rptDetail->SetValue(_T("s8"), nTotalHUU);
+		rptDetail->SetValue(_T("s9"), nTotalCS);
+		rptDetail->SetValue(_T("s10"), nTotalBH);
+		rptDetail->SetValue(_T("s11"), nTotalDV);
+		rptDetail->SetValue(_T("s12"), nTotalBAN);
+		FormatCurrency(nTotalAmount, tmpStr);
+		rptDetail->SetValue(_T("s13"), tmpStr);
+	}
+
+	CString szDate;
+	tmpStr = pMF->GetSysDate();
+	szDate.Format(rpt.GetReportFooter()->GetValue(_T("PrintDate")), tmpStr.Mid(8, 2), tmpStr.Mid(5, 2), tmpStr.Left(4));
+	rpt.GetReportFooter()->SetValue(_T("PrintDate"), szDate);
+//	rs.GetValue(_T("doctor"), tmpStr);
+	rpt.GetReportFooter()->SetValue(_T("UserName"), pMF->GetDoctorName(pMF->GetCurrentUser()));
+	CReportItem *img = rpt.GetReportFooter()->GetItem(_T("Signature"));
+	if(img)
+	{
+		img->SetHBITMAP(pMF->GetSignatureImage(tmpStr));
+		img->SetFixedHeight(false);
+	}
+
+	rpt.PrintPreview();
+}
+
+int CHMSDailyFoodOrder::OnExportOrderDeliveryDrug(){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+
+	return 0;
+}
+int CHMSDailyFoodOrder::OnOrderListPrintDeliveryDrug()
+{
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();	
+	return 0;
+}
+
+void CHMSDailyFoodOrder::OnAddDrugSelect(){
+	OnDrugListAddEntry();
+}
+
+void CHMSDailyFoodOrder::OnPrintDeliveryDrugsSelect(){
+
+}
+
+void CHMSDailyFoodOrder::Refresh(long nTransactionID, long nDocumentNo){
+	m_nTransactionID = nTransactionID;
+	m_nDocumentNo = nDocumentNo;
+	OnPatientListLoadData();
+	OnOrderListLoadData();
+	OnDrugListLoadData();
+	if(m_wndOrderList.GetItemCount() > 0 && m_szStatus == _T("O")){
+		m_wndSend.EnableWindow(TRUE);
+		m_wndPrint.EnableWindow(TRUE);
+		m_wndPrintDeliveryDrugs.EnableWindow(TRUE);
+	}	
+}
+
+long CHMSDailyFoodOrder::GetTransactionID(int nStorageID)
+{
+	long nTransactionID = -1;
+	for (int i =0; i < m_storages.GetCount(); i++){
+		if(nStorageID == m_storages[i])
+		{
+			nTransactionID = m_transaction_orders[i];
+			return nTransactionID;
+		}
+	}
+	return -1;
+}
\ No newline at end of file
Index: HMSDailyFoodOrder.h
===================================================================
--- HMSDailyFoodOrder.h	(revision 0)
+++ HMSDailyFoodOrder.h	(working copy)
@@ -0,0 +1,193 @@
+#ifndef HMSDailyFoodOrder_H
+#define HMSDailyFoodOrder_H
+
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Copyright(C) Viet Nam Medical Software Join Stock Company. 2005-2010. 			
+//	All rights reserved. 
+//	This program is protected by Viet nam and international treaties.  
+//	Unauthorized reproduction or distribution of this program, 
+//	or any portion of it, may result in severe civil and criminal penalties, 
+//	and will be prosecuted to the maximum extent possible under the law.
+//	This file is a part of the GUI(Graphical User Interface) class library.
+//	(c) 2006-2008 Hay Hoang Van, All rights reserved.
+//	CONTACT INFORMATION:
+//	Email  : hayhv@vimes.com.vn or hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+/////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Ban quyen cua Cong Ty Co Phan Phan Mem Y Te Viet Nam 2005-2010.
+//	Do Cuc Ban Quyen, Bo VHTT nuoc Cong hoa xa hoi chu nghia Viet Nam cap.
+//	Chuong trinh phan mem nay duoc Luat phap Viet Nam va quoc te bao ho.
+//	San xuat, su dung hoac phan phoi trai phep toan bo hoac mot phan cua phan men nay se
+//	chiu cac hinh phat va hinh su hoac dan su, co the len den muc toi da dung theo Luat qui dinh.
+//	File nay la mot phan cua thu vien lap trinh(GUI). Ban quyen cua Hoang Van Hay. 2006-2008
+//	THONG TIN LIEN HE:
+//	Email  : hayhv@vimes.com.vn hoac hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+#include "GuiUtils.h"
+#include "GuiView.h"
+#include "DbField.h"
+#include "GridListCtrl.h"
+
+
+class CHMSDailyFoodOrder : public CGuiView{
+protected:
+public:
+	long	m_nOID;	//Order ID
+	long	m_nTransactionID;
+	long	m_nOrderID;
+	long	m_nDocumentNo;
+	CArray<long,long&> m_transaction_orders;
+	CArray<int,int&> m_storages;
+	CString	m_szDoctor;
+	CString	m_szBatchNo;
+	CString	m_szPatientOrderDate;
+	CString m_szOrderType;
+
+	CString	m_szIssueState;
+	CString	m_szCreatedBy;
+	CString	m_szAutoPrintDeliveryVote;
+	CString	m_szPrintType;	
+	CString	m_szTransactionString;
+	
+	
+	void			RefreshData();
+	void			LoadDrugList(long nID);
+	CGuiGroupBox	m_wndOrderInformation;
+	CGuiGroupBox	m_wndPatientInformation;
+	CGuiGroupBox	m_wndDrugInformation;
+	CGuiGroupBox	m_wndGroupListDrug;
+	CGridListCtrl	m_wndOrderList;
+	CGridListCtrl	m_wndPatientList;
+	CGridListCtrl	m_wndDrugList;
+	CGuiLabel		m_wndOrderNoLabel;
+	CGuiTextCtrl	m_wndOrderNo;
+	CGuiButton		m_wndFind;
+	CGuiLabel		m_wndOrderDateLabel;
+	CGuiDateTimeCtrl	m_wndOrderDate;
+	CGuiLabel		m_wndIssueDateLabel;
+	CGuiDateTimeCtrl	m_wndIssueDate;
+	CGuiLabel		m_wndStatusLabel;
+	CGuiTextCtrl	m_wndStatus;
+	CGuiLabel		m_wndPrintedLabel;
+	CGuiNumberCtrl	m_wndPrinted;
+	CGuiLabel		m_wndNoteLabel;
+	CGuiTextCtrl	m_wndNote;
+	CGuiButton		m_wndAdd;
+	CGuiButton		m_wndEdit;
+	CGuiButton		m_wndDelete;
+	CGuiButton		m_wndSave;
+	CGuiButton		m_wndCancel;
+	CGuiButton		m_wndSend;
+	CGuiButton		m_wndPrint;
+	CGuiButton		m_wndPrintDeliveryDrugs;
+	CGuiButton		m_wndAddDrug;
+	CGuiButton		m_wndAddAutomatic;
+	CGuiLabel		m_wndPatientNameLabel;
+	CGuiTextCtrl	m_wndPatientName;
+	CGuiLabel		m_wndDeptLabel;
+	CGuiTextCtrl	m_wndDept;
+	CGuiLabel		m_wndTypeLabel;
+	CGuiTextCtrl	m_wndType;
+	CGuiNumberCtrl	m_wndTotalCount;
+
+
+	CString	m_szOrderNo;
+	CString	m_szOrderDate;
+	CString	m_szOrderTime;
+	CString	m_szIssueDate;
+	CString	m_szPatientName;
+	CString	m_szDept;
+
+	CString	m_szStatus;
+	CString	m_szStatusDesc;
+	long	m_nTotalCount;
+	CString	m_szNote;
+	CDbfMap	m_feefoodTbl;
+	long		OnOrderListLoadData(); 
+	void		OnOrderListSelectChange(int nOldItem, int nNewItem); 
+	void		OnOrderListDblClick(); 
+	int			OnOrderListDeleteItem(); 
+	int			OnOrderListPrintDeliveryDrug(); 
+	int			OnExportOrderDeliveryDrug();
+	int			OnOrderListPrintSheetDate();
+	int			OnOrderListPrintSheetPublicity();	
+	long		OnPatientListLoadData(); 
+	void		OnPatientListSelectChange(int nOldItem, int nNewItem); 
+	void		OnPatientListDblClick(); 
+	int			OnPatientListIssueAll(); 
+	int			OnPatientListIssue(); 
+	int			OnPatientListRollback(); 
+	int			OnPatientListDeleteItem(); 
+	long		OnDrugListLoadData(); 
+	void		OnDrugListSelectChange(int nOldItem, int nNewItem); 
+	void		OnDrugListDblClick(); 
+	int			OnDrugListAddEntry(); 
+	int			OnDrugListDeleteItem(); 
+	int			OnDrugListReturnDrug(); 
+
+	//void			OnPatientNameChange(); 
+	//void			OnPatientNameSetfocus(); 
+	//void			OnPatientNameKillfocus(); 
+	int			OnPatientNameCheckValue(); 
+
+
+	//void		OnOrderNoChange(); 
+	//void		OnOrderNoSetfocus(); 
+	//void		OnOrderNoKillfocus(); 
+	int			OnOrderNoCheckValue(); 
+	void			OnFindSelect(); 
+	//void			OnOrderDateChange(); 
+	//void			OnOrderDateSetfocus(); 
+	//void			OnOrderDateKillfocus(); 
+	int			OnOrderDateCheckValue(); 
+	//void			OnIssueDateChange(); 
+	//void			OnIssueDateSetfocus(); 
+	//void			OnIssueDateKillfocus(); 
+	int			OnIssueDateCheckValue(); 
+	//void			OnStatusChange(); 
+	//void			OnStatusSetfocus(); 
+	//void			OnStatusKillfocus(); 
+	int			OnStatusCheckValue(); 
+	//void			OnPrintedChange(); 
+	//void			OnPrintedSetfocus(); 
+	//void			OnPrintedKillfocus(); 
+	int			OnPrintedCheckValue(); 
+	//void			OnNoteChange(); 
+	//void			OnNoteSetfocus(); 
+	//void			OnNoteKillfocus(); 
+	int			OnNoteCheckValue(); 
+	void			OnAddSelect(); 
+	void			OnEditSelect(); 
+	void			OnDeleteSelect(); 
+	void			OnSaveSelect(); 
+	void			OnCancelSelect(); 
+	void			OnSendSelect(); 
+	void			OnPrintSelect(); 
+	void			OnPrintDeliveryDrugsSelect(); 
+	void			OnAddDrugSelect(); 
+	void			OnAddAutomaticSelect(); 
+	void			OnPrintDelivery(long nOID, LPCTSTR lpszOrderDate);
+	void			OnPrintDeliverySummery(long nOID, LPCTSTR lpszOrderDate);
+	
+	//CHMSDailyFoodOrder(CWnd *pParent);
+	CHMSDailyFoodOrder();
+	~CHMSDailyFoodOrder();
+	void OnCreateComponents();
+	void OnInitializeComponents();
+	void OnSetWindowEvents();
+	void OnDoDataExchange(CDataExchange* pDX);
+	void GetDataToScreen();
+	void GetScreenToData();
+	void SetDefaultValues();
+	int SetMode(int nMode);
+	int OnAddHMSDailyFoodOrder(); 
+	int OnEditHMSDailyFoodOrder(); 
+	int OnDeleteHMSDailyFoodOrder(); 
+	int OnSaveHMSDailyFoodOrder(); 
+	int OnCancelHMSDailyFoodOrder(); 
+	int OnHMSDailyFoodOrderListLoadData(); 
+	void	Refresh(long nTransactionID, long nPharmaOID);
+	long	GetTransactionID(int nStorageID);
+};
+#endif
Index: HMSDailyFoodOrderList.cpp
===================================================================
--- HMSDailyFoodOrderList.cpp	(revision 0)
+++ HMSDailyFoodOrderList.cpp	(working copy)
@@ -0,0 +1,561 @@
+#include "HMSDailyFoodOrder.h"
+#include "HMSDailyFoodOrderList.h"
+//#include "stdafx.h"
+
+#include "MainFrm.h"
+static void _OnAllStatusCheckFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnAllStatusCheck();
+}
+static void _OnOpenStatusCheckFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnOpenStatusCheck();
+}
+static void _OnSendStatusCheckFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnSendStatusCheck();
+}
+static void _OnIssueStatusCheckFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnIssueStatusCheck();
+}
+/*static void _OnFromDateChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnFromDateChange();
+} */
+/*static void _OnFromDateSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnFromDateSetfocus();} */ 
+/*static void _OnFromDateKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnFromDateKillfocus();
+} */
+static int _OnFromDateCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrderList *)pWnd)->OnFromDateCheckValue();
+} 
+/*static void _OnToDateChangeFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnToDateChange();
+} */
+/*static void _OnToDateSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnToDateSetfocus();} */ 
+/*static void _OnToDateKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnToDateKillfocus();
+} */
+static int _OnToDateCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrderList *)pWnd)->OnToDateCheckValue();
+} 
+
+
+
+static int _OnOrderNoCheckValueFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrderList *)pWnd)->OnOrderNoCheckValue();
+}
+static long _OnListLoadDataFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrderList*)pWnd)->OnListLoadData();
+} 
+static void _OnListDblClickFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList*)pWnd)->OnListDblClick();
+} 
+static void _OnListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CHMSDailyFoodOrderList*)pWnd)->OnListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnListSelectItemFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrderList*)pWnd)->OnListSelectItem();
+} 
+static void _OnPrintSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrderList *pVw = (CHMSDailyFoodOrderList *)pWnd;
+	pVw->OnPrintSelect();
+} 
+static void _OnCancelSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrderList *pVw = (CHMSDailyFoodOrderList *)pWnd;
+	pVw->OnCancelSelect();
+} 
+static int _OnAddHMSDailyDrugOrderListDialogFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrderList*)pWnd)->OnAddHMSDailyDrugOrderListDialog();
+} 
+static int _OnEditHMSDailyDrugOrderListDialogFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrderList*)pWnd)->OnEditHMSDailyDrugOrderListDialog();
+} 
+static int _OnDeleteHMSDailyDrugOrderListDialogFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrderList*)pWnd)->OnDeleteHMSDailyDrugOrderListDialog();
+} 
+static int _OnSaveHMSDailyDrugOrderListDialogFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrderList*)pWnd)->OnSaveHMSDailyDrugOrderListDialog();
+} 
+static int _OnCancelHMSDailyDrugOrderListDialogFnc(CWnd *pWnd){
+	 return ((CHMSDailyFoodOrderList*)pWnd)->OnCancelHMSDailyDrugOrderListDialog();
+} 
+static void _OnFindSelectFnc(CWnd *pWnd){
+	CHMSDailyFoodOrderList *pVw = (CHMSDailyFoodOrderList *)pWnd;
+	pVw->OnFindSelect();
+} 
+static void _OnDepartmentSelectChangeFnc(CWnd *pWnd, int nOldItemSel, int nNewItemSel){
+	((CHMSDailyFoodOrderList* )pWnd)->OnDepartmentSelectChange(nOldItemSel, nNewItemSel);
+} 
+static void _OnDepartmentSelendokFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnDepartmentSelendok();
+}
+/*static void _OnDepartmentSetfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnDepartmentKillfocus();
+}*/
+/*static void _OnDepartmentKillfocusFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnDepartmentKillfocus();
+}*/
+static long _OnDepartmentLoadDataFnc(CWnd *pWnd){
+	return ((CHMSDailyFoodOrderList *)pWnd)->OnDepartmentLoadData();
+}
+/*static void _OnDepartmentAddNewFnc(CWnd *pWnd){
+	((CHMSDailyFoodOrderList *)pWnd)->OnDepartmentAddNew();
+}*/
+
+
+CHMSDailyFoodOrderList::CHMSDailyFoodOrderList()	
+{
+	m_nDlgWidth = 1024;
+	m_nDlgHeight = 620;
+	SetDefaultValues();
+	m_bAllStatus = m_bSendStatus = m_bIssueStatus = TRUE;
+	m_bOpenStatus = TRUE;
+
+}
+CHMSDailyFoodOrderList::~CHMSDailyFoodOrderList(){
+}
+void CHMSDailyFoodOrderList::OnCreateComponents(){
+	m_wndAllStatus.Create(this, _T("All"), 10, 590, 110, 615);	
+	m_wndSendStatus.Create(this, _T("Sending"), 115, 590, 215, 615);
+	m_wndIssueStatus.Create(this, _T("Issued"), 220, 590, 320, 615);
+	m_wndOrderInformation.Create(this, _T("Order Information"), 5, 5, 1015, 60);
+	m_wndFromDateLabel.Create(this, _T("From Date"), 10, 30, 85, 55);
+	m_wndFromDate.Create(this,90, 30, 175, 55); 
+	m_wndToDateLabel.Create(this, _T("To Date"), 180, 30, 255, 55);
+	m_wndToDate.Create(this,260, 30, 345, 55);
+	m_wndDepartmentLabel.Create(this, _T("Department"), 350, 30, 415, 55);
+	m_wndDepartment.Create(this,420, 30, 675, 55); 
+	m_wndOrderNoLabel.Create(this, _T("Sheet No"), 680, 30, 755, 55);
+	m_wndOrderNo.Create(this,760, 30, 895, 55); 
+	m_wndFind.Create(this, _T("&Find"), 900, 30, 1000, 55);
+	m_wndList.Create(this, 5, 65, 1015, 585);
+	m_wndPrint.Create(this, _T("&Print"), 795, 590, 895, 615);
+	m_wndCancel.Create(this, _T("&Cancel"), 900, 590, 1000, 615);
+}
+void CHMSDailyFoodOrderList::OnInitializeComponents(){
+	CHMSMainFrame *pMF = (CHMSMainFrame*) AfxGetMainWnd();
+	EnableControls(true);
+	m_wndFromDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndFromDate.SetCheckValue(true);
+	m_wndToDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndToDate.SetCheckValue(true);
+	m_wndOrderNo.ModifyStyle(0, ES_UPPERCASE);
+
+	m_wndDepartment.InsertColumn(0, _T("ID"), CFMT_TEXT, 50);
+	m_wndDepartment.InsertColumn(1, _T("Name"), CFMT_TEXT, 250);
+
+	m_wndList.InsertColumn(0, _T(""), CFMT_NUMBER, 0);	//batch_id
+	m_wndList.InsertColumn(1, _T("ORDERNO"), CFMT_TEXT, 90);
+	m_wndList.InsertColumn(2, _T("ORDERDATE"), CFMT_DATETIME, 120);
+	m_wndList.InsertColumn(3, _T("Approval Date"), CFMT_DATETIME, 120);
+	m_wndList.InsertColumn(4, _T("Status"), CFMT_TEXT|CFMT_CENTER, 90);
+	m_wndList.InsertColumn(5, _T("Description"), CFMT_TEXT, 230);
+	m_wndList.InsertColumn(6, _T("Department"), CFMT_TEXT, 250);	
+	m_wndList.InsertColumn(7, _T("Order Type"), CFMT_TEXT, 120);
+	m_wndList.InsertColumn(8, _T("Created By"), CFMT_TEXT, 120);
+	m_wndList.GetHeaderControl()->SetItemHeight(2);	
+
+}
+void CHMSDailyFoodOrderList::OnSetWindowEvents(){
+	//m_wndFromDate.SetEvent(WE_CHANGE, _OnFromDateChangeFnc);
+	//m_wndFromDate.SetEvent(WE_SETFOCUS, _OnFromDateSetfocusFnc);
+	//m_wndFromDate.SetEvent(WE_KILLFOCUS, _OnFromDateKillfocusFnc);
+	m_wndFromDate.SetEvent(WE_CHECKVALUE, _OnFromDateCheckValueFnc);
+	//m_wndToDate.SetEvent(WE_CHANGE, _OnToDateChangeFnc);
+	//m_wndToDate.SetEvent(WE_SETFOCUS, _OnToDateSetfocusFnc);
+	//m_wndToDate.SetEvent(WE_KILLFOCUS, _OnToDateKillfocusFnc);
+	m_wndToDate.SetEvent(WE_CHECKVALUE, _OnToDateCheckValueFnc);
+	m_wndOrderNo.SetEvent(WE_CHECKVALUE, _OnOrderNoCheckValueFnc);
+	
+	m_wndDepartment.SetEvent(WE_SELENDOK, _OnDepartmentSelendokFnc);
+	//m_wndDepartment.SetEvent(WE_SETFOCUS, _OnDepartmentSetfocusFnc);
+	//m_wndDepartment.SetEvent(WE_KILLFOCUS, _OnDepartmentKillfocusFnc);
+	m_wndDepartment.SetEvent(WE_SELCHANGE, _OnDepartmentSelectChangeFnc);
+	m_wndDepartment.SetEvent(WE_LOADDATA, _OnDepartmentLoadDataFnc);
+	//m_wndDepartment.SetEvent(WE_ADDNEW, _OnDepartmentAddNewFnc);
+
+	m_wndFind.SetEvent(WE_CLICK, _OnFindSelectFnc);
+	m_wndList.SetEvent(WE_SELCHANGE, _OnListSelectChangeFnc);
+	m_wndList.SetEvent(WE_LOADDATA, _OnListLoadDataFnc);
+	m_wndList.SetEvent(WE_DBLCLICK, _OnListDblClickFnc);
+	m_wndList.AddEvent(1, _T("Select"), _OnListSelectItemFnc, 0, VK_F3, 0);
+	m_wndPrint.SetEvent(WE_CLICK, _OnPrintSelectFnc);
+	m_wndCancel.SetEvent(WE_CLICK, _OnCancelSelectFnc);
+
+	m_wndAllStatus.SetEvent(WE_CLICK, _OnAllStatusCheckFnc);
+	m_wndOpenStatus.SetEvent(WE_CLICK, _OnOpenStatusCheckFnc);
+	m_wndSendStatus.SetEvent(WE_CLICK, _OnSendStatusCheckFnc);
+	m_wndIssueStatus.SetEvent(WE_CLICK, _OnIssueStatusCheckFnc);
+
+	CHMSMainFrame *pMF = (CHMSMainFrame*) AfxGetMainWnd();
+	if(m_szFromDate.IsEmpty())
+	{
+		m_szFromDate = pMF->GetSysDate();
+		m_szToDate = m_szFromDate;
+	}
+	if(!m_szDeptKey.IsEmpty())
+	{
+	//	m_wndDept.EnableWindow(false);
+	}
+	UpdateData(false);	
+	
+	OnListLoadData();
+
+}
+void CHMSDailyFoodOrderList::OnDoDataExchange(CDataExchange* pDX){
+	DDX_TextEx(pDX, m_wndFromDate.GetDlgCtrlID(), m_szFromDate);
+	DDX_TextEx(pDX, m_wndToDate.GetDlgCtrlID(), m_szToDate);
+	DDX_TextEx(pDX, m_wndDepartment.GetDlgCtrlID(), m_szDepartmentKey);
+	DDX_Text(pDX, m_wndOrderNo.GetDlgCtrlID(), m_szOrderNo);
+	DDX_Check(pDX, m_wndAllStatus.GetDlgCtrlID(), m_bAllStatus);
+	DDX_Check(pDX, m_wndOpenStatus.GetDlgCtrlID(), m_bOpenStatus);
+	DDX_Check(pDX, m_wndSendStatus.GetDlgCtrlID(), m_bSendStatus);
+	DDX_Check(pDX, m_wndIssueStatus.GetDlgCtrlID(), m_bIssueStatus);
+}
+void CHMSDailyFoodOrderList::GetDataToScreen(){
+	CHMSMainFrame *pMF = (CHMSMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT * FROM "));
+	rs.ExecSQL(szSQL);
+
+}
+void CHMSDailyFoodOrderList::GetScreenToData(){
+	CHMSMainFrame *pMF = (CHMSMainFrame*) AfxGetMainWnd();
+
+}
+void CHMSDailyFoodOrderList::SetDefaultValues(){
+
+	m_szFromDate.Empty();
+	m_szToDate.Empty();
+	m_szFromStockKey.Empty();
+	m_szDeptKey.Empty();
+
+}
+int CHMSDailyFoodOrderList::SetMode(int nMode){ 
+ 		int nOldMode = GetMode(); 
+ 		CGuiView::SetMode(nMode); 
+ 		CHMSMainFrame *pMF = (CHMSMainFrame *) AfxGetMainWnd(); 
+ 		CString szSQL; 
+ 		CRecord rs(&pMF->m_db); 
+  		switch(nMode){ 
+ 		case VM_ADD: 
+ 			EnableControls(TRUE); 
+ 			EnableButtons(TRUE, 3, 4, -1); 
+ 			SetDefaultValues(); 
+ 			break; 
+ 		case VM_EDIT: 
+ 			EnableControls(TRUE); 
+ 			EnableButtons(TRUE, 3, 4, -1); 
+ 			break; 
+ 		case VM_VIEW: 
+ 			EnableControls(FALSE); 
+ 			EnableButtons(FALSE, 3, 4, -1); 
+ 			break; 
+ 		case VM_NONE: 
+ 			EnableControls(FALSE); 
+ 			EnableButtons(TRUE, 0, 6, -1); 
+ 			SetDefaultValues(); 
+ 			break; 
+ 		}; 
+ 		UpdateData(FALSE); 
+ 		return nOldMode; 
+ 	} 
+/*void CHMSDailyFoodOrderList::OnFromDateChange(){
+	
+} */
+/*void CHMSDailyFoodOrderList::OnFromDateSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrderList::OnFromDateKillfocus(){
+	
+} */
+int CHMSDailyFoodOrderList::OnFromDateCheckValue(){
+	OnListLoadData();
+	return 1;
+} 
+/*void CHMSDailyFoodOrderList::OnToDateChange(){
+	
+} */
+/*void CHMSDailyFoodOrderList::OnToDateSetfocus(){
+	
+} */
+/*void CHMSDailyFoodOrderList::OnToDateKillfocus(){
+	
+} */
+int CHMSDailyFoodOrderList::OnToDateCheckValue(){
+	OnListLoadData();
+	return 1;
+} 
+
+
+int CHMSDailyFoodOrderList::OnOrderNoCheckValue(){
+	OnListLoadData();
+	return 1;
+}
+
+void CHMSDailyFoodOrderList::OnListDblClick(){
+	int nSel = m_wndList.GetCurSel();
+	if(nSel < 0)
+	{
+		ShowMessageBox(_T("You must select an item"), MB_OK);
+		return;
+	}
+	long m_nID = ToLong(m_wndList.GetItemText(nSel, 0));	
+	((CHMSDailyFoodOrder*)m_wndOrder)->m_nOID = m_nOID;
+	((CHMSDailyFoodOrder*)m_wndOrder)->m_szOrderType = m_szOrderType;
+	((CHMSDailyFoodOrder*)m_wndOrder)->GetDataToScreen();
+	((CGuiTabCtrl*)GetParent())->SetCurSel(1);
+} 
+void CHMSDailyFoodOrderList::OnListSelectChange(int nOldItem, int nNewItem){
+	if(nNewItem < 0)
+		return;
+	m_nOID = str2long(m_wndList.GetItemText(nNewItem, 0));
+	m_szOrderType = m_wndList.GetItemText(nNewItem, 7);
+	
+} 
+int CHMSDailyFoodOrderList::OnListSelectItem(){
+	//OnOK();
+	return 0;
+} 
+long CHMSDailyFoodOrderList::OnListLoadData(){
+	CHMSMainFrame *pMF = (CHMSMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szWhere, szStatusFilter;
+	UpdateData(true);
+	m_wndList.BeginLoad(); 
+	int nCount = 0;
+
+			
+	if(m_bAllStatus){
+		m_bOpenStatus = m_bSendStatus = m_bIssueStatus = TRUE;
+	}	
+	if(m_bSendStatus){
+		if(!szStatusFilter.IsEmpty())
+			szStatusFilter += _T(",");
+		szStatusFilter += _T("'S'");
+	}
+	if(m_bIssueStatus){
+		if(!szStatusFilter.IsEmpty())
+			szStatusFilter += _T(",");
+		szStatusFilter += _T("'A','I'");
+	}
+	if(!szStatusFilter.IsEmpty())
+	{
+		szWhere.AppendFormat(_T(" and HFOS_ORDERSTATUS in(%s) "), szStatusFilter);
+	}
+
+	if(!m_szDepartmentKey.IsEmpty())
+	{
+		szWhere.AppendFormat(_T(" AND hfos_deptid ='%s' "), m_szDepartmentKey);
+	}
+
+	if(!m_szOrderNo.IsEmpty())
+	{
+		szWhere.AppendFormat(_T(" and hfos_sheetno='%s' "), m_szOrderNo);
+	}
+
+	szSQL.Format(_T(" SELECT HFOS_ORDERID as ORDERID,") \
+		_T(" HFOS_SHEETNO as SHEETNO, ") \
+		_T("   HFOS_ORDERDATE                     AS orderdate,") \
+		_T("   hfos_approvedate                     AS issuedate,") \
+		_T("   HFOS_DESCRIPTION as description,") \
+		_T("   HFOS_ORDERSTATUS as status,") \
+		_T("   HFOS_ORDERTYPE as ORDERTYPE,") \
+		_T("   HFOS_DEPTID AS DEPTID, ") \
+		_T("   m_transaction_getstatusdesc(HFOS_ORDERSTATUS) as statusdesc,") \
+		_T("   HFOS_CREATEDBY as createdby ") \
+		_T(" FROM HMS_FOODORDERSHEET ") \
+		_T(" WHERE Cast_Timestamp2Date(HFOS_ORDERDATE) BETWEEN cast_string2date('%s') AND cast_string2date('%s') AND HFOS_ORDERSTATUS IN('S','A')") \
+		_T(" %s ") \
+		_T(" ORDER BY ORDERID, HFOS_ORDERDATE"), m_szFromDate, m_szToDate,  szWhere);
+
+	
+	//_fmsg(_T("%s"), szSQL);
+
+	CString szStatus, tmpStr;
+	int nItem = 0;
+	int nIndex = 1;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		rs.GetValue(_T("status"), szStatus);
+		tmpStr.Format(_T("%d"), nIndex++);		
+		nItem = m_wndList.AddItems(
+			rs.GetValue(_T("ORDERID")), 
+			rs.GetValue(_T("SHEETNO")),			
+			rs.GetValue(_T("orderDate")), 
+			rs.GetValue(_T("IssueDate")), 
+			rs.GetValue(_T("statusdesc")),
+			rs.GetValue(_T("description")),			
+			pMF->GetDepartmentName(rs.GetValue(_T("deptid"))),			
+			rs.GetValue(_T("ORDERTYPE")), 
+			pMF->GetDoctorName(rs.GetValue(_T("createdby"))), 
+			NULL);
+
+		if(szStatus == _T("A")){
+			m_wndList.SetItemBkColor(nItem, COLOR_SEND, FALSE);
+			m_wndList.SetItemTextColor(nItem, COLOR_BLACK, FALSE);
+		}
+		/*else if(szStatus == _T("S")){
+			m_wndList.SetItemBkColor(nItem, COLOR_TERMINATE, FALSE);
+			m_wndList.SetItemTextColor(nItem, COLOR_WHITE, FALSE);
+		}*/
+
+		rs.MoveNext();
+	}
+	m_wndList.EndLoad(); 
+	return nCount;
+}
+void CHMSDailyFoodOrderList::OnPrintSelect(){
+	CHMSMainFrame *pMF = (CHMSMainFrame*) AfxGetMainWnd();
+	
+} 
+void CHMSDailyFoodOrderList::OnCancelSelect(){
+//	OnCancel();	
+} 
+int CHMSDailyFoodOrderList::OnAddHMSDailyDrugOrderListDialog(){
+ 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)  
+ 		return -1; 
+ 	CHMSMainFrame *pMF = (CHMSMainFrame *) AfxGetMainWnd(); 
+ 	SetMode(VM_ADD);
+	return 0;  
+} 
+int CHMSDailyFoodOrderList::OnEditHMSDailyDrugOrderListDialog(){
+ 	if(GetMode() != VM_VIEW) 
+ 		return -1; 
+ 	CHMSMainFrame *pMF = (CHMSMainFrame *) AfxGetMainWnd(); 
+ 	SetMode(VM_EDIT);
+return 0;  
+ 
+} 
+int CHMSDailyFoodOrderList::OnDeleteHMSDailyDrugOrderListDialog(){
+ 	if(GetMode() != VM_VIEW) 
+ 		return -1; 
+ 	CHMSMainFrame *pMF = (CHMSMainFrame *)AfxGetMainWnd(); 
+ 	CString szSQL; 
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO) 
+ 		return -1; 
+ 	szSQL.Format(_T("DELETE FROM  WHERE  AND") ); 
+ 	int ret = pMF->ExecSQL(szSQL); 
+ 	if(ret >= 0){ 
+ 		SetMode(VM_NONE); 
+ 		OnCancelHMSDailyDrugOrderListDialog(); 
+ 	}
+return 0;
+ } 
+int CHMSDailyFoodOrderList::OnSaveHMSDailyDrugOrderListDialog(){
+ 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT) 
+ 		return -1; 
+ 	if(!IsValidateData()) 
+ 		return -1; 
+ 	CHMSMainFrame *pMF = (CHMSMainFrame *)AfxGetMainWnd(); 
+ 	CString szSQL; 
+ 	if(GetMode() == VM_ADD){ 
+ 		//7szSQL = m_dm_purchaseorderlnTbl.GetInsertSQL(); 
+ 	} 
+ 	else if(GetMode() == VM_EDIT){ 
+ 		CString szWhere; 
+ 		szWhere.Format(_T(" WHERE")); 
+ 		//szSQL = m_dm_purchaseorderlnTbl.GetUpdateSQL(_T("createdby,createddate")); 
+ 		szSQL += szWhere; 
+ 	} 
+ //_fmsg(_T("%s"), szSQL); 
+ 	int ret = pMF->ExecSQL(szSQL); 
+ 	if(ret > 0) 
+ 	{ 
+ 		//OnHMSDailyDrugOrderListDialogListLoadData(); 
+ 		SetMode(VM_VIEW); 
+ 		 
+ 	} 
+ 	else 
+ 	{ 
+ 	} 
+ 	return ret; 
+ 	return 0; 
+}
+int CHMSDailyFoodOrderList::OnCancelHMSDailyDrugOrderListDialog(){
+ 	if(GetMode() == VM_EDIT) 
+ 	{ 
+ 		SetMode(VM_VIEW); 
+ 	} 
+ 	else 
+ 	{ 
+ 		SetMode(VM_NONE); 
+ 	} 
+ 	CHMSMainFrame *pMF = (CHMSMainFrame *)AfxGetMainWnd(); 
+ 	 
+ 	return 0;
+} 
+int CHMSDailyFoodOrderList::OnHMSDailyDrugOrderListDialogListLoadData(){
+	return 0;
+}
+
+void CHMSDailyFoodOrderList::OnAllStatusCheck(){
+	UpdateData(TRUE);
+	m_bAllStatus =TRUE;
+	m_bOpenStatus = m_bSendStatus = m_bIssueStatus = FALSE;
+    OnListLoadData();
+	UpdateData(FALSE);
+}
+void CHMSDailyFoodOrderList::OnOpenStatusCheck(){
+	UpdateData(TRUE);
+	m_bOpenStatus =TRUE;
+	m_bAllStatus = m_bSendStatus = m_bIssueStatus = FALSE;
+    OnListLoadData();
+	UpdateData(FALSE);
+}
+void CHMSDailyFoodOrderList::OnSendStatusCheck(){
+	UpdateData(TRUE);
+	m_bSendStatus =TRUE;
+	m_bAllStatus = m_bOpenStatus = m_bIssueStatus = FALSE;
+    OnListLoadData();
+	UpdateData(FALSE);
+}
+void CHMSDailyFoodOrderList::OnIssueStatusCheck(){
+	UpdateData(TRUE);
+	m_bIssueStatus =TRUE;
+	m_bAllStatus = m_bSendStatus = m_bOpenStatus = FALSE;
+    OnListLoadData();
+	UpdateData(FALSE);
+}
+void CHMSDailyFoodOrderList::OnFindSelect(){
+	OnListLoadData();
+}
+void CHMSDailyFoodOrderList::OnDepartmentSelectChange(int nOldItemSel, int nNewItemSel){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CHMSDailyFoodOrderList::OnDepartmentSelendok(){
+	 
+}
+/*void CHMSDailyFoodOrderList::OnDepartmentSetfocus(){
+	
+}*/
+/*void CHMSDailyFoodOrderList::OnDepartmentKillfocus(){
+	
+}*/
+long CHMSDailyFoodOrderList::OnDepartmentLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szWhere;
+	if(m_wndDepartment.IsSearchKey() && !m_szDepartmentKey.IsEmpty()){
+		szWhere.Format(_T(" AND sd_id='%s' "), m_szDepartmentKey);
+	};
+
+	m_wndDepartment.DeleteAllItems(); 
+	int nCount = 0;
+	szSQL.Format(_T("SELECT * FROM sys_dept WHERE sd_type in('DT') and sd_isactive='Y' %s ORDER BY sd_id"), szWhere);
+
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndDepartment.AddItems(
+			rs.GetValue(_T("sd_id")), 
+			rs.GetValue(_T("sd_name")), 
+			NULL);
+		rs.MoveNext();
+	}
+	return nCount;
+}
+/*void CHMSDailyFoodOrderList::OnDepartmentAddNew(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} */
Index: HMSDailyFoodOrderList.h
===================================================================
--- HMSDailyFoodOrderList.h	(revision 0)
+++ HMSDailyFoodOrderList.h	(working copy)
@@ -0,0 +1,111 @@
+#ifndef HMSDailyDrugOrderListDialog_H
+#define HMSDailyDrugOrderListDialog_H
+
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Copyright(C) Viet Nam Medical Software Join Stock Company. 2005-2010. 			
+//	All rights reserved. 
+//	This program is protected by Viet nam and international treaties.  
+//	Unauthorized reproduction or distribution of this program, 
+//	or any portion of it, may result in severe civil and criminal penalties, 
+//	and will be prosecuted to the maximum extent possible under the law.
+//	This file is a part of the GUI(Graphical User Interface) class library.
+//	(c) 2006-2008 Hay Hoang Van, All rights reserved.
+//	CONTACT INFORMATION:
+//	Email  : hayhv@miteco.com.vn or hayhv@yahoo.com
+//	Website: http://www.miteco.com.vn
+/////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Ban quyen cua Cong Ty Co Phan Phan Mem Y Te Viet Nam 2005-2010.
+//	Do Cuc Ban Quyen, Bo VHTT nuoc Cong hoa xa hoi chu nghia Viet Nam cap.
+//	Chuong trinh phan mem nay duoc Luat phap Viet Nam va quoc te bao ho.
+//	San xuat, su dung hoac phan phoi trai phep toan bo hoac mot phan cua phan men nay se
+//	chiu cac hinh phat va hinh su hoac dan su, co the len den muc toi da dung theo Luat qui dinh.
+//	File nay la mot phan cua thu vien lap trinh(GUI). Ban quyen cua Hoang Van Hay. 2006-2008
+//	THONG TIN LIEN HE:
+//	Email  : hayhv@miteco.com.vn hoac hayhv@yahoo.com
+//	Website: http://www.miteco.com.vn
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+#include "GuiUtils.h"
+#include "GuiView.h"
+#include "DbField.h"
+class CHMSDailyFoodOrderList : public CGuiView{
+protected:
+public:
+	long		m_nOID;
+	CWnd*		m_wndOrder;
+	CString		m_szOrderNo;
+	CString		m_szStockList;
+	CGuiGroupBox	m_wndOrderInformation;
+	CGuiLabel		m_wndFromDateLabel;
+	CGuiDateCtrl	m_wndFromDate;
+	CGuiLabel		m_wndToDateLabel;
+	CGuiDateCtrl	m_wndToDate;
+	CGuiLabel		m_wndOrderNoLabel;
+	CGuiTextCtrl	m_wndOrderNo;
+	CGuiLabel		m_wndDepartmentLabel;
+	CGuiComboBox	m_wndDepartment;
+	CGuiListCtrl	m_wndList;
+	CGuiButton		m_wndPrint;
+	CGuiButton		m_wndCancel;
+	CGuiCheckBox	m_wndAllStatus;
+	CGuiCheckBox	m_wndOpenStatus;
+	CGuiCheckBox	m_wndSendStatus;
+	CGuiCheckBox	m_wndIssueStatus;
+	CGuiButton		m_wndFind;
+	
+	CString	m_szFromDate;
+	CString	m_szToDate;
+	CString	m_szFromStockKey;
+	CString	m_szDeptKey;
+	CString	m_szOrderType;
+	CString	m_szDepartmentKey;
+//	CString	m_szOrderNo;	
+	BOOL	m_bAllStatus;
+	BOOL	m_bOpenStatus;
+	BOOL	m_bSendStatus;
+	BOOL	m_bIssueStatus;
+	CDbfMap	m_dm_purchaseorderlnTbl;
+	//void			OnFromDateChange(); 
+	//void			OnFromDateSetfocus(); 
+	//void			OnFromDateKillfocus(); 
+	int			OnFromDateCheckValue(); 
+	//void			OnToDateChange(); 
+	//void			OnToDateSetfocus(); 
+	//void			OnToDateKillfocus(); 
+	int			OnToDateCheckValue(); 
+	int			OnOrderNoCheckValue(); 
+	void			OnFindSelect();
+	long			OnListLoadData(); 
+	void			OnListSelectChange(int nOldItem, int nNewItem); 
+	void			OnListDblClick(); 
+	int				OnListSelectItem(); 
+	void			OnPrintSelect(); 
+	void			OnCancelSelect(); 
+	void			OnAllStatusCheck();
+	void			OnOpenStatusCheck();
+	void			OnSendStatusCheck();
+	void			OnIssueStatusCheck();
+	
+	void			OnDepartmentSelectChange(int nOldItemSel, int nNewItemSel); 
+	void			OnDepartmentSelendok(); 
+	//void			OnDepartmentSetfocus(); 
+	//void			OnDepartmentKillfocus(); 
+	long			OnDepartmentLoadData(); 
+	//void			OnDepartmentAddNew(); 
+	CHMSDailyFoodOrderList();
+	~CHMSDailyFoodOrderList();
+	void OnCreateComponents();
+	void OnInitializeComponents();
+	void OnSetWindowEvents();
+	void OnDoDataExchange(CDataExchange* pDX);
+	void GetDataToScreen();
+	void GetScreenToData();
+	void SetDefaultValues();
+	int SetMode(int nMode);
+	int OnAddHMSDailyDrugOrderListDialog(); 
+	int OnEditHMSDailyDrugOrderListDialog(); 
+	int OnDeleteHMSDailyDrugOrderListDialog(); 
+	int OnSaveHMSDailyDrugOrderListDialog(); 
+	int OnCancelHMSDailyDrugOrderListDialog(); 
+	int OnHMSDailyDrugOrderListDialogListLoadData(); 
+};
+#endif
Index: HMSSummaryDailyFoodOrder.cpp
===================================================================
--- HMSSummaryDailyFoodOrder.cpp	(revision 0)
+++ HMSSummaryDailyFoodOrder.cpp	(working copy)
@@ -0,0 +1,1149 @@
+#include "HMSSummaryDailyFoodOrder.h"
+#include "MainFrm.h"
+/*static void _OnFormDateChangeFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFormDateChange();
+} */
+/*static void _OnFormDateSetfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFormDateSetfocus();} */ 
+/*static void _OnFormDateKillfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFormDateKillfocus();
+} */
+static int _OnFormDateCheckValueFnc(CWnd *pWnd){
+	return ((CHMSSummaryDailyFoodOrder *)pWnd)->OnFormDateCheckValue();
+} 
+/*static void _OnToDateChangeFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnToDateChange();
+} */
+/*static void _OnToDateSetfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnToDateSetfocus();} */ 
+/*static void _OnToDateKillfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnToDateKillfocus();
+} */
+static int _OnToDateCheckValueFnc(CWnd *pWnd){
+	return ((CHMSSummaryDailyFoodOrder *)pWnd)->OnToDateCheckValue();
+} 
+static void _OnStatusSelectChangeFnc(CWnd *pWnd, int nOldItemSel, int nNewItemSel){
+	((CHMSSummaryDailyFoodOrder* )pWnd)->OnStatusSelectChange(nOldItemSel, nNewItemSel);
+} 
+static void _OnStatusSelendokFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnStatusSelendok();
+}
+/*static void _OnStatusSetfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+}*/
+/*static void _OnStatusKillfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+}*/
+static long _OnStatusLoadDataFnc(CWnd *pWnd){
+	return ((CHMSSummaryDailyFoodOrder *)pWnd)->OnStatusLoadData();
+}
+/*static void _OnStatusAddNewFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnStatusAddNew();
+}*/
+static void _OnPrintSelectFnc(CWnd *pWnd){
+	CHMSSummaryDailyFoodOrder *pVw = (CHMSSummaryDailyFoodOrder *)pWnd;
+	pVw->OnPrintSelect();
+} 
+static long _OnOrderListLoadDataFnc(CWnd *pWnd){
+	return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListLoadData();
+} 
+static void _OnOrderListDblClickFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListDblClick();
+} 
+static void _OnOrderListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnOrderListDeleteItemFnc(CWnd *pWnd){
+	 return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListDeleteItem();
+} 
+static void _OnRefreshSelectFnc(CWnd *pWnd){
+	CHMSSummaryDailyFoodOrder *pVw = (CHMSSummaryDailyFoodOrder *)pWnd;
+	pVw->OnRefreshSelect();
+} 
+static void _OnFoodTypeSelectChangeFnc(CWnd *pWnd, int nOldItemSel, int nNewItemSel){
+	((CHMSSummaryDailyFoodOrder* )pWnd)->OnFoodTypeSelectChange(nOldItemSel, nNewItemSel);
+} 
+static void _OnFoodTypeSelendokFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeSelendok();
+}
+/*static void _OnFoodTypeSetfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeKillfocus();
+}*/
+/*static void _OnFoodTypeKillfocusFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeKillfocus();
+}*/
+static long _OnFoodTypeLoadDataFnc(CWnd *pWnd){
+	return ((CHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeLoadData();
+}
+/*static void _OnFoodTypeAddNewFnc(CWnd *pWnd){
+	((CHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeAddNew();
+}*/
+static int _OnAddCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnAddCHMSSummaryDailyFoodOrder();
+} 
+static int _OnEditCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnEditCHMSSummaryDailyFoodOrder();
+} 
+static int _OnDeleteCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnDeleteCHMSSummaryDailyFoodOrder();
+} 
+static int _OnSaveCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnSaveCHMSSummaryDailyFoodOrder();
+} 
+static int _OnCancelCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CHMSSummaryDailyFoodOrder*)pWnd)->OnCancelCHMSSummaryDailyFoodOrder();
+} 
+CHMSSummaryDailyFoodOrder::CHMSSummaryDailyFoodOrder(){
+
+	m_nDlgWidth = 1029;
+	m_nDlgHeight = 635;
+	SetDefaultValues();
+}
+CHMSSummaryDailyFoodOrder::~CHMSSummaryDailyFoodOrder(){
+}
+void CHMSSummaryDailyFoodOrder::OnCreateComponents(){
+	m_wndOrderInformation.Create(this, _T("Order Information"), 5, 5, 1020, 60);
+	m_wndGroupListDrug.Create(this, _T("Food Type List"), 5, 65, 1020, 625);
+	m_wndFormDateLabel.Create(this, _T("From Date"), 10, 30, 100, 55);
+	m_wndFormDate.Create(this,105, 30, 195, 55); 
+	m_wndToDateLabel.Create(this, _T("To Date"), 200, 30, 290, 55);
+	m_wndToDate.Create(this,295, 30, 385, 55); 
+	m_wndStatusLabel.Create(this, _T("Status"), 390, 30, 480, 55);
+	m_wndStatus.Create(this,485, 30, 625, 55); 
+	m_wndPrint.Create(this, _T("&Preview"), 930, 30, 1015, 55);
+	m_wndOrderList.Create(this,10, 90, 1015, 620); 
+	m_wndRefresh.Create(this, _T("Refresh"), 845, 30, 925, 55);
+	m_wndAllDept.Create(this, _T("Summery"), 630, 30, 710, 55);
+	/*m_wndFoodTypeLabel.Create(this, _T("Food Type"), 630, 30, 710, 55);
+	m_wndFoodType.Create(this,715, 30, 840, 55); */
+
+}
+void CHMSSummaryDailyFoodOrder::OnInitializeComponents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	m_wndFormDate.SetMax(CDate(pMF->GetSysDate()));
+	//m_wndFormDate.SetCheckValue(true);
+	m_wndToDate.SetMax(CDate(pMF->GetSysDate()));
+	//m_wndToDate.SetCheckValue(true);
+	m_wndStatus.SetCheckValue(true);
+	m_wndStatus.LimitText(1024);
+	m_wndFoodType.SetCheckValue(true);
+	m_wndFoodType.LimitText(35);
+
+	m_wndStatus.InsertColumn(0, _T("ID"), CFMT_TEXT, 50);
+	m_wndStatus.InsertColumn(1, _T("Name"), CFMT_TEXT, 150);
+
+	m_wndFoodType.InsertColumn(0, _T("ID"), CFMT_TEXT, 50);
+	m_wndFoodType.InsertColumn(1, _T("Name"), CFMT_TEXT, 150);
+
+	m_wndOrderList.InsertColumn(0, _T("ID"), CFMT_TEXT|CFMT_RIGHT, 60);	//identify
+	m_wndOrderList.InsertColumn(1, _T("Desc"), CFMT_TEXT, 350);	
+	m_wndOrderList.InsertColumn(2, _T("\x42\xE1o"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(3, _T("\x43\x1EAFt"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(4, _T("Qty"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(5, _T("\x42\xE1o"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(6, _T("\x43\x1EAFt"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(7, _T("Qty"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(8, _T("\x42\xE1o"), CFMT_NUMBER, 40);		
+	m_wndOrderList.InsertColumn(9, _T("\x43\x1EAFt"), CFMT_NUMBER, 40);	
+	m_wndOrderList.InsertColumn(10, _T("Qty"), CFMT_NUMBER, 40);	
+	//m_wndOrderList.InsertColumn(11, _T("\x43\x1EAFt"), CFMT_MONEY, 40);	
+	m_wndOrderList.InsertColumn(11, _T("T\x1ED5ng s\x1ED1"), CFMT_NUMBER, 50);
+	m_wndOrderList.InsertColumn(12, _T("Price"), CFMT_MONEY, 70);
+	m_wndOrderList.InsertColumn(13, _T("Amount"), CFMT_MONEY, 90);
+	m_wndOrderList.InsertColumn(14, _T("ItemID"), CFMT_TEXT, 0);	
+	m_wndOrderList.InsertColumn(15, _T("GroupID"), CFMT_TEXT, 0);
+	m_wndOrderList.SetSortHeader(false);
+	m_wndOrderList.GetHeaderControl()->SetItemHeight(2);
+	m_wndOrderList.GetHeaderControl()->MergeCell(_T("S\xE1ng"), 0, 2, 1, 4, true);
+	m_wndOrderList.GetHeaderControl()->MergeCell(_T("Tr\x1B0\x61"), 0, 5, 1, 7, true);
+	m_wndOrderList.GetHeaderControl()->MergeCell(_T("T\x1ED1i"), 0, 8, 1, 10, true);
+	
+	m_wndOrderList.ModifyStyle(0, LVS_NOSORTHEADER);
+
+}
+void CHMSSummaryDailyFoodOrder::OnSetWindowEvents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	//m_wndFormDate.SetEvent(WE_CHANGE, _OnFormDateChangeFnc);
+	//m_wndFormDate.SetEvent(WE_SETFOCUS, _OnFormDateSetfocusFnc);
+	//m_wndFormDate.SetEvent(WE_KILLFOCUS, _OnFormDateKillfocusFnc);
+	m_wndFormDate.SetEvent(WE_CHECKVALUE, _OnFormDateCheckValueFnc);
+	//m_wndToDate.SetEvent(WE_CHANGE, _OnToDateChangeFnc);
+	//m_wndToDate.SetEvent(WE_SETFOCUS, _OnToDateSetfocusFnc);
+	//m_wndToDate.SetEvent(WE_KILLFOCUS, _OnToDateKillfocusFnc);
+	m_wndToDate.SetEvent(WE_CHECKVALUE, _OnToDateCheckValueFnc);
+	m_wndStatus.SetEvent(WE_SELENDOK, _OnStatusSelendokFnc);
+	//m_wndStatus.SetEvent(WE_SETFOCUS, _OnStatusSetfocusFnc);
+	//m_wndStatus.SetEvent(WE_KILLFOCUS, _OnStatusKillfocusFnc);
+	m_wndStatus.SetEvent(WE_SELCHANGE, _OnStatusSelectChangeFnc);
+	m_wndStatus.SetEvent(WE_LOADDATA, _OnStatusLoadDataFnc);
+	//m_wndStatus.SetEvent(WE_ADDNEW, _OnStatusAddNewFnc);
+	m_wndPrint.SetEvent(WE_CLICK, _OnPrintSelectFnc);
+	m_wndOrderList.SetEvent(WE_SELCHANGE, _OnOrderListSelectChangeFnc);
+	m_wndOrderList.SetEvent(WE_LOADDATA, _OnOrderListLoadDataFnc);
+	m_wndOrderList.SetEvent(WE_DBLCLICK, _OnOrderListDblClickFnc);
+	m_wndOrderList.AddEvent(1, _T("Delete"), _OnOrderListDeleteItemFnc, 0, VK_DELETE, 0);
+	m_wndRefresh.SetEvent(WE_CLICK, _OnRefreshSelectFnc);
+	m_wndFoodType.SetEvent(WE_SELENDOK, _OnFoodTypeSelendokFnc);
+	//m_wndFoodType.SetEvent(WE_SETFOCUS, _OnFoodTypeSetfocusFnc);
+	//m_wndFoodType.SetEvent(WE_KILLFOCUS, _OnFoodTypeKillfocusFnc);
+	m_wndFoodType.SetEvent(WE_SELCHANGE, _OnFoodTypeSelectChangeFnc);
+	m_wndFoodType.SetEvent(WE_LOADDATA, _OnFoodTypeLoadDataFnc);
+	//m_wndFoodType.SetEvent(WE_ADDNEW, _OnFoodTypeAddNewFnc);
+	AddEvent(1, _T("Add	Ctrl+A"), _OnAddCHMSSummaryDailyFoodOrderFnc, 0, 'A', VK_CONTROL);
+	AddEvent(2, _T("Edit	Ctrl+E"), _OnEditCHMSSummaryDailyFoodOrderFnc, 0, 'E', VK_CONTROL);
+	AddEvent(3, _T("Delete	Ctrl+D"), _OnDeleteCHMSSummaryDailyFoodOrderFnc, 0, 'D', VK_CONTROL);
+	AddEvent(4, _T("Save	Ctrl+S"), _OnSaveCHMSSummaryDailyFoodOrderFnc, 0, 'S', VK_CONTROL);
+	AddEvent(0, _T("-"));
+	AddEvent(5, _T("Cancel	Ctrl+T"), _OnCancelCHMSSummaryDailyFoodOrderFnc, 0, 'T', VK_CONTROL);
+	m_szFormDate = m_szToDate = pMF->GetSysDate();
+	SetMode(VM_EDIT);
+
+}
+void CHMSSummaryDailyFoodOrder::OnDoDataExchange(CDataExchange* pDX){
+	DDX_TextEx(pDX, m_wndFormDate.GetDlgCtrlID(), m_szFormDate);
+	DDX_TextEx(pDX, m_wndToDate.GetDlgCtrlID(), m_szToDate);
+	DDX_TextEx(pDX, m_wndStatus.GetDlgCtrlID(), m_szStatusKey);
+	//DDX_TextEx(pDX, m_wndFoodType.GetDlgCtrlID(), m_szFoodTypeKey);
+	DDX_Check(pDX, m_wndAllDept.GetDlgCtrlID(), m_bAllDept);
+
+}
+void CHMSSummaryDailyFoodOrder::GetDataToScreen(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT * FROM "));
+	rs.ExecSQL(szSQL);
+
+}
+void CHMSSummaryDailyFoodOrder::GetScreenToData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+
+}
+void CHMSSummaryDailyFoodOrder::SetDefaultValues(){
+
+	m_szFormDate.Empty();
+	m_szToDate.Empty();
+	m_szStatusKey.Empty();
+	m_szFoodTypeKey.Empty();
+
+}
+int CHMSSummaryDailyFoodOrder::SetMode(int nMode){
+ 		int nOldMode = GetMode();
+ 		CGuiView::SetMode(nMode);
+ 		CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 		CString szSQL;
+ 		CRecord rs(&pMF->m_db);
+  		switch(nMode){
+ 		case VM_ADD: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		case VM_EDIT: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 0, 1, -1);
+ 			break;
+ 		case VM_VIEW: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(FALSE, 3, 4, -1);
+ 			break;
+ 		case VM_NONE: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(TRUE, 0, 6, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		};
+ 		UpdateData(FALSE);
+ 		return nOldMode;
+}
+/*void CHMSSummaryDailyFoodOrder::OnFormDateChange(){
+	
+} */
+/*void CHMSSummaryDailyFoodOrder::OnFormDateSetfocus(){
+	
+} */
+/*void CHMSSummaryDailyFoodOrder::OnFormDateKillfocus(){
+	
+} */
+int CHMSSummaryDailyFoodOrder::OnFormDateCheckValue(){
+	return 0;
+} 
+/*void CHMSSummaryDailyFoodOrder::OnToDateChange(){
+	
+} */
+/*void CHMSSummaryDailyFoodOrder::OnToDateSetfocus(){
+	
+} */
+/*void CHMSSummaryDailyFoodOrder::OnToDateKillfocus(){
+	
+} */
+int CHMSSummaryDailyFoodOrder::OnToDateCheckValue(){
+	return 0;
+} 
+void CHMSSummaryDailyFoodOrder::OnStatusSelectChange(int nOldItemSel, int nNewItemSel){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CHMSSummaryDailyFoodOrder::OnStatusSelendok(){
+	 
+}
+/*void CHMSSummaryDailyFoodOrder::OnStatusSetfocus(){
+	
+}*/
+/*void CHMSSummaryDailyFoodOrder::OnStatusKillfocus(){
+	
+}*/
+long CHMSSummaryDailyFoodOrder::OnStatusLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CString szLabel;	
+	TranslateString(_T("Confirm"), szLabel);
+	m_wndStatus.AddItems(_T("S"), szLabel, NULL);
+	TranslateString(_T("Approval"), szLabel);
+	m_wndStatus.AddItems(_T("A"), szLabel, NULL);
+
+	return 0;
+}
+/*void CHMSSummaryDailyFoodOrder::OnStatusAddNew(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} */
+void CHMSSummaryDailyFoodOrder::OnPrintSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnPrintDeliverySummery(_T(""), _T(""));
+} 
+void CHMSSummaryDailyFoodOrder::OnOrderListDblClick(){
+	
+} 
+void CHMSSummaryDailyFoodOrder::OnOrderListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CHMSSummaryDailyFoodOrder::OnOrderListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CHMSSummaryDailyFoodOrder::OnOrderListLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szOrderBy, szWhere;	
+	UpdateData(true);
+	int nSubQtySC=0,nSubQtyTC=0,nSubQtyCC=0, nSubQtyS=0,nSubQtyT=0,nSubQtyC=0, nSubQty=0, nSubAmount=0,nSubTongS=0, nSubTongT=0, nSubTongC=0;
+	int nTotalQtySC,nTotalQtyTC,nTotalQtyCC, nTotalQtyS,nTotalQtyT,nTotalQtyC, nTongS, nTongT, nTongC;
+	nTotalQtySC = nTotalQtyTC = nTotalQtyCC = nTotalQtyS = nTotalQtyT = nTotalQtyC = nTongS = nTongT = nTongC=0;
+	m_szStatusKey = m_wndStatus.GetCurrent(0);
+
+	if(m_szStatusKey == _T("S"))
+	{
+		szWhere.Format(_T(" AND hfo_orderstatus = 'S' AND Cast_Timestamp2Date(hfo_orderdate) BETWEEN cast_string2date('%s') AND cast_string2date('%s') "),  m_szFormDate, m_szToDate);
+	}
+	else
+	{
+		szWhere.Format(_T(" AND hfo_orderstatus = 'A' AND Cast_Timestamp2Date(hfo_orderdate) BETWEEN cast_string2date('%s') AND cast_string2date('%s') "),  m_szFormDate, m_szToDate);
+	}
+
+	/*if(!m_szFoodTypeKey.IsEmpty()){
+		szWhere.AppendFormat(_T(" AND hfl_name2 ='%s' "), m_szFoodTypeKey);
+	}*/
+
+	m_wndOrderList.BeginLoad(); 
+	int nCount = 0;
+
+	if(m_bAllDept){
+		m_szSQL.Format(_T(" SELECT itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   groupid,") \
+		_T("   unit,") \
+		_T("   unitprice,") \
+		_T("   SUM(FoodQtyS)          AS QtyS,  ") \
+		_T("   SUM(FoodQtySC)          AS QtySC,  ") \
+		_T("   SUM(FoodQtyS-FoodQtySC) AS TongS,  ") \
+		_T("   SUM(FoodQtyT)          AS QtyT,  ") \
+		_T("   SUM(FoodQtyTC)          AS QtyTC,  ") \
+		_T("   SUM(FoodQtyT-FoodQtyTC) AS TongT,  ") \
+		_T("   SUM(FoodQtyC)          AS QtyC,  ") \
+		_T("   SUM(FoodQtyCC)          AS QtyCC,  ") \
+		_T("   SUM(FoodQtyC-FoodQtyCC) AS TongC,  ") \
+		_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))          AS Qty,  ") \
+		_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))*unitprice AS amount") \
+		_T(" FROM") \
+		_T("   (SELECT hfol_itemid AS itemid,") \
+		_T("     hfo_deptid         AS deptid,") \
+		_T("     hfl_name2          AS foodid,") \
+		_T("     hfl_name          AS foodname,") \
+		_T("	 hfol_type		   AS type, ") \
+		_T("     hfol_groupid      AS groupid,") \
+		_T("     hfl_unit          AS unit,") \
+		_T("     hfol_unitprice    AS unitprice,    ") \
+		_T("     hfol_qtyorder     AS FoodQty,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'S' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyS,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'S' AND hfe_refstatus='C'") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtySC,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'T' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyT,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'T' AND hfe_refstatus='C'") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyTC,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'C' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyC,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'C' AND hfe_refstatus='C'") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyCC    ") \
+		_T("   FROM hms_feefood") \
+		_T("   LEFT JOIN hms_feefoodline") \
+		_T("   ON(hfo_orderid=hfol_orderid)") \
+		_T("   LEFT JOIN hms_fee_list") \
+		_T("   ON(hfl_feeid        =hfol_itemid)") \
+		_T("   WHERE hfo_ordertype ='D'") \
+		_T("   %s ") \
+		_T("   )") \
+		_T(" GROUP BY groupid,") \
+		_T("   itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   unit,") \
+		_T("   unitprice") \
+		_T(" ORDER BY foodname,") \
+		_T("   unit,") \
+		_T("   unitprice"), szWhere);
+	}
+	else
+	{
+		m_szSQL.Format(_T(" SELECT itemid,") \
+			_T("   HMS_GETDEPARTMENTNAME(deptid) AS DeptName,") \
+			_T("   foodid,") \
+			_T("   foodname,") \
+			_T("   groupid,") \
+			_T("   unit,") \
+			_T("   unitprice,") \
+			_T("   SUM(FoodQtyS)          AS QtyS,  ") \
+			_T("   SUM(FoodQtySC)          AS QtySC,  ") \
+			_T("   SUM(FoodQtyS-FoodQtySC) AS TongS,  ") \
+			_T("   SUM(FoodQtyT)          AS QtyT,  ") \
+			_T("   SUM(FoodQtyTC)          AS QtyTC,  ") \
+			_T("   SUM(FoodQtyT-FoodQtyTC) AS TongT,  ") \
+			_T("   SUM(FoodQtyC)          AS QtyC,  ") \
+			_T("   SUM(FoodQtyCC)          AS QtyCC,  ") \
+			_T("   SUM(FoodQtyC-FoodQtyCC) AS TongC,  ") \
+			_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))          AS Qty,  ") \
+			_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))*unitprice AS amount") \
+			_T(" FROM") \
+			_T("   (SELECT hfol_itemid AS itemid,") \
+			_T("     hfo_deptid         AS deptid,") \
+			_T("     hfl_name2          AS foodid,") \
+			_T("     hfl_name          AS foodname,") \
+			_T("	 hfol_type		   AS type, ") \
+			_T("     hfol_groupid      AS groupid,") \
+			_T("     hfl_unit          AS unit,") \
+			_T("     hfol_unitprice    AS unitprice,    ") \
+			_T("     hfol_qtyorder     AS FoodQty,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'S' ") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyS,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'S' AND hfe_refstatus='C'") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtySC,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'T' ") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyT,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'T' AND hfe_refstatus='C'") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyTC,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'C' ") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyC,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'C' AND hfe_refstatus='C'") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyCC    ") \
+			_T("   FROM hms_feefood") \
+			_T("   LEFT JOIN hms_feefoodline") \
+			_T("   ON(hfo_orderid=hfol_orderid)") \
+			_T("   LEFT JOIN hms_fee_list") \
+			_T("   ON(hfl_feeid        =hfol_itemid)") \
+			_T("   WHERE hfo_ordertype ='D'") \
+			_T("   %s ") \
+			_T("   )") \
+			_T(" GROUP BY groupid,") \
+			_T("   itemid,") \
+			_T("   deptid,") \
+			_T("   foodid,") \
+			_T("   foodname,") \
+			_T("   unit,") \
+			_T("   unitprice") \
+			_T(" ORDER BY DeptName,foodname,") \
+			_T("   unit,") \
+			_T("   unitprice"), szWhere);
+	}
+		
+
+_fmsg(_T("%s"), m_szSQL);
+	nCount = rs.ExecSQL(m_szSQL);
+	int nIndex = 1;
+	double nTotalAmount =0;
+	int nItem = 0, nTotalQty =0;	
+	CString tmpStr, szStorageName, szProductName, szLineNew, szLineOld;
+	while(!rs.IsEOF()){		
+		nItem++;		
+		rs.GetValue(_T("deptname"), szLineNew);
+		if(szLineNew != szLineOld && !szLineNew.IsEmpty() && !m_bAllDept)
+		{
+			if( nSubQty > 0){
+				TranslateString(_T("Sum"), tmpStr);
+				nItem = m_wndOrderList.AddItems(
+					_T(""),
+					tmpStr,			
+					ToString(nSubQtyS),
+					ToString(nSubQtySC),
+					ToString(nSubTongS),
+					ToString(nSubQtyT),
+					ToString(nSubQtyTC),
+					ToString(nSubTongT),
+					ToString(nSubQtyC),
+					ToString(nSubQtyCC),
+					ToString(nSubTongC),
+					ToString(nSubQty),
+					_T(""),
+					ToString(nSubAmount), 
+					_T(""),
+					_T(""),
+					NULL);
+				m_wndOrderList.SetItemBkColor(nItem, RGB(192, 192, 192), FALSE);
+				m_wndOrderList.SetItemTextColor(nItem, RGB(0, 0, 255), FALSE);
+				m_wndOrderList.MergeCell(nItem, 1, nItem, 1, DT_LEFT|DT_VCENTER|DT_SINGLELINE, false, true);
+
+				nTotalQtySC += nSubQtySC;
+				nTotalQtyTC += nSubQtyTC;
+				nTotalQtyCC += nSubQtyCC; 
+				nTotalQtyS += nSubQtyS;
+				nTotalQtyT += nSubQtyT;
+				nTotalQtyC += nSubQtyC;
+				nTongS += nSubTongS;
+				nTongT += nSubTongT;
+				nTongC += nSubTongC;
+				nTotalQty += nSubQty;
+				nTotalAmount += nSubAmount;
+
+				nSubQtySC=0,nSubQtyTC=0,nSubQtyCC=0, nSubQtyS=0,nSubQtyT=0,nSubQtyC=0,nSubQty=0;
+				nSubAmount=nSubTongS=nSubTongT=nSubTongC=0;
+				
+			}
+			nItem = m_wndOrderList.AddItems(_T(""), szLineNew, NULL);
+			m_wndOrderList.SetItemBkColor(nItem, RGB( 64, 128, 128), FALSE);
+			m_wndOrderList.SetItemTextColor(nItem, COLOR_WHITE, FALSE);
+			m_wndOrderList.MergeCell(nItem, 1, nItem, 10, DT_LEFT|DT_VCENTER|DT_SINGLELINE, true, false);
+			szLineOld = szLineNew;
+		}
+
+
+		nSubQtyS += str2int(rs.GetValue(_T("QtyS")));
+		nSubQtySC += str2int(rs.GetValue(_T("QtySC")));
+		nSubTongS += str2int(rs.GetValue(_T("TongS")));
+
+		nSubQtyT += str2int(rs.GetValue(_T("QtyT")));
+		nSubQtyTC += str2int(rs.GetValue(_T("QtyTC")));
+		nSubTongT += str2int(rs.GetValue(_T("TongT")));
+
+		nSubQtyC += str2int(rs.GetValue(_T("QtyC")));
+		nSubQtyCC += str2int(rs.GetValue(_T("QtyCC")));
+		nSubTongC += str2int(rs.GetValue(_T("TongC")));
+
+		nSubQty += str2int(rs.GetValue(_T("Qty")));
+		nSubAmount += str2double(rs.GetValue(_T("amount")));
+
+
+		m_wndOrderList.AddItems(
+			rs.GetValue(_T("foodid")),
+			rs.GetValue(_T("foodname")),
+			rs.GetValue(_T("QtyS")),
+			rs.GetValue(_T("QtySC")),
+			rs.GetValue(_T("TongS")),
+			rs.GetValue(_T("QtyT")),
+			rs.GetValue(_T("QtyTC")),
+			rs.GetValue(_T("TongT")),
+			rs.GetValue(_T("QtyC")),
+			rs.GetValue(_T("QtyCC")),
+			rs.GetValue(_T("TongC")),
+			rs.GetValue(_T("Qty")),
+			rs.GetValue(_T("unitprice")),
+			rs.GetValue(_T("amount")),
+			rs.GetValue(_T("itemid")),
+			rs.GetValue(_T("Groupid")),
+			NULL);
+		rs.MoveNext();
+	}
+	if( nSubQty > 0){
+		TranslateString(_T("Sum"), tmpStr);
+		nItem = m_wndOrderList.AddItems(
+			_T(""),
+			tmpStr,			
+			ToString(nSubQtyS),
+			ToString(nSubQtySC),
+			ToString(nSubTongS),
+			ToString(nSubQtyT),
+			ToString(nSubQtyTC),
+			ToString(nSubTongT),
+			ToString(nSubQtyC),
+			ToString(nSubQtyCC),
+			ToString(nSubTongC),
+			ToString(nSubQty),
+			_T(""),
+			ToString(nSubAmount), 
+			_T(""),
+			_T(""),
+			NULL);
+		m_wndOrderList.SetItemBkColor(nItem, RGB(192, 192, 192), FALSE);
+		m_wndOrderList.SetItemTextColor(nItem, RGB(0, 0, 255), FALSE);
+		m_wndOrderList.MergeCell(nItem, 1, nItem, 1, DT_LEFT|DT_VCENTER|DT_SINGLELINE, false, true);
+
+		nTotalQtySC += nSubQtySC;
+		nTotalQtyTC += nSubQtyTC;
+		nTotalQtyCC += nSubQtyCC; 
+		nTotalQtyS += nSubQtyS;
+		nTotalQtyT += nSubQtyT;
+		nTotalQtyC += nSubQtyC;
+		nTongS += nSubTongS;
+		nTongT += nSubTongT;
+		nTongC += nSubTongC;
+		nTotalQty += nSubQty;
+		nTotalAmount += nSubAmount;
+	}
+
+	if(nTotalQty > 0 && !m_bAllDept){
+		TranslateString(_T("Total"), tmpStr);
+		nItem = m_wndOrderList.AddItems(
+			_T(""),
+			tmpStr,			
+			ToString(nTotalQtyS),
+			ToString(nTotalQtySC),
+			ToString(nTongS),
+			ToString(nTotalQtyT),
+			ToString(nTotalQtyTC),
+			ToString(nTongT),
+			ToString(nTotalQtyC),
+			ToString(nTotalQtyCC),
+			ToString(nTongC),
+			ToString(nTotalQty),
+			_T(""),
+			ToString(nTotalAmount), 
+			_T(""),
+			_T(""),
+			NULL);
+		m_wndOrderList.SetItemBkColor(nItem, RGB(192, 192, 192), FALSE);
+		m_wndOrderList.SetItemTextColor(nItem, RGB(0, 0, 255), FALSE);
+		m_wndOrderList.MergeCell(nItem, 1, nItem, 1, DT_LEFT|DT_VCENTER|DT_SINGLELINE, true, true);
+	}
+	
+	m_wndOrderList.EndLoad();
+
+	return nCount;
+}
+void CHMSSummaryDailyFoodOrder::OnRefreshSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	OnOrderListLoadData();
+} 
+void CHMSSummaryDailyFoodOrder::OnFoodTypeSelectChange(int nOldItemSel, int nNewItemSel){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CHMSSummaryDailyFoodOrder::OnFoodTypeSelendok(){
+	 
+}
+/*void CHMSSummaryDailyFoodOrder::OnFoodTypeSetfocus(){
+	
+}*/
+/*void CHMSSummaryDailyFoodOrder::OnFoodTypeKillfocus(){
+	
+}*/
+long CHMSSummaryDailyFoodOrder::OnFoodTypeLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szWhere;
+	if(m_wndFoodType.IsSearchKey() && str2int(m_szFoodTypeKey)){
+		szWhere.Format(_T(" AND hfl_name2='%s' "), m_szFoodTypeKey);
+	};
+	
+	m_wndFoodType.DeleteAllItems(); 
+	int nCount = 0;
+	szSQL.Format(_T(" SELECT  hfl_name2 as id,") \
+_T(" 	hfl_feeid as itemid, ") \
+_T(" 	hfl_name as name, ") \
+_T(" 	hfl_unit as unit, ") \
+_T(" 	hfl_servprice as unitprice,") \
+_T(" 	hfl_groupid as groupid, ") \
+_T(" 	hfl_typeid as typeid ") \
+_T(" FROM hms_fee_list ") \
+_T(" WHERE hfl_typeid = 'F' and hfl_groupid = 'FF000' and hfl_active='Y' %s ") \
+_T(" ORDER BY name, unit, unitprice "), szWhere );
+	nCount = rs.ExecSQL(szSQL);
+_tprintf(_T("%s"), szSQL);
+
+_fmsg(_T("%s"), szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndFoodType.AddItems(
+			rs.GetValue(_T("id")),
+			rs.GetValue(_T("name")), 
+			rs.GetValue(_T("unit")), 
+			rs.GetValue(_T("unitprice")), 
+			rs.GetValue(_T("groupid")), 
+			rs.GetValue(_T("itemid")),			
+			NULL);
+		rs.MoveNext();
+	}
+	return nCount;
+}
+/*void CHMSSummaryDailyFoodOrder::OnFoodTypeAddNew(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} */
+int CHMSSummaryDailyFoodOrder::OnAddCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_ADD);
+	return 0;
+}
+int CHMSSummaryDailyFoodOrder::OnEditCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_EDIT);
+	return 0;  
+}
+int CHMSSummaryDailyFoodOrder::OnDeleteCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO)
+ 		return -1;
+ 	szSQL.Format(_T("DELETE FROM  WHERE  AND") );
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret >= 0){
+ 		SetMode(VM_NONE);
+ 		OnCancelCHMSSummaryDailyFoodOrder();
+ 	}
+	return 0;
+}
+int CHMSSummaryDailyFoodOrder::OnSaveCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT)
+ 		return -1;
+ 	if(!IsValidateData())
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(GetMode() == VM_ADD){
+ 		//szSQL = m_tblTbl.GetInsertSQL();
+ 	}
+ 	else if(GetMode() == VM_EDIT){
+ 		CString szWhere;
+ 		szWhere.Format(_T(" WHERE"));
+ 		//szSQL = m_tblTbl.GetUpdateSQL(_T("createdby,createddate"));
+ 		szSQL += szWhere;
+ 	}
+ _fmsg(_T("%s"), szSQL);
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret > 0)
+ 	{
+ 		//OnCHMSSummaryDailyFoodOrderListLoadData();
+ 		SetMode(VM_VIEW);
+ 	}
+ 	else
+ 	{
+ 	}
+ 	return ret;
+ 	return 0;
+}
+int CHMSSummaryDailyFoodOrder::OnCancelCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() == VM_EDIT)
+ 	{
+ 		SetMode(VM_VIEW);
+ 	} 
+ 	else 
+ 	{
+ 		SetMode(VM_NONE);
+ 	} 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	return 0;
+} 
+int CHMSSummaryDailyFoodOrder::OnCHMSSummaryDailyFoodOrderListLoadData(){
+	return 0;
+}
+
+void CHMSSummaryDailyFoodOrder::OnPrintDeliverySummery(LPCTSTR lpszFromDate, LPCTSTR lpszToDate){
+	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+	CReport rpt;	
+	CString tmpStr;
+	CString szSQL, szWhere;
+	CRecord rs(&pMF->m_db);	
+	int nSubQtySC=0,nSubQtyTC=0,nSubQtyCC=0, nSubQtyS=0,nSubQtyT=0,nSubQtyC=0, nSubQty=0, nSubAmount=0,nSubTongS=0, nSubTongT=0, nSubTongC=0;
+	int nTotalQtySC,nTotalQtyTC,nTotalQtyCC, nTotalQtyS,nTotalQtyT,nTotalQtyC, nTongS, nTongT, nTongC;
+	nTotalQtySC = nTotalQtyTC = nTotalQtyCC = nTotalQtyS = nTotalQtyT = nTotalQtyC = nTongS = nTongT = nTongC=0;
+
+	UpdateData(true);
+
+	if(!rpt.Init(_T("Reports/HMS/TM_FOODORDERSUMMERYALL.RPT")) )
+		return;
+		
+	
+	m_szStatusKey = m_wndStatus.GetCurrent(0);
+
+	if(m_szStatusKey == _T("S"))
+	{
+		szWhere.Format(_T(" AND hfo_orderstatus = 'S' AND Cast_Timestamp2Date(hfo_orderdate) BETWEEN cast_string2date('%s') AND cast_string2date('%s') "),  m_szFormDate, m_szToDate);
+	}
+	else
+	{
+		szWhere.Format(_T(" AND hfo_orderstatus = 'A' AND Cast_Timestamp2Date(hfo_orderdate) BETWEEN cast_string2date('%s') AND cast_string2date('%s') "),  m_szFormDate, m_szToDate);
+	}
+	if(m_bAllDept){
+		m_szSQL.Format(_T(" SELECT itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   groupid,") \
+		_T("   unit,") \
+		_T("   unitprice,") \
+		_T("   SUM(FoodQtyS)          AS QtyS,  ") \
+		_T("   SUM(FoodQtySC)          AS QtySC,  ") \
+		_T("   SUM(FoodQtyS-FoodQtySC) AS TongS,  ") \
+		_T("   SUM(FoodQtyT)          AS QtyT,  ") \
+		_T("   SUM(FoodQtyTC)          AS QtyTC,  ") \
+		_T("   SUM(FoodQtyT-FoodQtyTC) AS TongT,  ") \
+		_T("   SUM(FoodQtyC)          AS QtyC,  ") \
+		_T("   SUM(FoodQtyCC)          AS QtyCC,  ") \
+		_T("   SUM(FoodQtyC-FoodQtyCC) AS TongC,  ") \
+		_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))          AS Qty,  ") \
+		_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))*unitprice AS amount") \
+		_T(" FROM") \
+		_T("   (SELECT hfol_itemid AS itemid,") \
+		_T("     hfo_deptid         AS deptid,") \
+		_T("     hfl_name2          AS foodid,") \
+		_T("     hfl_name          AS foodname,") \
+		_T("	 hfol_type		   AS type, ") \
+		_T("     hfol_groupid      AS groupid,") \
+		_T("     hfl_unit          AS unit,") \
+		_T("     hfol_unitprice    AS unitprice,    ") \
+		_T("     hfol_qtyorder     AS FoodQty,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'S' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyS,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'S' AND hfe_refstatus='C'") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtySC,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'T' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyT,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'T' AND hfe_refstatus='C'") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyTC,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'C' ") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyC,    ") \
+		_T("     CASE ") \
+		_T("		WHEN hfol_type = 'C' AND hfe_refstatus='C'") \
+		_T("		THEN hfol_qtyorder ") \
+		_T("		ELSE 0 ") \
+		_T("	 END AS FoodQtyCC    ") \
+		_T("   FROM hms_feefood") \
+		_T("   LEFT JOIN hms_feefoodline") \
+		_T("   ON(hfo_orderid=hfol_orderid)") \
+		_T("   LEFT JOIN hms_fee_list") \
+		_T("   ON(hfl_feeid        =hfol_itemid)") \
+		_T("   WHERE hfo_ordertype ='D'") \
+		_T("   %s ") \
+		_T("   )") \
+		_T(" GROUP BY groupid,") \
+		_T("   itemid,") \
+		_T("   foodid,") \
+		_T("   foodname,") \
+		_T("   unit,") \
+		_T("   unitprice") \
+		_T(" ORDER BY foodname,") \
+		_T("   unit,") \
+		_T("   unitprice"), szWhere);
+	}
+	else
+	{
+		m_szSQL.Format(_T(" SELECT itemid,") \
+			_T("   HMS_GETDEPARTMENTNAME(deptid) AS DeptName,") \
+			_T("   foodid,") \
+			_T("   foodname,") \
+			_T("   groupid,") \
+			_T("   unit,") \
+			_T("   unitprice,") \
+			_T("   SUM(FoodQtyS)          AS QtyS,  ") \
+			_T("   SUM(FoodQtySC)          AS QtySC,  ") \
+			_T("   SUM(FoodQtyS-FoodQtySC) AS TongS,  ") \
+			_T("   SUM(FoodQtyT)          AS QtyT,  ") \
+			_T("   SUM(FoodQtyTC)          AS QtyTC,  ") \
+			_T("   SUM(FoodQtyT-FoodQtyTC) AS TongT,  ") \
+			_T("   SUM(FoodQtyC)          AS QtyC,  ") \
+			_T("   SUM(FoodQtyCC)          AS QtyCC,  ") \
+			_T("   SUM(FoodQtyC-FoodQtyCC) AS TongC,  ") \
+			_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))          AS Qty,  ") \
+			_T("   SUM(FoodQty-(FoodQtySC+FoodQtyTC+FoodQtyCC))*unitprice AS amount") \
+			_T(" FROM") \
+			_T("   (SELECT hfol_itemid AS itemid,") \
+			_T("     hfo_deptid         AS deptid,") \
+			_T("     hfl_name2          AS foodid,") \
+			_T("     hfl_name          AS foodname,") \
+			_T("	 hfol_type		   AS type, ") \
+			_T("     hfol_groupid      AS groupid,") \
+			_T("     hfl_unit          AS unit,") \
+			_T("     hfol_unitprice    AS unitprice,    ") \
+			_T("     hfol_qtyorder     AS FoodQty,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'S' ") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyS,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'S' AND hfe_refstatus='C'") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtySC,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'T' ") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyT,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'T' AND hfe_refstatus='C'") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyTC,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'C' ") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyC,    ") \
+			_T("     CASE ") \
+			_T("		WHEN hfol_type = 'C' AND hfe_refstatus='C'") \
+			_T("		THEN hfol_qtyorder ") \
+			_T("		ELSE 0 ") \
+			_T("	 END AS FoodQtyCC    ") \
+			_T("   FROM hms_feefood") \
+			_T("   LEFT JOIN hms_feefoodline") \
+			_T("   ON(hfo_orderid=hfol_orderid)") \
+			_T("   LEFT JOIN hms_fee_list") \
+			_T("   ON(hfl_feeid        =hfol_itemid)") \
+			_T("   WHERE hfo_ordertype ='D'") \
+			_T("   %s ") \
+			_T("   )") \
+			_T(" GROUP BY groupid,") \
+			_T("   itemid,") \
+			_T("   deptid,") \
+			_T("   foodid,") \
+			_T("   foodname,") \
+			_T("   unit,") \
+			_T("   unitprice") \
+			_T(" ORDER BY DeptName,foodname,") \
+			_T("   unit,") \
+			_T("   unitprice"), szWhere);
+	}
+
+	rs.ExecSQL(m_szSQL);
+
+	CString szDate;
+	CReportSection* rptDetail;
+	CString szItemID;	
+	int nIndex = 1;
+	double nTotalAmount =0;
+	int nItem = 0, nTotalQty =0;
+	
+	szDate.Format(_T("Ng\xE0y %s"), CDate::Convert(m_szFormDate, yyyymmdd, ddmmyyyy));
+	if(m_szFormDate != m_szToDate )
+		szDate.Format(_T("T\x1EEB ng\xE0y %s \x111\x1EBFn ng\xE0y %s "), CDate::Convert(m_szFormDate, yyyymmdd, ddmmyyyy), CDate::Convert(m_szToDate, yyyymmdd, ddmmyyyy));
+
+	rpt.GetReportHeader()->SetValue(_T("ReportDate"), szDate);
+
+	CString szLineNew, szLineOld;
+	while(!rs.IsEOF())
+	{		
+		rs.GetValue(_T("deptname"), szLineNew);
+		if(szLineNew != szLineOld && !szLineNew.IsEmpty() && !m_bAllDept)
+		{
+			if(nSubQty > 0)
+			{				
+				rptDetail = rpt.AddDetail(rpt.GetGroupFooter(1));			
+				rptDetail->SetValue(_T("s3"), nSubQtyS);
+				rptDetail->SetValue(_T("s4"), nSubQtySC);
+				rptDetail->SetValue(_T("s5"), nSubTongS),
+				rptDetail->SetValue(_T("s6"), nSubQtyT);
+				rptDetail->SetValue(_T("s7"), nSubQtyTC);
+				rptDetail->SetValue(_T("s8"), nSubTongT);
+				rptDetail->SetValue(_T("s9"), nSubQtyC);
+				rptDetail->SetValue(_T("s10"), nSubQtyCC);
+				rptDetail->SetValue(_T("s11"), nSubTongC);
+				rptDetail->SetValue(_T("s12"), nSubQty);
+				rptDetail->SetValue(_T("s14"), nSubAmount);	
+
+				nTotalQtySC += nSubQtySC;
+				nTotalQtyTC += nSubQtyTC;
+				nTotalQtyCC += nSubQtyCC; 
+				nTotalQtyS += nSubQtyS;
+				nTotalQtyT += nSubQtyT;
+				nTotalQtyC += nSubQtyC;
+				nTongS += nSubTongS;
+				nTongT += nSubTongT;
+				nTongC += nSubTongC;
+				nTotalQty += nSubQty;
+				nTotalAmount += nSubAmount;
+			}
+
+			rptDetail = rpt.AddDetail(rpt.GetGroupHeader(1));
+			rptDetail->SetValue(_T("name"), szLineNew);
+			szLineOld = szLineNew;
+
+			nSubQtySC=0,nSubQtyTC=0,nSubQtyCC=0, nSubQtyS=0,nSubQtyT=0,nSubQtyC=0,nSubQty=0;
+			nSubAmount=nSubTongS=nSubTongT=nSubTongC=0;
+		}
+		
+		rptDetail = rpt.AddDetail();
+		nItem++;
+		rs.GetValue(_T("foodid"), tmpStr);
+		rptDetail->SetValue(_T("1"), tmpStr);
+		rs.GetValue(_T("foodname"), tmpStr);
+		rptDetail->SetValue(_T("2"), tmpStr);
+		rs.GetValue(_T("QtyS"), tmpStr);
+		rptDetail->SetValue(_T("3"), tmpStr);
+		rs.GetValue(_T("QtySC"), tmpStr);
+		rptDetail->SetValue(_T("4"), tmpStr);
+		rs.GetValue(_T("TongS"), tmpStr);
+		rptDetail->SetValue(_T("5"), tmpStr);
+		rs.GetValue(_T("QtyT"), tmpStr);
+		rptDetail->SetValue(_T("6"), tmpStr);
+		rs.GetValue(_T("QtyTC"), tmpStr);
+		rptDetail->SetValue(_T("7"), tmpStr);
+		rs.GetValue(_T("TongT"), tmpStr);
+		rptDetail->SetValue(_T("8"), tmpStr);
+		rs.GetValue(_T("QtyC"), tmpStr);
+		rptDetail->SetValue(_T("9"), tmpStr);		
+		rs.GetValue(_T("QtyCC"), tmpStr);
+		rptDetail->SetValue(_T("10"), tmpStr);
+		rs.GetValue(_T("TongC"), tmpStr);
+		rptDetail->SetValue(_T("11"), tmpStr);
+		rs.GetValue(_T("Qty"), tmpStr);
+		rptDetail->SetValue(_T("12"), tmpStr);
+		rs.GetValue(_T("unitprice"), tmpStr);
+		rptDetail->SetValue(_T("13"), tmpStr);
+		rs.GetValue(_T("amount"), tmpStr);
+		rptDetail->SetValue(_T("14"), tmpStr);
+
+		nSubQtyS += str2int(rs.GetValue(_T("QtyS")));
+		nSubQtySC += str2int(rs.GetValue(_T("QtySC")));
+		nSubTongS += str2int(rs.GetValue(_T("TongS")));
+
+		nSubQtyT += str2int(rs.GetValue(_T("QtyT")));
+		nSubQtyTC += str2int(rs.GetValue(_T("QtyTC")));
+		nSubTongT += str2int(rs.GetValue(_T("TongT")));
+
+		nSubQtyC += str2int(rs.GetValue(_T("QtyC")));
+		nSubQtyCC += str2int(rs.GetValue(_T("QtyCC")));
+		nSubTongC += str2int(rs.GetValue(_T("TongC")));
+
+		nSubQty += str2int(rs.GetValue(_T("Qty")));
+		nSubAmount += str2double(rs.GetValue(_T("amount")));
+
+		
+		rs.MoveNext();
+	}
+	
+
+	if(nSubQty > 0)
+	{		
+		rptDetail = rpt.AddDetail(rpt.GetGroupFooter(1));			
+		rptDetail->SetValue(_T("s3"), nSubQtyS);
+		rptDetail->SetValue(_T("s4"), nSubQtySC);
+		rptDetail->SetValue(_T("s5"), nSubTongS),
+		rptDetail->SetValue(_T("s6"), nSubQtyT);
+		rptDetail->SetValue(_T("s7"), nSubQtyTC);
+		rptDetail->SetValue(_T("s8"), nSubTongT);
+		rptDetail->SetValue(_T("s9"), nSubQtyC);
+		rptDetail->SetValue(_T("s10"), nSubQtyCC);
+		rptDetail->SetValue(_T("s11"), nSubTongC);
+		rptDetail->SetValue(_T("s12"), nSubQty);			
+		rptDetail->SetValue(_T("s14"), nSubAmount);	
+
+		nTotalQtySC += nSubQtySC;
+		nTotalQtyTC += nSubQtyTC;
+		nTotalQtyCC += nSubQtyCC; 
+		nTotalQtyS += nSubQtyS;
+		nTotalQtyT += nSubQtyT;
+		nTotalQtyC += nSubQtyC;
+		nTongS += nSubTongS;
+		nTongT += nSubTongT;
+		nTongC += nSubTongC;
+		nTotalQty += nSubQty;
+		nTotalAmount += nSubAmount;		
+	}
+
+	if(nTotalQty > 0 && !m_bAllDept)
+	{		
+		rptDetail = rpt.AddDetail(rpt.GetGroupFooter(1));			
+		rptDetail->SetValue(_T("s3"), nTotalQtyS);
+		rptDetail->SetValue(_T("s4"), nTotalQtySC);
+		rptDetail->SetValue(_T("s5"), nTongS),
+		rptDetail->SetValue(_T("s6"), nTotalQtyT);
+		rptDetail->SetValue(_T("s7"), nTotalQtyTC);
+		rptDetail->SetValue(_T("s8"), nTongT);
+		rptDetail->SetValue(_T("s9"), nTotalQtyC);
+		rptDetail->SetValue(_T("s10"), nTotalQtyCC);
+		rptDetail->SetValue(_T("s11"), nTongC);
+		rptDetail->SetValue(_T("s12"), nTotalQty);			
+		rptDetail->SetValue(_T("s14"), nTotalAmount);		
+	}
+
+
+	tmpStr = pMF->GetSysDate();
+	szDate.Format(rpt.GetReportFooter()->GetValue(_T("PrintDate")), tmpStr.Mid(8, 2), tmpStr.Mid(5, 2), tmpStr.Left(4));
+	rpt.GetReportFooter()->SetValue(_T("PrintDate"), szDate);
+//	rs.GetValue(_T("doctor"), tmpStr);
+	rpt.GetReportFooter()->SetValue(_T("UserName"), pMF->GetDoctorName(pMF->GetCurrentUser()));
+	CReportItem *img = rpt.GetReportFooter()->GetItem(_T("Signature"));
+	if(img)
+	{
+		img->SetHBITMAP(pMF->GetSignatureImage(tmpStr));
+		img->SetFixedHeight(false);
+	}
+
+	rpt.PrintPreview();
+}
Index: HMSSummaryDailyFoodOrder.h
===================================================================
--- HMSSummaryDailyFoodOrder.h	(revision 0)
+++ HMSSummaryDailyFoodOrder.h	(working copy)
@@ -0,0 +1,99 @@
+#ifndef CHMSSUMMARYDAILYFOODORDER_H
+#define CHMSSUMMARYDAILYFOODORDER_H
+
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Copyright  Viet Nam Medical Software Joint Stock Company. 2005-2012. 			
+//	All rights reserved. 
+//	This program is protected by Viet nam and international treaties.  
+//	Unauthorized reproduction or distribution of this program, 
+//	or any portion of it, may result in severe civil and criminal penalties, 
+//	and will be prosecuted to the maximum extent possible under the law.
+//	This file is a part of the GUI(Graphical User Interface) class library.
+//	(c) 2006-2008 Hoang Van Hay, All rights reserved.
+//	CONTACT INFORMATION:
+//	Email  : hayhv@vimes.com.vn or hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+/////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Ban quyen cua Cong Ty Co Phan Phan Mem Y Te Viet Nam 2005-2012.
+//	Do Cuc Ban Quyen, Bo VHTT nuoc Cong hoa xa hoi chu nghia Viet Nam cap.
+//	Chuong trinh phan mem nay duoc Luat phap Viet Nam va quoc te bao ho.
+//	San xuat, su dung hoac phan phoi trai phep toan bo hoac mot phan cua phan men nay se
+//	chiu cac hinh phat va hinh su hoac dan su, co the len den muc toi da dung theo Luat qui dinh.
+//	File nay la mot phan cua thu vien lap trinh(GUI). Ban quyen cua Hoang Van Hay. 2006-2008
+//	THONG TIN LIEN HE:
+//	Email  : hayhv@vimes.com.vn hoac hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+#include "GuiUtils.h"
+#include "GuiView.h"
+#include "DbField.h"
+class CHMSSummaryDailyFoodOrder : public CGuiView{
+protected:
+public:
+	CGuiGroupBox	m_wndOrderInformation;
+	CGuiGroupBox	m_wndGroupListDrug;
+	CGuiLabel		m_wndFormDateLabel;
+	CGuiDateCtrl	m_wndFormDate;
+	CGuiLabel		m_wndToDateLabel;
+	CGuiDateCtrl	m_wndToDate;
+	CGuiLabel		m_wndStatusLabel;
+	CGuiComboBox	m_wndStatus;
+	CGuiButton		m_wndPrint;
+	CGuiListCtrl	m_wndOrderList;
+	CGuiButton		m_wndRefresh;
+	CGuiLabel		m_wndFoodTypeLabel;
+	CGuiComboBox	m_wndFoodType;
+	CGuiCheckBox	m_wndAllDept;
+
+	CString	m_szFormDate;
+	CString	m_szToDate;
+	CString	m_szStatusKey;
+	CString	m_szFoodTypeKey;
+	CString	m_szSQL;
+	BOOL	m_bAllDept;
+	//void			OnFormDateChange(); 
+	//void			OnFormDateSetfocus(); 
+	//void			OnFormDateKillfocus(); 
+	int			OnFormDateCheckValue(); 
+	//void			OnToDateChange(); 
+	//void			OnToDateSetfocus(); 
+	//void			OnToDateKillfocus(); 
+	int			OnToDateCheckValue(); 
+	void			OnStatusSelectChange(int nOldItemSel, int nNewItemSel); 
+	void			OnStatusSelendok(); 
+	//void			OnStatusSetfocus(); 
+	//void			OnStatusKillfocus(); 
+	long			OnStatusLoadData(); 
+	//void			OnStatusAddNew(); 
+	void			OnPrintSelect(); 
+	long			OnOrderListLoadData(); 
+	void			OnOrderListSelectChange(int nOldItem, int nNewItem); 
+	void			OnOrderListDblClick(); 
+	int			OnOrderListDeleteItem(); 
+	void			OnPrintDeliverySummery(LPCTSTR lpszFromDate, LPCTSTR lpszToDate);
+	void			OnRefreshSelect(); 
+	void			OnFoodTypeSelectChange(int nOldItemSel, int nNewItemSel); 
+	void			OnFoodTypeSelendok(); 
+	//void			OnFoodTypeSetfocus(); 
+	//void			OnFoodTypeKillfocus(); 
+	long			OnFoodTypeLoadData(); 
+	//void			OnFoodTypeAddNew(); 
+
+	CHMSSummaryDailyFoodOrder();
+	~CHMSSummaryDailyFoodOrder();
+	void OnCreateComponents();
+	void OnInitializeComponents();
+	void OnSetWindowEvents();
+	void OnDoDataExchange(CDataExchange* pDX);
+	void GetDataToScreen();
+	void GetScreenToData();
+	void SetDefaultValues();
+	int SetMode(int nMode);
+	int OnAddCHMSSummaryDailyFoodOrder(); 
+	int OnEditCHMSSummaryDailyFoodOrder(); 
+	int OnDeleteCHMSSummaryDailyFoodOrder(); 
+	int OnSaveCHMSSummaryDailyFoodOrder(); 
+	int OnCancelCHMSSummaryDailyFoodOrder(); 
+	int OnCHMSSummaryDailyFoodOrderListLoadData(); 
+};
+#endif
Index: MainFrm.cpp
===================================================================
--- MainFrm.cpp	(revision 0)
+++ MainFrm.cpp	(working copy)
@@ -0,0 +1,104 @@
+// MainFrm.cpp : implementation of the CMainFrame class
+//
+#include "stdafx.h"
+#include "MainFrm.h"
+#include "GuiUtils.h"
+#include "resource.h"
+#include ".\mainfrm.h"
+
+
+IMPLEMENT_DYNAMIC(CMainFrame, CHMSMainFrame)
+
+BEGIN_MESSAGE_MAP(CMainFrame, CHMSMainFrame)
+	ON_WM_CREATE()
+	ON_WM_SIZE()
+END_MESSAGE_MAP()
+
+// CMainFrame construction/destruction
+
+CMainFrame::CMainFrame()
+{
+	SetLocalLang(1);
+	m_szModuleName = _T("NUTRITION MODULE");
+	m_szModuleID = _T("NM");
+	m_szVersion = _T("1.1");
+	m_szSize = CSize(1024, 720);
+}
+
+CMainFrame::~CMainFrame()
+{	
+
+}
+
+void _OnSelChange(CWnd* pWnd, int nOldItem, int nNewItem)
+{
+	//_msg(_T("%d : %d"), nOldItem, nNewItem);
+	CMainFrame *pMF = (CMainFrame *)pWnd;
+	if (nNewItem == 0)
+	{
+		/*if (pMF->m_wndSurgerySchedule.m_wndWeekView.GetCheck())
+		{
+			pMF->m_wndSurgerySchedule.m_wndCalendar.SetView(WV_WEEKVIEW, FALSE);
+		}*/
+	}
+}
+
+int CMainFrame::OnCreate(LPCREATESTRUCT lpCreateStruct)
+{
+
+	if (CHMSMainFrame::OnCreate(lpCreateStruct) == -1)
+		return -1;
+	CString szSQL, tmpStr;
+
+	TranslateString(_T("NUTRITON MODULE"), tmpStr);
+	SetWindowText(tmpStr);
+
+	ModifyStyle(WS_MAXIMIZEBOX|WS_SIZEBOX, 0);
+	m_hIcon = AfxGetApp()->LoadIcon(IDR_MAINFRAME);
+	SetIcon(m_hIcon, TRUE);			// Set big icon
+	SetIcon(m_hIcon, FALSE);		// Set small icon
+
+	CenterWindow();
+	
+	m_wndTab.Create(this,0, 0, 1024, 660);
+	m_wndDailyFoodOrderList.Create(&m_wndTab);
+	m_wndDailyFoodOrder.Create(&m_wndTab);
+	m_wndSummaryDailyFoodOrder.Create(&m_wndTab);
+	m_wndTab.Add(_T("Order List"), &m_wndDailyFoodOrderList);
+	m_wndTab.Add(_T("Order Information"), &m_wndDailyFoodOrder);
+	m_wndTab.Add(_T("Summary Order"), &m_wndSummaryDailyFoodOrder);
+	//SetWindowText(_T("Delivery Cabinet Management"));
+	m_wndDailyFoodOrderList.m_wndOrder = &m_wndDailyFoodOrder;
+
+
+	CString szStatus, szStatusLabel, szDate;
+	szDate = GetSysDate();
+	TranslateString(_T("UserID: %s - Working Date: %s"), szStatusLabel);
+	szStatus.Format(szStatusLabel, GetCurrentUser(), CDate::Convert(szDate, yyyymmdd, ddmmyyyy));
+	szStatus.AppendFormat(_T(" - Host: %s"), GetHost(), GetDatabase());
+	SetStatusText(szStatus, 1);
+
+	SetActivePane(0);
+
+	SetForegroundWindow();
+
+	CGuiTabCtrl *pTab = (CGuiTabCtrl *)GetPane();
+	pTab->SetEvent(WE_SELCHANGE, _OnSelChange);
+	
+	return 0;
+}
+
+void CMainFrame::OnInitializes()
+{
+	CHMSMainFrame::OnInitializes();
+	CString szSQL;
+	CRecord rs(&m_db);
+	
+	/*if (GetCurrentUser().Trim().MakeLower() != _T("admin"))
+	{
+		m_pSplashThread->HideSplash();
+		ShowMessageBox(_T("Permisson denied"), MB_OK | MB_ICONERROR);
+		exit(0);
+	}*/
+
+}
\ No newline at end of file
Index: MainFrm.h
===================================================================
--- MainFrm.h	(revision 0)
+++ MainFrm.h	(working copy)
@@ -0,0 +1,31 @@
+#ifndef MAINFRAME_H
+#define MAINFRAME_H
+#include "HMSDailyFoodOrderList.h"
+#include "HMSDailyFoodOrder.h"
+#include "HMSMainFrame.h"
+#include "HMSSummaryDailyFoodOrder.h"
+
+class CMainFrame : public CHMSMainFrame
+{
+	CHMSDailyFoodOrderList	m_wndDailyFoodOrderList;
+	CHMSDailyFoodOrder		m_wndDailyFoodOrder;
+	CHMSSummaryDailyFoodOrder		m_wndSummaryDailyFoodOrder;
+	CGuiTabCtrl	m_wndTab;
+
+	DECLARE_DYNAMIC(CMainFrame)
+	HICON m_hIcon;
+public:
+
+	CMainFrame();
+	virtual ~CMainFrame();
+
+protected: 
+	
+	void OnInitializes();
+	afx_msg int OnCreate(LPCREATESTRUCT lpCreateStruct);
+
+	DECLARE_MESSAGE_MAP()
+public:
+	void Recurse(LPCTSTR pstr);
+};
+#endif
\ No newline at end of file
Index: ReadMe.txt
===================================================================
--- ReadMe.txt	(revision 0)
+++ ReadMe.txt	(working copy)
@@ -0,0 +1,122 @@
+================================================================================
+    MICROSOFT FOUNDATION CLASS LIBRARY : VIMESNutritionManagr Project Overview
+===============================================================================
+
+The application wizard has created this VIMESNutritionManagr application for 
+you.  This application not only demonstrates the basics of using the Microsoft 
+Foundation Classes but is also a starting point for writing your application.
+
+This file contains a summary of what you will find in each of the files that
+make up your VIMESNutritionManagr application.
+
+VIMESNutritionManagr.vcproj
+    This is the main project file for VC++ projects generated using an application wizard. 
+    It contains information about the version of Visual C++ that generated the file, and 
+    information about the platforms, configurations, and project features selected with the
+    application wizard.
+
+VIMESNutritionManagr.h
+    This is the main header file for the application.  It includes other
+    project specific headers (including Resource.h) and declares the
+    CVIMESNutritionManagrApp application class.
+
+VIMESNutritionManagr.cpp
+    This is the main application source file that contains the application
+    class CVIMESNutritionManagrApp.
+
+VIMESNutritionManagr.rc
+    This is a listing of all of the Microsoft Windows resources that the
+    program uses.  It includes the icons, bitmaps, and cursors that are stored
+    in the RES subdirectory.  This file can be directly edited in Microsoft
+    Visual C++. Your project resources are in 1033.
+
+res\VIMESNutritionManagr.ico
+    This is an icon file, which is used as the application's icon.  This
+    icon is included by the main resource file VIMESNutritionManagr.rc.
+
+res\VIMESNutritionManagr.rc2
+    This file contains resources that are not edited by Microsoft 
+    Visual C++. You should place all resources not editable by
+    the resource editor in this file.
+/////////////////////////////////////////////////////////////////////////////
+
+For the main frame window:
+    The project includes a standard MFC interface.
+MainFrm.h, MainFrm.cpp
+    These files contain the frame class CMainFrame, which is derived from
+    CMDIFrameWnd and controls all MDI frame features.
+res\Toolbar.bmp
+    This bitmap file is used to create tiled images for the toolbar.
+    The initial toolbar and status bar are constructed in the CMainFrame
+    class. Edit this toolbar bitmap using the resource editor, and
+    update the IDR_MAINFRAME TOOLBAR array in VIMESNutritionManagr.rc to add
+    toolbar buttons.
+/////////////////////////////////////////////////////////////////////////////
+
+For the child frame window:
+
+ChildFrm.h, ChildFrm.cpp
+    These files define and implement the CChildFrame class, which
+    supports the child windows in an MDI application.
+
+/////////////////////////////////////////////////////////////////////////////
+
+The application wizard creates one document type and one view:
+
+VIMESNutritionManagrDoc.h, VIMESNutritionManagrDoc.cpp - the document
+    These files contain your CVIMESNutritionManagrDoc class.  Edit these files to
+    add your special document data and to implement file saving and loading
+    (via CVIMESNutritionManagrDoc::Serialize).
+VIMESNutritionManagrView.h, VIMESNutritionManagrView.cpp - the view of the document
+    These files contain your CVIMESNutritionManagrView class.
+    CVIMESNutritionManagrView objects are used to view CVIMESNutritionManagrDoc objects.
+res\VIMESNutritionManagrDoc.ico
+    This is an icon file, which is used as the icon for MDI child windows
+    for the CVIMESNutritionManagrDoc class.  This icon is included by the main
+    resource file VIMESNutritionManagr.rc.
+/////////////////////////////////////////////////////////////////////////////
+
+Other Features:
+
+ActiveX Controls
+    The application includes support to use ActiveX controls.
+
+Printing and Print Preview support
+    The application wizard has generated code to handle the print, print setup, and print preview
+    commands by calling member functions in the CView class from the MFC library.
+/////////////////////////////////////////////////////////////////////////////
+
+Other standard files:
+
+StdAfx.h, StdAfx.cpp
+    These files are used to build a precompiled header (PCH) file
+    named VIMESNutritionManagr.pch and a precompiled types file named StdAfx.obj.
+
+Resource.h
+    This is the standard header file, which defines new resource IDs.
+    Microsoft Visual C++ reads and updates this file.
+
+VIMESNutritionManagr.manifest
+	Application manifest files are used by Windows XP to describe an applications 
+	dependency on specific versions of Side-by-Side assemblies. The loader uses this 
+	information to load the appropriate assembly from the assembly cache or private 
+	from the application. The Application manifest  maybe included for redistribution 
+	as an external .manifest file that is installed in the same folder as the application 
+	executable or it may be included in the executable in the form of a resource. 
+/////////////////////////////////////////////////////////////////////////////
+
+Other notes:
+
+The application wizard uses "TODO:" to indicate parts of the source code you
+should add to or customize.
+
+If your application uses MFC in a shared DLL, and your application is in a 
+language other than the operating system's current language, you will need 
+to copy the corresponding localized resources MFC70XXX.DLL from the Microsoft
+Visual C++ CD-ROM under the Win\System directory to your computer's system or 
+system32 directory, and rename it to be MFCLOC.DLL.  ("XXX" stands for the 
+language abbreviation.  For example, MFC70DEU.DLL contains resources 
+translated to German.)  If you don't do this, some of the UI elements of 
+your application will remain in the language of the operating system.
+
+/////////////////////////////////////////////////////////////////////////////
Index: res/Toolbar.bmp
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: res/Toolbar.bmp
===================================================================
--- res/Toolbar.bmp	(revision 0)
+++ res/Toolbar.bmp	(working copy)

Property changes on: res/Toolbar.bmp
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: res/VIMESNutritionManagr.ico
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: res/VIMESNutritionManagr.ico
===================================================================
--- res/VIMESNutritionManagr.ico	(revision 0)
+++ res/VIMESNutritionManagr.ico	(working copy)

Property changes on: res/VIMESNutritionManagr.ico
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: res/VIMESNutritionManagr.manifest
===================================================================
--- res/VIMESNutritionManagr.manifest	(revision 0)
+++ res/VIMESNutritionManagr.manifest	(working copy)
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
+<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"> 
+<assemblyIdentity 
+    version="1.0.0.0" 
+    processorArchitecture="X86" 
+    name="Microsoft.Windows.VIMESNutritionManagr"
+    type="win32" 
+/> 
+<description>Your app description here</description> 
+<dependency> 
+    <dependentAssembly> 
+        <assemblyIdentity 
+            type="win32" 
+            name="Microsoft.Windows.Common-Controls" 
+            version="6.0.0.0" 
+            processorArchitecture="X86" 
+            publicKeyToken="6595b64144ccf1df" 
+            language="*" 
+        /> 
+    </dependentAssembly> 
+</dependency> 
+</assembly>
Index: res/VIMESNutritionManagr.rc2
===================================================================
--- res/VIMESNutritionManagr.rc2	(revision 0)
+++ res/VIMESNutritionManagr.rc2	(working copy)
@@ -0,0 +1,13 @@
+//
+// VIMESNutritionManagr.RC2 - resources Microsoft Visual C++ does not edit directly
+//
+
+#ifdef APSTUDIO_INVOKED
+#error this file is not editable by Microsoft Visual C++
+#endif //APSTUDIO_INVOKED
+
+
+/////////////////////////////////////////////////////////////////////////////
+// Add manually edited resources here...
+
+/////////////////////////////////////////////////////////////////////////////
Index: res/VIMESNutritionManagrDoc.ico
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: res/VIMESNutritionManagrDoc.ico
===================================================================
--- res/VIMESNutritionManagrDoc.ico	(revision 0)
+++ res/VIMESNutritionManagrDoc.ico	(working copy)

Property changes on: res/VIMESNutritionManagrDoc.ico
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: res/sandwich.ico
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: res/sandwich.ico
===================================================================
--- res/sandwich.ico	(revision 0)
+++ res/sandwich.ico	(working copy)

Property changes on: res/sandwich.ico
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: res/sandwich.ico
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: res/sandwich.ico
===================================================================
--- res/sandwich.ico	(revision 0)
+++ res/sandwich.ico	(working copy)

Property changes on: res/sandwich.ico
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: res/Toolbar.bmp
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: res/Toolbar.bmp
===================================================================
--- res/Toolbar.bmp	(revision 0)
+++ res/Toolbar.bmp	(working copy)

Property changes on: res/Toolbar.bmp
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: res/VIMESNutritionManagr.ico
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: res/VIMESNutritionManagr.ico
===================================================================
--- res/VIMESNutritionManagr.ico	(revision 0)
+++ res/VIMESNutritionManagr.ico	(working copy)

Property changes on: res/VIMESNutritionManagr.ico
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: res/VIMESNutritionManagr.manifest
===================================================================
--- res/VIMESNutritionManagr.manifest	(revision 0)
+++ res/VIMESNutritionManagr.manifest	(working copy)
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
+<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"> 
+<assemblyIdentity 
+    version="1.0.0.0" 
+    processorArchitecture="X86" 
+    name="Microsoft.Windows.VIMESNutritionManagr"
+    type="win32" 
+/> 
+<description>Your app description here</description> 
+<dependency> 
+    <dependentAssembly> 
+        <assemblyIdentity 
+            type="win32" 
+            name="Microsoft.Windows.Common-Controls" 
+            version="6.0.0.0" 
+            processorArchitecture="X86" 
+            publicKeyToken="6595b64144ccf1df" 
+            language="*" 
+        /> 
+    </dependentAssembly> 
+</dependency> 
+</assembly>
Index: res/VIMESNutritionManagr.rc2
===================================================================
--- res/VIMESNutritionManagr.rc2	(revision 0)
+++ res/VIMESNutritionManagr.rc2	(working copy)
@@ -0,0 +1,13 @@
+//
+// VIMESNutritionManagr.RC2 - resources Microsoft Visual C++ does not edit directly
+//
+
+#ifdef APSTUDIO_INVOKED
+#error this file is not editable by Microsoft Visual C++
+#endif //APSTUDIO_INVOKED
+
+
+/////////////////////////////////////////////////////////////////////////////
+// Add manually edited resources here...
+
+/////////////////////////////////////////////////////////////////////////////
Index: res/VIMESNutritionManagrDoc.ico
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: res/VIMESNutritionManagrDoc.ico
===================================================================
--- res/VIMESNutritionManagrDoc.ico	(revision 0)
+++ res/VIMESNutritionManagrDoc.ico	(working copy)

Property changes on: res/VIMESNutritionManagrDoc.ico
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: resource.h
===================================================================
--- resource.h	(revision 0)
+++ resource.h	(working copy)
@@ -0,0 +1,20 @@
+//{{NO_DEPENDENCIES}}
+// Microsoft Visual C++ generated include file.
+// Used by VIMESNutritionManagr.rc
+//
+#define IDD_ABOUTBOX                    100
+#define IDP_OLE_INIT_FAILED             100
+#define IDR_MAINFRAME                   128
+#define IDR_VIMESNutritionMTYPE         129
+#define IDI_ICON1                       0
+
+// Next default values for new objects
+// 
+#ifdef APSTUDIO_INVOKED
+#ifndef APSTUDIO_READONLY_SYMBOLS
+#define _APS_NEXT_RESOURCE_VALUE        131
+#define _APS_NEXT_COMMAND_VALUE         32771
+#define _APS_NEXT_CONTROL_VALUE         1000
+#define _APS_NEXT_SYMED_VALUE           101
+#endif
+#endif
Index: Resx/CHMSDailyFoodOrder.cpp
===================================================================
--- Resx/CHMSDailyFoodOrder.cpp	(revision 0)
+++ Resx/CHMSDailyFoodOrder.cpp	(working copy)
@@ -0,0 +1,635 @@
+#include "CHMSDailyFoodOrder.h"
+#include "MainFrm.h"
+/*static void _OnOrderNoChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderNoChange();
+} */
+/*static void _OnOrderNoSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderNoSetfocus();} */ 
+/*static void _OnOrderNoKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderNoKillfocus();
+} */
+static int _OnOrderNoCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnOrderNoCheckValue();
+} 
+static void _OnFindSelectFnc(CWnd *pWnd){
+	CCHMSDailyFoodOrder *pVw = (CCHMSDailyFoodOrder *)pWnd;
+	pVw->OnFindSelect();
+} 
+/*static void _OnOrderDateChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderDateChange();
+} */
+/*static void _OnOrderDateSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderDateSetfocus();} */ 
+/*static void _OnOrderDateKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderDateKillfocus();
+} */
+static int _OnOrderDateCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnOrderDateCheckValue();
+} 
+/*static void _OnIssueDateChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnIssueDateChange();
+} */
+/*static void _OnIssueDateSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnIssueDateSetfocus();} */ 
+/*static void _OnIssueDateKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnIssueDateKillfocus();
+} */
+static int _OnIssueDateCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnIssueDateCheckValue();
+} 
+/*static void _OnStatusChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnStatusChange();
+} */
+/*static void _OnStatusSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnStatusSetfocus();} */ 
+/*static void _OnStatusKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+} */
+static int _OnStatusCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnStatusCheckValue();
+} 
+/*static void _OnNoteChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnNoteChange();
+} */
+/*static void _OnNoteSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnNoteSetfocus();} */ 
+/*static void _OnNoteKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnNoteKillfocus();
+} */
+static int _OnNoteCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnNoteCheckValue();
+} 
+static void _OnSendSelectFnc(CWnd *pWnd){
+	CCHMSDailyFoodOrder *pVw = (CCHMSDailyFoodOrder *)pWnd;
+	pVw->OnSendSelect();
+} 
+static void _OnPrintSelectFnc(CWnd *pWnd){
+	CCHMSDailyFoodOrder *pVw = (CCHMSDailyFoodOrder *)pWnd;
+	pVw->OnPrintSelect();
+} 
+/*static void _OnPatientNameChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnPatientNameChange();
+} */
+/*static void _OnPatientNameSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnPatientNameSetfocus();} */ 
+/*static void _OnPatientNameKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnPatientNameKillfocus();
+} */
+static int _OnPatientNameCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnPatientNameCheckValue();
+} 
+/*static void _OnDeptChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnDeptChange();
+} */
+/*static void _OnDeptSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnDeptSetfocus();} */ 
+/*static void _OnDeptKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnDeptKillfocus();
+} */
+static int _OnDeptCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnDeptCheckValue();
+} 
+static long _OnOrderListLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder*)pWnd)->OnOrderListLoadData();
+} 
+static void _OnOrderListDblClickFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder*)pWnd)->OnOrderListDblClick();
+} 
+static void _OnOrderListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CCHMSDailyFoodOrder*)pWnd)->OnOrderListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnOrderListDeleteItemFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnOrderListDeleteItem();
+} 
+static long _OnPatientListLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder*)pWnd)->OnPatientListLoadData();
+} 
+static void _OnPatientListDblClickFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder*)pWnd)->OnPatientListDblClick();
+} 
+static void _OnPatientListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CCHMSDailyFoodOrder*)pWnd)->OnPatientListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnPatientListDeleteItemFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnPatientListDeleteItem();
+} 
+static long _OnDrugListLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder*)pWnd)->OnDrugListLoadData();
+} 
+static void _OnDrugListDblClickFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder*)pWnd)->OnDrugListDblClick();
+} 
+static void _OnDrugListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CCHMSDailyFoodOrder*)pWnd)->OnDrugListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnDrugListDeleteItemFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnDrugListDeleteItem();
+} 
+/*static void _OnTypeChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTypeChange();
+} */
+/*static void _OnTypeSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTypeSetfocus();} */ 
+/*static void _OnTypeKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTypeKillfocus();
+} */
+static int _OnTypeCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnTypeCheckValue();
+} 
+/*static void _OnTotalCountChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTotalCountChange();
+} */
+/*static void _OnTotalCountSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTotalCountSetfocus();} */ 
+/*static void _OnTotalCountKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTotalCountKillfocus();
+} */
+static int _OnTotalCountCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnTotalCountCheckValue();
+} 
+static int _OnAddCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnAddCHMSDailyFoodOrder();
+} 
+static int _OnEditCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnEditCHMSDailyFoodOrder();
+} 
+static int _OnDeleteCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnDeleteCHMSDailyFoodOrder();
+} 
+static int _OnSaveCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnSaveCHMSDailyFoodOrder();
+} 
+static int _OnCancelCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnCancelCHMSDailyFoodOrder();
+} 
+CCHMSDailyFoodOrder::CCHMSDailyFoodOrder(){
+
+	m_nDlgWidth = 1029;
+	m_nDlgHeight = 635;
+	SetDefaultValues();
+}
+CCHMSDailyFoodOrder::~CCHMSDailyFoodOrder(){
+}
+void CCHMSDailyFoodOrder::OnCreateComponents(){
+	m_wndOrderInformation.Create(this, _T("Order Information"), 5, 5, 550, 180);
+	m_wndPatientInformation.Create(this, _T("Patient Information"), 555, 5, 1020, 410);
+	m_wndDrugInformation.Create(this, _T("Food Informations"), 555, 445, 1020, 625);
+	m_wndGroupListDrug.Create(this, _T("Food Type List"), 5, 185, 550, 625);
+	m_wndOrderNoLabel.Create(this, _T("Order ID"), 10, 30, 140, 55);
+	m_wndOrderNo.Create(this,145, 30, 275, 55); 
+	m_wndFind.Create(this, _T("&Find"), 825, 415, 925, 440);
+	m_wndOrderDateLabel.Create(this, _T("Order Date"), 10, 60, 140, 85);
+	m_wndOrderDate.Create(this,145, 60, 275, 85); 
+	m_wndIssueDateLabel.Create(this, _T("Issue Date"), 280, 60, 410, 85);
+	m_wndIssueDate.Create(this,415, 60, 545, 85); 
+	m_wndStatusLabel.Create(this, _T("Status"), 280, 30, 410, 55);
+	m_wndStatus.Create(this,415, 30, 545, 55); 
+	m_wndNoteLabel.Create(this, _T("Note"), 10, 90, 140, 115);
+	m_wndNote.Create(this,145, 90, 545, 115); 
+	m_wndSend.Create(this, _T("&Send"), 370, 150, 455, 175);
+	m_wndPrint.Create(this, _T("&Preview"), 460, 150, 545, 175);
+	m_wndPatientNameLabel.Create(this, _T("Patient Name"), 555, 415, 665, 440);
+	m_wndPatientName.Create(this,670, 415, 820, 440); 
+	m_wndDeptLabel.Create(this, _T("Dept"), 10, 120, 140, 145);
+	m_wndDept.Create(this,145, 120, 545, 145); 
+	m_wndOrderList.Create(this,10, 210, 545, 620); 
+	m_wndPatientList.Create(this,560, 30, 1015, 405); 
+	m_wndDrugList.Create(this,560, 470, 1015, 620); 
+	m_wndTypeLabel.Create(this, _T("Type"), 10, 149, 140, 174);
+	m_wndType.Create(this,145, 149, 360, 174); 
+	m_wndTotalCount.Create(this,935, 415, 1015, 440); 
+
+}
+void CCHMSDailyFoodOrder::OnInitializeComponents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	m_wndOrderNo.SetLimitText(1024);
+	m_wndOrderNo.SetCheckValue(true);
+	m_wndOrderDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndOrderDate.SetCheckValue(true);
+	m_wndIssueDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndIssueDate.SetCheckValue(true);
+	m_wndStatus.SetLimitText(1024);
+	m_wndStatus.SetCheckValue(true);
+	m_wndNote.SetLimitText(1024);
+	m_wndNote.SetCheckValue(true);
+	m_wndPatientName.SetLimitText(1024);
+	m_wndPatientName.SetCheckValue(true);
+	m_wndDept.SetLimitText(35);
+	m_wndDept.SetCheckValue(true);
+	m_wndType.SetLimitText(35);
+	m_wndType.SetCheckValue(true);
+	m_wndTotalCount.SetLimitText(16);
+	m_wndTotalCount.SetCheckValue(true);
+
+
+
+
+
+
+
+}
+void CCHMSDailyFoodOrder::OnSetWindowEvents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	//m_wndOrderNo.SetEvent(WE_CHANGE, _OnOrderNoChangeFnc);
+	//m_wndOrderNo.SetEvent(WE_SETFOCUS, _OnOrderNoSetfocusFnc);
+	//m_wndOrderNo.SetEvent(WE_KILLFOCUS, _OnOrderNoKillfocusFnc);
+	m_wndOrderNo.SetEvent(WE_CHECKVALUE, _OnOrderNoCheckValueFnc);
+	m_wndFind.SetEvent(WE_CLICK, _OnFindSelectFnc);
+	//m_wndOrderDate.SetEvent(WE_CHANGE, _OnOrderDateChangeFnc);
+	//m_wndOrderDate.SetEvent(WE_SETFOCUS, _OnOrderDateSetfocusFnc);
+	//m_wndOrderDate.SetEvent(WE_KILLFOCUS, _OnOrderDateKillfocusFnc);
+	m_wndOrderDate.SetEvent(WE_CHECKVALUE, _OnOrderDateCheckValueFnc);
+	//m_wndIssueDate.SetEvent(WE_CHANGE, _OnIssueDateChangeFnc);
+	//m_wndIssueDate.SetEvent(WE_SETFOCUS, _OnIssueDateSetfocusFnc);
+	//m_wndIssueDate.SetEvent(WE_KILLFOCUS, _OnIssueDateKillfocusFnc);
+	m_wndIssueDate.SetEvent(WE_CHECKVALUE, _OnIssueDateCheckValueFnc);
+	//m_wndStatus.SetEvent(WE_CHANGE, _OnStatusChangeFnc);
+	//m_wndStatus.SetEvent(WE_SETFOCUS, _OnStatusSetfocusFnc);
+	//m_wndStatus.SetEvent(WE_KILLFOCUS, _OnStatusKillfocusFnc);
+	m_wndStatus.SetEvent(WE_CHECKVALUE, _OnStatusCheckValueFnc);
+	//m_wndNote.SetEvent(WE_CHANGE, _OnNoteChangeFnc);
+	//m_wndNote.SetEvent(WE_SETFOCUS, _OnNoteSetfocusFnc);
+	//m_wndNote.SetEvent(WE_KILLFOCUS, _OnNoteKillfocusFnc);
+	m_wndNote.SetEvent(WE_CHECKVALUE, _OnNoteCheckValueFnc);
+	m_wndSend.SetEvent(WE_CLICK, _OnSendSelectFnc);
+	m_wndPrint.SetEvent(WE_CLICK, _OnPrintSelectFnc);
+	//m_wndPatientName.SetEvent(WE_CHANGE, _OnPatientNameChangeFnc);
+	//m_wndPatientName.SetEvent(WE_SETFOCUS, _OnPatientNameSetfocusFnc);
+	//m_wndPatientName.SetEvent(WE_KILLFOCUS, _OnPatientNameKillfocusFnc);
+	m_wndPatientName.SetEvent(WE_CHECKVALUE, _OnPatientNameCheckValueFnc);
+	//m_wndDept.SetEvent(WE_CHANGE, _OnDeptChangeFnc);
+	//m_wndDept.SetEvent(WE_SETFOCUS, _OnDeptSetfocusFnc);
+	//m_wndDept.SetEvent(WE_KILLFOCUS, _OnDeptKillfocusFnc);
+	m_wndDept.SetEvent(WE_CHECKVALUE, _OnDeptCheckValueFnc);
+	m_wndOrderList.SetEvent(WE_SELCHANGE, _OnOrderListSelectChangeFnc);
+	m_wndOrderList.SetEvent(WE_LOADDATA, _OnOrderListLoadDataFnc);
+	m_wndOrderList.SetEvent(WE_DBLCLICK, _OnOrderListDblClickFnc);
+	m_wndOrderList.AddEvent(1, _T("Delete"), _OnOrderListDeleteItemFnc, 0, VK_DELETE, 0);
+	m_wndPatientList.SetEvent(WE_SELCHANGE, _OnPatientListSelectChangeFnc);
+	m_wndPatientList.SetEvent(WE_LOADDATA, _OnPatientListLoadDataFnc);
+	m_wndPatientList.SetEvent(WE_DBLCLICK, _OnPatientListDblClickFnc);
+	m_wndPatientList.AddEvent(1, _T("Delete"), _OnPatientListDeleteItemFnc, 0, VK_DELETE, 0);
+	m_wndDrugList.SetEvent(WE_SELCHANGE, _OnDrugListSelectChangeFnc);
+	m_wndDrugList.SetEvent(WE_LOADDATA, _OnDrugListLoadDataFnc);
+	m_wndDrugList.SetEvent(WE_DBLCLICK, _OnDrugListDblClickFnc);
+	m_wndDrugList.AddEvent(1, _T("Delete"), _OnDrugListDeleteItemFnc, 0, VK_DELETE, 0);
+	//m_wndType.SetEvent(WE_CHANGE, _OnTypeChangeFnc);
+	//m_wndType.SetEvent(WE_SETFOCUS, _OnTypeSetfocusFnc);
+	//m_wndType.SetEvent(WE_KILLFOCUS, _OnTypeKillfocusFnc);
+	m_wndType.SetEvent(WE_CHECKVALUE, _OnTypeCheckValueFnc);
+	//m_wndTotalCount.SetEvent(WE_CHANGE, _OnTotalCountChangeFnc);
+	//m_wndTotalCount.SetEvent(WE_SETFOCUS, _OnTotalCountSetfocusFnc);
+	//m_wndTotalCount.SetEvent(WE_KILLFOCUS, _OnTotalCountKillfocusFnc);
+	m_wndTotalCount.SetEvent(WE_CHECKVALUE, _OnTotalCountCheckValueFnc);
+	AddEvent(1, _T("Add	Ctrl+A"), _OnAddCHMSDailyFoodOrderFnc, 0, 'A', VK_CONTROL);
+	AddEvent(2, _T("Edit	Ctrl+E"), _OnEditCHMSDailyFoodOrderFnc, 0, 'E', VK_CONTROL);
+	AddEvent(3, _T("Delete	Ctrl+D"), _OnDeleteCHMSDailyFoodOrderFnc, 0, 'D', VK_CONTROL);
+	AddEvent(4, _T("Save	Ctrl+S"), _OnSaveCHMSDailyFoodOrderFnc, 0, 'S', VK_CONTROL);
+	AddEvent(0, _T("-"));
+	AddEvent(5, _T("Cancel	Ctrl+T"), _OnCancelCHMSDailyFoodOrderFnc, 0, 'T', VK_CONTROL);
+	SetMode(VM_NONE);
+
+}
+void CCHMSDailyFoodOrder::OnDoDataExchange(CDataExchange* pDX){
+	DDX_Text(pDX, m_wndOrderNo.GetDlgCtrlID(), m_szOrderNo);
+	DDX_TextEx(pDX, m_wndOrderDate.GetDlgCtrlID(), m_szOrderDate);
+	DDX_TextEx(pDX, m_wndIssueDate.GetDlgCtrlID(), m_szIssueDate);
+	DDX_Text(pDX, m_wndStatus.GetDlgCtrlID(), m_szStatus);
+	DDX_Text(pDX, m_wndNote.GetDlgCtrlID(), m_szNote);
+	DDX_Text(pDX, m_wndPatientName.GetDlgCtrlID(), m_szPatientName);
+	DDX_Text(pDX, m_wndDept.GetDlgCtrlID(), m_szDept);
+	DDX_Text(pDX, m_wndType.GetDlgCtrlID(), m_szType);
+	DDX_Text(pDX, m_wndTotalCount.GetDlgCtrlID(), m_nTotalCount);
+
+}
+void CCHMSDailyFoodOrder::GetDataToScreen(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT * FROM "));
+	rs.ExecSQL(szSQL);
+
+}
+void CCHMSDailyFoodOrder::GetScreenToData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+
+}
+void CCHMSDailyFoodOrder::SetDefaultValues(){
+
+	m_szOrderNo.Empty();
+	m_szOrderDate.Empty();
+	m_szIssueDate.Empty();
+	m_szStatus.Empty();
+	m_szNote.Empty();
+	m_szPatientName.Empty();
+	m_szDept.Empty();
+	m_szType.Empty();
+	m_nTotalCount=0;
+
+}
+int CCHMSDailyFoodOrder::SetMode(int nMode){
+ 		int nOldMode = GetMode();
+ 		CGuiView::SetMode(nMode);
+ 		CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 		CString szSQL;
+ 		CRecord rs(&pMF->m_db);
+  		switch(nMode){
+ 		case VM_ADD: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		case VM_EDIT: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			break;
+ 		case VM_VIEW: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(FALSE, 3, 4, -1);
+ 			break;
+ 		case VM_NONE: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(TRUE, 0, 6, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		};
+ 		UpdateData(FALSE);
+ 		return nOldMode;
+}
+/*void CCHMSDailyFoodOrder::OnOrderNoChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnOrderNoSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnOrderNoKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnOrderNoCheckValue(){
+	return 0;
+} 
+void CCHMSDailyFoodOrder::OnFindSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+/*void CCHMSDailyFoodOrder::OnOrderDateChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnOrderDateSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnOrderDateKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnOrderDateCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnIssueDateChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnIssueDateSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnIssueDateKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnIssueDateCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnStatusChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnStatusSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnStatusKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnStatusCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnNoteChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnNoteSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnNoteKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnNoteCheckValue(){
+	return 0;
+} 
+void CCHMSDailyFoodOrder::OnSendSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSDailyFoodOrder::OnPrintSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+/*void CCHMSDailyFoodOrder::OnPatientNameChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnPatientNameSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnPatientNameKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnPatientNameCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnDeptChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnDeptSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnDeptKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnDeptCheckValue(){
+	return 0;
+} 
+void CCHMSDailyFoodOrder::OnOrderListDblClick(){
+	
+} 
+void CCHMSDailyFoodOrder::OnOrderListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CCHMSDailyFoodOrder::OnOrderListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CCHMSDailyFoodOrder::OnOrderListLoadData(){
+/*
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	m_wndOrderList.BeginLoad(); 
+	int nCount = 0;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndOrderList.AddItems(
+		rs.MoveNext();
+	}
+	m_wndOrderList.EndLoad(); 
+	return nCount;
+*/
+	return 0;
+}
+void CCHMSDailyFoodOrder::OnPatientListDblClick(){
+	
+} 
+void CCHMSDailyFoodOrder::OnPatientListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CCHMSDailyFoodOrder::OnPatientListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CCHMSDailyFoodOrder::OnPatientListLoadData(){
+/*
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	m_wndPatientList.BeginLoad(); 
+	int nCount = 0;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndPatientList.AddItems(
+		rs.MoveNext();
+	}
+	m_wndPatientList.EndLoad(); 
+	return nCount;
+*/
+	return 0;
+}
+void CCHMSDailyFoodOrder::OnDrugListDblClick(){
+	
+} 
+void CCHMSDailyFoodOrder::OnDrugListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CCHMSDailyFoodOrder::OnDrugListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CCHMSDailyFoodOrder::OnDrugListLoadData(){
+/*
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	m_wndDrugList.BeginLoad(); 
+	int nCount = 0;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndDrugList.AddItems(
+		rs.MoveNext();
+	}
+	m_wndDrugList.EndLoad(); 
+	return nCount;
+*/
+	return 0;
+}
+/*void CCHMSDailyFoodOrder::OnTypeChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnTypeSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnTypeKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnTypeCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnTotalCountChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnTotalCountSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnTotalCountKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnTotalCountCheckValue(){
+	return 0;
+} 
+int CCHMSDailyFoodOrder::OnAddCHMSDailyFoodOrder(){
+ 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_ADD);
+	return 0;
+}
+int CCHMSDailyFoodOrder::OnEditCHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_EDIT);
+	return 0;  
+}
+int CCHMSDailyFoodOrder::OnDeleteCHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO)
+ 		return -1;
+ 	szSQL.Format(_T("DELETE FROM  WHERE  AND") );
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret >= 0){
+ 		SetMode(VM_NONE);
+ 		OnCancelCHMSDailyFoodOrder();
+ 	}
+	return 0;
+}
+int CCHMSDailyFoodOrder::OnSaveCHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT)
+ 		return -1;
+ 	if(!IsValidateData())
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(GetMode() == VM_ADD){
+ 		//szSQL = m_tblTbl.GetInsertSQL();
+ 	}
+ 	else if(GetMode() == VM_EDIT){
+ 		CString szWhere;
+ 		szWhere.Format(_T(" WHERE"));
+ 		//szSQL = m_tblTbl.GetUpdateSQL(_T("createdby,createddate"));
+ 		szSQL += szWhere;
+ 	}
+ _fmsg(_T("%s"), szSQL);
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret > 0)
+ 	{
+ 		//OnCHMSDailyFoodOrderListLoadData();
+ 		SetMode(VM_VIEW);
+ 	}
+ 	else
+ 	{
+ 	}
+ 	return ret;
+ 	return 0;
+}
+int CCHMSDailyFoodOrder::OnCancelCHMSDailyFoodOrder(){
+ 	if(GetMode() == VM_EDIT)
+ 	{
+ 		SetMode(VM_VIEW);
+ 	} 
+ 	else 
+ 	{
+ 		SetMode(VM_NONE);
+ 	} 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	return 0;
+} 
+int CCHMSDailyFoodOrder::OnCHMSDailyFoodOrderListLoadData(){
+	return 0;
+}
Index: Resx/CHMSDailyFoodOrder.h
===================================================================
--- Resx/CHMSDailyFoodOrder.h	(revision 0)
+++ Resx/CHMSDailyFoodOrder.h	(working copy)
@@ -0,0 +1,137 @@
+#ifndef CHMSDAILYFOODORDER_H
+#define CHMSDAILYFOODORDER_H
+
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Copyright  Viet Nam Medical Software Joint Stock Company. 2005-2012. 			
+//	All rights reserved. 
+//	This program is protected by Viet nam and international treaties.  
+//	Unauthorized reproduction or distribution of this program, 
+//	or any portion of it, may result in severe civil and criminal penalties, 
+//	and will be prosecuted to the maximum extent possible under the law.
+//	This file is a part of the GUI(Graphical User Interface) class library.
+//	(c) 2006-2008 Hoang Van Hay, All rights reserved.
+//	CONTACT INFORMATION:
+//	Email  : hayhv@vimes.com.vn or hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+/////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Ban quyen cua Cong Ty Co Phan Phan Mem Y Te Viet Nam 2005-2012.
+//	Do Cuc Ban Quyen, Bo VHTT nuoc Cong hoa xa hoi chu nghia Viet Nam cap.
+//	Chuong trinh phan mem nay duoc Luat phap Viet Nam va quoc te bao ho.
+//	San xuat, su dung hoac phan phoi trai phep toan bo hoac mot phan cua phan men nay se
+//	chiu cac hinh phat va hinh su hoac dan su, co the len den muc toi da dung theo Luat qui dinh.
+//	File nay la mot phan cua thu vien lap trinh(GUI). Ban quyen cua Hoang Van Hay. 2006-2008
+//	THONG TIN LIEN HE:
+//	Email  : hayhv@vimes.com.vn hoac hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+#include "GuiUtils.h"
+#include "GuiView.h"
+#include "DbField.h"
+class CCHMSDailyFoodOrder : public CGuiView{
+protected:
+public:
+	CGuiGroupBox	m_wndOrderInformation;
+	CGuiGroupBox	m_wndPatientInformation;
+	CGuiGroupBox	m_wndDrugInformation;
+	CGuiGroupBox	m_wndGroupListDrug;
+	CGuiLabel		m_wndOrderNoLabel;
+	CGuiTextCtrl	m_wndOrderNo;
+	CGuiButton		m_wndFind;
+	CGuiLabel		m_wndOrderDateLabel;
+	CGuiDateCtrl	m_wndOrderDate;
+	CGuiLabel		m_wndIssueDateLabel;
+	CGuiDateCtrl	m_wndIssueDate;
+	CGuiLabel		m_wndStatusLabel;
+	CGuiTextCtrl	m_wndStatus;
+	CGuiLabel		m_wndNoteLabel;
+	CGuiTextCtrl	m_wndNote;
+	CGuiButton		m_wndSend;
+	CGuiButton		m_wndPrint;
+	CGuiLabel		m_wndPatientNameLabel;
+	CGuiTextCtrl	m_wndPatientName;
+	CGuiLabel		m_wndDeptLabel;
+	CGuiTextCtrl	m_wndDept;
+	CGuiListCtrl	m_wndOrderList;
+	CGuiListCtrl	m_wndPatientList;
+	CGuiListCtrl	m_wndDrugList;
+	CGuiLabel		m_wndTypeLabel;
+	CGuiTextCtrl	m_wndType;
+	CGuiNumberCtrl	m_wndTotalCount;
+	CString	m_szOrderNo;
+	CString	m_szOrderDate;
+	CString	m_szIssueDate;
+	CString	m_szStatus;
+	CString	m_szNote;
+	CString	m_szPatientName;
+	CString	m_szDept;
+	CString	m_szType;
+	long	m_nTotalCount;
+	//void			OnOrderNoChange(); 
+	//void			OnOrderNoSetfocus(); 
+	//void			OnOrderNoKillfocus(); 
+	int			OnOrderNoCheckValue(); 
+	void			OnFindSelect(); 
+	//void			OnOrderDateChange(); 
+	//void			OnOrderDateSetfocus(); 
+	//void			OnOrderDateKillfocus(); 
+	int			OnOrderDateCheckValue(); 
+	//void			OnIssueDateChange(); 
+	//void			OnIssueDateSetfocus(); 
+	//void			OnIssueDateKillfocus(); 
+	int			OnIssueDateCheckValue(); 
+	//void			OnStatusChange(); 
+	//void			OnStatusSetfocus(); 
+	//void			OnStatusKillfocus(); 
+	int			OnStatusCheckValue(); 
+	//void			OnNoteChange(); 
+	//void			OnNoteSetfocus(); 
+	//void			OnNoteKillfocus(); 
+	int			OnNoteCheckValue(); 
+	void			OnSendSelect(); 
+	void			OnPrintSelect(); 
+	//void			OnPatientNameChange(); 
+	//void			OnPatientNameSetfocus(); 
+	//void			OnPatientNameKillfocus(); 
+	int			OnPatientNameCheckValue(); 
+	//void			OnDeptChange(); 
+	//void			OnDeptSetfocus(); 
+	//void			OnDeptKillfocus(); 
+	int			OnDeptCheckValue(); 
+	long			OnOrderListLoadData(); 
+	void			OnOrderListSelectChange(int nOldItem, int nNewItem); 
+	void			OnOrderListDblClick(); 
+	int			OnOrderListDeleteItem(); 
+	long			OnPatientListLoadData(); 
+	void			OnPatientListSelectChange(int nOldItem, int nNewItem); 
+	void			OnPatientListDblClick(); 
+	int			OnPatientListDeleteItem(); 
+	long			OnDrugListLoadData(); 
+	void			OnDrugListSelectChange(int nOldItem, int nNewItem); 
+	void			OnDrugListDblClick(); 
+	int			OnDrugListDeleteItem(); 
+	//void			OnTypeChange(); 
+	//void			OnTypeSetfocus(); 
+	//void			OnTypeKillfocus(); 
+	int			OnTypeCheckValue(); 
+	//void			OnTotalCountChange(); 
+	//void			OnTotalCountSetfocus(); 
+	//void			OnTotalCountKillfocus(); 
+	int			OnTotalCountCheckValue(); 
+	CCHMSDailyFoodOrder();
+	~CCHMSDailyFoodOrder();
+	void OnCreateComponents();
+	void OnInitializeComponents();
+	void OnSetWindowEvents();
+	void OnDoDataExchange(CDataExchange* pDX);
+	void GetDataToScreen();
+	void GetScreenToData();
+	void SetDefaultValues();
+	int SetMode(int nMode);
+	int OnAddCHMSDailyFoodOrder(); 
+	int OnEditCHMSDailyFoodOrder(); 
+	int OnDeleteCHMSDailyFoodOrder(); 
+	int OnSaveCHMSDailyFoodOrder(); 
+	int OnCancelCHMSDailyFoodOrder(); 
+	int OnCHMSDailyFoodOrderListLoadData(); 
+};
+#endif
Index: Resx/CHMSDailyFoodOrder.resx
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: Resx/CHMSDailyFoodOrder.resx
===================================================================
--- Resx/CHMSDailyFoodOrder.resx	(revision 0)
+++ Resx/CHMSDailyFoodOrder.resx	(working copy)

Property changes on: Resx/CHMSDailyFoodOrder.resx
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: Resx/CHMSSummaryDailyFoodOrder.cpp
===================================================================
--- Resx/CHMSSummaryDailyFoodOrder.cpp	(revision 0)
+++ Resx/CHMSSummaryDailyFoodOrder.cpp	(working copy)
@@ -0,0 +1,441 @@
+#include "CHMSSummaryDailyFoodOrder.h"
+#include "MainFrm.h"
+/*static void _OnOrderDateChangeFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnOrderDateChange();
+} */
+/*static void _OnOrderDateSetfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnOrderDateSetfocus();} */ 
+/*static void _OnOrderDateKillfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnOrderDateKillfocus();
+} */
+static int _OnOrderDateCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder *)pWnd)->OnOrderDateCheckValue();
+} 
+/*static void _OnIssueDateChangeFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnIssueDateChange();
+} */
+/*static void _OnIssueDateSetfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnIssueDateSetfocus();} */ 
+/*static void _OnIssueDateKillfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnIssueDateKillfocus();
+} */
+static int _OnIssueDateCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder *)pWnd)->OnIssueDateCheckValue();
+} 
+static void _OnStatusSelectChangeFnc(CWnd *pWnd, int nOldItemSel, int nNewItemSel){
+	((CCHMSSummaryDailyFoodOrder* )pWnd)->OnStatusSelectChange(nOldItemSel, nNewItemSel);
+} 
+static void _OnStatusSelendokFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusSelendok();
+}
+/*static void _OnStatusSetfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+}*/
+/*static void _OnStatusKillfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+}*/
+static long _OnStatusLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusLoadData();
+}
+/*static void _OnStatusAddNewFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusAddNew();
+}*/
+static void _OnPrintSelectFnc(CWnd *pWnd){
+	CCHMSSummaryDailyFoodOrder *pVw = (CCHMSSummaryDailyFoodOrder *)pWnd;
+	pVw->OnPrintSelect();
+} 
+static long _OnOrderListLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListLoadData();
+} 
+static void _OnOrderListDblClickFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListDblClick();
+} 
+static void _OnOrderListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CCHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnOrderListDeleteItemFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListDeleteItem();
+} 
+static void _OnRefreshSelectFnc(CWnd *pWnd){
+	CCHMSSummaryDailyFoodOrder *pVw = (CCHMSSummaryDailyFoodOrder *)pWnd;
+	pVw->OnRefreshSelect();
+} 
+static void _OnFoodTypeSelectChangeFnc(CWnd *pWnd, int nOldItemSel, int nNewItemSel){
+	((CCHMSSummaryDailyFoodOrder* )pWnd)->OnFoodTypeSelectChange(nOldItemSel, nNewItemSel);
+} 
+static void _OnFoodTypeSelendokFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeSelendok();
+}
+/*static void _OnFoodTypeSetfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeKillfocus();
+}*/
+/*static void _OnFoodTypeKillfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeKillfocus();
+}*/
+static long _OnFoodTypeLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeLoadData();
+}
+/*static void _OnFoodTypeAddNewFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeAddNew();
+}*/
+static int _OnAddCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnAddCHMSSummaryDailyFoodOrder();
+} 
+static int _OnEditCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnEditCHMSSummaryDailyFoodOrder();
+} 
+static int _OnDeleteCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnDeleteCHMSSummaryDailyFoodOrder();
+} 
+static int _OnSaveCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnSaveCHMSSummaryDailyFoodOrder();
+} 
+static int _OnCancelCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnCancelCHMSSummaryDailyFoodOrder();
+} 
+CCHMSSummaryDailyFoodOrder::CCHMSSummaryDailyFoodOrder(){
+
+	m_nDlgWidth = 1029;
+	m_nDlgHeight = 635;
+	SetDefaultValues();
+}
+CCHMSSummaryDailyFoodOrder::~CCHMSSummaryDailyFoodOrder(){
+}
+void CCHMSSummaryDailyFoodOrder::OnCreateComponents(){
+	m_wndOrderInformation.Create(this, _T("Order Information"), 5, 5, 1020, 60);
+	m_wndGroupListDrug.Create(this, _T("Food Type List"), 5, 65, 1020, 625);
+	m_wndOrderDateLabel.Create(this, _T("Order Date"), 10, 30, 100, 55);
+	m_wndOrderDate.Create(this,105, 30, 195, 55); 
+	m_wndIssueDateLabel.Create(this, _T("Issue Date"), 200, 30, 290, 55);
+	m_wndIssueDate.Create(this,295, 30, 385, 55); 
+	m_wndStatusLabel.Create(this, _T("Status"), 390, 30, 480, 55);
+	m_wndStatus.Create(this,485, 30, 625, 55); 
+	m_wndPrint.Create(this, _T("&Preview"), 930, 30, 1015, 55);
+	m_wndOrderList.Create(this,10, 90, 1015, 620); 
+	m_wndRefresh.Create(this, _T("Refresh"), 845, 30, 925, 55);
+	m_wndFoodTypeLabel.Create(this, _T("Food Type"), 630, 30, 710, 55);
+	m_wndFoodType.Create(this,715, 30, 840, 55); 
+
+}
+void CCHMSSummaryDailyFoodOrder::OnInitializeComponents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	m_wndOrderDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndOrderDate.SetCheckValue(true);
+	m_wndIssueDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndIssueDate.SetCheckValue(true);
+	m_wndStatus.SetCheckValue(true);
+	m_wndStatus.LimitText(1024);
+	m_wndFoodType.SetCheckValue(true);
+	m_wndFoodType.LimitText(35);
+
+
+
+
+
+
+	m_wndFoodType.InsertColumn(0, _T("ID"), CFMT_TEXT, 50);
+	m_wndFoodType.InsertColumn(1, _T("Name"), CFMT_TEXT, 150);
+
+}
+void CCHMSSummaryDailyFoodOrder::OnSetWindowEvents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	//m_wndOrderDate.SetEvent(WE_CHANGE, _OnOrderDateChangeFnc);
+	//m_wndOrderDate.SetEvent(WE_SETFOCUS, _OnOrderDateSetfocusFnc);
+	//m_wndOrderDate.SetEvent(WE_KILLFOCUS, _OnOrderDateKillfocusFnc);
+	m_wndOrderDate.SetEvent(WE_CHECKVALUE, _OnOrderDateCheckValueFnc);
+	//m_wndIssueDate.SetEvent(WE_CHANGE, _OnIssueDateChangeFnc);
+	//m_wndIssueDate.SetEvent(WE_SETFOCUS, _OnIssueDateSetfocusFnc);
+	//m_wndIssueDate.SetEvent(WE_KILLFOCUS, _OnIssueDateKillfocusFnc);
+	m_wndIssueDate.SetEvent(WE_CHECKVALUE, _OnIssueDateCheckValueFnc);
+	m_wndStatus.SetEvent(WE_SELENDOK, _OnStatusSelendokFnc);
+	//m_wndStatus.SetEvent(WE_SETFOCUS, _OnStatusSetfocusFnc);
+	//m_wndStatus.SetEvent(WE_KILLFOCUS, _OnStatusKillfocusFnc);
+	m_wndStatus.SetEvent(WE_SELCHANGE, _OnStatusSelectChangeFnc);
+	m_wndStatus.SetEvent(WE_LOADDATA, _OnStatusLoadDataFnc);
+	//m_wndStatus.SetEvent(WE_ADDNEW, _OnStatusAddNewFnc);
+	m_wndPrint.SetEvent(WE_CLICK, _OnPrintSelectFnc);
+	m_wndOrderList.SetEvent(WE_SELCHANGE, _OnOrderListSelectChangeFnc);
+	m_wndOrderList.SetEvent(WE_LOADDATA, _OnOrderListLoadDataFnc);
+	m_wndOrderList.SetEvent(WE_DBLCLICK, _OnOrderListDblClickFnc);
+	m_wndOrderList.AddEvent(1, _T("Delete"), _OnOrderListDeleteItemFnc, 0, VK_DELETE, 0);
+	m_wndRefresh.SetEvent(WE_CLICK, _OnRefreshSelectFnc);
+	m_wndFoodType.SetEvent(WE_SELENDOK, _OnFoodTypeSelendokFnc);
+	//m_wndFoodType.SetEvent(WE_SETFOCUS, _OnFoodTypeSetfocusFnc);
+	//m_wndFoodType.SetEvent(WE_KILLFOCUS, _OnFoodTypeKillfocusFnc);
+	m_wndFoodType.SetEvent(WE_SELCHANGE, _OnFoodTypeSelectChangeFnc);
+	m_wndFoodType.SetEvent(WE_LOADDATA, _OnFoodTypeLoadDataFnc);
+	//m_wndFoodType.SetEvent(WE_ADDNEW, _OnFoodTypeAddNewFnc);
+	AddEvent(1, _T("Add	Ctrl+A"), _OnAddCHMSSummaryDailyFoodOrderFnc, 0, 'A', VK_CONTROL);
+	AddEvent(2, _T("Edit	Ctrl+E"), _OnEditCHMSSummaryDailyFoodOrderFnc, 0, 'E', VK_CONTROL);
+	AddEvent(3, _T("Delete	Ctrl+D"), _OnDeleteCHMSSummaryDailyFoodOrderFnc, 0, 'D', VK_CONTROL);
+	AddEvent(4, _T("Save	Ctrl+S"), _OnSaveCHMSSummaryDailyFoodOrderFnc, 0, 'S', VK_CONTROL);
+	AddEvent(0, _T("-"));
+	AddEvent(5, _T("Cancel	Ctrl+T"), _OnCancelCHMSSummaryDailyFoodOrderFnc, 0, 'T', VK_CONTROL);
+	SetMode(VM_NONE);
+
+}
+void CCHMSSummaryDailyFoodOrder::OnDoDataExchange(CDataExchange* pDX){
+	DDX_TextEx(pDX, m_wndOrderDate.GetDlgCtrlID(), m_szOrderDate);
+	DDX_TextEx(pDX, m_wndIssueDate.GetDlgCtrlID(), m_szIssueDate);
+	DDX_TextEx(pDX, m_wndStatus.GetDlgCtrlID(), m_szStatusKey);
+	DDX_TextEx(pDX, m_wndFoodType.GetDlgCtrlID(), m_szFoodTypeKey);
+
+}
+void CCHMSSummaryDailyFoodOrder::GetDataToScreen(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT * FROM "));
+	rs.ExecSQL(szSQL);
+
+}
+void CCHMSSummaryDailyFoodOrder::GetScreenToData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+
+}
+void CCHMSSummaryDailyFoodOrder::SetDefaultValues(){
+
+	m_szOrderDate.Empty();
+	m_szIssueDate.Empty();
+	m_szStatusKey.Empty();
+	m_szFoodTypeKey.Empty();
+
+}
+int CCHMSSummaryDailyFoodOrder::SetMode(int nMode){
+ 		int nOldMode = GetMode();
+ 		CGuiView::SetMode(nMode);
+ 		CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 		CString szSQL;
+ 		CRecord rs(&pMF->m_db);
+  		switch(nMode){
+ 		case VM_ADD: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		case VM_EDIT: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			break;
+ 		case VM_VIEW: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(FALSE, 3, 4, -1);
+ 			break;
+ 		case VM_NONE: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(TRUE, 0, 6, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		};
+ 		UpdateData(FALSE);
+ 		return nOldMode;
+}
+/*void CCHMSSummaryDailyFoodOrder::OnOrderDateChange(){
+	
+} */
+/*void CCHMSSummaryDailyFoodOrder::OnOrderDateSetfocus(){
+	
+} */
+/*void CCHMSSummaryDailyFoodOrder::OnOrderDateKillfocus(){
+	
+} */
+int CCHMSSummaryDailyFoodOrder::OnOrderDateCheckValue(){
+	return 0;
+} 
+/*void CCHMSSummaryDailyFoodOrder::OnIssueDateChange(){
+	
+} */
+/*void CCHMSSummaryDailyFoodOrder::OnIssueDateSetfocus(){
+	
+} */
+/*void CCHMSSummaryDailyFoodOrder::OnIssueDateKillfocus(){
+	
+} */
+int CCHMSSummaryDailyFoodOrder::OnIssueDateCheckValue(){
+	return 0;
+} 
+void CCHMSSummaryDailyFoodOrder::OnStatusSelectChange(int nOldItemSel, int nNewItemSel){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnStatusSelendok(){
+	 
+}
+/*void CCHMSSummaryDailyFoodOrder::OnStatusSetfocus(){
+	
+}*/
+/*void CCHMSSummaryDailyFoodOrder::OnStatusKillfocus(){
+	
+}*/
+long CCHMSSummaryDailyFoodOrder::OnStatusLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+/*
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szWhere;
+	if(m_wndStatus.IsSearchKey() && !m_szStatusKey.IsEmpty()){
+	 szWhere.Format(_T(" and id='%s' "), m_szStatusKey
+};
+	m_wndStatus.DeleteAllItems(); 
+	int nCount = 0;
+	szSQL.Format(_T("SELECT fld1 as id, fld2 as name FROM tbl WHERE 1=1 %s ORDER BY id "), szWhere
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndStatus.AddItems(
+		rs.MoveNext();
+	}
+	return nCount;
+*/
+	return 0;
+}
+/*void CCHMSSummaryDailyFoodOrder::OnStatusAddNew(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} */
+void CCHMSSummaryDailyFoodOrder::OnPrintSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnOrderListDblClick(){
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnOrderListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CCHMSSummaryDailyFoodOrder::OnOrderListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CCHMSSummaryDailyFoodOrder::OnOrderListLoadData(){
+/*
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	m_wndOrderList.BeginLoad(); 
+	int nCount = 0;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndOrderList.AddItems(
+		rs.MoveNext();
+	}
+	m_wndOrderList.EndLoad(); 
+	return nCount;
+*/
+	return 0;
+}
+void CCHMSSummaryDailyFoodOrder::OnRefreshSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnFoodTypeSelectChange(int nOldItemSel, int nNewItemSel){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnFoodTypeSelendok(){
+	 
+}
+/*void CCHMSSummaryDailyFoodOrder::OnFoodTypeSetfocus(){
+	
+}*/
+/*void CCHMSSummaryDailyFoodOrder::OnFoodTypeKillfocus(){
+	
+}*/
+long CCHMSSummaryDailyFoodOrder::OnFoodTypeLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+/*
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szWhere;
+	if(m_wndFoodType.IsSearchKey() && !m_szFoodTypeKey.IsEmpty()){
+	 szWhere.Format(_T(" and id='%s' "), m_szFoodTypeKey
+};
+	m_wndFoodType.DeleteAllItems(); 
+	int nCount = 0;
+	szSQL.Format(_T("SELECT fld1 as id, fld2 as name FROM tbl WHERE 1=1 %s ORDER BY id "), szWhere
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndFoodType.AddItems(
+			rs.GetValue(_T("id")), 
+			rs.GetValue(_T("name")), NULL);
+		rs.MoveNext();
+	}
+	return nCount;
+*/
+	return 0;
+}
+/*void CCHMSSummaryDailyFoodOrder::OnFoodTypeAddNew(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} */
+int CCHMSSummaryDailyFoodOrder::OnAddCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_ADD);
+	return 0;
+}
+int CCHMSSummaryDailyFoodOrder::OnEditCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_EDIT);
+	return 0;  
+}
+int CCHMSSummaryDailyFoodOrder::OnDeleteCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO)
+ 		return -1;
+ 	szSQL.Format(_T("DELETE FROM  WHERE  AND") );
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret >= 0){
+ 		SetMode(VM_NONE);
+ 		OnCancelCHMSSummaryDailyFoodOrder();
+ 	}
+	return 0;
+}
+int CCHMSSummaryDailyFoodOrder::OnSaveCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT)
+ 		return -1;
+ 	if(!IsValidateData())
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(GetMode() == VM_ADD){
+ 		//szSQL = m_tblTbl.GetInsertSQL();
+ 	}
+ 	else if(GetMode() == VM_EDIT){
+ 		CString szWhere;
+ 		szWhere.Format(_T(" WHERE"));
+ 		//szSQL = m_tblTbl.GetUpdateSQL(_T("createdby,createddate"));
+ 		szSQL += szWhere;
+ 	}
+ _fmsg(_T("%s"), szSQL);
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret > 0)
+ 	{
+ 		//OnCHMSSummaryDailyFoodOrderListLoadData();
+ 		SetMode(VM_VIEW);
+ 	}
+ 	else
+ 	{
+ 	}
+ 	return ret;
+ 	return 0;
+}
+int CCHMSSummaryDailyFoodOrder::OnCancelCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() == VM_EDIT)
+ 	{
+ 		SetMode(VM_VIEW);
+ 	} 
+ 	else 
+ 	{
+ 		SetMode(VM_NONE);
+ 	} 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	return 0;
+} 
+int CCHMSSummaryDailyFoodOrder::OnCHMSSummaryDailyFoodOrderListLoadData(){
+	return 0;
+}
Index: Resx/CHMSSummaryDailyFoodOrder.h
===================================================================
--- Resx/CHMSSummaryDailyFoodOrder.h	(revision 0)
+++ Resx/CHMSSummaryDailyFoodOrder.h	(working copy)
@@ -0,0 +1,93 @@
+#ifndef CHMSSUMMARYDAILYFOODORDER_H
+#define CHMSSUMMARYDAILYFOODORDER_H
+
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Copyright  Viet Nam Medical Software Joint Stock Company. 2005-2012. 			
+//	All rights reserved. 
+//	This program is protected by Viet nam and international treaties.  
+//	Unauthorized reproduction or distribution of this program, 
+//	or any portion of it, may result in severe civil and criminal penalties, 
+//	and will be prosecuted to the maximum extent possible under the law.
+//	This file is a part of the GUI(Graphical User Interface) class library.
+//	(c) 2006-2008 Hoang Van Hay, All rights reserved.
+//	CONTACT INFORMATION:
+//	Email  : hayhv@vimes.com.vn or hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+/////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Ban quyen cua Cong Ty Co Phan Phan Mem Y Te Viet Nam 2005-2012.
+//	Do Cuc Ban Quyen, Bo VHTT nuoc Cong hoa xa hoi chu nghia Viet Nam cap.
+//	Chuong trinh phan mem nay duoc Luat phap Viet Nam va quoc te bao ho.
+//	San xuat, su dung hoac phan phoi trai phep toan bo hoac mot phan cua phan men nay se
+//	chiu cac hinh phat va hinh su hoac dan su, co the len den muc toi da dung theo Luat qui dinh.
+//	File nay la mot phan cua thu vien lap trinh(GUI). Ban quyen cua Hoang Van Hay. 2006-2008
+//	THONG TIN LIEN HE:
+//	Email  : hayhv@vimes.com.vn hoac hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+#include "GuiUtils.h"
+#include "GuiView.h"
+#include "DbField.h"
+class CCHMSSummaryDailyFoodOrder : public CGuiView{
+protected:
+public:
+	CGuiGroupBox	m_wndOrderInformation;
+	CGuiGroupBox	m_wndGroupListDrug;
+	CGuiLabel		m_wndOrderDateLabel;
+	CGuiDateCtrl	m_wndOrderDate;
+	CGuiLabel		m_wndIssueDateLabel;
+	CGuiDateCtrl	m_wndIssueDate;
+	CGuiLabel		m_wndStatusLabel;
+	CGuiComboBox	m_wndStatus;
+	CGuiButton		m_wndPrint;
+	CGuiListCtrl	m_wndOrderList;
+	CGuiButton		m_wndRefresh;
+	CGuiLabel		m_wndFoodTypeLabel;
+	CGuiComboBox	m_wndFoodType;
+	CString	m_szOrderDate;
+	CString	m_szIssueDate;
+	CString	m_szStatusKey;
+	CString	m_szFoodTypeKey;
+	//void			OnOrderDateChange(); 
+	//void			OnOrderDateSetfocus(); 
+	//void			OnOrderDateKillfocus(); 
+	int			OnOrderDateCheckValue(); 
+	//void			OnIssueDateChange(); 
+	//void			OnIssueDateSetfocus(); 
+	//void			OnIssueDateKillfocus(); 
+	int			OnIssueDateCheckValue(); 
+	void			OnStatusSelectChange(int nOldItemSel, int nNewItemSel); 
+	void			OnStatusSelendok(); 
+	//void			OnStatusSetfocus(); 
+	//void			OnStatusKillfocus(); 
+	long			OnStatusLoadData(); 
+	//void			OnStatusAddNew(); 
+	void			OnPrintSelect(); 
+	long			OnOrderListLoadData(); 
+	void			OnOrderListSelectChange(int nOldItem, int nNewItem); 
+	void			OnOrderListDblClick(); 
+	int			OnOrderListDeleteItem(); 
+	void			OnRefreshSelect(); 
+	void			OnFoodTypeSelectChange(int nOldItemSel, int nNewItemSel); 
+	void			OnFoodTypeSelendok(); 
+	//void			OnFoodTypeSetfocus(); 
+	//void			OnFoodTypeKillfocus(); 
+	long			OnFoodTypeLoadData(); 
+	//void			OnFoodTypeAddNew(); 
+	CCHMSSummaryDailyFoodOrder();
+	~CCHMSSummaryDailyFoodOrder();
+	void OnCreateComponents();
+	void OnInitializeComponents();
+	void OnSetWindowEvents();
+	void OnDoDataExchange(CDataExchange* pDX);
+	void GetDataToScreen();
+	void GetScreenToData();
+	void SetDefaultValues();
+	int SetMode(int nMode);
+	int OnAddCHMSSummaryDailyFoodOrder(); 
+	int OnEditCHMSSummaryDailyFoodOrder(); 
+	int OnDeleteCHMSSummaryDailyFoodOrder(); 
+	int OnSaveCHMSSummaryDailyFoodOrder(); 
+	int OnCancelCHMSSummaryDailyFoodOrder(); 
+	int OnCHMSSummaryDailyFoodOrderListLoadData(); 
+};
+#endif
Index: Resx/CHMSSummaryDailyFoodOrder.resx
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: Resx/CHMSSummaryDailyFoodOrder.resx
===================================================================
--- Resx/CHMSSummaryDailyFoodOrder.resx	(revision 0)
+++ Resx/CHMSSummaryDailyFoodOrder.resx	(working copy)

Property changes on: Resx/CHMSSummaryDailyFoodOrder.resx
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: Resx/CHMSDailyFoodOrder.cpp
===================================================================
--- Resx/CHMSDailyFoodOrder.cpp	(revision 0)
+++ Resx/CHMSDailyFoodOrder.cpp	(working copy)
@@ -0,0 +1,635 @@
+#include "CHMSDailyFoodOrder.h"
+#include "MainFrm.h"
+/*static void _OnOrderNoChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderNoChange();
+} */
+/*static void _OnOrderNoSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderNoSetfocus();} */ 
+/*static void _OnOrderNoKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderNoKillfocus();
+} */
+static int _OnOrderNoCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnOrderNoCheckValue();
+} 
+static void _OnFindSelectFnc(CWnd *pWnd){
+	CCHMSDailyFoodOrder *pVw = (CCHMSDailyFoodOrder *)pWnd;
+	pVw->OnFindSelect();
+} 
+/*static void _OnOrderDateChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderDateChange();
+} */
+/*static void _OnOrderDateSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderDateSetfocus();} */ 
+/*static void _OnOrderDateKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnOrderDateKillfocus();
+} */
+static int _OnOrderDateCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnOrderDateCheckValue();
+} 
+/*static void _OnIssueDateChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnIssueDateChange();
+} */
+/*static void _OnIssueDateSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnIssueDateSetfocus();} */ 
+/*static void _OnIssueDateKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnIssueDateKillfocus();
+} */
+static int _OnIssueDateCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnIssueDateCheckValue();
+} 
+/*static void _OnStatusChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnStatusChange();
+} */
+/*static void _OnStatusSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnStatusSetfocus();} */ 
+/*static void _OnStatusKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+} */
+static int _OnStatusCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnStatusCheckValue();
+} 
+/*static void _OnNoteChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnNoteChange();
+} */
+/*static void _OnNoteSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnNoteSetfocus();} */ 
+/*static void _OnNoteKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnNoteKillfocus();
+} */
+static int _OnNoteCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnNoteCheckValue();
+} 
+static void _OnSendSelectFnc(CWnd *pWnd){
+	CCHMSDailyFoodOrder *pVw = (CCHMSDailyFoodOrder *)pWnd;
+	pVw->OnSendSelect();
+} 
+static void _OnPrintSelectFnc(CWnd *pWnd){
+	CCHMSDailyFoodOrder *pVw = (CCHMSDailyFoodOrder *)pWnd;
+	pVw->OnPrintSelect();
+} 
+/*static void _OnPatientNameChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnPatientNameChange();
+} */
+/*static void _OnPatientNameSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnPatientNameSetfocus();} */ 
+/*static void _OnPatientNameKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnPatientNameKillfocus();
+} */
+static int _OnPatientNameCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnPatientNameCheckValue();
+} 
+/*static void _OnDeptChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnDeptChange();
+} */
+/*static void _OnDeptSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnDeptSetfocus();} */ 
+/*static void _OnDeptKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnDeptKillfocus();
+} */
+static int _OnDeptCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnDeptCheckValue();
+} 
+static long _OnOrderListLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder*)pWnd)->OnOrderListLoadData();
+} 
+static void _OnOrderListDblClickFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder*)pWnd)->OnOrderListDblClick();
+} 
+static void _OnOrderListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CCHMSDailyFoodOrder*)pWnd)->OnOrderListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnOrderListDeleteItemFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnOrderListDeleteItem();
+} 
+static long _OnPatientListLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder*)pWnd)->OnPatientListLoadData();
+} 
+static void _OnPatientListDblClickFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder*)pWnd)->OnPatientListDblClick();
+} 
+static void _OnPatientListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CCHMSDailyFoodOrder*)pWnd)->OnPatientListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnPatientListDeleteItemFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnPatientListDeleteItem();
+} 
+static long _OnDrugListLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder*)pWnd)->OnDrugListLoadData();
+} 
+static void _OnDrugListDblClickFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder*)pWnd)->OnDrugListDblClick();
+} 
+static void _OnDrugListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CCHMSDailyFoodOrder*)pWnd)->OnDrugListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnDrugListDeleteItemFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnDrugListDeleteItem();
+} 
+/*static void _OnTypeChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTypeChange();
+} */
+/*static void _OnTypeSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTypeSetfocus();} */ 
+/*static void _OnTypeKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTypeKillfocus();
+} */
+static int _OnTypeCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnTypeCheckValue();
+} 
+/*static void _OnTotalCountChangeFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTotalCountChange();
+} */
+/*static void _OnTotalCountSetfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTotalCountSetfocus();} */ 
+/*static void _OnTotalCountKillfocusFnc(CWnd *pWnd){
+	((CCHMSDailyFoodOrder *)pWnd)->OnTotalCountKillfocus();
+} */
+static int _OnTotalCountCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSDailyFoodOrder *)pWnd)->OnTotalCountCheckValue();
+} 
+static int _OnAddCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnAddCHMSDailyFoodOrder();
+} 
+static int _OnEditCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnEditCHMSDailyFoodOrder();
+} 
+static int _OnDeleteCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnDeleteCHMSDailyFoodOrder();
+} 
+static int _OnSaveCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnSaveCHMSDailyFoodOrder();
+} 
+static int _OnCancelCHMSDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSDailyFoodOrder*)pWnd)->OnCancelCHMSDailyFoodOrder();
+} 
+CCHMSDailyFoodOrder::CCHMSDailyFoodOrder(){
+
+	m_nDlgWidth = 1029;
+	m_nDlgHeight = 635;
+	SetDefaultValues();
+}
+CCHMSDailyFoodOrder::~CCHMSDailyFoodOrder(){
+}
+void CCHMSDailyFoodOrder::OnCreateComponents(){
+	m_wndOrderInformation.Create(this, _T("Order Information"), 5, 5, 550, 180);
+	m_wndPatientInformation.Create(this, _T("Patient Information"), 555, 5, 1020, 410);
+	m_wndDrugInformation.Create(this, _T("Food Informations"), 555, 445, 1020, 625);
+	m_wndGroupListDrug.Create(this, _T("Food Type List"), 5, 185, 550, 625);
+	m_wndOrderNoLabel.Create(this, _T("Order ID"), 10, 30, 140, 55);
+	m_wndOrderNo.Create(this,145, 30, 275, 55); 
+	m_wndFind.Create(this, _T("&Find"), 825, 415, 925, 440);
+	m_wndOrderDateLabel.Create(this, _T("Order Date"), 10, 60, 140, 85);
+	m_wndOrderDate.Create(this,145, 60, 275, 85); 
+	m_wndIssueDateLabel.Create(this, _T("Issue Date"), 280, 60, 410, 85);
+	m_wndIssueDate.Create(this,415, 60, 545, 85); 
+	m_wndStatusLabel.Create(this, _T("Status"), 280, 30, 410, 55);
+	m_wndStatus.Create(this,415, 30, 545, 55); 
+	m_wndNoteLabel.Create(this, _T("Note"), 10, 90, 140, 115);
+	m_wndNote.Create(this,145, 90, 545, 115); 
+	m_wndSend.Create(this, _T("&Send"), 370, 150, 455, 175);
+	m_wndPrint.Create(this, _T("&Preview"), 460, 150, 545, 175);
+	m_wndPatientNameLabel.Create(this, _T("Patient Name"), 555, 415, 665, 440);
+	m_wndPatientName.Create(this,670, 415, 820, 440); 
+	m_wndDeptLabel.Create(this, _T("Dept"), 10, 120, 140, 145);
+	m_wndDept.Create(this,145, 120, 545, 145); 
+	m_wndOrderList.Create(this,10, 210, 545, 620); 
+	m_wndPatientList.Create(this,560, 30, 1015, 405); 
+	m_wndDrugList.Create(this,560, 470, 1015, 620); 
+	m_wndTypeLabel.Create(this, _T("Type"), 10, 149, 140, 174);
+	m_wndType.Create(this,145, 149, 360, 174); 
+	m_wndTotalCount.Create(this,935, 415, 1015, 440); 
+
+}
+void CCHMSDailyFoodOrder::OnInitializeComponents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	m_wndOrderNo.SetLimitText(1024);
+	m_wndOrderNo.SetCheckValue(true);
+	m_wndOrderDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndOrderDate.SetCheckValue(true);
+	m_wndIssueDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndIssueDate.SetCheckValue(true);
+	m_wndStatus.SetLimitText(1024);
+	m_wndStatus.SetCheckValue(true);
+	m_wndNote.SetLimitText(1024);
+	m_wndNote.SetCheckValue(true);
+	m_wndPatientName.SetLimitText(1024);
+	m_wndPatientName.SetCheckValue(true);
+	m_wndDept.SetLimitText(35);
+	m_wndDept.SetCheckValue(true);
+	m_wndType.SetLimitText(35);
+	m_wndType.SetCheckValue(true);
+	m_wndTotalCount.SetLimitText(16);
+	m_wndTotalCount.SetCheckValue(true);
+
+
+
+
+
+
+
+}
+void CCHMSDailyFoodOrder::OnSetWindowEvents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	//m_wndOrderNo.SetEvent(WE_CHANGE, _OnOrderNoChangeFnc);
+	//m_wndOrderNo.SetEvent(WE_SETFOCUS, _OnOrderNoSetfocusFnc);
+	//m_wndOrderNo.SetEvent(WE_KILLFOCUS, _OnOrderNoKillfocusFnc);
+	m_wndOrderNo.SetEvent(WE_CHECKVALUE, _OnOrderNoCheckValueFnc);
+	m_wndFind.SetEvent(WE_CLICK, _OnFindSelectFnc);
+	//m_wndOrderDate.SetEvent(WE_CHANGE, _OnOrderDateChangeFnc);
+	//m_wndOrderDate.SetEvent(WE_SETFOCUS, _OnOrderDateSetfocusFnc);
+	//m_wndOrderDate.SetEvent(WE_KILLFOCUS, _OnOrderDateKillfocusFnc);
+	m_wndOrderDate.SetEvent(WE_CHECKVALUE, _OnOrderDateCheckValueFnc);
+	//m_wndIssueDate.SetEvent(WE_CHANGE, _OnIssueDateChangeFnc);
+	//m_wndIssueDate.SetEvent(WE_SETFOCUS, _OnIssueDateSetfocusFnc);
+	//m_wndIssueDate.SetEvent(WE_KILLFOCUS, _OnIssueDateKillfocusFnc);
+	m_wndIssueDate.SetEvent(WE_CHECKVALUE, _OnIssueDateCheckValueFnc);
+	//m_wndStatus.SetEvent(WE_CHANGE, _OnStatusChangeFnc);
+	//m_wndStatus.SetEvent(WE_SETFOCUS, _OnStatusSetfocusFnc);
+	//m_wndStatus.SetEvent(WE_KILLFOCUS, _OnStatusKillfocusFnc);
+	m_wndStatus.SetEvent(WE_CHECKVALUE, _OnStatusCheckValueFnc);
+	//m_wndNote.SetEvent(WE_CHANGE, _OnNoteChangeFnc);
+	//m_wndNote.SetEvent(WE_SETFOCUS, _OnNoteSetfocusFnc);
+	//m_wndNote.SetEvent(WE_KILLFOCUS, _OnNoteKillfocusFnc);
+	m_wndNote.SetEvent(WE_CHECKVALUE, _OnNoteCheckValueFnc);
+	m_wndSend.SetEvent(WE_CLICK, _OnSendSelectFnc);
+	m_wndPrint.SetEvent(WE_CLICK, _OnPrintSelectFnc);
+	//m_wndPatientName.SetEvent(WE_CHANGE, _OnPatientNameChangeFnc);
+	//m_wndPatientName.SetEvent(WE_SETFOCUS, _OnPatientNameSetfocusFnc);
+	//m_wndPatientName.SetEvent(WE_KILLFOCUS, _OnPatientNameKillfocusFnc);
+	m_wndPatientName.SetEvent(WE_CHECKVALUE, _OnPatientNameCheckValueFnc);
+	//m_wndDept.SetEvent(WE_CHANGE, _OnDeptChangeFnc);
+	//m_wndDept.SetEvent(WE_SETFOCUS, _OnDeptSetfocusFnc);
+	//m_wndDept.SetEvent(WE_KILLFOCUS, _OnDeptKillfocusFnc);
+	m_wndDept.SetEvent(WE_CHECKVALUE, _OnDeptCheckValueFnc);
+	m_wndOrderList.SetEvent(WE_SELCHANGE, _OnOrderListSelectChangeFnc);
+	m_wndOrderList.SetEvent(WE_LOADDATA, _OnOrderListLoadDataFnc);
+	m_wndOrderList.SetEvent(WE_DBLCLICK, _OnOrderListDblClickFnc);
+	m_wndOrderList.AddEvent(1, _T("Delete"), _OnOrderListDeleteItemFnc, 0, VK_DELETE, 0);
+	m_wndPatientList.SetEvent(WE_SELCHANGE, _OnPatientListSelectChangeFnc);
+	m_wndPatientList.SetEvent(WE_LOADDATA, _OnPatientListLoadDataFnc);
+	m_wndPatientList.SetEvent(WE_DBLCLICK, _OnPatientListDblClickFnc);
+	m_wndPatientList.AddEvent(1, _T("Delete"), _OnPatientListDeleteItemFnc, 0, VK_DELETE, 0);
+	m_wndDrugList.SetEvent(WE_SELCHANGE, _OnDrugListSelectChangeFnc);
+	m_wndDrugList.SetEvent(WE_LOADDATA, _OnDrugListLoadDataFnc);
+	m_wndDrugList.SetEvent(WE_DBLCLICK, _OnDrugListDblClickFnc);
+	m_wndDrugList.AddEvent(1, _T("Delete"), _OnDrugListDeleteItemFnc, 0, VK_DELETE, 0);
+	//m_wndType.SetEvent(WE_CHANGE, _OnTypeChangeFnc);
+	//m_wndType.SetEvent(WE_SETFOCUS, _OnTypeSetfocusFnc);
+	//m_wndType.SetEvent(WE_KILLFOCUS, _OnTypeKillfocusFnc);
+	m_wndType.SetEvent(WE_CHECKVALUE, _OnTypeCheckValueFnc);
+	//m_wndTotalCount.SetEvent(WE_CHANGE, _OnTotalCountChangeFnc);
+	//m_wndTotalCount.SetEvent(WE_SETFOCUS, _OnTotalCountSetfocusFnc);
+	//m_wndTotalCount.SetEvent(WE_KILLFOCUS, _OnTotalCountKillfocusFnc);
+	m_wndTotalCount.SetEvent(WE_CHECKVALUE, _OnTotalCountCheckValueFnc);
+	AddEvent(1, _T("Add	Ctrl+A"), _OnAddCHMSDailyFoodOrderFnc, 0, 'A', VK_CONTROL);
+	AddEvent(2, _T("Edit	Ctrl+E"), _OnEditCHMSDailyFoodOrderFnc, 0, 'E', VK_CONTROL);
+	AddEvent(3, _T("Delete	Ctrl+D"), _OnDeleteCHMSDailyFoodOrderFnc, 0, 'D', VK_CONTROL);
+	AddEvent(4, _T("Save	Ctrl+S"), _OnSaveCHMSDailyFoodOrderFnc, 0, 'S', VK_CONTROL);
+	AddEvent(0, _T("-"));
+	AddEvent(5, _T("Cancel	Ctrl+T"), _OnCancelCHMSDailyFoodOrderFnc, 0, 'T', VK_CONTROL);
+	SetMode(VM_NONE);
+
+}
+void CCHMSDailyFoodOrder::OnDoDataExchange(CDataExchange* pDX){
+	DDX_Text(pDX, m_wndOrderNo.GetDlgCtrlID(), m_szOrderNo);
+	DDX_TextEx(pDX, m_wndOrderDate.GetDlgCtrlID(), m_szOrderDate);
+	DDX_TextEx(pDX, m_wndIssueDate.GetDlgCtrlID(), m_szIssueDate);
+	DDX_Text(pDX, m_wndStatus.GetDlgCtrlID(), m_szStatus);
+	DDX_Text(pDX, m_wndNote.GetDlgCtrlID(), m_szNote);
+	DDX_Text(pDX, m_wndPatientName.GetDlgCtrlID(), m_szPatientName);
+	DDX_Text(pDX, m_wndDept.GetDlgCtrlID(), m_szDept);
+	DDX_Text(pDX, m_wndType.GetDlgCtrlID(), m_szType);
+	DDX_Text(pDX, m_wndTotalCount.GetDlgCtrlID(), m_nTotalCount);
+
+}
+void CCHMSDailyFoodOrder::GetDataToScreen(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT * FROM "));
+	rs.ExecSQL(szSQL);
+
+}
+void CCHMSDailyFoodOrder::GetScreenToData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+
+}
+void CCHMSDailyFoodOrder::SetDefaultValues(){
+
+	m_szOrderNo.Empty();
+	m_szOrderDate.Empty();
+	m_szIssueDate.Empty();
+	m_szStatus.Empty();
+	m_szNote.Empty();
+	m_szPatientName.Empty();
+	m_szDept.Empty();
+	m_szType.Empty();
+	m_nTotalCount=0;
+
+}
+int CCHMSDailyFoodOrder::SetMode(int nMode){
+ 		int nOldMode = GetMode();
+ 		CGuiView::SetMode(nMode);
+ 		CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 		CString szSQL;
+ 		CRecord rs(&pMF->m_db);
+  		switch(nMode){
+ 		case VM_ADD: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		case VM_EDIT: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			break;
+ 		case VM_VIEW: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(FALSE, 3, 4, -1);
+ 			break;
+ 		case VM_NONE: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(TRUE, 0, 6, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		};
+ 		UpdateData(FALSE);
+ 		return nOldMode;
+}
+/*void CCHMSDailyFoodOrder::OnOrderNoChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnOrderNoSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnOrderNoKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnOrderNoCheckValue(){
+	return 0;
+} 
+void CCHMSDailyFoodOrder::OnFindSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+/*void CCHMSDailyFoodOrder::OnOrderDateChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnOrderDateSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnOrderDateKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnOrderDateCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnIssueDateChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnIssueDateSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnIssueDateKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnIssueDateCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnStatusChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnStatusSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnStatusKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnStatusCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnNoteChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnNoteSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnNoteKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnNoteCheckValue(){
+	return 0;
+} 
+void CCHMSDailyFoodOrder::OnSendSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSDailyFoodOrder::OnPrintSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+/*void CCHMSDailyFoodOrder::OnPatientNameChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnPatientNameSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnPatientNameKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnPatientNameCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnDeptChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnDeptSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnDeptKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnDeptCheckValue(){
+	return 0;
+} 
+void CCHMSDailyFoodOrder::OnOrderListDblClick(){
+	
+} 
+void CCHMSDailyFoodOrder::OnOrderListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CCHMSDailyFoodOrder::OnOrderListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CCHMSDailyFoodOrder::OnOrderListLoadData(){
+/*
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	m_wndOrderList.BeginLoad(); 
+	int nCount = 0;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndOrderList.AddItems(
+		rs.MoveNext();
+	}
+	m_wndOrderList.EndLoad(); 
+	return nCount;
+*/
+	return 0;
+}
+void CCHMSDailyFoodOrder::OnPatientListDblClick(){
+	
+} 
+void CCHMSDailyFoodOrder::OnPatientListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CCHMSDailyFoodOrder::OnPatientListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CCHMSDailyFoodOrder::OnPatientListLoadData(){
+/*
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	m_wndPatientList.BeginLoad(); 
+	int nCount = 0;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndPatientList.AddItems(
+		rs.MoveNext();
+	}
+	m_wndPatientList.EndLoad(); 
+	return nCount;
+*/
+	return 0;
+}
+void CCHMSDailyFoodOrder::OnDrugListDblClick(){
+	
+} 
+void CCHMSDailyFoodOrder::OnDrugListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CCHMSDailyFoodOrder::OnDrugListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CCHMSDailyFoodOrder::OnDrugListLoadData(){
+/*
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	m_wndDrugList.BeginLoad(); 
+	int nCount = 0;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndDrugList.AddItems(
+		rs.MoveNext();
+	}
+	m_wndDrugList.EndLoad(); 
+	return nCount;
+*/
+	return 0;
+}
+/*void CCHMSDailyFoodOrder::OnTypeChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnTypeSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnTypeKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnTypeCheckValue(){
+	return 0;
+} 
+/*void CCHMSDailyFoodOrder::OnTotalCountChange(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnTotalCountSetfocus(){
+	
+} */
+/*void CCHMSDailyFoodOrder::OnTotalCountKillfocus(){
+	
+} */
+int CCHMSDailyFoodOrder::OnTotalCountCheckValue(){
+	return 0;
+} 
+int CCHMSDailyFoodOrder::OnAddCHMSDailyFoodOrder(){
+ 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_ADD);
+	return 0;
+}
+int CCHMSDailyFoodOrder::OnEditCHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_EDIT);
+	return 0;  
+}
+int CCHMSDailyFoodOrder::OnDeleteCHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO)
+ 		return -1;
+ 	szSQL.Format(_T("DELETE FROM  WHERE  AND") );
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret >= 0){
+ 		SetMode(VM_NONE);
+ 		OnCancelCHMSDailyFoodOrder();
+ 	}
+	return 0;
+}
+int CCHMSDailyFoodOrder::OnSaveCHMSDailyFoodOrder(){
+ 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT)
+ 		return -1;
+ 	if(!IsValidateData())
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(GetMode() == VM_ADD){
+ 		//szSQL = m_tblTbl.GetInsertSQL();
+ 	}
+ 	else if(GetMode() == VM_EDIT){
+ 		CString szWhere;
+ 		szWhere.Format(_T(" WHERE"));
+ 		//szSQL = m_tblTbl.GetUpdateSQL(_T("createdby,createddate"));
+ 		szSQL += szWhere;
+ 	}
+ _fmsg(_T("%s"), szSQL);
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret > 0)
+ 	{
+ 		//OnCHMSDailyFoodOrderListLoadData();
+ 		SetMode(VM_VIEW);
+ 	}
+ 	else
+ 	{
+ 	}
+ 	return ret;
+ 	return 0;
+}
+int CCHMSDailyFoodOrder::OnCancelCHMSDailyFoodOrder(){
+ 	if(GetMode() == VM_EDIT)
+ 	{
+ 		SetMode(VM_VIEW);
+ 	} 
+ 	else 
+ 	{
+ 		SetMode(VM_NONE);
+ 	} 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	return 0;
+} 
+int CCHMSDailyFoodOrder::OnCHMSDailyFoodOrderListLoadData(){
+	return 0;
+}
Index: Resx/CHMSDailyFoodOrder.h
===================================================================
--- Resx/CHMSDailyFoodOrder.h	(revision 0)
+++ Resx/CHMSDailyFoodOrder.h	(working copy)
@@ -0,0 +1,137 @@
+#ifndef CHMSDAILYFOODORDER_H
+#define CHMSDAILYFOODORDER_H
+
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Copyright  Viet Nam Medical Software Joint Stock Company. 2005-2012. 			
+//	All rights reserved. 
+//	This program is protected by Viet nam and international treaties.  
+//	Unauthorized reproduction or distribution of this program, 
+//	or any portion of it, may result in severe civil and criminal penalties, 
+//	and will be prosecuted to the maximum extent possible under the law.
+//	This file is a part of the GUI(Graphical User Interface) class library.
+//	(c) 2006-2008 Hoang Van Hay, All rights reserved.
+//	CONTACT INFORMATION:
+//	Email  : hayhv@vimes.com.vn or hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+/////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Ban quyen cua Cong Ty Co Phan Phan Mem Y Te Viet Nam 2005-2012.
+//	Do Cuc Ban Quyen, Bo VHTT nuoc Cong hoa xa hoi chu nghia Viet Nam cap.
+//	Chuong trinh phan mem nay duoc Luat phap Viet Nam va quoc te bao ho.
+//	San xuat, su dung hoac phan phoi trai phep toan bo hoac mot phan cua phan men nay se
+//	chiu cac hinh phat va hinh su hoac dan su, co the len den muc toi da dung theo Luat qui dinh.
+//	File nay la mot phan cua thu vien lap trinh(GUI). Ban quyen cua Hoang Van Hay. 2006-2008
+//	THONG TIN LIEN HE:
+//	Email  : hayhv@vimes.com.vn hoac hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+#include "GuiUtils.h"
+#include "GuiView.h"
+#include "DbField.h"
+class CCHMSDailyFoodOrder : public CGuiView{
+protected:
+public:
+	CGuiGroupBox	m_wndOrderInformation;
+	CGuiGroupBox	m_wndPatientInformation;
+	CGuiGroupBox	m_wndDrugInformation;
+	CGuiGroupBox	m_wndGroupListDrug;
+	CGuiLabel		m_wndOrderNoLabel;
+	CGuiTextCtrl	m_wndOrderNo;
+	CGuiButton		m_wndFind;
+	CGuiLabel		m_wndOrderDateLabel;
+	CGuiDateCtrl	m_wndOrderDate;
+	CGuiLabel		m_wndIssueDateLabel;
+	CGuiDateCtrl	m_wndIssueDate;
+	CGuiLabel		m_wndStatusLabel;
+	CGuiTextCtrl	m_wndStatus;
+	CGuiLabel		m_wndNoteLabel;
+	CGuiTextCtrl	m_wndNote;
+	CGuiButton		m_wndSend;
+	CGuiButton		m_wndPrint;
+	CGuiLabel		m_wndPatientNameLabel;
+	CGuiTextCtrl	m_wndPatientName;
+	CGuiLabel		m_wndDeptLabel;
+	CGuiTextCtrl	m_wndDept;
+	CGuiListCtrl	m_wndOrderList;
+	CGuiListCtrl	m_wndPatientList;
+	CGuiListCtrl	m_wndDrugList;
+	CGuiLabel		m_wndTypeLabel;
+	CGuiTextCtrl	m_wndType;
+	CGuiNumberCtrl	m_wndTotalCount;
+	CString	m_szOrderNo;
+	CString	m_szOrderDate;
+	CString	m_szIssueDate;
+	CString	m_szStatus;
+	CString	m_szNote;
+	CString	m_szPatientName;
+	CString	m_szDept;
+	CString	m_szType;
+	long	m_nTotalCount;
+	//void			OnOrderNoChange(); 
+	//void			OnOrderNoSetfocus(); 
+	//void			OnOrderNoKillfocus(); 
+	int			OnOrderNoCheckValue(); 
+	void			OnFindSelect(); 
+	//void			OnOrderDateChange(); 
+	//void			OnOrderDateSetfocus(); 
+	//void			OnOrderDateKillfocus(); 
+	int			OnOrderDateCheckValue(); 
+	//void			OnIssueDateChange(); 
+	//void			OnIssueDateSetfocus(); 
+	//void			OnIssueDateKillfocus(); 
+	int			OnIssueDateCheckValue(); 
+	//void			OnStatusChange(); 
+	//void			OnStatusSetfocus(); 
+	//void			OnStatusKillfocus(); 
+	int			OnStatusCheckValue(); 
+	//void			OnNoteChange(); 
+	//void			OnNoteSetfocus(); 
+	//void			OnNoteKillfocus(); 
+	int			OnNoteCheckValue(); 
+	void			OnSendSelect(); 
+	void			OnPrintSelect(); 
+	//void			OnPatientNameChange(); 
+	//void			OnPatientNameSetfocus(); 
+	//void			OnPatientNameKillfocus(); 
+	int			OnPatientNameCheckValue(); 
+	//void			OnDeptChange(); 
+	//void			OnDeptSetfocus(); 
+	//void			OnDeptKillfocus(); 
+	int			OnDeptCheckValue(); 
+	long			OnOrderListLoadData(); 
+	void			OnOrderListSelectChange(int nOldItem, int nNewItem); 
+	void			OnOrderListDblClick(); 
+	int			OnOrderListDeleteItem(); 
+	long			OnPatientListLoadData(); 
+	void			OnPatientListSelectChange(int nOldItem, int nNewItem); 
+	void			OnPatientListDblClick(); 
+	int			OnPatientListDeleteItem(); 
+	long			OnDrugListLoadData(); 
+	void			OnDrugListSelectChange(int nOldItem, int nNewItem); 
+	void			OnDrugListDblClick(); 
+	int			OnDrugListDeleteItem(); 
+	//void			OnTypeChange(); 
+	//void			OnTypeSetfocus(); 
+	//void			OnTypeKillfocus(); 
+	int			OnTypeCheckValue(); 
+	//void			OnTotalCountChange(); 
+	//void			OnTotalCountSetfocus(); 
+	//void			OnTotalCountKillfocus(); 
+	int			OnTotalCountCheckValue(); 
+	CCHMSDailyFoodOrder();
+	~CCHMSDailyFoodOrder();
+	void OnCreateComponents();
+	void OnInitializeComponents();
+	void OnSetWindowEvents();
+	void OnDoDataExchange(CDataExchange* pDX);
+	void GetDataToScreen();
+	void GetScreenToData();
+	void SetDefaultValues();
+	int SetMode(int nMode);
+	int OnAddCHMSDailyFoodOrder(); 
+	int OnEditCHMSDailyFoodOrder(); 
+	int OnDeleteCHMSDailyFoodOrder(); 
+	int OnSaveCHMSDailyFoodOrder(); 
+	int OnCancelCHMSDailyFoodOrder(); 
+	int OnCHMSDailyFoodOrderListLoadData(); 
+};
+#endif
Index: Resx/CHMSDailyFoodOrder.resx
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: Resx/CHMSDailyFoodOrder.resx
===================================================================
--- Resx/CHMSDailyFoodOrder.resx	(revision 0)
+++ Resx/CHMSDailyFoodOrder.resx	(working copy)

Property changes on: Resx/CHMSDailyFoodOrder.resx
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: Resx/CHMSSummaryDailyFoodOrder.cpp
===================================================================
--- Resx/CHMSSummaryDailyFoodOrder.cpp	(revision 0)
+++ Resx/CHMSSummaryDailyFoodOrder.cpp	(working copy)
@@ -0,0 +1,441 @@
+#include "CHMSSummaryDailyFoodOrder.h"
+#include "MainFrm.h"
+/*static void _OnOrderDateChangeFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnOrderDateChange();
+} */
+/*static void _OnOrderDateSetfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnOrderDateSetfocus();} */ 
+/*static void _OnOrderDateKillfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnOrderDateKillfocus();
+} */
+static int _OnOrderDateCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder *)pWnd)->OnOrderDateCheckValue();
+} 
+/*static void _OnIssueDateChangeFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnIssueDateChange();
+} */
+/*static void _OnIssueDateSetfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnIssueDateSetfocus();} */ 
+/*static void _OnIssueDateKillfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnIssueDateKillfocus();
+} */
+static int _OnIssueDateCheckValueFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder *)pWnd)->OnIssueDateCheckValue();
+} 
+static void _OnStatusSelectChangeFnc(CWnd *pWnd, int nOldItemSel, int nNewItemSel){
+	((CCHMSSummaryDailyFoodOrder* )pWnd)->OnStatusSelectChange(nOldItemSel, nNewItemSel);
+} 
+static void _OnStatusSelendokFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusSelendok();
+}
+/*static void _OnStatusSetfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+}*/
+/*static void _OnStatusKillfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusKillfocus();
+}*/
+static long _OnStatusLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusLoadData();
+}
+/*static void _OnStatusAddNewFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnStatusAddNew();
+}*/
+static void _OnPrintSelectFnc(CWnd *pWnd){
+	CCHMSSummaryDailyFoodOrder *pVw = (CCHMSSummaryDailyFoodOrder *)pWnd;
+	pVw->OnPrintSelect();
+} 
+static long _OnOrderListLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListLoadData();
+} 
+static void _OnOrderListDblClickFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListDblClick();
+} 
+static void _OnOrderListSelectChangeFnc(CWnd *pWnd, int nOldItem, int nNewItem){
+	((CCHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListSelectChange(nOldItem, nNewItem);
+} 
+static int _OnOrderListDeleteItemFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnOrderListDeleteItem();
+} 
+static void _OnRefreshSelectFnc(CWnd *pWnd){
+	CCHMSSummaryDailyFoodOrder *pVw = (CCHMSSummaryDailyFoodOrder *)pWnd;
+	pVw->OnRefreshSelect();
+} 
+static void _OnFoodTypeSelectChangeFnc(CWnd *pWnd, int nOldItemSel, int nNewItemSel){
+	((CCHMSSummaryDailyFoodOrder* )pWnd)->OnFoodTypeSelectChange(nOldItemSel, nNewItemSel);
+} 
+static void _OnFoodTypeSelendokFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeSelendok();
+}
+/*static void _OnFoodTypeSetfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeKillfocus();
+}*/
+/*static void _OnFoodTypeKillfocusFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeKillfocus();
+}*/
+static long _OnFoodTypeLoadDataFnc(CWnd *pWnd){
+	return ((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeLoadData();
+}
+/*static void _OnFoodTypeAddNewFnc(CWnd *pWnd){
+	((CCHMSSummaryDailyFoodOrder *)pWnd)->OnFoodTypeAddNew();
+}*/
+static int _OnAddCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnAddCHMSSummaryDailyFoodOrder();
+} 
+static int _OnEditCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnEditCHMSSummaryDailyFoodOrder();
+} 
+static int _OnDeleteCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnDeleteCHMSSummaryDailyFoodOrder();
+} 
+static int _OnSaveCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnSaveCHMSSummaryDailyFoodOrder();
+} 
+static int _OnCancelCHMSSummaryDailyFoodOrderFnc(CWnd *pWnd){
+	 return ((CCHMSSummaryDailyFoodOrder*)pWnd)->OnCancelCHMSSummaryDailyFoodOrder();
+} 
+CCHMSSummaryDailyFoodOrder::CCHMSSummaryDailyFoodOrder(){
+
+	m_nDlgWidth = 1029;
+	m_nDlgHeight = 635;
+	SetDefaultValues();
+}
+CCHMSSummaryDailyFoodOrder::~CCHMSSummaryDailyFoodOrder(){
+}
+void CCHMSSummaryDailyFoodOrder::OnCreateComponents(){
+	m_wndOrderInformation.Create(this, _T("Order Information"), 5, 5, 1020, 60);
+	m_wndGroupListDrug.Create(this, _T("Food Type List"), 5, 65, 1020, 625);
+	m_wndOrderDateLabel.Create(this, _T("Order Date"), 10, 30, 100, 55);
+	m_wndOrderDate.Create(this,105, 30, 195, 55); 
+	m_wndIssueDateLabel.Create(this, _T("Issue Date"), 200, 30, 290, 55);
+	m_wndIssueDate.Create(this,295, 30, 385, 55); 
+	m_wndStatusLabel.Create(this, _T("Status"), 390, 30, 480, 55);
+	m_wndStatus.Create(this,485, 30, 625, 55); 
+	m_wndPrint.Create(this, _T("&Preview"), 930, 30, 1015, 55);
+	m_wndOrderList.Create(this,10, 90, 1015, 620); 
+	m_wndRefresh.Create(this, _T("Refresh"), 845, 30, 925, 55);
+	m_wndFoodTypeLabel.Create(this, _T("Food Type"), 630, 30, 710, 55);
+	m_wndFoodType.Create(this,715, 30, 840, 55); 
+
+}
+void CCHMSSummaryDailyFoodOrder::OnInitializeComponents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	m_wndOrderDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndOrderDate.SetCheckValue(true);
+	m_wndIssueDate.SetMax(CDate(pMF->GetSysDate()));
+	m_wndIssueDate.SetCheckValue(true);
+	m_wndStatus.SetCheckValue(true);
+	m_wndStatus.LimitText(1024);
+	m_wndFoodType.SetCheckValue(true);
+	m_wndFoodType.LimitText(35);
+
+
+
+
+
+
+	m_wndFoodType.InsertColumn(0, _T("ID"), CFMT_TEXT, 50);
+	m_wndFoodType.InsertColumn(1, _T("Name"), CFMT_TEXT, 150);
+
+}
+void CCHMSSummaryDailyFoodOrder::OnSetWindowEvents(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	//m_wndOrderDate.SetEvent(WE_CHANGE, _OnOrderDateChangeFnc);
+	//m_wndOrderDate.SetEvent(WE_SETFOCUS, _OnOrderDateSetfocusFnc);
+	//m_wndOrderDate.SetEvent(WE_KILLFOCUS, _OnOrderDateKillfocusFnc);
+	m_wndOrderDate.SetEvent(WE_CHECKVALUE, _OnOrderDateCheckValueFnc);
+	//m_wndIssueDate.SetEvent(WE_CHANGE, _OnIssueDateChangeFnc);
+	//m_wndIssueDate.SetEvent(WE_SETFOCUS, _OnIssueDateSetfocusFnc);
+	//m_wndIssueDate.SetEvent(WE_KILLFOCUS, _OnIssueDateKillfocusFnc);
+	m_wndIssueDate.SetEvent(WE_CHECKVALUE, _OnIssueDateCheckValueFnc);
+	m_wndStatus.SetEvent(WE_SELENDOK, _OnStatusSelendokFnc);
+	//m_wndStatus.SetEvent(WE_SETFOCUS, _OnStatusSetfocusFnc);
+	//m_wndStatus.SetEvent(WE_KILLFOCUS, _OnStatusKillfocusFnc);
+	m_wndStatus.SetEvent(WE_SELCHANGE, _OnStatusSelectChangeFnc);
+	m_wndStatus.SetEvent(WE_LOADDATA, _OnStatusLoadDataFnc);
+	//m_wndStatus.SetEvent(WE_ADDNEW, _OnStatusAddNewFnc);
+	m_wndPrint.SetEvent(WE_CLICK, _OnPrintSelectFnc);
+	m_wndOrderList.SetEvent(WE_SELCHANGE, _OnOrderListSelectChangeFnc);
+	m_wndOrderList.SetEvent(WE_LOADDATA, _OnOrderListLoadDataFnc);
+	m_wndOrderList.SetEvent(WE_DBLCLICK, _OnOrderListDblClickFnc);
+	m_wndOrderList.AddEvent(1, _T("Delete"), _OnOrderListDeleteItemFnc, 0, VK_DELETE, 0);
+	m_wndRefresh.SetEvent(WE_CLICK, _OnRefreshSelectFnc);
+	m_wndFoodType.SetEvent(WE_SELENDOK, _OnFoodTypeSelendokFnc);
+	//m_wndFoodType.SetEvent(WE_SETFOCUS, _OnFoodTypeSetfocusFnc);
+	//m_wndFoodType.SetEvent(WE_KILLFOCUS, _OnFoodTypeKillfocusFnc);
+	m_wndFoodType.SetEvent(WE_SELCHANGE, _OnFoodTypeSelectChangeFnc);
+	m_wndFoodType.SetEvent(WE_LOADDATA, _OnFoodTypeLoadDataFnc);
+	//m_wndFoodType.SetEvent(WE_ADDNEW, _OnFoodTypeAddNewFnc);
+	AddEvent(1, _T("Add	Ctrl+A"), _OnAddCHMSSummaryDailyFoodOrderFnc, 0, 'A', VK_CONTROL);
+	AddEvent(2, _T("Edit	Ctrl+E"), _OnEditCHMSSummaryDailyFoodOrderFnc, 0, 'E', VK_CONTROL);
+	AddEvent(3, _T("Delete	Ctrl+D"), _OnDeleteCHMSSummaryDailyFoodOrderFnc, 0, 'D', VK_CONTROL);
+	AddEvent(4, _T("Save	Ctrl+S"), _OnSaveCHMSSummaryDailyFoodOrderFnc, 0, 'S', VK_CONTROL);
+	AddEvent(0, _T("-"));
+	AddEvent(5, _T("Cancel	Ctrl+T"), _OnCancelCHMSSummaryDailyFoodOrderFnc, 0, 'T', VK_CONTROL);
+	SetMode(VM_NONE);
+
+}
+void CCHMSSummaryDailyFoodOrder::OnDoDataExchange(CDataExchange* pDX){
+	DDX_TextEx(pDX, m_wndOrderDate.GetDlgCtrlID(), m_szOrderDate);
+	DDX_TextEx(pDX, m_wndIssueDate.GetDlgCtrlID(), m_szIssueDate);
+	DDX_TextEx(pDX, m_wndStatus.GetDlgCtrlID(), m_szStatusKey);
+	DDX_TextEx(pDX, m_wndFoodType.GetDlgCtrlID(), m_szFoodTypeKey);
+
+}
+void CCHMSSummaryDailyFoodOrder::GetDataToScreen(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	szSQL.Format(_T("SELECT * FROM "));
+	rs.ExecSQL(szSQL);
+
+}
+void CCHMSSummaryDailyFoodOrder::GetScreenToData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+
+}
+void CCHMSSummaryDailyFoodOrder::SetDefaultValues(){
+
+	m_szOrderDate.Empty();
+	m_szIssueDate.Empty();
+	m_szStatusKey.Empty();
+	m_szFoodTypeKey.Empty();
+
+}
+int CCHMSSummaryDailyFoodOrder::SetMode(int nMode){
+ 		int nOldMode = GetMode();
+ 		CGuiView::SetMode(nMode);
+ 		CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 		CString szSQL;
+ 		CRecord rs(&pMF->m_db);
+  		switch(nMode){
+ 		case VM_ADD: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		case VM_EDIT: 
+ 			EnableControls(TRUE);
+ 			EnableButtons(TRUE, 3, 4, -1);
+ 			break;
+ 		case VM_VIEW: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(FALSE, 3, 4, -1);
+ 			break;
+ 		case VM_NONE: 
+ 			EnableControls(FALSE);
+ 			EnableButtons(TRUE, 0, 6, -1);
+ 			SetDefaultValues();
+ 			break;
+ 		};
+ 		UpdateData(FALSE);
+ 		return nOldMode;
+}
+/*void CCHMSSummaryDailyFoodOrder::OnOrderDateChange(){
+	
+} */
+/*void CCHMSSummaryDailyFoodOrder::OnOrderDateSetfocus(){
+	
+} */
+/*void CCHMSSummaryDailyFoodOrder::OnOrderDateKillfocus(){
+	
+} */
+int CCHMSSummaryDailyFoodOrder::OnOrderDateCheckValue(){
+	return 0;
+} 
+/*void CCHMSSummaryDailyFoodOrder::OnIssueDateChange(){
+	
+} */
+/*void CCHMSSummaryDailyFoodOrder::OnIssueDateSetfocus(){
+	
+} */
+/*void CCHMSSummaryDailyFoodOrder::OnIssueDateKillfocus(){
+	
+} */
+int CCHMSSummaryDailyFoodOrder::OnIssueDateCheckValue(){
+	return 0;
+} 
+void CCHMSSummaryDailyFoodOrder::OnStatusSelectChange(int nOldItemSel, int nNewItemSel){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnStatusSelendok(){
+	 
+}
+/*void CCHMSSummaryDailyFoodOrder::OnStatusSetfocus(){
+	
+}*/
+/*void CCHMSSummaryDailyFoodOrder::OnStatusKillfocus(){
+	
+}*/
+long CCHMSSummaryDailyFoodOrder::OnStatusLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+/*
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szWhere;
+	if(m_wndStatus.IsSearchKey() && !m_szStatusKey.IsEmpty()){
+	 szWhere.Format(_T(" and id='%s' "), m_szStatusKey
+};
+	m_wndStatus.DeleteAllItems(); 
+	int nCount = 0;
+	szSQL.Format(_T("SELECT fld1 as id, fld2 as name FROM tbl WHERE 1=1 %s ORDER BY id "), szWhere
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndStatus.AddItems(
+		rs.MoveNext();
+	}
+	return nCount;
+*/
+	return 0;
+}
+/*void CCHMSSummaryDailyFoodOrder::OnStatusAddNew(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} */
+void CCHMSSummaryDailyFoodOrder::OnPrintSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnOrderListDblClick(){
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnOrderListSelectChange(int nOldItem, int nNewItem){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+int CCHMSSummaryDailyFoodOrder::OnOrderListDeleteItem(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	 return 0;
+} 
+long CCHMSSummaryDailyFoodOrder::OnOrderListLoadData(){
+/*
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	CRecord rs(&pMF->m_db);
+	CString szSQL;
+	m_wndOrderList.BeginLoad(); 
+	int nCount = 0;
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndOrderList.AddItems(
+		rs.MoveNext();
+	}
+	m_wndOrderList.EndLoad(); 
+	return nCount;
+*/
+	return 0;
+}
+void CCHMSSummaryDailyFoodOrder::OnRefreshSelect(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnFoodTypeSelectChange(int nOldItemSel, int nNewItemSel){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} 
+void CCHMSSummaryDailyFoodOrder::OnFoodTypeSelendok(){
+	 
+}
+/*void CCHMSSummaryDailyFoodOrder::OnFoodTypeSetfocus(){
+	
+}*/
+/*void CCHMSSummaryDailyFoodOrder::OnFoodTypeKillfocus(){
+	
+}*/
+long CCHMSSummaryDailyFoodOrder::OnFoodTypeLoadData(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+/*
+	CRecord rs(&pMF->m_db);
+	CString szSQL, szWhere;
+	if(m_wndFoodType.IsSearchKey() && !m_szFoodTypeKey.IsEmpty()){
+	 szWhere.Format(_T(" and id='%s' "), m_szFoodTypeKey
+};
+	m_wndFoodType.DeleteAllItems(); 
+	int nCount = 0;
+	szSQL.Format(_T("SELECT fld1 as id, fld2 as name FROM tbl WHERE 1=1 %s ORDER BY id "), szWhere
+	nCount = rs.ExecSQL(szSQL);
+	while(!rs.IsEOF()){ 
+		m_wndFoodType.AddItems(
+			rs.GetValue(_T("id")), 
+			rs.GetValue(_T("name")), NULL);
+		rs.MoveNext();
+	}
+	return nCount;
+*/
+	return 0;
+}
+/*void CCHMSSummaryDailyFoodOrder::OnFoodTypeAddNew(){
+	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
+	
+} */
+int CCHMSSummaryDailyFoodOrder::OnAddCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_ADD);
+	return 0;
+}
+int CCHMSSummaryDailyFoodOrder::OnEditCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
+ 	SetMode(VM_EDIT);
+	return 0;  
+}
+int CCHMSSummaryDailyFoodOrder::OnDeleteCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_VIEW)
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO)
+ 		return -1;
+ 	szSQL.Format(_T("DELETE FROM  WHERE  AND") );
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret >= 0){
+ 		SetMode(VM_NONE);
+ 		OnCancelCHMSSummaryDailyFoodOrder();
+ 	}
+	return 0;
+}
+int CCHMSSummaryDailyFoodOrder::OnSaveCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT)
+ 		return -1;
+ 	if(!IsValidateData())
+ 		return -1;
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	CString szSQL;
+ 	if(GetMode() == VM_ADD){
+ 		//szSQL = m_tblTbl.GetInsertSQL();
+ 	}
+ 	else if(GetMode() == VM_EDIT){
+ 		CString szWhere;
+ 		szWhere.Format(_T(" WHERE"));
+ 		//szSQL = m_tblTbl.GetUpdateSQL(_T("createdby,createddate"));
+ 		szSQL += szWhere;
+ 	}
+ _fmsg(_T("%s"), szSQL);
+ 	int ret = pMF->ExecSQL(szSQL);
+ 	if(ret > 0)
+ 	{
+ 		//OnCHMSSummaryDailyFoodOrderListLoadData();
+ 		SetMode(VM_VIEW);
+ 	}
+ 	else
+ 	{
+ 	}
+ 	return ret;
+ 	return 0;
+}
+int CCHMSSummaryDailyFoodOrder::OnCancelCHMSSummaryDailyFoodOrder(){
+ 	if(GetMode() == VM_EDIT)
+ 	{
+ 		SetMode(VM_VIEW);
+ 	} 
+ 	else 
+ 	{
+ 		SetMode(VM_NONE);
+ 	} 
+ 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
+ 	return 0;
+} 
+int CCHMSSummaryDailyFoodOrder::OnCHMSSummaryDailyFoodOrderListLoadData(){
+	return 0;
+}
Index: Resx/CHMSSummaryDailyFoodOrder.h
===================================================================
--- Resx/CHMSSummaryDailyFoodOrder.h	(revision 0)
+++ Resx/CHMSSummaryDailyFoodOrder.h	(working copy)
@@ -0,0 +1,93 @@
+#ifndef CHMSSUMMARYDAILYFOODORDER_H
+#define CHMSSUMMARYDAILYFOODORDER_H
+
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Copyright  Viet Nam Medical Software Joint Stock Company. 2005-2012. 			
+//	All rights reserved. 
+//	This program is protected by Viet nam and international treaties.  
+//	Unauthorized reproduction or distribution of this program, 
+//	or any portion of it, may result in severe civil and criminal penalties, 
+//	and will be prosecuted to the maximum extent possible under the law.
+//	This file is a part of the GUI(Graphical User Interface) class library.
+//	(c) 2006-2008 Hoang Van Hay, All rights reserved.
+//	CONTACT INFORMATION:
+//	Email  : hayhv@vimes.com.vn or hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+/////////////////////////////////////////////////////////////////////////////////////////////////////////
+//	Ban quyen cua Cong Ty Co Phan Phan Mem Y Te Viet Nam 2005-2012.
+//	Do Cuc Ban Quyen, Bo VHTT nuoc Cong hoa xa hoi chu nghia Viet Nam cap.
+//	Chuong trinh phan mem nay duoc Luat phap Viet Nam va quoc te bao ho.
+//	San xuat, su dung hoac phan phoi trai phep toan bo hoac mot phan cua phan men nay se
+//	chiu cac hinh phat va hinh su hoac dan su, co the len den muc toi da dung theo Luat qui dinh.
+//	File nay la mot phan cua thu vien lap trinh(GUI). Ban quyen cua Hoang Van Hay. 2006-2008
+//	THONG TIN LIEN HE:
+//	Email  : hayhv@vimes.com.vn hoac hayhv@yahoo.com
+//	Website: http://www.vimes.com.vn
+//////////////////////////////////////////////////////////////////////////////////////////////////////////
+#include "GuiUtils.h"
+#include "GuiView.h"
+#include "DbField.h"
+class CCHMSSummaryDailyFoodOrder : public CGuiView{
+protected:
+public:
+	CGuiGroupBox	m_wndOrderInformation;
+	CGuiGroupBox	m_wndGroupListDrug;
+	CGuiLabel		m_wndOrderDateLabel;
+	CGuiDateCtrl	m_wndOrderDate;
+	CGuiLabel		m_wndIssueDateLabel;
+	CGuiDateCtrl	m_wndIssueDate;
+	CGuiLabel		m_wndStatusLabel;
+	CGuiComboBox	m_wndStatus;
+	CGuiButton		m_wndPrint;
+	CGuiListCtrl	m_wndOrderList;
+	CGuiButton		m_wndRefresh;
+	CGuiLabel		m_wndFoodTypeLabel;
+	CGuiComboBox	m_wndFoodType;
+	CString	m_szOrderDate;
+	CString	m_szIssueDate;
+	CString	m_szStatusKey;
+	CString	m_szFoodTypeKey;
+	//void			OnOrderDateChange(); 
+	//void			OnOrderDateSetfocus(); 
+	//void			OnOrderDateKillfocus(); 
+	int			OnOrderDateCheckValue(); 
+	//void			OnIssueDateChange(); 
+	//void			OnIssueDateSetfocus(); 
+	//void			OnIssueDateKillfocus(); 
+	int			OnIssueDateCheckValue(); 
+	void			OnStatusSelectChange(int nOldItemSel, int nNewItemSel); 
+	void			OnStatusSelendok(); 
+	//void			OnStatusSetfocus(); 
+	//void			OnStatusKillfocus(); 
+	long			OnStatusLoadData(); 
+	//void			OnStatusAddNew(); 
+	void			OnPrintSelect(); 
+	long			OnOrderListLoadData(); 
+	void			OnOrderListSelectChange(int nOldItem, int nNewItem); 
+	void			OnOrderListDblClick(); 
+	int			OnOrderListDeleteItem(); 
+	void			OnRefreshSelect(); 
+	void			OnFoodTypeSelectChange(int nOldItemSel, int nNewItemSel); 
+	void			OnFoodTypeSelendok(); 
+	//void			OnFoodTypeSetfocus(); 
+	//void			OnFoodTypeKillfocus(); 
+	long			OnFoodTypeLoadData(); 
+	//void			OnFoodTypeAddNew(); 
+	CCHMSSummaryDailyFoodOrder();
+	~CCHMSSummaryDailyFoodOrder();
+	void OnCreateComponents();
+	void OnInitializeComponents();
+	void OnSetWindowEvents();
+	void OnDoDataExchange(CDataExchange* pDX);
+	void GetDataToScreen();
+	void GetScreenToData();
+	void SetDefaultValues();
+	int SetMode(int nMode);
+	int OnAddCHMSSummaryDailyFoodOrder(); 
+	int OnEditCHMSSummaryDailyFoodOrder(); 
+	int OnDeleteCHMSSummaryDailyFoodOrder(); 
+	int OnSaveCHMSSummaryDailyFoodOrder(); 
+	int OnCancelCHMSSummaryDailyFoodOrder(); 
+	int OnCHMSSummaryDailyFoodOrderListLoadData(); 
+};
+#endif
Index: Resx/CHMSSummaryDailyFoodOrder.resx
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: Resx/CHMSSummaryDailyFoodOrder.resx
===================================================================
--- Resx/CHMSSummaryDailyFoodOrder.resx	(revision 0)
+++ Resx/CHMSSummaryDailyFoodOrder.resx	(working copy)

Property changes on: Resx/CHMSSummaryDailyFoodOrder.resx
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: stdafx.cpp
===================================================================
--- stdafx.cpp	(revision 0)
+++ stdafx.cpp	(working copy)
@@ -0,0 +1,7 @@
+// stdafx.cpp : source file that includes just the standard includes
+// VIMESNutritionManagr.pch will be the pre-compiled header
+// stdafx.obj will contain the pre-compiled type information
+
+#include "stdafx.h"
+
+
Index: stdafx.h
===================================================================
--- stdafx.h	(revision 0)
+++ stdafx.h	(working copy)
@@ -0,0 +1,42 @@
+// stdafx.h : include file for standard system include files,
+// or project specific include files that are used frequently,
+// but are changed infrequently
+
+#pragma once
+
+#ifndef VC_EXTRALEAN
+#define VC_EXTRALEAN		// Exclude rarely-used stuff from Windows headers
+#endif
+
+// Modify the following defines if you have to target a platform prior to the ones specified below.
+// Refer to MSDN for the latest info on corresponding values for different platforms.
+#ifndef WINVER				// Allow use of features specific to Windows 95 and Windows NT 4 or later.
+#define WINVER 0x0400		// Change this to the appropriate value to target Windows 98 and Windows 2000 or later.
+#endif
+
+#ifndef _WIN32_WINNT		// Allow use of features specific to Windows NT 4 or later.
+#define _WIN32_WINNT 0x0400		// Change this to the appropriate value to target Windows 98 and Windows 2000 or later.
+#endif						
+
+#ifndef _WIN32_WINDOWS		// Allow use of features specific to Windows 98 or later.
+#define _WIN32_WINDOWS 0x0410 // Change this to the appropriate value to target Windows Me or later.
+#endif
+
+#ifndef _WIN32_IE			// Allow use of features specific to IE 4.0 or later.
+#define _WIN32_IE 0x0400	// Change this to the appropriate value to target IE 5.0 or later.
+#endif
+
+#define _ATL_CSTRING_EXPLICIT_CONSTRUCTORS	// some CString constructors will be explicit
+
+// turns off MFC's hiding of some common and often safely ignored warning messages
+#define _AFX_ALL_WARNINGS
+
+#include <afxwin.h>         // MFC core and standard components
+#include <afxext.h>         // MFC extensions
+#include <afxdisp.h>        // MFC Automation classes
+
+#include <afxdtctl.h>		// MFC support for Internet Explorer 4 Common Controls
+#ifndef _AFX_NO_AFXCMN_SUPPORT
+#include <afxcmn.h>			// MFC support for Windows Common Controls
+#endif // _AFX_NO_AFXCMN_SUPPORT
+
Index: VIMESNutritionManagr.aps
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: VIMESNutritionManagr.aps
===================================================================
--- VIMESNutritionManagr.aps	(revision 0)
+++ VIMESNutritionManagr.aps	(working copy)

Property changes on: VIMESNutritionManagr.aps
___________________________________________________________________
Added: svn:mime-type
## -0,0 +1 ##
+application/octet-stream
\ No newline at end of property
Index: VIMESNutritionManagr.cpp
===================================================================
--- VIMESNutritionManagr.cpp	(revision 0)
+++ VIMESNutritionManagr.cpp	(working copy)
@@ -0,0 +1,128 @@
+// VIMESNutritionManagr.cpp : Defines the class behaviors for the application.
+//
+
+#include "stdafx.h"
+#include "VIMESNutritionManagr.h"
+#include "MainFrm.h"
+
+#ifdef _DEBUG
+#define new DEBUG_NEW
+#endif
+
+
+// CVIMESNutritionManagrApp
+
+BEGIN_MESSAGE_MAP(CVIMESNutritionManagrApp, CWinApp)
+	ON_COMMAND(ID_APP_ABOUT, OnAppAbout)
+	// Standard file based document commands
+	ON_COMMAND(ID_FILE_NEW, CWinApp::OnFileNew)
+	ON_COMMAND(ID_FILE_OPEN, CWinApp::OnFileOpen)
+	// Standard print setup command
+	ON_COMMAND(ID_FILE_PRINT_SETUP, CWinApp::OnFilePrintSetup)
+END_MESSAGE_MAP()
+
+
+// CVIMESNutritionManagrApp construction
+
+CVIMESNutritionManagrApp::CVIMESNutritionManagrApp()
+{
+	// TODO: add construction code here,
+	// Place all significant initialization in InitInstance
+}
+
+
+// The one and only CVIMESNutritionManagrApp object
+
+CVIMESNutritionManagrApp theApp;
+
+// CVIMESNutritionManagrApp initialization
+
+BOOL CVIMESNutritionManagrApp::InitInstance()
+{
+	// InitCommonControls() is required on Windows XP if an application
+	// manifest specifies use of ComCtl32.dll version 6 or later to enable
+	// visual styles.  Otherwise, any window creation will fail.
+	InitCommonControls();
+
+	CWinApp::InitInstance();
+
+	// Initialize OLE libraries
+	if (!AfxOleInit())
+	{
+		AfxMessageBox(IDP_OLE_INIT_FAILED);
+		return FALSE;
+	}
+	AfxEnableControlContainer();
+	// Standard initialization
+	// If you are not using these features and wish to reduce the size
+	// of your final executable, you should remove from the following
+	// the specific initialization routines you do not need
+	// Change the registry key under which our settings are stored
+	// TODO: You should modify this string to be something appropriate
+	// such as the name of your company or organization
+	SetRegistryKey(_T("Local AppWizard-Generated Applications"));
+	// To create the main window, this code creates a new frame window
+	// object and then sets it as the application's main window object
+
+	
+	CMainFrame* pFrame = new CMainFrame;
+	if (!pFrame)
+		return FALSE;
+	m_pMainWnd = pFrame;
+	// create and load the frame with its resources
+	pFrame->LoadFrame(IDR_MAINFRAME,
+		WS_OVERLAPPEDWINDOW | FWS_ADDTOTITLE, NULL,
+		NULL);
+	// The one and only window has been initialized, so show and update it
+	pFrame->CenterWindow();
+	pFrame->ShowWindow(SW_SHOW);
+	pFrame->UpdateWindow();
+
+	//pFrame->OnFileInvoicesetup();
+	// call DragAcceptFiles only if there's a suffix
+	//  In an SDI app, this should occur after ProcessShellCommand
+	return TRUE;
+}
+
+
+
+// CAboutDlg dialog used for App About
+
+class CAboutDlg : public CDialog
+{
+public:
+	CAboutDlg();
+
+// Dialog Data
+	enum { IDD = IDD_ABOUTBOX };
+
+protected:
+	virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support
+
+// Implementation
+protected:
+	DECLARE_MESSAGE_MAP()
+};
+
+CAboutDlg::CAboutDlg() : CDialog(CAboutDlg::IDD)
+{
+}
+
+void CAboutDlg::DoDataExchange(CDataExchange* pDX)
+{
+	CDialog::DoDataExchange(pDX);
+}
+
+BEGIN_MESSAGE_MAP(CAboutDlg, CDialog)
+END_MESSAGE_MAP()
+
+// App command to run the dialog
+void CVIMESNutritionManagrApp::OnAppAbout()
+{
+	CAboutDlg aboutDlg;
+	aboutDlg.DoModal();
+}
+
+
+// CVIMESNutritionManagrApp message handlers
+
Index: VIMESNutritionManagr.h
===================================================================
--- VIMESNutritionManagr.h	(revision 0)
+++ VIMESNutritionManagr.h	(working copy)
@@ -0,0 +1,31 @@
+// VIMESNutritionManagr.h : main header file for the VIMESNutritionManagr application
+//
+#pragma once
+
+#ifndef __AFXWIN_H__
+	#error include 'stdafx.h' before including this file for PCH
+#endif
+
+#include "resource.h"       // main symbols
+
+
+// CVIMESNutritionManagrApp:
+// See VIMESNutritionManagr.cpp for the implementation of this class
+//
+
+class CVIMESNutritionManagrApp : public CWinApp
+{
+public:
+	CVIMESNutritionManagrApp();
+
+
+// Overrides
+public:
+	virtual BOOL InitInstance();
+
+// Implementation
+	afx_msg void OnAppAbout();
+	DECLARE_MESSAGE_MAP()
+};
+
+extern CVIMESNutritionManagrApp theApp;
\ No newline at end of file
