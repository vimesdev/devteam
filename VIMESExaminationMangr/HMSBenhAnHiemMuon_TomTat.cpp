#include "HMSBenhAnHiemMuon_TomTat.h"
#include "MainFrm.h"
/*static void _OnHoTenVoChangeFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnHoTenVoChange();
} */
/*static void _OnHoTenVoSetfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnHoTenVoSetfocus();} */ 
/*static void _OnHoTenVoKillfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnHoTenVoKillfocus();
} */
static int _OnHoTenVoCheckValueFnc(CWnd *pWnd){
	return ((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnHoTenVoCheckValue();
} 
/*static void _OnNamSinhVoChangeFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnNamSinhVoChange();
} */
/*static void _OnNamSinhVoSetfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnNamSinhVoSetfocus();} */ 
/*static void _OnNamSinhVoKillfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnNamSinhVoKillfocus();
} */
static int _OnNamSinhVoCheckValueFnc(CWnd *pWnd){
	return ((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnNamSinhVoCheckValue();
} 
/*static void _OnHoTenChongChangeFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnHoTenChongChange();
} */
/*static void _OnHoTenChongSetfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnHoTenChongSetfocus();} */ 
/*static void _OnHoTenChongKillfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnHoTenChongKillfocus();
} */
static int _OnHoTenChongCheckValueFnc(CWnd *pWnd){
	return ((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnHoTenChongCheckValue();
} 
/*static void _OnNamSinhChongChangeFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnNamSinhChongChange();
} */
/*static void _OnNamSinhChongSetfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnNamSinhChongSetfocus();} */ 
/*static void _OnNamSinhChongKillfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnNamSinhChongKillfocus();
} */
static int _OnNamSinhChongCheckValueFnc(CWnd *pWnd){
	return ((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnNamSinhChongCheckValue();
} 
/*static void _OnVoSinhChangeFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnVoSinhChange();
} */
/*static void _OnVoSinhSetfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnVoSinhSetfocus();} */ 
/*static void _OnVoSinhKillfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnVoSinhKillfocus();
} */
static int _OnVoSinhCheckValueFnc(CWnd *pWnd){
	return ((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnVoSinhCheckValue();
} 
/*static void _OnTienSuChangeFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnTienSuChange();
} */
/*static void _OnTienSuSetfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnTienSuSetfocus();} */ 
/*static void _OnTienSuKillfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnTienSuKillfocus();
} */
static int _OnTienSuCheckValueFnc(CWnd *pWnd){
	return ((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnTienSuCheckValue();
} 
/*static void _OnCacVanDeChangeFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnCacVanDeChange();
} */
/*static void _OnCacVanDeSetfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnCacVanDeSetfocus();} */ 
/*static void _OnCacVanDeKillfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnCacVanDeKillfocus();
} */
static int _OnCacVanDeCheckValueFnc(CWnd *pWnd){
	return ((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnCacVanDeCheckValue();
} 
/*static void _OnChanDoanSoBoChangeFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnChanDoanSoBoChange();
} */
/*static void _OnChanDoanSoBoSetfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnChanDoanSoBoSetfocus();} */ 
/*static void _OnChanDoanSoBoKillfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnChanDoanSoBoKillfocus();
} */
static int _OnChanDoanSoBoCheckValueFnc(CWnd *pWnd){
	return ((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnChanDoanSoBoCheckValue();
} 
/*static void _OnHuongDieuTriChangeFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnHuongDieuTriChange();
} */
/*static void _OnHuongDieuTriSetfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnHuongDieuTriSetfocus();} */ 
/*static void _OnHuongDieuTriKillfocusFnc(CWnd *pWnd){
	((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnHuongDieuTriKillfocus();
} */
static int _OnHuongDieuTriCheckValueFnc(CWnd *pWnd){
	return ((CHMSBenhAnHiemMuon_TomTat *)pWnd)->OnHuongDieuTriCheckValue();
} 
static void _OnEditSelectFnc(CWnd *pWnd){
	CHMSBenhAnHiemMuon_TomTat *pVw = (CHMSBenhAnHiemMuon_TomTat *)pWnd;
	pVw->OnEditSelect();
} 
static void _OnSaveSelectFnc(CWnd *pWnd){
	CHMSBenhAnHiemMuon_TomTat *pVw = (CHMSBenhAnHiemMuon_TomTat *)pWnd;
	pVw->OnSaveSelect();
} 
static void _OnCancelSelectFnc(CWnd *pWnd){
	CHMSBenhAnHiemMuon_TomTat *pVw = (CHMSBenhAnHiemMuon_TomTat *)pWnd;
	pVw->OnCancelSelect();
} 
static int _OnAddHMSBenhAnHiemMuon_TomTatFnc(CWnd *pWnd){
	 return ((CHMSBenhAnHiemMuon_TomTat*)pWnd)->OnAddHMSBenhAnHiemMuon_TomTat();
} 
static int _OnEditHMSBenhAnHiemMuon_TomTatFnc(CWnd *pWnd){
	 return ((CHMSBenhAnHiemMuon_TomTat*)pWnd)->OnEditHMSBenhAnHiemMuon_TomTat();
} 
static int _OnDeleteHMSBenhAnHiemMuon_TomTatFnc(CWnd *pWnd){
	 return ((CHMSBenhAnHiemMuon_TomTat*)pWnd)->OnDeleteHMSBenhAnHiemMuon_TomTat();
} 
static int _OnSaveHMSBenhAnHiemMuon_TomTatFnc(CWnd *pWnd){
	 return ((CHMSBenhAnHiemMuon_TomTat*)pWnd)->OnSaveHMSBenhAnHiemMuon_TomTat();
} 
static int _OnCancelHMSBenhAnHiemMuon_TomTatFnc(CWnd *pWnd){
	 return ((CHMSBenhAnHiemMuon_TomTat*)pWnd)->OnCancelHMSBenhAnHiemMuon_TomTat();
} 
CHMSBenhAnHiemMuon_TomTat::CHMSBenhAnHiemMuon_TomTat(){

	m_nDlgWidth = 1029;
	m_nDlgHeight = 773;
	SetDefaultValues();
}
CHMSBenhAnHiemMuon_TomTat::~CHMSBenhAnHiemMuon_TomTat(){
}
void CHMSBenhAnHiemMuon_TomTat::OnCreateComponents(){
	m_wndcontrol_0.Create(this, _T("T\xD3M T\x1EAET \x42\x1EC6NH \xC1N"), 330, 5, 450, 30);
	m_wndHoTenVoLabel.Create(this, _T("H\x1ECD t\xEAn v\x1EE3"), 5, 30, 125, 55);
	m_wndHoTenVo.Create(this,130, 30, 620, 55); 
	m_wndNamSinhVoLabel.Create(this, _T("N\x103m sinh"), 625, 30, 705, 55);
	m_wndNamSinhVo.Create(this,710, 30, 790, 55); 
	m_wndHoTenChongLabel.Create(this, _T("H\x1ECD t\xEAn \x63h\x1ED3ng"), 5, 60, 125, 85);
	m_wndHoTenChong.Create(this,130, 60, 620, 85); 
	m_wndNamSinhChongLabel.Create(this, _T("N\x103m sinh"), 625, 60, 705, 85);
	m_wndNamSinhChong.Create(this,710, 60, 790, 85); 
	m_wndVoSinhLabel.Create(this, _T("V\xF4 sinh"), 5, 90, 125, 115);
	m_wndVoSinh.Create(this,130, 90, 210, 115); 
	m_wndTienSuLabel.Create(this, _T("Ti\x1EC1n s\x1EED"), 5, 120, 125, 145);
	m_wndTienSu.Create(this,130, 120, 790, 220, 1, 0, 1); 
	m_wndCacVanDeLabel.Create(this, _T("\x43\xE1\x63 v\x1EA5n \x111\x1EC1"), 5, 225, 125, 250);
	m_wndCacVanDe.Create(this,130, 225, 790, 325, 1, 0, 1); 
	m_wndChanDoanSoBoLabel.Create(this, _T("\x43h\x1EA9n \x111o\xE1n s\x1A1 \x62\x1ED9"), 5, 330, 125, 355);
	m_wndChanDoanSoBo.Create(this,130, 330, 790, 430, 1, 0, 1); 
	m_wndHuongDieuTriLabel.Create(this, _T("H\x1B0\x1EDBng \x111i\x1EC1u tr\x1ECB"), 5, 435, 125, 460);
	m_wndHuongDieuTri.Create(this,130, 435, 790, 535, 1, 0, 1); 
	m_wndcontrol_19.Create(this, _T("n\x103m"), 215, 90, 295, 115);
	//m_wndEdit.Create(this, _T("Edit"), 540, 540, 620, 565);
	//m_wndSave.Create(this, _T("Save"), 625, 540, 705, 565);
	//m_wndCancel.Create(this, _T("Cancel"), 710, 540, 790, 565);

}
void CHMSBenhAnHiemMuon_TomTat::OnInitializeComponents(){
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
	m_wndHoTenVo.SetLimitText(35);
	m_wndHoTenVo.SetCheckValue(true);
	m_wndNamSinhVo.SetLimitText(16);
	m_wndNamSinhVo.SetCheckValue(true);
	m_wndHoTenChong.SetLimitText(35);
	m_wndHoTenChong.SetCheckValue(true);
	m_wndNamSinhChong.SetLimitText(16);
	m_wndNamSinhChong.SetCheckValue(true);
	m_wndVoSinh.SetLimitText(16);
	m_wndVoSinh.SetCheckValue(true);
	/*m_wndCacVanDe.SetCheckValue(true);
	m_wndChanDoanSoBo.SetCheckValue(true);
	m_wndTienSu.SetCheckValue(true);
	m_wndHuongDieuTri.SetCheckValue(true);*/

}
void CHMSBenhAnHiemMuon_TomTat::OnSetWindowEvents(){
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
	//m_wndHoTenVo.SetEvent(WE_CHANGE, _OnHoTenVoChangeFnc);
	//m_wndHoTenVo.SetEvent(WE_SETFOCUS, _OnHoTenVoSetfocusFnc);
	//m_wndHoTenVo.SetEvent(WE_KILLFOCUS, _OnHoTenVoKillfocusFnc);
	m_wndHoTenVo.SetEvent(WE_CHECKVALUE, _OnHoTenVoCheckValueFnc);
	//m_wndNamSinhVo.SetEvent(WE_CHANGE, _OnNamSinhVoChangeFnc);
	//m_wndNamSinhVo.SetEvent(WE_SETFOCUS, _OnNamSinhVoSetfocusFnc);
	//m_wndNamSinhVo.SetEvent(WE_KILLFOCUS, _OnNamSinhVoKillfocusFnc);
	m_wndNamSinhVo.SetEvent(WE_CHECKVALUE, _OnNamSinhVoCheckValueFnc);
	//m_wndHoTenChong.SetEvent(WE_CHANGE, _OnHoTenChongChangeFnc);
	//m_wndHoTenChong.SetEvent(WE_SETFOCUS, _OnHoTenChongSetfocusFnc);
	//m_wndHoTenChong.SetEvent(WE_KILLFOCUS, _OnHoTenChongKillfocusFnc);
	m_wndHoTenChong.SetEvent(WE_CHECKVALUE, _OnHoTenChongCheckValueFnc);
	//m_wndNamSinhChong.SetEvent(WE_CHANGE, _OnNamSinhChongChangeFnc);
	//m_wndNamSinhChong.SetEvent(WE_SETFOCUS, _OnNamSinhChongSetfocusFnc);
	//m_wndNamSinhChong.SetEvent(WE_KILLFOCUS, _OnNamSinhChongKillfocusFnc);
	m_wndNamSinhChong.SetEvent(WE_CHECKVALUE, _OnNamSinhChongCheckValueFnc);
	//m_wndVoSinh.SetEvent(WE_CHANGE, _OnVoSinhChangeFnc);
	//m_wndVoSinh.SetEvent(WE_SETFOCUS, _OnVoSinhSetfocusFnc);
	//m_wndVoSinh.SetEvent(WE_KILLFOCUS, _OnVoSinhKillfocusFnc);
	m_wndVoSinh.SetEvent(WE_CHECKVALUE, _OnVoSinhCheckValueFnc);
	//m_wndTienSu.SetEvent(WE_CHANGE, _OnTienSuChangeFnc);
	//m_wndTienSu.SetEvent(WE_SETFOCUS, _OnTienSuSetfocusFnc);
	//m_wndTienSu.SetEvent(WE_KILLFOCUS, _OnTienSuKillfocusFnc);
	m_wndTienSu.SetEvent(WE_CHECKVALUE, _OnTienSuCheckValueFnc);
	//m_wndCacVanDe.SetEvent(WE_CHANGE, _OnCacVanDeChangeFnc);
	//m_wndCacVanDe.SetEvent(WE_SETFOCUS, _OnCacVanDeSetfocusFnc);
	//m_wndCacVanDe.SetEvent(WE_KILLFOCUS, _OnCacVanDeKillfocusFnc);
	m_wndCacVanDe.SetEvent(WE_CHECKVALUE, _OnCacVanDeCheckValueFnc);
	//m_wndChanDoanSoBo.SetEvent(WE_CHANGE, _OnChanDoanSoBoChangeFnc);
	//m_wndChanDoanSoBo.SetEvent(WE_SETFOCUS, _OnChanDoanSoBoSetfocusFnc);
	//m_wndChanDoanSoBo.SetEvent(WE_KILLFOCUS, _OnChanDoanSoBoKillfocusFnc);
	m_wndChanDoanSoBo.SetEvent(WE_CHECKVALUE, _OnChanDoanSoBoCheckValueFnc);
	//m_wndHuongDieuTri.SetEvent(WE_CHANGE, _OnHuongDieuTriChangeFnc);
	//m_wndHuongDieuTri.SetEvent(WE_SETFOCUS, _OnHuongDieuTriSetfocusFnc);
	//m_wndHuongDieuTri.SetEvent(WE_KILLFOCUS, _OnHuongDieuTriKillfocusFnc);
	m_wndHuongDieuTri.SetEvent(WE_CHECKVALUE, _OnHuongDieuTriCheckValueFnc);
	m_wndEdit.SetEvent(WE_CLICK, _OnEditSelectFnc);
	m_wndSave.SetEvent(WE_CLICK, _OnSaveSelectFnc);
	m_wndCancel.SetEvent(WE_CLICK, _OnCancelSelectFnc);	

	GetNameDOB();
		GetDataToScreen();
	SetScrollSizes(MM_TEXT, CSize(700, 2550));
}
void CHMSBenhAnHiemMuon_TomTat::OnDoDataExchange(CDataExchange* pDX){
	DDX_Text(pDX, m_wndHoTenVo.GetDlgCtrlID(), m_szHoTenVo);
	DDX_Text(pDX, m_wndNamSinhVo.GetDlgCtrlID(), m_nNamSinhVo);
	DDX_Text(pDX, m_wndHoTenChong.GetDlgCtrlID(), m_szHoTenChong);
	DDX_Text(pDX, m_wndNamSinhChong.GetDlgCtrlID(), m_nNamSinhChong);
	DDX_Text(pDX, m_wndVoSinh.GetDlgCtrlID(), m_nVoSinh);
	DDX_Text(pDX, m_wndTienSu.GetDlgCtrlID(), m_szTienSu);
	DDX_Text(pDX, m_wndCacVanDe.GetDlgCtrlID(), m_szCacVanDe);
	DDX_Text(pDX, m_wndChanDoanSoBo.GetDlgCtrlID(), m_szChanDoanSoBo);
	DDX_Text(pDX, m_wndHuongDieuTri.GetDlgCtrlID(), m_szHuongDieuTri);

}
void CHMSBenhAnHiemMuon_TomTat::UpdateJson(BOOL bSave){
	if(bSave)
	{
			
	/*m_jData[_T("HoTenVo")] =  m_szHoTenVo;
	m_jData[_T("NamSinhVo")] =  m_nNamSinhVo;
	m_jData[_T("HoTenChong")] =  m_szHoTenChong;
	m_jData[_T("NamSinhChong")] =  m_nNamSinhChong;*/
	m_jData[_T("VoSinh")] =  m_nVoSinh;
	m_jData[_T("TienSu")] =  m_szTienSu;
	m_jData[_T("CacVanDe")] =  m_szCacVanDe;
	m_jData[_T("ChanDoanSoBo")] =  m_szChanDoanSoBo;
	m_jData[_T("HuongDieuTri")] =  m_szHuongDieuTri;
	}
	else
	{
			
	/*m_jData[_T("HoTenVo")].GetValue(m_szHoTenVo);
	m_jData[_T("NamSinhVo")].GetValue(m_nNamSinhVo);
	m_jData[_T("HoTenChong")].GetValue(m_szHoTenChong);
	m_jData[_T("NamSinhChong")].GetValue(m_nNamSinhChong);*/
	m_jData[_T("VoSinh")].GetValue(m_nVoSinh);
	m_jData[_T("TienSu")].GetValue(m_szTienSu);
	m_jData[_T("CacVanDe")].GetValue(m_szCacVanDe);
	m_jData[_T("ChanDoanSoBo")].GetValue(m_szChanDoanSoBo);
	m_jData[_T("HuongDieuTri")].GetValue(m_szHuongDieuTri);
	}

}
void CHMSBenhAnHiemMuon_TomTat::GetDataToScreen(){
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
	CRecord rs(&pMF->m_db);
	CString szSQL, szData, tmpStr;
	szSQL.Format(_T("SELECT hdi_summary FROM hms_doc_infertility WHERE hdi_docno = %ld "), m_nDocumentNo);
	rs.ExecSQL(szSQL);
	_debug(_T("%s"), szSQL);

	if(!rs.IsEOF())
	{
		rs.GetValue(_T("hdi_summary"), tmpStr);
		szData.AppendFormat(_T("%s"), tmpStr);
		m_jData.Parse(szData);
		UpdateJson(FALSE);
		UpdateData(FALSE);
		//SetMode(VM_VIEW);
	}else
	{
		//SetDefaultValues();
		_debug(_T("bug"));
		SetMode(VM_ADD);
	}

}
void CHMSBenhAnHiemMuon_TomTat::GetScreenToData(){
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
	UpdateJson(TRUE);
}
void CHMSBenhAnHiemMuon_TomTat::SetDefaultValues(){

	m_szHoTenVo.Empty();
	m_nNamSinhVo=0;
	m_szHoTenChong.Empty();
	m_nNamSinhChong=0;
	m_nVoSinh=0;
	m_szTienSu.Empty();
	m_szCacVanDe.Empty();
	m_szChanDoanSoBo.Empty();
	m_szHuongDieuTri.Empty();

}
int CHMSBenhAnHiemMuon_TomTat::SetMode(int nMode){
 		int nOldMode = GetMode();
 		CGuiView::SetMode(nMode);
 		CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
 		CString szSQL;
 		CRecord rs(&pMF->m_db);
  		switch(nMode){
 		case VM_ADD: 
 			EnableControls(TRUE);
 			EnableButtons(TRUE, 1, 2, -1);
 			//SetDefaultValues();
 			break;
 		case VM_EDIT: 
 			EnableControls(TRUE);
 			EnableButtons(TRUE, 1, 2, -1);
			m_wndHoTenChong.EnableWindow(FALSE);
			m_wndHoTenVo.EnableWindow(FALSE);
			m_wndNamSinhChong.EnableWindow(FALSE);
			m_wndNamSinhVo.EnableWindow(FALSE);
 			break;
 		case VM_VIEW: 
 			EnableControls(FALSE);
 			EnableButtons(FALSE, 4, 3, -1);
 			break;
 		case VM_NONE: 
 			EnableControls(FALSE);
 			EnableButtons(TRUE, 0, 6, -1);
 			SetDefaultValues();
 			break;
 		};
 		UpdateData(FALSE);
 		return nOldMode;
}
/*void CHMSBenhAnHiemMuon_TomTat::OnHoTenVoChange(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnHoTenVoSetfocus(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnHoTenVoKillfocus(){
	
} */
int CHMSBenhAnHiemMuon_TomTat::OnHoTenVoCheckValue(){
	return 0;
} 
/*void CHMSBenhAnHiemMuon_TomTat::OnNamSinhVoChange(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnNamSinhVoSetfocus(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnNamSinhVoKillfocus(){
	
} */
int CHMSBenhAnHiemMuon_TomTat::OnNamSinhVoCheckValue(){
	return 0;
} 
/*void CHMSBenhAnHiemMuon_TomTat::OnHoTenChongChange(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnHoTenChongSetfocus(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnHoTenChongKillfocus(){
	
} */
int CHMSBenhAnHiemMuon_TomTat::OnHoTenChongCheckValue(){
	return 0;
} 
/*void CHMSBenhAnHiemMuon_TomTat::OnNamSinhChongChange(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnNamSinhChongSetfocus(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnNamSinhChongKillfocus(){
	
} */
int CHMSBenhAnHiemMuon_TomTat::OnNamSinhChongCheckValue(){
	return 0;
} 
/*void CHMSBenhAnHiemMuon_TomTat::OnVoSinhChange(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnVoSinhSetfocus(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnVoSinhKillfocus(){
	
} */
int CHMSBenhAnHiemMuon_TomTat::OnVoSinhCheckValue(){
	return 0;
} 
/*void CHMSBenhAnHiemMuon_TomTat::OnTienSuChange(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnTienSuSetfocus(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnTienSuKillfocus(){
	
} */
int CHMSBenhAnHiemMuon_TomTat::OnTienSuCheckValue(){
	return 0;
} 
/*void CHMSBenhAnHiemMuon_TomTat::OnCacVanDeChange(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnCacVanDeSetfocus(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnCacVanDeKillfocus(){
	
} */
int CHMSBenhAnHiemMuon_TomTat::OnCacVanDeCheckValue(){
	return 0;
} 
/*void CHMSBenhAnHiemMuon_TomTat::OnChanDoanSoBoChange(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnChanDoanSoBoSetfocus(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnChanDoanSoBoKillfocus(){
	
} */
int CHMSBenhAnHiemMuon_TomTat::OnChanDoanSoBoCheckValue(){
	return 0;
} 
/*void CHMSBenhAnHiemMuon_TomTat::OnHuongDieuTriChange(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnHuongDieuTriSetfocus(){
	
} */
/*void CHMSBenhAnHiemMuon_TomTat::OnHuongDieuTriKillfocus(){
	
} */
int CHMSBenhAnHiemMuon_TomTat::OnHuongDieuTriCheckValue(){
	return 0;
} 
void CHMSBenhAnHiemMuon_TomTat::OnEditSelect(){
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
	OnEditHMSBenhAnHiemMuon_TomTat();
} 
void CHMSBenhAnHiemMuon_TomTat::OnSaveSelect(){
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
	OnSaveHMSBenhAnHiemMuon_TomTat();
} 
void CHMSBenhAnHiemMuon_TomTat::OnCancelSelect(){
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
	OnCancelHMSBenhAnHiemMuon_TomTat();
} 
int CHMSBenhAnHiemMuon_TomTat::OnAddHMSBenhAnHiemMuon_TomTat(){
 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)
 		return -1;
 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
 	SetMode(VM_ADD);
	return 0;
}
int CHMSBenhAnHiemMuon_TomTat::OnEditHMSBenhAnHiemMuon_TomTat(){
 	if(GetMode() != VM_VIEW)
 		return -1;
 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
 	SetMode(VM_EDIT);
	return 0;  
}
int CHMSBenhAnHiemMuon_TomTat::OnDeleteHMSBenhAnHiemMuon_TomTat(){
 	if(GetMode() != VM_VIEW)
 		return -1;
 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
 	CString szSQL;
 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO)
 		return -1;
 	szSQL.Format(_T("DELETE FROM  WHERE  AND") );
 	int ret = pMF->ExecSQL(szSQL);
 	if(ret >= 0){
 		SetMode(VM_NONE);
 		OnCancelHMSBenhAnHiemMuon_TomTat();
 	}
	return 0;
}
int CHMSBenhAnHiemMuon_TomTat::OnSaveHMSBenhAnHiemMuon_TomTat(){
 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
	if(!IsValidateData())
 		return -1;
	CString szSQL;
	CString szData;
	int ret = 0;
	GetScreenToData();
	m_jData.ToString(szData);
	
	int n =0;
	CString tmpStr, tmpStr2;
	tmpStr = szData;

	szSQL.Format(_T("UPDATE hms_doc_infertility SET HDI_UPDATEDBY = '%s', HDI_UPDATEDDATE = to_timestamp('%s','yyyy/mm/dd hh24:mi:ss'), ") \
		_T(" HDI_SUMMARY = '%s' WHERE HDI_DOCNO = '%ld'"), pMF->GetCurrentUser(), pMF->GetSysDateTime(), tmpStr, m_nDocumentNo);
	ret = pMF->ExecSQL(szSQL);
	_fmsg(_T("%s"), szSQL);
	
	if(ret > 0)
		SetMode(VM_VIEW);
	else
		MessageBox(_T("Error"), 0, MB_ICONERROR);

	
 	return ret;
}
int CHMSBenhAnHiemMuon_TomTat::OnCancelHMSBenhAnHiemMuon_TomTat(){
 	if(GetMode() == VM_EDIT)
 	{
 		SetMode(VM_VIEW);
 	} 
 	else 
 	{
 		SetMode(VM_NONE);
 	} 
 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
 	return 0;
} 
int CHMSBenhAnHiemMuon_TomTat::OnHMSBenhAnHiemMuon_TomTatListLoadData(){
	return 0;
}
void CHMSBenhAnHiemMuon_TomTat::OnPrint()
{
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
	CReport rpt;
	UpdateData(true);
	CRecord rs(&pMF->m_db);
	CReportSection *rptHeader = NULL, *rptDetail = NULL, *rptFooter = NULL, *rptGroupHeader = NULL;
	CString szSQL, tmpStr, szDate, szWhere;
	int nIdx = 1;

	if (!rpt.Init(_T("Reports\\HMS\\HMS_BENHANHIEMMUON_TOMTAT.RPT")))
		return;

	rptHeader = rpt.GetReportHeader();
	
	rptHeader->SetValue(_T("HoTenVo"), m_szHoTenVo);
	rptHeader->SetValue(_T("HoTenChong"), m_szHoTenChong);
	rptHeader->SetValue(_T("NamSinhVo"), m_nNamSinhVo);
	rptHeader->SetValue(_T("NamSinhChong"), m_nNamSinhChong);
	rptHeader->SetValue(_T("VoSinh"), m_nVoSinh);
	rptHeader->SetValue(_T("TienSu"), m_szTienSu);
	rptHeader->SetValue(_T("CacVanDe"), m_szCacVanDe);
	rptHeader->SetValue(_T("ChanDoanSoBo"), m_szChanDoanSoBo);
	rptHeader->SetValue(_T("HuongDieuTri"), m_szHuongDieuTri);
	

	rptDetail = rpt.AddDetail();
	rptFooter = rpt.GetReportFooter();
	EndWaitCursor();
	rpt.PrintPreview();
}
void CHMSBenhAnHiemMuon_TomTat::GetNameDOB()
{
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
	CRecord rs(&pMF->m_db);
	CRecord rs2(&pMF->m_db);
	CString szSQL, szData, tmpStr;
	int nRet = 0;
	if(pMF->m_bSwitch)
		szSQL.Format(_T("SELECT hdi_summary FROM hms_doc_infertility WHERE hdi_docno = %ld "), m_nDocumentNo);
	else
		szSQL.Format(_T("SELECT hdi_summary FROM hms_doc_infertility WHERE hdi_refdoc = %ld "), m_nDocumentNo);
	nRet = rs.ExecSQL(szSQL);
		
	if(pMF->m_bSwitch)
		szSQL.Format(_T("SELECT hdi_docinfo FROM hms_doc_infertility WHERE hdi_docno = %ld "), m_nDocumentNo);
	else
		szSQL.Format(_T("SELECT hdi_docinfo FROM hms_doc_infertility WHERE hdi_refdoc = %ld "), m_nDocumentNo);
	rs2.ExecSQL(szSQL);
	if(!rs2.IsEOF())
	{
		rs2.GetValue(_T("hdi_docinfo"), tmpStr);
		szData.Format(_T("%s"), tmpStr);
		m_jData.Parse(szData);
		m_jData[_T("WifeName")].GetValue(m_szHoTenVo);
		m_jData[_T("WifeDOB")].GetValue(m_nNamSinhVo);
		m_jData[_T("HusName")].GetValue(m_szHoTenChong);
		m_jData[_T("HusDOB")].GetValue(m_nNamSinhChong);
		UpdateData(FALSE);
	}
	_debug(_T("%s %s - %d - %s -%d"),szSQL,m_szHoTenVo,m_nNamSinhVo,m_szHoTenChong,m_nNamSinhChong);
	SetMode(VM_VIEW);
}