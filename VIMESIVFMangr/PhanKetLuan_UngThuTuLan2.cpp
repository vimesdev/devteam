#include "PhanKetLuan_UngThuTuLan2.h"
#include "MainFrm.h"
/*static void _OnkhambenhChangeFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OnkhambenhChange();
} */
/*static void _OnkhambenhSetfocusFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OnkhambenhSetfocus();} */ 
/*static void _OnkhambenhKillfocusFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OnkhambenhKillfocus();
} */
static int _OnkhambenhCheckValueFnc(CWnd *pWnd){
	return ((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OnkhambenhCheckValue();
} 
/*static void _OndanhgiaketquaChangeFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OndanhgiaketquaChange();
} */
/*static void _OndanhgiaketquaSetfocusFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OndanhgiaketquaSetfocus();} */ 
/*static void _OndanhgiaketquaKillfocusFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OndanhgiaketquaKillfocus();
} */
static int _OndanhgiaketquaCheckValueFnc(CWnd *pWnd){
	return ((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OndanhgiaketquaCheckValue();
} 
/*static void _OnchandoanChangeFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OnchandoanChange();
} */
/*static void _OnchandoanSetfocusFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OnchandoanSetfocus();} */ 
/*static void _OnchandoanKillfocusFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OnchandoanKillfocus();
} */
static int _OnchandoanCheckValueFnc(CWnd *pWnd){
	return ((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OnchandoanCheckValue();
} 
/*static void _OncacxetnghiemChangeFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OncacxetnghiemChange();
} */
/*static void _OncacxetnghiemSetfocusFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OncacxetnghiemSetfocus();} */ 
/*static void _OncacxetnghiemKillfocusFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OncacxetnghiemKillfocus();
} */
static int _OncacxetnghiemCheckValueFnc(CWnd *pWnd){
	return ((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OncacxetnghiemCheckValue();
} 
/*static void _OnhuongdieutriChangeFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OnhuongdieutriChange();
} */
/*static void _OnhuongdieutriSetfocusFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OnhuongdieutriSetfocus();} */ 
/*static void _OnhuongdieutriKillfocusFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OnhuongdieutriKillfocus();
} */
static int _OnhuongdieutriCheckValueFnc(CWnd *pWnd){
	return ((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OnhuongdieutriCheckValue();
} 
/*static void _OntienluongChangeFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OntienluongChange();
} */
/*static void _OntienluongSetfocusFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OntienluongSetfocus();} */ 
/*static void _OntienluongKillfocusFnc(CWnd *pWnd){
	((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OntienluongKillfocus();
} */
static int _OntienluongCheckValueFnc(CWnd *pWnd){
	return ((CPhanKetLuan_UngThuTuLan2 *)pWnd)->OntienluongCheckValue();
} 
static int _OnAddPhanKetLuan_UngThuTuLan2Fnc(CWnd *pWnd){
	 return ((CPhanKetLuan_UngThuTuLan2*)pWnd)->OnAddPhanKetLuan_UngThuTuLan2();
} 
static int _OnEditPhanKetLuan_UngThuTuLan2Fnc(CWnd *pWnd){
	 return ((CPhanKetLuan_UngThuTuLan2*)pWnd)->OnEditPhanKetLuan_UngThuTuLan2();
} 
static int _OnDeletePhanKetLuan_UngThuTuLan2Fnc(CWnd *pWnd){
	 return ((CPhanKetLuan_UngThuTuLan2*)pWnd)->OnDeletePhanKetLuan_UngThuTuLan2();
} 
static int _OnSavePhanKetLuan_UngThuTuLan2Fnc(CWnd *pWnd){
	 return ((CPhanKetLuan_UngThuTuLan2*)pWnd)->OnSavePhanKetLuan_UngThuTuLan2();
} 
static int _OnCancelPhanKetLuan_UngThuTuLan2Fnc(CWnd *pWnd){
	 return ((CPhanKetLuan_UngThuTuLan2*)pWnd)->OnCancelPhanKetLuan_UngThuTuLan2();
} 

// CPhanKetLuan_UngThuTuLan2::CPhanKetLuan_UngThuTuLan2(){
// 
// }
// CPhanKetLuan_UngThuTuLan2::CPhanKetLuan_UngThuTuLan2(CWnd *pParent, int nMode, long nDocNo, CString szRecordNo){
// 
// }
// CPhanKetLuan_UngThuTuLan2::~CPhanKetLuan_UngThuTuLan2(){
// }
// void CPhanKetLuan_UngThuTuLan2::Init(CWnd *pParent, int nMode, long nDocNo, CString szRecordNo){
// 	CGuiView::SetMode(nMode);
// 	m_nDocumentNo = nDocNo;
// 	m_szRecordNo = szRecordNo;
// 	m_nDlgWidth = 960;
// 	m_nDlgHeight = 600;
// 	SetDefaultValues();
// }

CPhanKetLuan_UngThuTuLan2::CPhanKetLuan_UngThuTuLan2(){
	m_szType = _T("BENH_AN_KL_UTTL2");
}

CPhanKetLuan_UngThuTuLan2::~CPhanKetLuan_UngThuTuLan2(){
}

void CPhanKetLuan_UngThuTuLan2::Init(int nMode, long nDocNo, CString szRecordNo, int nHtrIdx, int nCancerTime, int nTreatTime)
{
	CGuiView::SetMode(nMode);
	m_nDocumentNo = nDocNo;
	m_szRecordNo = szRecordNo;
	m_nHtrIdx = nHtrIdx;
	m_nTreatTime = nTreatTime;
	m_nCancerTime = nCancerTime;
	m_nDlgWidth = 960;
	m_nDlgHeight = 600;
	SetDefaultValues();
}

void CPhanKetLuan_UngThuTuLan2::OnCreateComponents(){
	m_wndkhambenhLabel.Create(this, _T("1. Khám bệnh:"), 5, 5, 155, 30);
	m_wndkhambenh.Create(this,5, 31, 930, 231, 1, 0, 1); 
	m_wnddanhgiaketquaLabel.Create(this, _T("2. Đánh giá kết quả điều trị và tình hình thực tại của bệnh nhân:"), 5, 232, 465, 257);
	m_wnddanhgiaketqua.Create(this,5, 258, 465, 333, 1, 0, 1); 
	m_wndchandoanLabel.Create(this, _T("3. Chẩn đoán:"), 470, 232, 620, 257);
	m_wndchandoan.Create(this,470, 258, 930, 333, 1, 0, 1); 
	m_wndkehoachdieutriLabel.Create(this, _T("4. Kế hoạch điều trị:"), 5, 334, 155, 359);
	m_wndcacxetnghiemLabel.Create(this, _T("Các xét nghiệm cần làm:"), 5, 360, 465, 385);
	m_wndcacxetnghiem.Create(this,5, 386, 465, 461, 1, 0, 1); 
	m_wndhuongdieutriLabel.Create(this, _T("Hướng điều trị:"), 470, 360, 620, 385);
	m_wndhuongdieutri.Create(this,470, 386, 930, 461, 1, 0, 1); 
	m_wndtienluongLabel.Create(this, _T("5. Tiên lượng:"), 5, 462, 155, 487);
	m_wndtienluong.Create(this,5, 488, 930, 563, 1, 0, 1); 

}
void CPhanKetLuan_UngThuTuLan2::OnInitializeComponents(){
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
// 	m_wndkhambenh.SetLimitText(35);
// 	m_wndkhambenh.SetCheckValue(true);
// 	m_wnddanhgiaketqua.SetLimitText(35);
// 	m_wnddanhgiaketqua.SetCheckValue(true);
// 	m_wndchandoan.SetLimitText(35);
// 	m_wndchandoan.SetCheckValue(true);
// 	m_wndcacxetnghiem.SetLimitText(35);
// 	m_wndcacxetnghiem.SetCheckValue(true);
// 	m_wndhuongdieutri.SetLimitText(35);
// 	m_wndhuongdieutri.SetCheckValue(true);
// 	m_wndtienluong.SetLimitText(35);
// 	m_wndtienluong.SetCheckValue(true);

}
void CPhanKetLuan_UngThuTuLan2::OnSetWindowEvents(){
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
	//m_wndkhambenh.SetEvent(WE_CHANGE, _OnkhambenhChangeFnc);
	//m_wndkhambenh.SetEvent(WE_SETFOCUS, _OnkhambenhSetfocusFnc);
	//m_wndkhambenh.SetEvent(WE_KILLFOCUS, _OnkhambenhKillfocusFnc);
	m_wndkhambenh.SetEvent(WE_CHECKVALUE, _OnkhambenhCheckValueFnc);
	//m_wnddanhgiaketqua.SetEvent(WE_CHANGE, _OndanhgiaketquaChangeFnc);
	//m_wnddanhgiaketqua.SetEvent(WE_SETFOCUS, _OndanhgiaketquaSetfocusFnc);
	//m_wnddanhgiaketqua.SetEvent(WE_KILLFOCUS, _OndanhgiaketquaKillfocusFnc);
	m_wnddanhgiaketqua.SetEvent(WE_CHECKVALUE, _OndanhgiaketquaCheckValueFnc);
	//m_wndchandoan.SetEvent(WE_CHANGE, _OnchandoanChangeFnc);
	//m_wndchandoan.SetEvent(WE_SETFOCUS, _OnchandoanSetfocusFnc);
	//m_wndchandoan.SetEvent(WE_KILLFOCUS, _OnchandoanKillfocusFnc);
	m_wndchandoan.SetEvent(WE_CHECKVALUE, _OnchandoanCheckValueFnc);
	//m_wndcacxetnghiem.SetEvent(WE_CHANGE, _OncacxetnghiemChangeFnc);
	//m_wndcacxetnghiem.SetEvent(WE_SETFOCUS, _OncacxetnghiemSetfocusFnc);
	//m_wndcacxetnghiem.SetEvent(WE_KILLFOCUS, _OncacxetnghiemKillfocusFnc);
	m_wndcacxetnghiem.SetEvent(WE_CHECKVALUE, _OncacxetnghiemCheckValueFnc);
	//m_wndhuongdieutri.SetEvent(WE_CHANGE, _OnhuongdieutriChangeFnc);
	//m_wndhuongdieutri.SetEvent(WE_SETFOCUS, _OnhuongdieutriSetfocusFnc);
	//m_wndhuongdieutri.SetEvent(WE_KILLFOCUS, _OnhuongdieutriKillfocusFnc);
	m_wndhuongdieutri.SetEvent(WE_CHECKVALUE, _OnhuongdieutriCheckValueFnc);
	//m_wndtienluong.SetEvent(WE_CHANGE, _OntienluongChangeFnc);
	//m_wndtienluong.SetEvent(WE_SETFOCUS, _OntienluongSetfocusFnc);
	//m_wndtienluong.SetEvent(WE_KILLFOCUS, _OntienluongKillfocusFnc);
	m_wndtienluong.SetEvent(WE_CHECKVALUE, _OntienluongCheckValueFnc);
	int nMode = GetMode();
	if(nMode == VM_VIEW || nMode == VM_EDIT)
		GetDataToScreen();
	SetMode(nMode);

}
void CPhanKetLuan_UngThuTuLan2::OnDoDataExchange(CDataExchange* pDX){
	DDX_Text(pDX, m_wndkhambenh.GetDlgCtrlID(), m_szkhambenh);
	DDX_Text(pDX, m_wnddanhgiaketqua.GetDlgCtrlID(), m_szdanhgiaketqua);
	DDX_Text(pDX, m_wndchandoan.GetDlgCtrlID(), m_szchandoan);
	DDX_Text(pDX, m_wndcacxetnghiem.GetDlgCtrlID(), m_szcacxetnghiem);
	DDX_Text(pDX, m_wndhuongdieutri.GetDlgCtrlID(), m_szhuongdieutri);
	DDX_Text(pDX, m_wndtienluong.GetDlgCtrlID(), m_sztienluong);

}
void CPhanKetLuan_UngThuTuLan2::UpdateJson(BOOL bSave){
	if(bSave)
	{
		UpdateData(TRUE);
		m_jData[_T("cancertime")] =  m_nCancerTime;
		m_jData[_T("kham_benh")] =  m_szkhambenh;
		m_jData[_T("danh_gia_ket_qua")] =  m_szdanhgiaketqua;
		m_jData[_T("chan_doan")] =  m_szchandoan;
		m_jData[_T("ke_hoach_xet_nghiem")] =  m_szcacxetnghiem;
		m_jData[_T("ke_hoach_dieu_tri")] =  m_szhuongdieutri;
		m_jData[_T("tien_luong")] =  m_sztienluong;
	}
	else
	{
		m_jData[_T("cancertime")].GetValue(m_nCancerTime);
		m_jData[_T("kham_benh")].GetValue(m_szkhambenh);
		m_jData[_T("danh_gia_ket_qua")].GetValue(m_szdanhgiaketqua);
		m_jData[_T("chan_doan")].GetValue(m_szchandoan);
		m_jData[_T("ke_hoach_xet_nghiem")].GetValue(m_szcacxetnghiem);
		m_jData[_T("ke_hoach_dieu_tri")].GetValue(m_szhuongdieutri);
		m_jData[_T("tien_luong")].GetValue(m_sztienluong);
		UpdateData(FALSE);
	}

}
void CPhanKetLuan_UngThuTuLan2::GetDataToScreen(){
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
	CRecord rs(&pMF->m_db);
	CString szSQL, szType, tmpStr, szData;
	int n = 0;
	
	CString szFilter;
	szFilter.Empty();
	bool res = pMF->GetEMRData(m_nDocumentNo, m_nTreatTime, m_szType, m_szRecordNo, szFilter, szData);
	if(res)
	{
		m_jData.Parse(szData);
		UpdateJson(FALSE);
	}
	else
	{

		szSQL.Format(_T("SELECT COUNT(*) AS solan FROM hms_doc_emr WHERE hde_docno=%ld and hde_name in ('%s', 'BANGT') ") \
			_T(" and hde_type='BENH_AN_KL_UTTL2' AND hde_treattime = %d"), m_nDocumentNo, m_szRecordNo, m_nTreatTime);
		rs.ExecSQL(szSQL);
		rs.GetValue(_T("solan"), n);

		if(n > 0)
		{
			for (int i = 0; i < n; i++)
			{
				szSQL.Format(_T("SELECT to_char(hde_value) as hde_value FROM hms_doc_emr WHERE hde_docno=%ld and hde_name in ('%s', 'BANGT') ") \
					_T(" and hde_type='BENH_AN_KL_UTTL2' and hde_refidx = %d AND hde_treattime = %d "), m_nDocumentNo, m_szRecordNo, i, m_nTreatTime);
				rs.ExecSQL(szSQL);
				rs.GetValue(_T("hde_value"), tmpStr);
				szData.AppendFormat(_T("%s"), tmpStr);
			}
			m_jData.Parse(szData);
			UpdateJson(FALSE);
		}
		else
		{
			SetDefaultValues();
			m_wndkhambenh.SetFocus();
		}
	}
}
void CPhanKetLuan_UngThuTuLan2::GetScreenToData(){
	CMainFrame *pMF = (CMainFrame*) AfxGetMainWnd();
	UpdateJson(TRUE);
}
void CPhanKetLuan_UngThuTuLan2::SetDefaultValues(){

	m_szkhambenh.Empty();
	m_szdanhgiaketqua.Empty();
	m_szchandoan.Empty();
	m_szcacxetnghiem.Empty();
	m_szhuongdieutri.Empty();
	m_sztienluong.Empty();

}
int CPhanKetLuan_UngThuTuLan2::SetMode(int nMode){
 		int nOldMode = GetMode();
 		CGuiView::SetMode(nMode);
 		CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
 		CString szSQL;
 		CRecord rs(&pMF->m_db);
  		switch(nMode){
 		case VM_ADD: 
 			EnableControls(TRUE);
 			EnableButtons(TRUE, 3, 4, -1);
 			SetDefaultValues();
 			break;
 		case VM_EDIT: 
 			EnableControls(TRUE);
 			EnableButtons(TRUE, 3, 4, -1);
 			break;
 		case VM_VIEW: 
 			EnableControls(FALSE);
 			EnableButtons(FALSE, 3, 4, -1);
 			break;
 		case VM_NONE: 
 			EnableControls(FALSE);
 			EnableButtons(TRUE, 0, 6, -1);
 			SetDefaultValues();
 			break;
 		};
 		UpdateData(FALSE);
 		return nOldMode;
}
/*void CPhanKetLuan_UngThuTuLan2::OnkhambenhChange(){
	
} */
/*void CPhanKetLuan_UngThuTuLan2::OnkhambenhSetfocus(){
	
} */
/*void CPhanKetLuan_UngThuTuLan2::OnkhambenhKillfocus(){
	
} */
int CPhanKetLuan_UngThuTuLan2::OnkhambenhCheckValue(){
	return 0;
} 
/*void CPhanKetLuan_UngThuTuLan2::OndanhgiaketquaChange(){
	
} */
/*void CPhanKetLuan_UngThuTuLan2::OndanhgiaketquaSetfocus(){
	
} */
/*void CPhanKetLuan_UngThuTuLan2::OndanhgiaketquaKillfocus(){
	
} */
int CPhanKetLuan_UngThuTuLan2::OndanhgiaketquaCheckValue(){
	return 0;
} 
/*void CPhanKetLuan_UngThuTuLan2::OnchandoanChange(){
	
} */
/*void CPhanKetLuan_UngThuTuLan2::OnchandoanSetfocus(){
	
} */
/*void CPhanKetLuan_UngThuTuLan2::OnchandoanKillfocus(){
	
} */
int CPhanKetLuan_UngThuTuLan2::OnchandoanCheckValue(){
	return 0;
} 
/*void CPhanKetLuan_UngThuTuLan2::OncacxetnghiemChange(){
	
} */
/*void CPhanKetLuan_UngThuTuLan2::OncacxetnghiemSetfocus(){
	
} */
/*void CPhanKetLuan_UngThuTuLan2::OncacxetnghiemKillfocus(){
	
} */
int CPhanKetLuan_UngThuTuLan2::OncacxetnghiemCheckValue(){
	return 0;
} 
/*void CPhanKetLuan_UngThuTuLan2::OnhuongdieutriChange(){
	
} */
/*void CPhanKetLuan_UngThuTuLan2::OnhuongdieutriSetfocus(){
	
} */
/*void CPhanKetLuan_UngThuTuLan2::OnhuongdieutriKillfocus(){
	
} */
int CPhanKetLuan_UngThuTuLan2::OnhuongdieutriCheckValue(){
	return 0;
} 
/*void CPhanKetLuan_UngThuTuLan2::OntienluongChange(){
	
} */
/*void CPhanKetLuan_UngThuTuLan2::OntienluongSetfocus(){
	
} */
/*void CPhanKetLuan_UngThuTuLan2::OntienluongKillfocus(){
	
} */
int CPhanKetLuan_UngThuTuLan2::OntienluongCheckValue(){
	return 0;
} 
int CPhanKetLuan_UngThuTuLan2::OnAddPhanKetLuan_UngThuTuLan2(){
 	if(GetMode() == VM_ADD || GetMode() == VM_EDIT)
 		return -1;
 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
 	SetMode(VM_ADD);
	return 0;
}
int CPhanKetLuan_UngThuTuLan2::OnEditPhanKetLuan_UngThuTuLan2(){
 	if(GetMode() != VM_VIEW)
 		return -1;
 	CMainFrame *pMF = (CMainFrame *) AfxGetMainWnd();
 	SetMode(VM_EDIT);
	return 0;  
}
int CPhanKetLuan_UngThuTuLan2::OnDeletePhanKetLuan_UngThuTuLan2(){
 	if(GetMode() != VM_VIEW)
 		return -1;
 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
 	CString szSQL;
 	if(ShowMessage(1, MB_YESNO|MB_ICONQUESTION|MB_DEFBUTTON2) == IDNO)
 		return -1;
 	szSQL.Format(_T("DELETE FROM  WHERE  AND") );
 	int ret = pMF->ExecSQL(szSQL);
 	if(ret >= 0){
 		SetMode(VM_NONE);
 		OnCancelPhanKetLuan_UngThuTuLan2();
 	}
	return 0;
}
int CPhanKetLuan_UngThuTuLan2::OnSavePhanKetLuan_UngThuTuLan2(){
 	if(GetMode() != VM_ADD && GetMode() != VM_EDIT)
		return -1;
	if(!IsValidateData())
		return -1;
	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
	CString szSQL;
	CString szData;
	int ret = 0;
	m_jData.ToString(szData);

	//Thay function hms_doc_emr_create = function SaveEMRData
	bool res = pMF->SaveEMRData(m_szType, m_szRecordNo, m_nDocumentNo, pMF->m_szDept, pMF->m_nRefIndex, m_nCancerTime,  0, szData);
	if(!res)
		return -1;
	res = 1;
	/*
	int n =0;
	CString tmpStr;
	tmpStr = szData;

	pMF->BeginTransaction();
	szSQL.Format(_T("DELETE FROM hms_doc_emr WHERE hde_docno=%ld and hde_name='%s' and hde_type='BENH_AN_KL_UTTL2' AND hde_htridx = %d "), m_nDocumentNo, m_szRecordNo, m_nHtrIdx);
	pMF->ExecSQL(szSQL);

	CStringArray strList;
	pMF->String2Array(szData, &strList, 2000);
	for (int i =0; i < strList.GetCount();i++)
	{
		tmpStr = strList[i];
		tmpStr.Replace(_T("'"), _T("''"));
		szSQL.Format(_T("HMS_DOC_EMR_CREATE('BENH_AN_KL_UTTL2', %ld, '%s', %d, %d, '%s', '%s', '%s', %d, %d) "),
			m_nDocumentNo, pMF->m_szDept, n++, 0, pMF->GetCurrentUser(), m_szRecordNo, tmpStr, 0, m_nHtrIdx);
		ret = str2int(pMF->ExecDML(szSQL));
		if(ret < 0)
		{
			pMF->Rollback();
			return -1;
		}
		
	}
	pMF->Commit();
	*/
/*
	for (;;)
	{
		szSQL.Format(_T("HMS_DOC_EMR_CREATE('BENH_AN', %ld, '%s', %d, %d, '%s', '%s', '%s') "),
			m_nDocumentNo, pMF->m_szDept, n++, 0, pMF->GetCurrentUser(), m_szRecordNo, tmpStr);
		ret = str2int(pMF->ExecDML(szSQL));
		_msg(_T("%d"), n++);
		if(tmpStr.GetLength()  < 2000)
			break;
		tmpStr = tmpStr.Mid(2000);
	}
*/

/*
	szSQL.Format(_T("HMS_DOC_EMR_CREATE('BENH_AN', %ld, '%s', %d, %d, '%s', '%s', '%s') "),
		m_nDocumentNo, pMF->m_szDept, 1, 0, pMF->GetCurrentUser(), m_szRecordNo, szData);

	int ret = str2int(pMF->ExecDML(szSQL));

	return ret;
*/

	return ret;

	return 0;
}
int CPhanKetLuan_UngThuTuLan2::OnCancelPhanKetLuan_UngThuTuLan2(){
 	if(GetMode() == VM_EDIT)
 	{
 		SetMode(VM_VIEW);
 	} 
 	else 
 	{
 		SetMode(VM_NONE);
 	} 
 	CMainFrame *pMF = (CMainFrame *)AfxGetMainWnd();
 	return 0;
} 
int CPhanKetLuan_UngThuTuLan2::OnPhanKetLuan_UngThuTuLan2ListLoadData(){
	return 0;
}

void CPhanKetLuan_UngThuTuLan2::Refresh(int nTreatTime)
{
	m_nTreatTime = nTreatTime;
	GetDataToScreen();
	SetMode(VM_VIEW);
}